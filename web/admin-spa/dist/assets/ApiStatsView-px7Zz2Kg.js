import{aT as rt,r as D,c as R,aZ as j,x as i,y as n,z as t,O as b,K as G,aq as X,u as e,aa as ot,f as lt,P as o,C as M,L,B as Y,R as A,Q as F,ac as V,q as it,aY as nt,V as dt,o as ct,J as ut,ax as mt}from"./vue-vendor-CcFZMz-v.js";import{_ as E,a as xt}from"./index-BZqqNmWF.js";import{L as gt}from"./LogoTitle-MNvdAi1Y.js";import{T as ft}from"./ThemeToggle-CmSxoxJV.js";import{b as yt}from"./vendor-B90ziCBp.js";import{_ as pt}from"./WindowCountdown-DEPTPq8A.js";import vt from"./TutorialView-BcXcs79J.js";import"./element-plus-C-1FTG0y.js";class bt{constructor(){this.baseURL=window.location.origin,this.isDev=!1}async request(c,a={}){try{this.isDev&&c.startsWith("/admin")&&(c="/webapi"+c);const x=await fetch(`${this.baseURL}${c}`,{headers:{"Content-Type":"application/json",...a.headers},...a}),f=await x.json();if(!x.ok)throw new Error(f.message||`请求失败: ${x.status}`);return f}catch(x){throw console.error("API Stats request error:",x),x}}async getKeyId(c){return this.request("/apiStats/api/get-key-id",{method:"POST",body:JSON.stringify({apiKey:c})})}async getUserStats(c){return this.request("/apiStats/api/user-stats",{method:"POST",body:JSON.stringify({apiId:c})})}async getUserModelStats(c,a="daily"){return this.request("/apiStats/api/user-model-stats",{method:"POST",body:JSON.stringify({apiId:c,period:a})})}async getUserHourlyStats(c,a,x=24){return this.request("/apiStats/api/user-model-stats/hourly",{method:"POST",body:JSON.stringify({apiKey:c,date:a,hours:x})})}async getOemSettings(){try{return await this.request("/admin/oem-settings")}catch(c){return console.error("Failed to load OEM settings:",c),{success:!0,data:{siteName:"Claude Relay Service",siteIcon:"",siteIconData:""}}}}}const N=new bt,U=rt("apistats",()=>{const I=D(""),c=D(null),a=D(!1),x=D(!1),f=D(!0),m=D(""),s=D("daily"),h=D(null),S=D([]),T=D(null),P=D(null),u=D([]),g=D(!1),q=D(""),y=D({selectedHours:24,selectedDate:new Date().toISOString().split("T")[0]}),k=D({siteName:"",siteIcon:"",siteIconData:""}),l=R(()=>{const r={requests:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,allTokens:0,cost:0,formattedCost:"$0.000000"};return s.value==="daily"?T.value||r:s.value==="monthly"?P.value||r:s.value==="hourly"&&d.value||r}),d=R(()=>{if(!u.value||u.value.length===0)return null;const r={requests:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,allTokens:0,cost:0,formattedCost:"$0.000000"};return u.value.forEach($=>{var W;r.requests+=$.requests||0,r.inputTokens+=$.inputTokens||0,r.outputTokens+=$.outputTokens||0,r.cacheCreateTokens+=$.cacheCreateTokens||0,r.cacheReadTokens+=$.cacheReadTokens||0,r.allTokens+=$.allTokens||0,r.cost+=((W=$.costs)==null?void 0:W.total)||0}),r.formattedCost=z(r.cost),r}),p=R(()=>{if(!h.value||!l.value)return{tokenUsage:0,costUsage:0,requestUsage:0};const r=l.value,$=h.value.limits;return{tokenUsage:$.tokenLimit>0?Math.min(r.allTokens/$.tokenLimit*100,100):0,costUsage:$.dailyCostLimit>0?Math.min(r.cost/$.dailyCostLimit*100,100):0,requestUsage:$.rateLimitRequests>0?Math.min(r.requests/$.rateLimitRequests*100,100):0}});async function _(){if(!I.value.trim()){m.value="请输入 API Key";return}a.value=!0,m.value="",h.value=null,S.value=[],c.value=null;try{const r=await N.getKeyId(I.value);if(r.success){c.value=r.data.id;const $=await N.getUserStats(c.value);if($.success)h.value=$.data,await w(),m.value="",st();else throw new Error($.message||"查询失败")}else throw new Error(r.message||"获取 API Key ID 失败")}catch(r){console.error("Query stats error:",r),m.value=r.message||"查询统计数据失败，请检查您的 API Key 是否正确",h.value=null,S.value=[],c.value=null}finally{a.value=!1}}async function w(){c.value&&(await Promise.all([C("daily"),C("monthly")]),await v(s.value))}async function C(r){try{const $=await N.getUserModelStats(c.value,r);if($.success){const W=$.data||[],K={requests:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,allTokens:0,cost:0,formattedCost:"$0.000000"};W.forEach(O=>{var Q;K.requests+=O.requests||0,K.inputTokens+=O.inputTokens||0,K.outputTokens+=O.outputTokens||0,K.cacheCreateTokens+=O.cacheCreateTokens||0,K.cacheReadTokens+=O.cacheReadTokens||0,K.allTokens+=O.allTokens||0,K.cost+=((Q=O.costs)==null?void 0:Q.total)||0}),K.formattedCost=z(K.cost),r==="daily"?T.value=K:P.value=K}else console.warn(`Failed to load ${r} stats:`,$.message)}catch($){console.error(`Load ${r} stats error:`,$)}}async function v(r="daily"){if(c.value){x.value=!0;try{const $=await N.getUserModelStats(c.value,r);if($.success)S.value=$.data||[];else throw new Error($.message||"加载模型统计失败")}catch($){console.error("Load model stats error:",$),S.value=[]}finally{x.value=!1}}}async function B(r){s.value===r||x.value||(s.value=r,r==="daily"&&!T.value||r==="monthly"&&!P.value?await C(r):r==="hourly"&&await H(),await v(r))}async function H(){if(!I.value){q.value="请先输入 API Key";return}g.value=!0,q.value="";try{const r=await N.getUserHourlyStats(I.value,y.value.selectedDate,y.value.selectedHours);if(r.success)u.value=r.data||[],q.value="";else throw new Error(r.message||"加载小时统计失败")}catch(r){console.error("Load hourly stats error:",r),q.value=r.message||"加载小时统计失败",u.value=[]}finally{g.value=!1}}async function Z(r){y.value={...y.value,...r},s.value==="hourly"&&await H()}async function tt(){if(c.value){a.value=!0,m.value="",h.value=null,S.value=[];try{const r=await N.getUserStats(c.value);if(r.success)h.value=r.data,await w(),m.value="";else throw new Error(r.message||"查询失败")}catch(r){console.error("Load stats with apiId error:",r),m.value=r.message||"查询统计数据失败",h.value=null,S.value=[]}finally{a.value=!1}}}async function et(){f.value=!0;try{const r=await N.getOemSettings();r&&r.success&&r.data&&(k.value={...k.value,...r.data})}catch(r){console.error("Error loading OEM settings:",r),k.value={siteName:"Claude Relay Service",siteIcon:"",siteIconData:""}}finally{f.value=!1}}function z(r){return typeof r!="number"||r===0?"$0.000000":r>=1?"$"+r.toFixed(2):r>=.01?"$"+r.toFixed(4):"$"+r.toFixed(6)}function st(){if(c.value){const r=new URL(window.location);r.searchParams.set("apiId",c.value),window.history.pushState({},"",r)}}function J(){h.value=null,S.value=[],T.value=null,P.value=null,u.value=[],q.value="",m.value="",s.value="daily",c.value=null}function at(){I.value="",J()}return{apiKey:I,apiId:c,loading:a,modelStatsLoading:x,oemLoading:f,error:m,statsPeriod:s,statsData:h,modelStats:S,dailyStats:T,monthlyStats:P,hourlyStats:u,hourlyLoading:g,hourlyError:q,hourlyConfig:y,oemSettings:k,currentPeriodData:l,hourlyStatsSummary:d,usagePercentages:p,queryStats:_,loadAllPeriodStats:w,loadPeriodStats:C,loadModelStats:v,switchPeriod:B,loadHourlyStats:H,updateHourlyConfig:Z,loadStatsWithApiId:tt,loadOemSettings:et,clearData:J,reset:at}}),kt={class:"api-input-wide-card mb-8 rounded-3xl p-6 shadow-xl"},_t={class:"mx-auto max-w-4xl"},ht={class:"api-input-grid grid grid-cols-1 lg:grid-cols-4"},$t={class:"lg:col-span-3"},wt=["disabled"],St={class:"lg:col-span-1"},Tt=["disabled"],Ct={key:0,class:"fas fa-spinner loading-spinner"},Dt={key:1,class:"fas fa-search"},qt={__name:"ApiKeyInput",setup(I){const c=U(),{apiKey:a,loading:x}=j(c),{queryStats:f}=c;return(m,s)=>(n(),i("div",kt,[s[6]||(s[6]=t("div",{class:"wide-card-title mb-6 text-center"},[t("h2",{class:"mb-2 text-2xl font-bold text-gray-900 dark:text-white"},[t("i",{class:"fas fa-chart-line mr-3"}),b(" 使用统计查询 ")]),t("p",{class:"text-base text-gray-600 dark:text-gray-300"},"查询您的 API Key 使用情况和统计数据")],-1)),t("div",_t,[t("div",ht,[t("div",$t,[s[3]||(s[3]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-200"},[t("i",{class:"fas fa-key mr-2"}),b(" 输入您的 API Key ")],-1)),G(t("input",{"onUpdate:modelValue":s[0]||(s[0]=h=>lt(a)?a.value=h:null),class:"wide-card-input w-full",disabled:e(x),placeholder:"请输入您的 API Key (cr_...)",type:"password",onKeyup:s[1]||(s[1]=ot((...h)=>e(f)&&e(f)(...h),["enter"]))},null,40,wt),[[X,e(a)]])]),t("div",St,[s[4]||(s[4]=t("label",{class:"mb-2 hidden text-sm font-medium text-gray-700 dark:text-gray-200 lg:block"},"   ",-1)),t("button",{class:"btn btn-primary btn-query flex h-full w-full items-center justify-center gap-2",disabled:e(x)||!e(a).trim(),onClick:s[2]||(s[2]=(...h)=>e(f)&&e(f)(...h))},[e(x)?(n(),i("i",Ct)):(n(),i("i",Dt)),b(" "+o(e(x)?"查询中...":"查询统计"),1)],8,Tt)])]),s[5]||(s[5]=t("div",{class:"security-notice mt-4"},[t("i",{class:"fas fa-shield-alt mr-2"}),b(" 您的 API Key 仅用于查询自己的统计数据，不会被存储或用于其他用途 ")],-1))])]))}},Lt=E(qt,[["__scopeId","data-v-42ae9d1d"]]),It={class:"mb-6 grid grid-cols-1 gap-4 md:mb-8 md:gap-6 lg:grid-cols-2"},Pt={class:"card p-4 md:p-6"},Mt={class:"space-y-2 md:space-y-3"},Rt={class:"flex items-center justify-between"},At={class:"break-all text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},Kt={class:"flex items-center justify-between"},Ht={class:"flex items-center justify-between"},jt={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},Et={class:"flex items-center justify-between"},Ut={class:"break-all text-xs font-medium text-gray-900 dark:text-gray-100 md:text-base"},Ot={class:"flex items-start justify-between"},Nt={key:0,class:"text-right"},Ft={key:0,class:"text-sm font-medium text-red-600 md:text-base"},Vt={key:1,class:"break-all text-xs font-medium text-orange-600 md:text-base"},Wt={key:2,class:"break-all text-xs font-medium text-gray-900 dark:text-gray-100 md:text-base"},Bt={key:1,class:"text-sm font-medium text-gray-400 dark:text-gray-500 md:text-base"},Yt={class:"card p-4 md:p-6"},zt={class:"mb-3 flex flex-col text-lg font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center md:mb-4 md:text-xl"},Jt={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},Qt={class:"grid grid-cols-2 gap-3 md:gap-4"},Gt={class:"stat-card text-center"},Xt={class:"text-lg font-bold text-green-600 md:text-3xl"},Zt={class:"text-xs text-gray-600 dark:text-gray-400 md:text-sm"},te={class:"stat-card text-center"},ee={class:"text-lg font-bold text-blue-600 md:text-3xl"},se={class:"text-xs text-gray-600 dark:text-gray-400 md:text-sm"},ae={class:"stat-card text-center"},re={class:"text-lg font-bold text-purple-600 md:text-3xl"},oe={class:"text-xs text-gray-600 dark:text-gray-400 md:text-sm"},le={class:"stat-card text-center"},ie={class:"text-lg font-bold text-yellow-600 md:text-3xl"},ne={class:"text-xs text-gray-600 dark:text-gray-400 md:text-sm"},de={__name:"StatsOverview",setup(I){const c=U(),{statsData:a,statsPeriod:x,currentPeriodData:f}=j(c),m=u=>{if(!u)return"无";try{return yt(u).format("YYYY年MM月DD日 HH:mm")}catch{return"格式错误"}},s=u=>u?new Date(u).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",h=u=>u?new Date(u)<new Date:!1,S=u=>{if(!u)return!1;const y=(new Date(u)-new Date)/(1e3*60*60*24);return y>0&&y<=7},T=u=>(typeof u!="number"&&(u=parseInt(u)||0),u===0?"0":u>=1e6?(u/1e6).toFixed(1)+"M":u>=1e3?(u/1e3).toFixed(1)+"K":u.toLocaleString()),P=u=>({claude:"Claude",gemini:"Gemini",all:"全部模型"})[u]||u||"未知";return(u,g)=>(n(),i("div",It,[t("div",Pt,[g[8]||(g[8]=t("h3",{class:"mb-3 flex items-center text-lg font-bold text-gray-900 dark:text-gray-100 md:mb-4 md:text-xl"},[t("i",{class:"fas fa-info-circle mr-2 text-sm text-blue-500 md:mr-3 md:text-base"}),b(" API Key 信息 ")],-1)),t("div",Mt,[t("div",Rt,[g[0]||(g[0]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"名称",-1)),t("span",At,o(e(a).name),1)]),t("div",Kt,[g[1]||(g[1]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"状态",-1)),t("span",{class:M(["text-sm font-medium md:text-base",e(a).isActive?"text-green-600":"text-red-600"])},[t("i",{class:M(["mr-1 text-xs md:text-sm",e(a).isActive?"fas fa-check-circle":"fas fa-times-circle"])},null,2),b(" "+o(e(a).isActive?"活跃":"已停用"),1)],2)]),t("div",Ht,[g[2]||(g[2]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"权限",-1)),t("span",jt,o(P(e(a).permissions)),1)]),t("div",Et,[g[3]||(g[3]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"创建时间",-1)),t("span",Ut,o(m(e(a).createdAt)),1)]),t("div",Ot,[g[7]||(g[7]=t("span",{class:"mt-1 flex-shrink-0 text-sm text-gray-600 dark:text-gray-400 md:text-base"},"过期时间",-1)),e(a).expiresAt?(n(),i("div",Nt,[h(e(a).expiresAt)?(n(),i("div",Ft,[...g[4]||(g[4]=[t("i",{class:"fas fa-exclamation-circle mr-1 text-xs md:text-sm"},null,-1),b(" 已过期 ",-1)])])):S(e(a).expiresAt)?(n(),i("div",Vt,[g[5]||(g[5]=t("i",{class:"fas fa-clock mr-1 text-xs md:text-sm"},null,-1)),b(" "+o(s(e(a).expiresAt)),1)])):(n(),i("div",Wt,o(s(e(a).expiresAt)),1))])):(n(),i("div",Bt,[...g[6]||(g[6]=[t("i",{class:"fas fa-infinity mr-1 text-xs md:text-sm"},null,-1),b(" 永不过期 ",-1)])]))])])]),t("div",Yt,[t("h3",zt,[g[9]||(g[9]=t("span",{class:"flex items-center"},[t("i",{class:"fas fa-chart-bar mr-2 text-sm text-green-500 md:mr-3 md:text-base"}),b(" 使用统计概览 ")],-1)),t("span",Jt,"("+o(e(x)==="daily"?"今日":"本月")+")",1)]),t("div",Qt,[t("div",Gt,[t("div",Xt,o(T(e(f).requests)),1),t("div",Zt,o(e(x)==="daily"?"今日":"本月")+"请求数 ",1)]),t("div",te,[t("div",ee,o(T(e(f).allTokens)),1),t("div",se,o(e(x)==="daily"?"今日":"本月")+"Token数 ",1)]),t("div",ae,[t("div",re,o(e(f).formattedCost||"$0.000000"),1),t("div",oe,o(e(x)==="daily"?"今日":"本月")+"费用 ",1)]),t("div",le,[t("div",ie,o(T(e(f).inputTokens)),1),t("div",ne,o(e(x)==="daily"?"今日":"本月")+"输入Token ",1)])])])]))}},ce=E(de,[["__scopeId","data-v-f536da49"]]),ue={class:"card p-4 md:p-6"},me={class:"mb-3 flex flex-col text-lg font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center md:mb-4 md:text-xl"},xe={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},ge={class:"space-y-2 md:space-y-3"},fe={class:"flex items-center justify-between"},ye={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},pe={class:"flex items-center justify-between"},ve={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},be={class:"flex items-center justify-between"},ke={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},_e={class:"flex items-center justify-between"},he={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},$e={class:"mt-3 border-t border-gray-200 pt-3 dark:border-gray-700 md:mt-4 md:pt-4"},we={class:"flex items-center justify-between font-bold text-gray-900 dark:text-gray-100"},Se={class:"text-sm md:text-base"},Te={class:"text-lg md:text-xl"},Ce={__name:"TokenDistribution",setup(I){const c=U(),{statsPeriod:a,currentPeriodData:x}=j(c),f=m=>(typeof m!="number"&&(m=parseInt(m)||0),m===0?"0":m>=1e6?(m/1e6).toFixed(1)+"M":m>=1e3?(m/1e3).toFixed(1)+"K":m.toLocaleString());return(m,s)=>(n(),i("div",ue,[t("h3",me,[s[0]||(s[0]=t("span",{class:"flex items-center"},[t("i",{class:"fas fa-coins mr-2 text-sm text-yellow-500 md:mr-3 md:text-base"}),b(" Token 使用分布 ")],-1)),t("span",xe,"("+o(e(a)==="daily"?"今日":"本月")+")",1)]),t("div",ge,[t("div",fe,[s[1]||(s[1]=t("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[t("i",{class:"fas fa-arrow-right mr-1 text-xs text-green-500 md:mr-2 md:text-sm"}),b(" 输入 Token ")],-1)),t("span",ye,o(f(e(x).inputTokens)),1)]),t("div",pe,[s[2]||(s[2]=t("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[t("i",{class:"fas fa-arrow-left mr-1 text-xs text-blue-500 md:mr-2 md:text-sm"}),b(" 输出 Token ")],-1)),t("span",ve,o(f(e(x).outputTokens)),1)]),t("div",be,[s[3]||(s[3]=t("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[t("i",{class:"fas fa-save mr-1 text-xs text-purple-500 md:mr-2 md:text-sm"}),b(" 缓存创建 Token ")],-1)),t("span",ke,o(f(e(x).cacheCreateTokens)),1)]),t("div",_e,[s[4]||(s[4]=t("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[t("i",{class:"fas fa-download mr-1 text-xs text-orange-500 md:mr-2 md:text-sm"}),b(" 缓存读取 Token ")],-1)),t("span",he,o(f(e(x).cacheReadTokens)),1)])]),t("div",$e,[t("div",we,[t("span",Se,o(e(a)==="daily"?"今日":"本月")+"总计",1),t("span",Te,o(f(e(x).allTokens)),1)])])]))}},De=E(Ce,[["__scopeId","data-v-ecee0a94"]]),qe={class:"card p-4 md:p-6"},Le={class:"space-y-4 md:space-y-5"},Ie={class:"mb-2 flex items-center justify-between"},Pe={class:"text-xs text-gray-500 dark:text-gray-400 md:text-sm"},Me={key:0},Re={key:1,class:"flex items-center gap-1"},Ae={key:0,class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Ke={key:1,class:"h-2 w-full rounded-full bg-gray-200"},He={key:0},je={class:"space-y-2 border-t border-gray-100 pt-2 dark:border-gray-700"},Ee={class:"flex items-center justify-between"},Ue={class:"text-sm font-medium text-gray-900 md:text-base"},Oe={key:0},Ne={key:1,class:"flex items-center gap-1"},Fe={class:"flex items-center justify-between"},Ve={class:"text-sm font-medium text-gray-900 md:text-base"},We={key:0,class:"text-orange-600"},Be={key:1,class:"text-green-600"},Ye={class:"flex items-center justify-between"},ze={class:"text-sm font-medium text-gray-900 md:text-base"},Je={key:0,class:"text-orange-600"},Qe={key:1,class:"text-green-600"},Ge={key:0,class:"card mt-4 p-4 md:mt-6 md:p-6"},Xe={class:"grid grid-cols-1 gap-4 md:gap-6 lg:grid-cols-2"},Ze={key:0,class:"rounded-lg border border-amber-200 bg-amber-50 p-3 dark:border-amber-800 dark:bg-amber-900/20 md:p-4"},ts={class:"space-y-1 md:space-y-2"},es={class:"break-all text-gray-800 dark:text-gray-200"},ss={key:1,class:"rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-800 dark:bg-blue-900/20 md:p-4"},as={class:"space-y-1 md:space-y-2"},rs={class:"break-all text-gray-800 dark:text-gray-200"},os={__name:"LimitConfig",setup(I){const c=U(),{statsData:a}=j(c),x=()=>{if(!a.value.limits.dailyCostLimit||a.value.limits.dailyCostLimit===0)return 0;const m=a.value.limits.currentDailyCost/a.value.limits.dailyCostLimit*100;return Math.min(m,100)},f=()=>{const m=x();return m>=100?"bg-red-500":m>=80?"bg-yellow-500":"bg-green-500"};return(m,s)=>(n(),i("div",null,[t("div",qe,[s[12]||(s[12]=t("h3",{class:"mb-3 flex items-center text-lg font-bold text-gray-900 dark:text-gray-100 md:mb-4 md:text-xl"},[t("i",{class:"fas fa-shield-alt mr-2 text-sm text-red-500 md:mr-3 md:text-base"}),b(" 限制配置 ")],-1)),t("div",Le,[t("div",null,[t("div",Ie,[s[1]||(s[1]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400 md:text-base"},"每日费用限制",-1)),t("span",Pe,[e(a).limits.dailyCostLimit>0?(n(),i("span",Me," $"+o(e(a).limits.currentDailyCost.toFixed(4))+" / $"+o(e(a).limits.dailyCostLimit.toFixed(2)),1)):(n(),i("span",Re,[b(" $"+o(e(a).limits.currentDailyCost.toFixed(4))+" / ",1),s[0]||(s[0]=t("i",{class:"fas fa-infinity"},null,-1))]))])]),e(a).limits.dailyCostLimit>0?(n(),i("div",Ae,[t("div",{class:M(["h-2 rounded-full transition-all duration-300",f()]),style:Y({width:x()+"%"})},null,6)])):(n(),i("div",Ke,[...s[2]||(s[2]=[t("div",{class:"h-2 rounded-full bg-green-500",style:{width:"0%"}},null,-1)])]))]),e(a).limits.rateLimitWindow>0&&(e(a).limits.rateLimitRequests>0||e(a).limits.tokenLimit>0)?(n(),i("div",He,[A(pt,{"current-requests":e(a).limits.currentWindowRequests,"current-tokens":e(a).limits.currentWindowTokens,label:"时间窗口限制","rate-limit-window":e(a).limits.rateLimitWindow,"request-limit":e(a).limits.rateLimitRequests,"show-progress":!0,"show-tooltip":!0,"token-limit":e(a).limits.tokenLimit,"window-end-time":e(a).limits.windowEndTime,"window-remaining-seconds":e(a).limits.windowRemainingSeconds,"window-start-time":e(a).limits.windowStartTime},null,8,["current-requests","current-tokens","rate-limit-window","request-limit","token-limit","window-end-time","window-remaining-seconds","window-start-time"]),s[3]||(s[3]=t("div",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[t("i",{class:"fas fa-info-circle mr-1"}),b(' 请求次数和Token使用量为"或"的关系，任一达到限制即触发限流 ')],-1))])):L("",!0),t("div",je,[t("div",Ee,[s[5]||(s[5]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"并发限制",-1)),t("span",Ue,[e(a).limits.concurrencyLimit>0?(n(),i("span",Oe,o(e(a).limits.concurrencyLimit),1)):(n(),i("span",Ne,[...s[4]||(s[4]=[t("i",{class:"fas fa-infinity text-gray-400"},null,-1)])]))])]),t("div",Fe,[s[8]||(s[8]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"模型限制",-1)),t("span",Ve,[e(a).restrictions.enableModelRestriction&&e(a).restrictions.restrictedModels.length>0?(n(),i("span",We,[s[6]||(s[6]=t("i",{class:"fas fa-exclamation-triangle mr-1 text-xs md:text-sm"},null,-1)),b(" 限制 "+o(e(a).restrictions.restrictedModels.length)+" 个模型 ",1)])):(n(),i("span",Be,[...s[7]||(s[7]=[t("i",{class:"fas fa-check-circle mr-1 text-xs md:text-sm"},null,-1),b(" 允许所有模型 ",-1)])]))])]),t("div",Ye,[s[11]||(s[11]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"客户端限制",-1)),t("span",ze,[e(a).restrictions.enableClientRestriction&&e(a).restrictions.allowedClients.length>0?(n(),i("span",Je,[s[9]||(s[9]=t("i",{class:"fas fa-exclamation-triangle mr-1 text-xs md:text-sm"},null,-1)),b(" 限制 "+o(e(a).restrictions.allowedClients.length)+" 个客户端 ",1)])):(n(),i("span",Qe,[...s[10]||(s[10]=[t("i",{class:"fas fa-check-circle mr-1 text-xs md:text-sm"},null,-1),b(" 允许所有客户端 ",-1)])]))])])])])]),e(a).restrictions.enableModelRestriction&&e(a).restrictions.restrictedModels.length>0||e(a).restrictions.enableClientRestriction&&e(a).restrictions.allowedClients.length>0?(n(),i("div",Ge,[s[19]||(s[19]=t("h3",{class:"mb-3 flex items-center text-lg font-bold text-gray-900 dark:text-gray-100 md:mb-4 md:text-xl"},[t("i",{class:"fas fa-list-alt mr-2 text-sm text-amber-500 md:mr-3 md:text-base"}),b(" 详细限制信息 ")],-1)),t("div",Xe,[e(a).restrictions.enableModelRestriction&&e(a).restrictions.restrictedModels.length>0?(n(),i("div",Ze,[s[14]||(s[14]=t("h4",{class:"mb-2 flex items-center text-sm font-bold text-amber-800 dark:text-amber-300 md:mb-3 md:text-base"},[t("i",{class:"fas fa-robot mr-1 text-xs md:mr-2 md:text-sm"}),b(" 受限模型列表 ")],-1)),t("div",ts,[(n(!0),i(F,null,V(e(a).restrictions.restrictedModels,h=>(n(),i("div",{key:h,class:"rounded border border-amber-200 bg-white px-2 py-1 text-xs dark:border-amber-700 dark:bg-gray-800 md:px-3 md:py-2 md:text-sm"},[s[13]||(s[13]=t("i",{class:"fas fa-ban mr-1 text-xs text-red-500 md:mr-2"},null,-1)),t("span",es,o(h),1)]))),128))]),s[15]||(s[15]=t("p",{class:"mt-2 text-xs text-amber-700 dark:text-amber-400 md:mt-3"},[t("i",{class:"fas fa-info-circle mr-1"}),b(" 此 API Key 不能访问以上列出的模型 ")],-1))])):L("",!0),e(a).restrictions.enableClientRestriction&&e(a).restrictions.allowedClients.length>0?(n(),i("div",ss,[s[17]||(s[17]=t("h4",{class:"mb-2 flex items-center text-sm font-bold text-blue-800 dark:text-blue-300 md:mb-3 md:text-base"},[t("i",{class:"fas fa-desktop mr-1 text-xs md:mr-2 md:text-sm"}),b(" 允许的客户端 ")],-1)),t("div",as,[(n(!0),i(F,null,V(e(a).restrictions.allowedClients,h=>(n(),i("div",{key:h,class:"rounded border border-blue-200 bg-white px-2 py-1 text-xs dark:border-blue-700 dark:bg-gray-800 md:px-3 md:py-2 md:text-sm"},[s[16]||(s[16]=t("i",{class:"fas fa-check mr-1 text-xs text-green-500 md:mr-2"},null,-1)),t("span",rs,o(h),1)]))),128))]),s[18]||(s[18]=t("p",{class:"mt-2 text-xs text-blue-700 dark:text-blue-400 md:mt-3"},[t("i",{class:"fas fa-info-circle mr-1"}),b(" 此 API Key 只能被以上列出的客户端使用 ")],-1))])):L("",!0)])])):L("",!0)]))}},ls=E(os,[["__scopeId","data-v-2b2bf3be"]]),is={class:"card p-4 md:p-6"},ns={class:"mb-4 md:mb-6"},ds={class:"flex flex-col text-lg font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center md:text-xl"},cs={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},us={key:0,class:"py-6 text-center md:py-8"},ms={key:1,class:"space-y-3 md:space-y-4"},xs={class:"mb-2 flex items-start justify-between md:mb-3"},gs={class:"min-w-0 flex-1"},fs={class:"break-all text-base font-bold text-gray-900 dark:text-gray-100 md:text-lg"},ys={key:0,class:"ml-2 text-sm font-normal text-blue-600 dark:text-blue-400"},ps={class:"text-xs text-gray-600 dark:text-gray-400 md:text-sm"},vs={key:0,class:"ml-2"},bs={class:"ml-3 flex-shrink-0 text-right"},ks={class:"text-base font-bold text-green-600 md:text-lg"},_s={class:"grid grid-cols-2 gap-2 text-xs md:grid-cols-4 md:gap-3 md:text-sm"},hs={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},$s={class:"font-medium text-gray-900 dark:text-gray-100"},ws={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},Ss={class:"font-medium text-gray-900 dark:text-gray-100"},Ts={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},Cs={class:"font-medium text-gray-900 dark:text-gray-100"},Ds={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},qs={class:"font-medium text-gray-900 dark:text-gray-100"},Ls={key:2,class:"py-6 text-center text-gray-500 dark:text-gray-400 md:py-8"},Is={class:"text-sm md:text-base"},Ps={__name:"ModelUsageStats",setup(I){const c=U(),{statsPeriod:a,modelStats:x,modelStatsLoading:f,hourlyStats:m,hourlyLoading:s,hourlyConfig:h}=j(c),S=R(()=>{switch(a.value){case"daily":return"今日";case"monthly":return"本月";case"hourly":return`${h.value.selectedHours}小时内`;default:return"当前时段"}}),T=R(()=>a.value==="hourly"?m.value||[]:x.value||[]),P=R(()=>a.value==="hourly"?s.value:f.value),u=y=>(typeof y!="number"&&(y=parseInt(y)||0),y===0?"0":y>=1e6?(y/1e6).toFixed(1)+"M":y>=1e3?(y/1e3).toFixed(1)+"K":y.toLocaleString()),g=y=>{if(typeof y=="string"&&y.includes(":"))return y;const k=parseInt(y);return isNaN(k)?y:`${k.toString().padStart(2,"0")}:00`},q=y=>{if(!y)return"";try{const k=new Date(y),l=new Date,d=new Date(l);return d.setDate(l.getDate()-1),k.toDateString()===l.toDateString()?"今天":k.toDateString()===d.toDateString()?"昨天":k.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}catch{return y}};return(y,k)=>(n(),i("div",is,[t("div",ns,[t("h3",ds,[k[0]||(k[0]=t("span",{class:"flex items-center"},[t("i",{class:"fas fa-robot mr-2 text-sm text-indigo-500 md:mr-3 md:text-base"}),b(" 模型使用统计 ")],-1)),t("span",cs,"("+o(S.value)+")",1)])]),P.value?(n(),i("div",us,[...k[1]||(k[1]=[t("i",{class:"fas fa-spinner loading-spinner mb-2 text-xl text-gray-600 dark:text-gray-400 md:text-2xl"},null,-1),t("p",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"加载模型统计数据中...",-1)])])):T.value.length>0?(n(),i("div",ms,[(n(!0),i(F,null,V(T.value,(l,d)=>{var p;return n(),i("div",{key:d,class:"model-usage-item"},[t("div",xs,[t("div",gs,[t("h4",fs,[b(o(l.model)+" ",1),e(a)==="hourly"&&l.hour?(n(),i("span",ys,o(g(l.hour)),1)):L("",!0)]),t("p",ps,[b(o(l.requests)+" 次请求 ",1),e(a)==="hourly"&&l.date?(n(),i("span",vs," · "+o(q(l.date)),1)):L("",!0)])]),t("div",bs,[t("div",ks,o(((p=l.formatted)==null?void 0:p.total)||"$0.000000"),1),k[2]||(k[2]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400 md:text-sm"},"总费用",-1))])]),t("div",_s,[t("div",hs,[k[3]||(k[3]=t("div",{class:"text-gray-600 dark:text-gray-400"},"输入 Token",-1)),t("div",$s,o(u(l.inputTokens)),1)]),t("div",ws,[k[4]||(k[4]=t("div",{class:"text-gray-600 dark:text-gray-400"},"输出 Token",-1)),t("div",Ss,o(u(l.outputTokens)),1)]),t("div",Ts,[k[5]||(k[5]=t("div",{class:"text-gray-600 dark:text-gray-400"},"缓存创建",-1)),t("div",Cs,o(u(l.cacheCreateTokens)),1)]),t("div",Ds,[k[6]||(k[6]=t("div",{class:"text-gray-600 dark:text-gray-400"},"缓存读取",-1)),t("div",qs,o(u(l.cacheReadTokens)),1)])])])}),128))])):(n(),i("div",Ls,[k[7]||(k[7]=t("i",{class:"fas fa-chart-pie mb-3 text-2xl md:text-3xl"},null,-1)),t("p",Is,"暂无"+o(S.value)+"模型使用数据",1)]))]))}},Ms=E(Ps,[["__scopeId","data-v-d8f7bc09"]]),Rs={class:"rounded-xl bg-gradient-to-r from-blue-50 to-indigo-50 p-4 dark:from-gray-800 dark:to-gray-700 md:p-6"},As={class:"space-y-4"},Ks={class:"flex flex-col gap-3 md:flex-row md:items-center"},Hs={class:"flex flex-1 gap-2"},js={class:"relative flex-1"},Es={class:"flex gap-1"},Us=["onClick"],Os={class:"flex flex-col gap-3 md:flex-row md:items-center"},Ns={class:"flex flex-1 gap-2"},Fs=["onClick"],Vs={class:"flex flex-col items-start justify-between gap-3 pt-2 md:flex-row md:items-center"},Ws={class:"flex items-center gap-2"},Bs={key:0,class:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400"},Ys={key:1,class:"flex items-center gap-2 text-sm text-red-600 dark:text-red-400"},zs={key:2,class:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400"},Js={class:"flex gap-2"},Qs=["disabled"],Gs={__name:"HourlyStatsControls",setup(I){const c=U(),{apiKey:a,hourlyLoading:x,hourlyError:f,hourlyStats:m,hourlyConfig:s}=j(c),{updateHourlyConfig:h,loadHourlyStats:S}=c,T=[6,12,24,48],P=[{key:"today",label:"今天",date:new Date().toISOString().split("T")[0]},{key:"yesterday",label:"昨天",date:new Date(Date.now()-24*60*60*1e3).toISOString().split("T")[0]},{key:"twoDaysAgo",label:"前天",date:new Date(Date.now()-2*24*60*60*1e3).toISOString().split("T")[0]}],u=R({get:()=>s.value.selectedDate,set:p=>{h({selectedDate:p})}}),g=R({get:()=>s.value.selectedHours,set:p=>{h({selectedHours:p})}}),q=()=>{},y=p=>{g.value=p},k=p=>{u.value=p},l=p=>u.value===p,d=()=>{S()};return(p,_)=>(n(),i("div",Rs,[_[7]||(_[7]=t("div",{class:"mb-4 flex items-center gap-2 md:gap-3"},[t("i",{class:"fas fa-clock text-base text-blue-500 md:text-lg"}),t("h4",{class:"text-base font-semibold text-gray-900 dark:text-gray-100 md:text-lg"}," 小时统计配置 ")],-1)),t("div",As,[t("div",Ks,[_[1]||(_[1]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 md:w-20"}," 查询日期 ",-1)),t("div",Hs,[t("div",js,[G(t("input",{"onUpdate:modelValue":_[0]||(_[0]=w=>u.value=w),class:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm transition-all duration-200 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 dark:focus:border-blue-400",type:"date",onChange:q},null,544),[[X,u.value]])]),t("div",Es,[(n(),i(F,null,V(P,w=>t("button",{key:w.key,class:M(["quick-date-btn",{active:l(w.date)}]),onClick:C=>k(w.date)},o(w.label),11,Us)),64))])])]),t("div",Os,[_[2]||(_[2]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 md:w-20"}," 时间范围 ",-1)),t("div",Ns,[(n(),i(F,null,V(T,w=>t("button",{key:w,class:M(["hours-btn flex-1 md:flex-none",{active:g.value===w}]),onClick:C=>y(w)},o(w)+"小时 ",11,Fs)),64))])]),t("div",Vs,[t("div",Ws,[e(x)?(n(),i("div",Bs,[..._[3]||(_[3]=[t("i",{class:"fas fa-spinner loading-spinner"},null,-1),t("span",null,"加载数据中...",-1)])])):e(f)?(n(),i("div",Ys,[_[4]||(_[4]=t("i",{class:"fas fa-exclamation-triangle"},null,-1)),t("span",null,o(e(f)),1)])):e(m).length>0?(n(),i("div",zs,[_[5]||(_[5]=t("i",{class:"fas fa-check-circle"},null,-1)),t("span",null,"已加载 "+o(e(m).length)+" 条数据",1)])):L("",!0)]),t("div",Js,[t("button",{class:"refresh-btn flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-200",disabled:e(x)||!e(a),onClick:d},[t("i",{class:M(["fas fa-sync-alt",{"animate-spin":e(x)}])},null,2),_[6]||(_[6]=b(" 刷新数据 ",-1))],8,Qs)])])])]))}},Xs=E(Gs,[["__scopeId","data-v-4aadf7af"]]),Zs={class:"card p-4 md:p-6"},ta={class:"mb-4 md:mb-6"},ea={class:"flex flex-col text-lg font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center md:text-xl"},sa={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},aa={key:0,class:"py-8 text-center md:py-12"},ra={key:1,class:"space-y-4"},oa={key:0,class:"rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},la={class:"flex items-center gap-2 text-sm"},ia={class:"font-medium text-blue-800 dark:text-blue-200"},na={class:"space-y-2"},da={class:"flex justify-between text-xs text-gray-600 dark:text-gray-400"},ca=["onMouseenter"],ua={class:"absolute -bottom-6 left-1/2 -translate-x-1/2 text-xs text-gray-500 dark:text-gray-400"},ma={class:"mt-6 grid grid-cols-2 gap-3 md:grid-cols-4"},xa={class:"stat-card"},ga={class:"text-lg font-bold text-blue-600"},fa={class:"stat-card"},ya={class:"text-lg font-bold text-green-600"},pa={class:"stat-card"},va={class:"text-lg font-bold text-purple-600"},ba={class:"stat-card"},ka={class:"text-lg font-bold text-orange-600"},_a={key:2,class:"py-8 text-center text-gray-500 dark:text-gray-400 md:py-12"},ha={class:"rounded-lg bg-black p-2 text-xs text-white shadow-lg"},$a={class:"font-medium"},wa={key:0},Sa={__name:"HourlyChart",setup(I){const c=U(),{hourlyStats:a,hourlyLoading:x,hourlyConfig:f}=j(c),m=D({show:!1,x:0,y:0,data:{}}),s=R(()=>{if(!a.value||a.value.length===0)return[];const l=new Map;return a.value.forEach(d=>{var w;const p=d.hour||d.time||"00:00",_=l.get(p)||{time:p,requests:0,cost:0,models:new Set};_.requests+=d.requests||0,_.cost+=((w=d.costs)==null?void 0:w.total)||0,d.model&&_.models.add(d.model),l.set(p,_)}),Array.from(l.values()).sort((d,p)=>d.time.localeCompare(p.time)).map(d=>({...d,cost:q(d.cost),models:Array.from(d.models)}))}),h=R(()=>{const l=s.value.length;return l<=6?"grid-cols-6":l<=12?"grid-cols-12":(l<=24,"grid-cols-12 md:grid-cols-24")}),S=R(()=>{if(s.value.length===0)return null;const l=s.value.reduce((d,p)=>p.requests>d.requests?p:d);return{time:l.time,requests:l.requests,cost:l.cost}}),T=R(()=>{if(s.value.length===0)return{totalRequests:0,totalCost:"$0.00",avgPerHour:"0",activeHours:0};const l=s.value.reduce((_,w)=>_+w.requests,0),d=s.value.reduce((_,w)=>_+(parseFloat(w.cost.replace("$",""))||0),0),p=s.value.filter(_=>_.requests>0).length;return{totalRequests:l.toLocaleString(),totalCost:q(d),avgPerHour:Math.round(l/Math.max(p,1)).toLocaleString(),activeHours:p}}),P=l=>{if(s.value.length===0)return 0;const d=Math.max(...s.value.map(C=>C.requests));if(d===0)return 2;const p=2,_=60,w=l.requests/d;return Math.max(p,w*_)},u=l=>{const d=l.requests;return d===0?"bg-gray-200 dark:bg-gray-700":d<5?"bg-blue-300 dark:bg-blue-600":d<20?"bg-blue-500 dark:bg-blue-500":"bg-blue-600 dark:bg-blue-400"},g=l=>l?l.includes(":")?l.split(":")[0]+"h":l:"",q=l=>typeof l!="number"||l===0?"$0.00":l>=1?"$"+l.toFixed(2):l>=.01?"$"+l.toFixed(4):"$"+l.toFixed(6),y=(l,d)=>{m.value={show:!0,x:d.clientX+10,y:d.clientY-60,data:l}},k=()=>{m.value.show=!1};return(l,d)=>(n(),i("div",Zs,[t("div",ta,[t("h3",ea,[d[0]||(d[0]=t("span",{class:"flex items-center"},[t("i",{class:"fas fa-chart-line mr-2 text-sm text-blue-500 md:mr-3 md:text-base"}),b(" 小时使用趋势图 ")],-1)),t("span",sa," ("+o(e(f).selectedHours)+"小时内) ",1)])]),e(x)?(n(),i("div",aa,[...d[1]||(d[1]=[t("i",{class:"fas fa-spinner loading-spinner mb-2 text-xl text-gray-600 dark:text-gray-400 md:text-2xl"},null,-1),t("p",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"加载图表数据中...",-1)])])):s.value.length>0?(n(),i("div",ra,[S.value?(n(),i("div",oa,[t("div",la,[d[2]||(d[2]=t("i",{class:"fas fa-chart-line text-blue-500"},null,-1)),t("span",ia," 峰值时段: "+o(S.value.time)+" ("+o(S.value.requests)+" 次请求, "+o(S.value.cost)+") ",1)])])):L("",!0),t("div",na,[t("div",da,[d[3]||(d[3]=t("span",null,"使用量分布",-1)),t("span",null,o(s.value.length)+" 个时段",1)]),t("div",{class:M(["grid gap-1",h.value])},[(n(!0),i(F,null,V(s.value,(p,_)=>(n(),i("div",{key:_,class:"chart-bar group relative",style:Y({height:`${P(p)}px`}),onMouseenter:w=>y(p,w),onMouseleave:k},[t("div",{class:M(["h-full w-full rounded-t transition-all duration-200",u(p)])},null,2),t("div",ua,o(g(p.time)),1)],44,ca))),128))],2)]),t("div",ma,[t("div",xa,[d[4]||(d[4]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"总请求",-1)),t("div",ga,o(T.value.totalRequests),1)]),t("div",fa,[d[5]||(d[5]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"总费用",-1)),t("div",ya,o(T.value.totalCost),1)]),t("div",pa,[d[6]||(d[6]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"平均/小时",-1)),t("div",va,o(T.value.avgPerHour),1)]),t("div",ba,[d[7]||(d[7]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"活跃时段",-1)),t("div",ka,o(T.value.activeHours),1)])])])):(n(),i("div",_a,[...d[8]||(d[8]=[t("i",{class:"fas fa-chart-line mb-3 text-3xl opacity-50"},null,-1),t("p",{class:"text-sm md:text-base"},"暂无小时统计数据",-1),t("p",{class:"mt-1 text-xs text-gray-400 dark:text-gray-500"},"请选择日期和时间范围后查询",-1)])])),m.value.show?(n(),i("div",{key:3,class:"tooltip",style:Y({left:m.value.x+"px",top:m.value.y+"px"})},[t("div",ha,[t("div",$a,o(m.value.data.time),1),t("div",null,"请求: "+o(m.value.data.requests)+" 次",1),t("div",null,"费用: "+o(m.value.data.cost),1),m.value.data.model?(n(),i("div",wa,"模型: "+o(m.value.data.model),1)):L("",!0)])],4)):L("",!0)]))}},Ta=E(Sa,[["__scopeId","data-v-09028848"]]),Ca={class:"glass-strong mb-6 rounded-3xl p-4 shadow-xl md:mb-8 md:p-6"},Da={class:"flex flex-col items-center justify-between gap-4 md:flex-row"},qa={class:"flex items-center gap-2 md:gap-4"},La={class:"flex items-center"},Ia={class:"mb-6 md:mb-8"},Pa={class:"flex justify-center"},Ma={class:"inline-flex w-full max-w-md rounded-full border border-white/20 bg-white/10 p-1 shadow-lg backdrop-blur-xl md:w-auto"},Ra={key:0,class:"tab-content"},Aa={key:0,class:"mb-6 md:mb-8"},Ka={class:"rounded-xl border border-red-500/30 bg-red-500/20 p-3 text-sm text-red-800 backdrop-blur-sm dark:border-red-500/20 dark:bg-red-500/10 dark:text-red-200 md:p-4 md:text-base"},Ha={key:1,class:"fade-in"},ja={class:"glass-strong rounded-3xl p-4 shadow-xl md:p-6"},Ea={class:"mb-4 border-b border-gray-200 pb-4 dark:border-gray-700 md:mb-6 md:pb-6"},Ua={class:"flex flex-col items-start justify-between gap-3 md:flex-row md:items-center md:gap-4"},Oa={class:"flex w-full gap-2 md:w-auto"},Na=["disabled"],Fa=["disabled"],Va=["disabled"],Wa={key:0,class:"mb-6 md:mb-8"},Ba={class:"mb-6 grid grid-cols-1 gap-4 md:mb-8 md:gap-6 lg:grid-cols-2"},Ya={key:1,class:"mb-6 md:mb-8"},za={key:1,class:"tab-content"},Ja={class:"glass-strong rounded-3xl shadow-xl"},Qa={__name:"ApiStatsView",setup(I){const c=nt(),a=U(),x=xt(),f=D("stats"),m=R(()=>x.isDarkMode),{apiKey:s,apiId:h,loading:S,modelStatsLoading:T,oemLoading:P,error:u,statsPeriod:g,statsData:q,oemSettings:y}=j(a),{queryStats:k,switchPeriod:l,loadStatsWithApiId:d,loadOemSettings:p,reset:_}=a,w=C=>{(C.ctrlKey||C.metaKey)&&C.key==="Enter"&&(!S.value&&s.value.trim()&&k(),C.preventDefault()),C.key==="Escape"&&_()};return it(()=>{x.initTheme(),p();const C=c.query.apiId,v=c.query.apiKey;C&&C.match(/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i)?(h.value=C,d()):v&&v.length>10&&(s.value=v),document.addEventListener("keydown",w)}),dt(()=>{document.removeEventListener("keydown",w)}),ct(s,C=>{C||a.clearData()}),(C,v)=>{const B=mt("router-link");return n(),i("div",{class:M(["min-h-screen p-4 md:p-6",m.value?"gradient-bg-dark":"gradient-bg"])},[t("div",Ca,[t("div",Da,[A(gt,{loading:e(P),"logo-src":e(y).siteIconData||e(y).siteIcon,subtitle:f.value==="stats"?"API Key 使用统计":"使用教程",title:e(y).siteName},null,8,["loading","logo-src","subtitle","title"]),t("div",qa,[t("div",La,[A(ft,{mode:"dropdown"})]),v[6]||(v[6]=t("div",{class:"h-8 w-px bg-gradient-to-b from-transparent via-gray-300 to-transparent opacity-50 dark:via-gray-600"},null,-1)),A(B,{class:"admin-button-refined flex items-center gap-2 rounded-2xl px-4 py-2 transition-all duration-300 md:px-5 md:py-2.5",to:"/dashboard"},{default:ut(()=>[...v[5]||(v[5]=[t("i",{class:"fas fa-shield-alt text-sm md:text-base"},null,-1),t("span",{class:"text-xs font-semibold tracking-wide md:text-sm"},"管理后台",-1)])]),_:1})])])]),t("div",Ia,[t("div",Pa,[t("div",Ma,[t("button",{class:M(["tab-pill-button",f.value==="stats"?"active":""]),onClick:v[0]||(v[0]=H=>f.value="stats")},[...v[7]||(v[7]=[t("i",{class:"fas fa-chart-line mr-1 md:mr-2"},null,-1),t("span",{class:"text-sm md:text-base"},"统计查询",-1)])],2),t("button",{class:M(["tab-pill-button",f.value==="tutorial"?"active":""]),onClick:v[1]||(v[1]=H=>f.value="tutorial")},[...v[8]||(v[8]=[t("i",{class:"fas fa-graduation-cap mr-1 md:mr-2"},null,-1),t("span",{class:"text-sm md:text-base"},"使用教程",-1)])],2)])])]),f.value==="stats"?(n(),i("div",Ra,[A(Lt),e(u)?(n(),i("div",Aa,[t("div",Ka,[v[9]||(v[9]=t("i",{class:"fas fa-exclamation-triangle mr-2"},null,-1)),b(" "+o(e(u)),1)])])):L("",!0),e(q)?(n(),i("div",Ha,[t("div",ja,[t("div",Ea,[t("div",Ua,[v[13]||(v[13]=t("div",{class:"flex items-center gap-2 md:gap-3"},[t("i",{class:"fas fa-clock text-base text-blue-500 md:text-lg"}),t("span",{class:"text-base font-medium text-gray-700 dark:text-gray-200 md:text-lg"},"统计时间范围")],-1)),t("div",Oa,[t("button",{class:M(["flex flex-1 items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:flex-none md:gap-2 md:px-6 md:text-sm",["period-btn",{active:e(g)==="daily"}]]),disabled:e(S)||e(T),onClick:v[2]||(v[2]=H=>e(l)("daily"))},[...v[10]||(v[10]=[t("i",{class:"fas fa-calendar-day text-xs md:text-sm"},null,-1),b(" 今日 ",-1)])],10,Na),t("button",{class:M(["flex flex-1 items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:flex-none md:gap-2 md:px-6 md:text-sm",["period-btn",{active:e(g)==="monthly"}]]),disabled:e(S)||e(T),onClick:v[3]||(v[3]=H=>e(l)("monthly"))},[...v[11]||(v[11]=[t("i",{class:"fas fa-calendar-alt text-xs md:text-sm"},null,-1),b(" 本月 ",-1)])],10,Fa),t("button",{class:M(["flex flex-1 items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:flex-none md:gap-2 md:px-6 md:text-sm",["period-btn",{active:e(g)==="hourly"}]]),disabled:e(S)||e(T),onClick:v[4]||(v[4]=H=>e(l)("hourly"))},[...v[12]||(v[12]=[t("i",{class:"fas fa-clock text-xs md:text-sm"},null,-1),b(" 小时 ",-1)])],10,Va)])])]),e(g)==="hourly"?(n(),i("div",Wa,[A(Xs)])):L("",!0),A(ce),t("div",Ba,[A(De),A(ls)]),e(g)==="hourly"?(n(),i("div",Ya,[A(Ta)])):L("",!0),A(Ms)])])):L("",!0)])):L("",!0),f.value==="tutorial"?(n(),i("div",za,[t("div",Ja,[A(vt)])])):L("",!0)],2)}}},or=E(Qa,[["__scopeId","data-v-accd570b"]]);export{or as default};
