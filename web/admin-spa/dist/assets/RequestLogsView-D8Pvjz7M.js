import{x as d,y as l,z as t,O as b,P as r,L as k,C as $,B as xt,r as O,c as X,q as Dt,D as ge,o as ye,Q as at,K as Z,aq as yt,ac as ot,aW as gt,aZ as Te,V as De,I as Se,u as p,a_ as Tt,R as wt,a5 as je,Y as Be}from"./vue-vendor-CcFZMz-v.js";import{n as St,u as qe}from"./requestLogs-BP6R09mC.js";import{s as rt}from"./toast-BvwA7Mwb.js";import{_ as mt}from"./index-wRIo-pF1.js";import{C as Le}from"./chart-DOIXA9jv.js";import"./element-plus-C-1FTG0y.js";import"./vendor-B90ziCBp.js";const Ne={class:"request-overview"},Oe={class:"mb-8 grid grid-cols-1 gap-6 lg:grid-cols-2"},Re={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},Ae={class:"space-y-4"},Ie={class:"grid grid-cols-2 gap-4"},He={class:"text-sm text-gray-900 dark:text-gray-100"},Ke={class:"text-xs text-gray-500 dark:text-gray-400"},Pe={class:"break-all font-mono text-sm text-gray-900 dark:text-gray-100"},Me={class:"grid grid-cols-2 gap-4"},Fe={class:"flex items-center gap-2"},Ee={class:"text-sm text-gray-900 dark:text-gray-100"},Ue={class:"text-sm text-gray-900 dark:text-gray-100"},Ve={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},ze={class:"space-y-4"},Je={class:"grid grid-cols-2 gap-4"},We={class:"flex items-center gap-2"},Ge={class:"text-xs text-gray-500 dark:text-gray-400"},Qe={class:"break-all rounded border bg-gray-50 p-2 font-mono text-sm text-gray-900 dark:bg-gray-700/50 dark:text-gray-100"},Ye={class:"grid grid-cols-2 gap-4"},Ze={class:"flex items-center gap-2"},Xe={class:"font-mono text-sm text-gray-900 dark:text-gray-100"},ts={class:"mb-8 grid grid-cols-1 gap-6 lg:grid-cols-2"},es={class:"rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white"},ss={class:"grid grid-cols-2 gap-4"},as={class:"text-2xl font-bold"},rs={class:"text-2xl font-bold"},os={class:"mt-4 grid grid-cols-4 gap-2 text-xs"},ns={class:"text-center"},ls={class:"font-semibold"},ds={class:"text-center"},is={class:"font-semibold"},us={class:"text-center"},cs={class:"font-semibold"},xs={class:"text-center"},gs={class:"font-semibold"},ys={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},ms={class:"space-y-4"},fs={class:"text-center"},bs={class:"text-3xl font-bold text-green-600 dark:text-green-400"},ps={class:"grid grid-cols-2 gap-4 border-t border-gray-200 pt-4 dark:border-gray-700"},vs={class:"text-center"},ks={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},hs={class:"text-center"},$s={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},ws={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},_s={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Cs={class:"space-y-3"},Ts={class:"flex items-center justify-between"},Ds={class:"flex items-center gap-2"},Ss={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},js={class:"text-xs font-medium"},Bs={class:"flex items-center justify-between"},qs={class:"flex items-center gap-2"},Ls={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},Ns={class:"text-xs font-medium"},Os={class:"flex items-center justify-between"},Rs={class:"flex items-center gap-2"},As={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},Is={class:"text-xs font-medium"},Hs={class:"flex items-center justify-between"},Ks={class:"flex items-center gap-2"},Ps={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},Ms={class:"text-xs font-medium"},Fs={class:"space-y-2 text-sm"},Es={class:"flex justify-between"},Us={class:"text-gray-900 dark:text-gray-100"},Vs={class:"flex justify-between"},zs={class:"flex justify-between"},Js={class:"text-gray-900 dark:text-gray-100"},Ws={class:"mt-6 border-t border-gray-200 pt-4 dark:border-gray-700"},Gs={class:"flex items-center justify-between"},Qs={class:"flex items-center gap-3"},Ys={class:"h-3 w-32 rounded-full bg-gray-200 dark:bg-gray-700"},Zs={__name:"RequestOverview",props:{log:{type:Object,required:!0}},setup(c){const T=c,S=i=>i?new Date(i).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"N/A",B=i=>{if(!i)return"";const u=Date.now(),P=new Date(i).getTime(),L=u-P;return L<6e4?"刚刚":L<36e5?`${Math.floor(L/6e4)} 分钟前`:L<864e5?`${Math.floor(L/36e5)} 小时前`:`${Math.floor(L/864e5)} 天前`},C=i=>i.id||i.logId||"N/A",q=i=>{var u;return i.formattedKeyName||((u=i.apiKey)==null?void 0:u.name)||(i.keyId?`Key-${i.keyId.slice(-8)}`:"N/A")},j=i=>q(i).includes("(已删除)")?"已删除":"正常",x=i=>j(i)==="已删除"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",_=i=>({GET:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",POST:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",PUT:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300",DELETE:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300",PATCH:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300"})[i]||"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300",E=i=>i>=200&&i<300?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":i>=300&&i<400?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":i>=400&&i<500?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":i>=500?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300":"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300",H=i=>i>=200&&i<300?"成功":i>=300&&i<400?"重定向":i>=400&&i<500?"客户端错误":i>=500?"服务器错误":"",K=i=>i?i<1e3?`${i}ms`:`${(i/1e3).toFixed(2)}s`:"N/A",z=i=>i?i<1e3?"text-green-600 dark:text-green-400":i<3e3?"text-yellow-600 dark:text-yellow-400":i<5e3?"text-orange-600 dark:text-orange-400":"text-red-600 dark:text-red-400":"text-gray-500",U=i=>i?i<1e3?"快速":i<3e3?"正常":i<5e3?"较慢":"很慢":"N/A",J=i=>i?i<1e3?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":i<3e3?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":i<5e3?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300",g=()=>{const i=St(T.log.tokenDetails||{}),u=i.inputTokens||0,P=i.outputTokens||0,L=i.cacheCreateTokens||0,v=i.cacheReadTokens||0,A=i.totalTokens||u+P+L+v,F=u>0?(P/u).toFixed(2):"0.00";return{total:A.toLocaleString(),input:u.toLocaleString(),output:P.toLocaleString(),cacheCreate:L.toLocaleString(),cacheRead:v.toLocaleString(),efficiency:F}},s=()=>{const i=T.log.costDetails||{},u=(i.totalCost||0).toFixed(6),P=g(),L=parseInt(P.total.replace(/,/g,""))||0,v=L>0?(i.totalCost/L).toFixed(8):"0.00000000";return{total:u,perToken:v,currency:i.currency||"USD"}},m=()=>{const i=T.log,P=["timestamp","keyId","method","path","status"].reduce((Q,nt)=>Q+(i[nt]?20:0),0),v=!!(i.tokenDetails&&Object.keys(i.tokenDetails).length>0)?100:0,F=!!(i.costDetails&&i.costDetails.totalCost)?100:0,W=!!(i.requestHeaders||i.responseHeaders)?100:0;return{basic:Math.min(P,100),tokens:v,costs:F,headers:W}},y=()=>{const i=m();return Math.round((i.basic+i.tokens+i.costs+i.headers)/4)},n=()=>{const i=y();return i>=80?"bg-green-500":i>=60?"bg-yellow-500":i>=40?"bg-orange-500":"bg-red-500"},D=()=>{const i=y();return i>=80?"text-green-600 dark:text-green-400":i>=60?"text-yellow-600 dark:text-yellow-400":i>=40?"text-orange-600 dark:text-orange-400":"text-red-600 dark:text-red-400"},V=()=>new Date().toLocaleTimeString("zh-CN");return(i,u)=>{var P;return l(),d("div",Ne,[t("div",Oe,[t("div",Re,[u[4]||(u[4]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-info-circle mr-2 text-blue-500"}),b(" 基本信息 ")],-1)),t("div",Ae,[t("div",Ie,[t("div",null,[u[0]||(u[0]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求时间 ",-1)),t("div",He,r(S(c.log.timestamp)),1),t("div",Ke,r(B(c.log.timestamp)),1)]),t("div",null,[u[1]||(u[1]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求ID ",-1)),t("div",Pe,r(C(c.log)),1)])]),t("div",Me,[t("div",null,[u[2]||(u[2]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," API Key ",-1)),t("div",Fe,[t("span",Ee,r(q(c.log)),1),j(c.log)?(l(),d("span",{key:0,class:$(["rounded-full px-2 py-1 text-xs",x(c.log)])},r(j(c.log)),3)):k("",!0)])]),t("div",null,[u[3]||(u[3]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 使用模型 ",-1)),t("div",Ue,r(c.log.model||"N/A"),1)])])])]),t("div",Ve,[u[10]||(u[10]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-network-wired mr-2 text-green-500"}),b(" 请求详情 ")],-1)),t("div",ze,[t("div",Je,[t("div",null,[u[5]||(u[5]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求方法 ",-1)),t("span",{class:$(["inline-block rounded px-2 py-1 text-xs font-medium",_(c.log.method)])},r(c.log.method||"N/A"),3)]),t("div",null,[u[6]||(u[6]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 状态码 ",-1)),t("div",We,[t("span",{class:$(["inline-block rounded px-2 py-1 text-xs font-medium",E(c.log.status)])},r(c.log.status||"N/A"),3),t("span",Ge,r(H(c.log.status)),1)])])]),t("div",null,[u[7]||(u[7]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求路径 ",-1)),t("div",Qe,r(c.log.path||"/"),1)]),t("div",Ye,[t("div",null,[u[8]||(u[8]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 响应时间 ",-1)),t("div",Ze,[t("span",{class:$(["text-lg font-semibold",z(c.log.responseTime)])},r(K(c.log.responseTime)),3),t("span",{class:$(["rounded-full px-2 py-1 text-xs",J(c.log.responseTime)])},r(U(c.log.responseTime)),3)])]),t("div",null,[u[9]||(u[9]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 客户端IP ",-1)),t("div",Xe,r(((P=c.log.request)==null?void 0:P.ip)||c.log.clientIP||"N/A"),1)])])])])]),t("div",ts,[t("div",es,[u[17]||(u[17]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold"},[t("i",{class:"fas fa-coins mr-2"}),b(" Token使用概览 ")],-1)),t("div",ss,[t("div",null,[t("div",as,r(g().total),1),u[11]||(u[11]=t("div",{class:"text-sm opacity-90"},"总Token数",-1))]),t("div",null,[t("div",rs,r(g().efficiency),1),u[12]||(u[12]=t("div",{class:"text-sm opacity-90"},"使用效率",-1))])]),t("div",os,[t("div",ns,[t("div",ls,r(g().input),1),u[13]||(u[13]=t("div",{class:"opacity-75"},"输入",-1))]),t("div",ds,[t("div",is,r(g().output),1),u[14]||(u[14]=t("div",{class:"opacity-75"},"输出",-1))]),t("div",us,[t("div",cs,r(g().cacheCreate),1),u[15]||(u[15]=t("div",{class:"opacity-75"},"缓存创建",-1))]),t("div",xs,[t("div",gs,r(g().cacheRead),1),u[16]||(u[16]=t("div",{class:"opacity-75"},"缓存读取",-1))])])]),t("div",ys,[u[21]||(u[21]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-dollar-sign mr-2 text-green-500"}),b(" 费用信息 ")],-1)),t("div",ms,[t("div",fs,[t("div",bs," $"+r(s().total),1),u[18]||(u[18]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"总费用",-1))]),t("div",ps,[t("div",vs,[t("div",ks," $"+r(s().perToken),1),u[19]||(u[19]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"每Token费用",-1))]),t("div",hs,[t("div",$s,r(s().currency),1),u[20]||(u[20]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"货币单位",-1))])])])])]),t("div",ws,[u[33]||(u[33]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-pie mr-2 text-purple-500"}),b(" 数据完整性分析 ")],-1)),t("div",_s,[t("div",null,[u[26]||(u[26]=t("h5",{class:"mb-3 font-medium text-gray-900 dark:text-gray-100"},"数据可用性",-1)),t("div",Cs,[t("div",Ts,[u[22]||(u[22]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"基本信息",-1)),t("div",Ds,[t("div",Ss,[t("div",{class:"h-2 rounded-full bg-green-500",style:xt(`width: ${m().basic}%`)},null,4)]),t("span",js,r(m().basic)+"%",1)])]),t("div",Bs,[u[23]||(u[23]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Token详情",-1)),t("div",qs,[t("div",Ls,[t("div",{class:"h-2 rounded-full bg-blue-500",style:xt(`width: ${m().tokens}%`)},null,4)]),t("span",Ns,r(m().tokens)+"%",1)])]),t("div",Os,[u[24]||(u[24]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"费用信息",-1)),t("div",Rs,[t("div",As,[t("div",{class:"h-2 rounded-full bg-purple-500",style:xt(`width: ${m().costs}%`)},null,4)]),t("span",Is,r(m().costs)+"%",1)])]),t("div",Hs,[u[25]||(u[25]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Headers信息",-1)),t("div",Ks,[t("div",Ps,[t("div",{class:"h-2 rounded-full bg-orange-500",style:xt(`width: ${m().headers}%`)},null,4)]),t("span",Ms,r(m().headers)+"%",1)])])])]),t("div",null,[u[31]||(u[31]=t("h5",{class:"mb-3 font-medium text-gray-900 dark:text-gray-100"},"日志元信息",-1)),t("div",Fs,[t("div",Es,[u[27]||(u[27]=t("span",{class:"text-gray-600 dark:text-gray-400"},"日志版本",-1)),t("span",Us,r(c.log.logVersion||"1.0"),1)]),t("div",Vs,[u[28]||(u[28]=t("span",{class:"text-gray-600 dark:text-gray-400"},"数据优化",-1)),t("span",{class:$(c.log.dataOptimized?"text-green-600 dark:text-green-400":"text-gray-500")},r(c.log.dataOptimized?"已优化":"未优化"),3)]),u[30]||(u[30]=t("div",{class:"flex justify-between"},[t("span",{class:"text-gray-600 dark:text-gray-400"},"存储TTL"),t("span",{class:"text-gray-900 dark:text-gray-100"},"7 天")],-1)),t("div",zs,[u[29]||(u[29]=t("span",{class:"text-gray-600 dark:text-gray-400"},"检索时间",-1)),t("span",Js,r(V()),1)])])])]),t("div",Ws,[t("div",Gs,[u[32]||(u[32]=t("span",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"整体完整性评分",-1)),t("div",Qs,[t("div",Ys,[t("div",{class:$(["h-3 rounded-full transition-all duration-500",n()]),style:xt(`width: ${y()}%`)},null,6)]),t("span",{class:$(["text-xl font-bold",D()])},r(y())+"% ",3)])])])])])}}},Xs=mt(Zs,[["__scopeId","data-v-257c4395"]]),ta={class:"token-breakdown"},ea={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},sa={class:"stat-card bg-blue-50 dark:bg-blue-900/20"},aa={class:"flex items-center justify-between"},ra={class:"text-2xl font-bold text-blue-900 dark:text-blue-100"},oa={class:"mt-2 text-xs text-blue-600 dark:text-blue-400"},na={class:"stat-card bg-green-50 dark:bg-green-900/20"},la={class:"flex items-center justify-between"},da={class:"text-2xl font-bold text-green-900 dark:text-green-100"},ia={class:"mt-2 text-xs text-green-600 dark:text-green-400"},ua={class:"stat-card bg-purple-50 dark:bg-purple-900/20"},ca={class:"flex items-center justify-between"},xa={class:"text-2xl font-bold text-purple-900 dark:text-purple-100"},ga={class:"mt-2 text-xs text-purple-600 dark:text-purple-400"},ya={class:"stat-card bg-orange-50 dark:bg-orange-900/20"},ma={class:"flex items-center justify-between"},fa={class:"text-2xl font-bold text-orange-900 dark:text-orange-100"},ba={class:"mt-2 text-xs text-orange-600 dark:text-orange-400"},pa={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},va={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},ka={class:"relative flex h-64 items-center justify-center"},ha={key:0,class:"absolute inset-0 flex items-center justify-center"},$a={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},wa={class:"overflow-x-auto"},_a={class:"min-w-full"},Ca={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ta={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Da={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Sa={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},ja={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Ba={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},qa={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},La={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Na={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Oa={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Ra={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Aa={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Ia={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Ha={class:"bg-gray-50 dark:bg-gray-700/50"},Ka={class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},Pa={class:"bg-gray-50 dark:bg-gray-700/50"},Ma={class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},Fa={class:"mt-6 grid grid-cols-1 gap-6 lg:grid-cols-2"},Ea={class:"rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white"},Ua={class:"mb-2 text-3xl font-bold"},Va={class:"text-sm opacity-90"},za={class:"text-sm opacity-90"},Ja={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},Wa={class:"space-y-3"},Ga={class:"flex items-center justify-between"},Qa={class:"font-semibold text-gray-900 dark:text-gray-100"},Ya={class:"flex items-center justify-between"},Za={class:"font-semibold text-gray-900 dark:text-gray-100"},Xa={class:"flex items-center justify-between"},tr={__name:"TokenBreakdown",props:{tokenDetails:{type:Object,default:()=>({})},costDetails:{type:Object,default:()=>({})}},setup(c){const T=c,S=O(null);let B=null;const C=X(()=>St(T.tokenDetails)),q=X(()=>C.value.totalTokens>0),j=()=>C.value.totalTokens,x=g=>g>=1e6?(g/1e6).toFixed(1)+"M":g>=1e3?(g/1e3).toFixed(1)+"K":g.toLocaleString(),_=g=>typeof g!="number"||isNaN(g)?"0.000000":g.toFixed(6),E=g=>{const s=j();if(s===0)return"0.0";const m=C.value;return(({input:m.inputTokens,output:m.outputTokens,cache_create:m.cacheCreateTokens,cache_read:m.cacheReadTokens}[g]??0)/s*100).toFixed(1)},H=()=>{var m;const g=j(),s=((m=T.costDetails)==null?void 0:m.totalCost)||0;return g===0?0:s/g},K=()=>{const g=C.value,s=g.cacheReadTokens||0,m=(g.inputTokens||0)+(g.cacheCreateTokens||0)+s;return m===0?"0.0":(s/m*100).toFixed(1)},z=()=>{const g=C.value,s=g.inputTokens||0,m=g.outputTokens||0;return s===0?"N/A":(m/s).toFixed(2)},U=()=>{const g=parseFloat(z());return isNaN(g)?"text-gray-500":g>.5?"text-green-600 dark:text-green-400":g>.2?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"},J=()=>{if(!S.value||(B&&(B.destroy(),B=null),!q.value))return;const g=C.value,s={labels:["输入Token","输出Token","缓存创建","缓存读取"],datasets:[{data:[g.inputTokens||0,g.outputTokens||0,g.cacheCreateTokens||0,g.cacheReadTokens||0],backgroundColor:["#3B82F6","#10B981","#8B5CF6","#F59E0B"],borderWidth:0}]},m={labels:[],datasets:[{data:[],backgroundColor:[],borderWidth:0}]};s.labels.forEach((y,n)=>{s.datasets[0].data[n]>0&&(m.labels.push(y),m.datasets[0].data.push(s.datasets[0].data[n]),m.datasets[0].backgroundColor.push(s.datasets[0].backgroundColor[n]))}),B=new Le(S.value,{type:"doughnut",data:m,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0}}}}})};return Dt(()=>{ge(()=>{q.value&&J()})}),ye(()=>C.value,()=>{ge(()=>{J()})},{deep:!0}),(g,s)=>{var m,y,n,D,V,i,u,P,L,v,A;return l(),d("div",ta,[t("div",ea,[t("div",sa,[t("div",aa,[t("div",null,[s[0]||(s[0]=t("p",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"输入Token",-1)),t("p",ra,r(x(C.value.inputTokens||0)),1)]),s[1]||(s[1]=t("i",{class:"fas fa-sign-in-alt text-2xl text-blue-500"},null,-1))]),t("div",oa," 费用: $"+r(_(((m=c.costDetails)==null?void 0:m.inputCost)||0)),1)]),t("div",na,[t("div",la,[t("div",null,[s[2]||(s[2]=t("p",{class:"text-sm font-medium text-green-700 dark:text-green-300"},"输出Token",-1)),t("p",da,r(x(C.value.outputTokens||0)),1)]),s[3]||(s[3]=t("i",{class:"fas fa-sign-out-alt text-2xl text-green-500"},null,-1))]),t("div",ia," 费用: $"+r(_(((y=c.costDetails)==null?void 0:y.outputCost)||0)),1)]),t("div",ua,[t("div",ca,[t("div",null,[s[4]||(s[4]=t("p",{class:"text-sm font-medium text-purple-700 dark:text-purple-300"},"缓存创建",-1)),t("p",xa,r(x(C.value.cacheCreateTokens||0)),1)]),s[5]||(s[5]=t("i",{class:"fas fa-save text-2xl text-purple-500"},null,-1))]),t("div",ga," 费用: $"+r(_(((n=c.costDetails)==null?void 0:n.cacheCreateCost)||0)),1)]),t("div",ya,[t("div",ma,[t("div",null,[s[6]||(s[6]=t("p",{class:"text-sm font-medium text-orange-700 dark:text-orange-300"},"缓存读取",-1)),t("p",fa,r(x(C.value.cacheReadTokens||0)),1)]),s[7]||(s[7]=t("i",{class:"fas fa-download text-2xl text-orange-500"},null,-1))]),t("div",ba," 费用: $"+r(_(((D=c.costDetails)==null?void 0:D.cacheReadCost)||0)),1)])]),t("div",pa,[t("div",va,[s[9]||(s[9]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-pie mr-2"}),b(" Token分布 ")],-1)),t("div",ka,[t("canvas",{ref_key:"tokenChart",ref:S,class:"max-h-full max-w-full"},null,512),q.value?k("",!0):(l(),d("div",ha,[...s[8]||(s[8]=[t("div",{class:"text-center text-gray-400 dark:text-gray-600"},[t("i",{class:"fas fa-chart-pie mb-2 text-4xl"}),t("p",null,"暂无Token使用数据")],-1)])]))])]),t("div",$a,[s[21]||(s[21]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-table mr-2"}),b(" 详细统计 ")],-1)),t("div",wa,[t("table",_a,[s[20]||(s[20]=t("thead",null,[t("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[t("th",{class:"py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-300"}," 类型 "),t("th",{class:"py-2 text-right text-sm font-medium text-gray-700 dark:text-gray-300"}," Token数 "),t("th",{class:"py-2 text-right text-sm font-medium text-gray-700 dark:text-gray-300"}," 费用 "),t("th",{class:"py-2 text-right text-sm font-medium text-gray-700 dark:text-gray-300"}," 占比 ")])],-1)),t("tbody",Ca,[t("tr",null,[s[10]||(s[10]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"输入Token",-1)),t("td",Ta,r(x(C.value.inputTokens||0)),1),t("td",Da," $"+r(_(((V=c.costDetails)==null?void 0:V.inputCost)||0)),1),t("td",Sa,r(E("input"))+"% ",1)]),t("tr",null,[s[11]||(s[11]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"输出Token",-1)),t("td",ja,r(x(C.value.outputTokens||0)),1),t("td",Ba," $"+r(_(((i=c.costDetails)==null?void 0:i.outputCost)||0)),1),t("td",qa,r(E("output"))+"% ",1)]),t("tr",null,[s[12]||(s[12]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"缓存创建",-1)),t("td",La,r(x(C.value.cacheCreateTokens||0)),1),t("td",Na," $"+r(_(((u=c.costDetails)==null?void 0:u.cacheCreateCost)||0)),1),t("td",Oa,r(E("cache_create"))+"% ",1)]),t("tr",null,[s[13]||(s[13]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"缓存读取",-1)),t("td",Ra,r(x(C.value.cacheReadTokens||0)),1),t("td",Aa," $"+r(_(((P=c.costDetails)==null?void 0:P.cacheReadCost)||0)),1),t("td",Ia,r(E("cache_read"))+"% ",1)]),(L=c.tokenDetails)!=null&&L.cache_breakdown?(l(),d(at,{key:0},[t("tr",Ha,[s[14]||(s[14]=t("td",{class:"py-2 pl-4 text-sm text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-clock mr-1"}),b(" 5分钟缓存 ")],-1)),t("td",Ka,r(x(c.tokenDetails.cache_breakdown.ephemeral_5m_input_tokens||0)),1),s[15]||(s[15]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1)),s[16]||(s[16]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1))]),t("tr",Pa,[s[17]||(s[17]=t("td",{class:"py-2 pl-4 text-sm text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-hourglass-half mr-1"}),b(" 1小时缓存 ")],-1)),t("td",Ma,r(x(c.tokenDetails.cache_breakdown.ephemeral_1h_input_tokens||0)),1),s[18]||(s[18]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1)),s[19]||(s[19]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1))])],64)):k("",!0)])])])])]),t("div",Fa,[t("div",Ea,[s[22]||(s[22]=t("h4",{class:"mb-4 text-lg font-semibold"},[t("i",{class:"fas fa-dollar-sign mr-2"}),b(" 费用总计 ")],-1)),t("div",Ua,"$"+r(_(((v=c.costDetails)==null?void 0:v.totalCost)||0)),1),t("div",Va," 平均每Token: $"+r(_(H())),1),t("div",za,"货币: "+r(((A=c.costDetails)==null?void 0:A.currency)||"USD"),1)]),t("div",Ja,[s[26]||(s[26]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-line mr-2"}),b(" 效率分析 ")],-1)),t("div",Wa,[t("div",Ga,[s[23]||(s[23]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"总Token数",-1)),t("span",Qa,r(x(j())),1)]),t("div",Ya,[s[24]||(s[24]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"缓存命中率",-1)),t("span",Za,r(K())+"% ",1)]),t("div",Xa,[s[25]||(s[25]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"Token效率",-1)),t("span",{class:$(["font-semibold",U()])},r(z()),3)])])])])])}}},er=mt(tr,[["__scopeId","data-v-da18045c"]]),sr={class:"headers-viewer"},ar={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-3"},rr={class:"stat-card bg-blue-50 dark:bg-blue-900/20"},or={class:"flex items-center justify-between"},nr={class:"text-2xl font-bold text-blue-900 dark:text-blue-100"},lr={class:"stat-card bg-green-50 dark:bg-green-900/20"},dr={class:"flex items-center justify-between"},ir={class:"text-2xl font-bold text-green-900 dark:text-green-100"},ur={class:"stat-card bg-purple-50 dark:bg-purple-900/20"},cr={class:"flex items-center justify-between"},xr={class:"text-2xl font-bold text-purple-900 dark:text-purple-100"},gr={class:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},yr={class:"max-w-md flex-1"},mr={class:"relative"},fr={class:"flex items-center gap-2"},br={class:"space-y-6"},pr={key:0,class:"rounded-lg bg-white shadow dark:bg-gray-800"},vr={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},kr={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},hr={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},$r={class:"p-6"},wr={key:0,class:"py-8 text-center"},_r={class:"text-gray-500 dark:text-gray-400"},Cr={key:1,class:"space-y-3"},Tr={class:"flex items-start justify-between rounded-lg bg-gray-50 px-4 py-3 transition-colors duration-200 hover:bg-gray-100 dark:bg-gray-700/50 dark:hover:bg-gray-700"},Dr={class:"min-w-0 flex-1"},Sr={class:"mb-1 flex items-center gap-2"},jr={class:"font-medium text-gray-900 dark:text-gray-100"},Br={class:"break-all text-sm text-gray-600 dark:text-gray-400"},qr=["title","onClick"],Lr={key:1,class:"rounded-lg bg-white shadow dark:bg-gray-800"},Nr={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},Or={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},Rr={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},Ar={class:"p-6"},Ir={key:0,class:"py-8 text-center"},Hr={class:"text-gray-500 dark:text-gray-400"},Kr={key:1,class:"space-y-3"},Pr={class:"flex items-start justify-between rounded-lg bg-gray-50 px-4 py-3 transition-colors duration-200 hover:bg-gray-100 dark:bg-gray-700/50 dark:hover:bg-gray-700"},Mr={class:"min-w-0 flex-1"},Fr={class:"mb-1 flex items-center gap-2"},Er={class:"font-medium text-gray-900 dark:text-gray-100"},Ur={class:"break-all text-sm text-gray-600 dark:text-gray-400"},Vr=["title","onClick"],zr={key:0,class:"mt-6"},Jr={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},Wr={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Gr={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},Qr={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},Yr={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},Zr={class:"text-2xl font-bold text-green-600 dark:text-green-400"},Xr={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},to={class:"text-2xl font-bold text-purple-600 dark:text-purple-400"},eo={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},so={class:"text-2xl font-bold text-orange-600 dark:text-orange-400"},ao={__name:"HeadersViewer",props:{requestHeaders:{type:Object,default:()=>({})},responseHeaders:{type:Object,default:()=>({})}},setup(c){const T=c,S=O(""),B=O(!0),C=O(!0),q=X(()=>Object.keys(T.requestHeaders||{}).length>0||Object.keys(T.responseHeaders||{}).length>0),j=X(()=>{let g=0;return Object.entries(T.requestHeaders||{}).forEach(([s,m])=>{g+=s.length+String(m).length}),Object.entries(T.responseHeaders||{}).forEach(([s,m])=>{g+=s.length+String(m).length}),g}),x=X(()=>{const g=T.requestHeaders||{},s=Object.entries(g);if(!S.value)return s;const m=S.value.toLowerCase();return s.filter(([y,n])=>y.toLowerCase().includes(m)||String(n).toLowerCase().includes(m))}),_=X(()=>{const g=T.responseHeaders||{},s=Object.entries(g);if(!S.value)return s;const m=S.value.toLowerCase();return s.filter(([y,n])=>y.toLowerCase().includes(m)||String(n).toLowerCase().includes(m))}),E=g=>{if(g===0)return"0 B";const s=1024,m=["B","KB","MB","GB"],y=Math.floor(Math.log(g)/Math.log(s));return parseFloat((g/Math.pow(s,y)).toFixed(2))+" "+m[y]},H=g=>typeof g!="string"?String(g):g.length>100?g.substring(0,97)+"...":g,K=g=>{const s=g.toLowerCase();return["authorization","cookie","set-cookie","x-csrf-token","x-frame-options","x-content-type-options"].includes(s)?"安全":["cache-control","expires","etag","if-none-match","if-modified-since","last-modified"].includes(s)?"缓存":["content-type","content-length","content-encoding","accept","accept-encoding","accept-language"].includes(s)?"内容":s.startsWith("x-")||s.startsWith("anthropic-")?"自定义":"标准"},z=g=>{const s=K(g),m={安全:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300",缓存:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",内容:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",自定义:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",标准:"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300"};return m[s]||m.标准},U=g=>{const s={...T.requestHeaders,...T.responseHeaders};let m=0;return Object.keys(s).forEach(y=>{const n=K(y);(g==="security"&&n==="安全"||g==="cache"&&n==="缓存"||g==="content"&&n==="内容"||g==="custom"&&n==="自定义")&&m++}),m},J=async g=>{try{await navigator.clipboard.writeText(g),console.log("已复制到剪贴板")}catch(s){console.error("复制失败:",s)}};return(g,s)=>(l(),d("div",sr,[t("div",ar,[t("div",rr,[t("div",or,[t("div",null,[s[3]||(s[3]=t("p",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"请求头数量",-1)),t("p",nr,r(Object.keys(c.requestHeaders||{}).length),1)]),s[4]||(s[4]=t("i",{class:"fas fa-arrow-up text-2xl text-blue-500"},null,-1))])]),t("div",lr,[t("div",dr,[t("div",null,[s[5]||(s[5]=t("p",{class:"text-sm font-medium text-green-700 dark:text-green-300"},"响应头数量",-1)),t("p",ir,r(Object.keys(c.responseHeaders||{}).length),1)]),s[6]||(s[6]=t("i",{class:"fas fa-arrow-down text-2xl text-green-500"},null,-1))])]),t("div",ur,[t("div",cr,[t("div",null,[s[7]||(s[7]=t("p",{class:"text-sm font-medium text-purple-700 dark:text-purple-300"},"总大小",-1)),t("p",xr,r(E(j.value)),1)]),s[8]||(s[8]=t("i",{class:"fas fa-weight-hanging text-2xl text-purple-500"},null,-1))])])]),t("div",gr,[t("div",yr,[t("div",mr,[Z(t("input",{"onUpdate:modelValue":s[0]||(s[0]=m=>S.value=m),class:"w-full rounded-lg border border-gray-300 bg-white py-2 pl-10 pr-4 text-gray-900 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",placeholder:"搜索请求头或响应头...",type:"text"},null,512),[[yt,S.value]]),s[9]||(s[9]=t("i",{class:"fas fa-search absolute left-3 top-3 text-gray-400"},null,-1))])]),t("div",fr,[t("button",{class:$(["rounded-lg px-3 py-2 text-sm font-medium transition-colors",B.value?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:s[1]||(s[1]=m=>B.value=!B.value)},[...s[10]||(s[10]=[t("i",{class:"fas fa-arrow-up mr-1"},null,-1),b(" 请求头 ",-1)])],2),t("button",{class:$(["rounded-lg px-3 py-2 text-sm font-medium transition-colors",C.value?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:s[2]||(s[2]=m=>C.value=!C.value)},[...s[11]||(s[11]=[t("i",{class:"fas fa-arrow-down mr-1"},null,-1),b(" 响应头 ",-1)])],2)])]),t("div",br,[B.value?(l(),d("div",pr,[t("div",vr,[t("h4",kr,[s[12]||(s[12]=t("i",{class:"fas fa-arrow-up mr-2 text-blue-500"},null,-1)),s[13]||(s[13]=b(" 请求头 ",-1)),t("span",hr," ("+r(x.value.length)+" 个) ",1)])]),t("div",$r,[x.value.length===0?(l(),d("div",wr,[s[14]||(s[14]=t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1)),t("p",_r,r(S.value?"没有找到匹配的请求头":"暂无请求头信息"),1)])):(l(),d("div",Cr,[(l(!0),d(at,null,ot(x.value,([m,y])=>(l(),d("div",{key:`req-${m}`,class:"header-item group"},[t("div",Tr,[t("div",Dr,[t("div",Sr,[t("span",jr,r(m),1),t("span",{class:$(["rounded-full px-2 py-1 text-xs",z(m)])},r(K(m)),3)]),t("div",Br,r(H(y)),1)]),t("button",{class:"ml-3 p-2 text-gray-400 opacity-0 transition-all duration-200 hover:text-gray-600 group-hover:opacity-100 dark:hover:text-gray-300",title:`复制 ${m}`,onClick:n=>J(`${m}: ${y}`)},[...s[15]||(s[15]=[t("i",{class:"fas fa-copy text-sm"},null,-1)])],8,qr)])]))),128))]))])])):k("",!0),C.value?(l(),d("div",Lr,[t("div",Nr,[t("h4",Or,[s[16]||(s[16]=t("i",{class:"fas fa-arrow-down mr-2 text-green-500"},null,-1)),s[17]||(s[17]=b(" 响应头 ",-1)),t("span",Rr," ("+r(_.value.length)+" 个) ",1)])]),t("div",Ar,[_.value.length===0?(l(),d("div",Ir,[s[18]||(s[18]=t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1)),t("p",Hr,r(S.value?"没有找到匹配的响应头":"暂无响应头信息"),1)])):(l(),d("div",Kr,[(l(!0),d(at,null,ot(_.value,([m,y])=>(l(),d("div",{key:`res-${m}`,class:"header-item group"},[t("div",Pr,[t("div",Mr,[t("div",Fr,[t("span",Er,r(m),1),t("span",{class:$(["rounded-full px-2 py-1 text-xs",z(m)])},r(K(m)),3)]),t("div",Ur,r(H(y)),1)]),t("button",{class:"ml-3 p-2 text-gray-400 opacity-0 transition-all duration-200 hover:text-gray-600 group-hover:opacity-100 dark:hover:text-gray-300",title:`复制 ${m}`,onClick:n=>J(`${m}: ${y}`)},[...s[19]||(s[19]=[t("i",{class:"fas fa-copy text-sm"},null,-1)])],8,Vr)])]))),128))]))])])):k("",!0)]),q.value?(l(),d("div",zr,[t("div",Jr,[s[24]||(s[24]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-bar mr-2"}),b(" Header分析 ")],-1)),t("div",Wr,[t("div",Gr,[t("div",Qr,r(U("security")),1),s[20]||(s[20]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"安全相关",-1))]),t("div",Yr,[t("div",Zr,r(U("cache")),1),s[21]||(s[21]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"缓存控制",-1))]),t("div",Xr,[t("div",to,r(U("content")),1),s[22]||(s[22]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"内容类型",-1))]),t("div",eo,[t("div",so,r(U("custom")),1),s[23]||(s[23]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"自定义头",-1))])])])])):k("",!0)]))}},ro=mt(ao,[["__scopeId","data-v-8e3597c3"]]),oo={class:"message-content"},no={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},lo={class:"stat-card bg-blue-50 dark:bg-blue-900/20"},io={class:"flex items-center justify-between"},uo={class:"text-2xl font-bold text-blue-900 dark:text-blue-100"},co={class:"stat-card bg-green-50 dark:bg-green-900/20"},xo={class:"flex items-center justify-between"},go={class:"text-2xl font-bold text-green-900 dark:text-green-100"},yo={class:"stat-card bg-purple-50 dark:bg-purple-900/20"},mo={class:"flex items-center justify-between"},fo={class:"text-2xl font-bold text-purple-900 dark:text-purple-100"},bo={class:"stat-card bg-orange-50 dark:bg-orange-900/20"},po={class:"flex items-center justify-between"},vo={class:"text-lg font-bold text-orange-900 dark:text-orange-100"},ko={class:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},ho={class:"flex items-center gap-2"},$o={class:"flex items-center gap-2"},wo={class:"relative"},_o={class:"space-y-6"},Co={key:0,class:"rounded-lg bg-white shadow dark:bg-gray-800"},To={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},Do={class:"flex items-center justify-between"},So={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},jo={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},Bo={class:"flex items-center gap-2"},qo={class:"p-6"},Lo={key:0,class:"py-12 text-center"},No={key:1,class:"relative"},Oo={class:"content-container"},Ro={key:0,class:"content-block raw-content"},Ao=["innerHTML"],Io={key:2,class:"content-block pretty-content"},Ho={class:"mt-4 flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400"},Ko={key:0},Po={key:1,class:"rounded-lg bg-white shadow dark:bg-gray-800"},Mo={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},Fo={class:"flex items-center justify-between"},Eo={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},Uo={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},Vo={class:"flex items-center gap-2"},zo={class:"p-6"},Jo={key:0,class:"py-12 text-center"},Wo={key:1,class:"relative"},Go={class:"content-container"},Qo={key:0,class:"content-block raw-content"},Yo=["innerHTML"],Zo={key:2,class:"content-block pretty-content"},Xo={class:"mt-4 flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400"},tn={key:0},en={key:0,class:"mt-6"},sn={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},an={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},rn={class:"rounded-lg bg-blue-50 p-4 dark:bg-blue-900/20"},on={class:"space-y-1 text-sm text-blue-800 dark:text-blue-200"},nn={class:"rounded-lg bg-green-50 p-4 dark:bg-green-900/20"},ln={class:"space-y-1 text-sm text-green-800 dark:text-green-200"},dn={__name:"MessageContent",props:{requestBody:{type:[String,Object],default:null},responseBody:{type:[String,Object],default:null}},setup(c){const T=c,S=O("request"),B=O("formatted"),C=O(""),q=y=>{if(y===0)return"0 B";const n=1024,D=["B","KB","MB","GB"],V=Math.floor(Math.log(y)/Math.log(n));return parseFloat((y/Math.pow(n,V)).toFixed(2))+" "+D[V]},j=y=>y?typeof y=="string"?y.length:JSON.stringify(y).length:0,x=y=>y?typeof y=="string"?y:JSON.stringify(y,null,2):"",_=y=>{if(!y)return"";try{if(typeof y=="string"){const n=JSON.parse(y);return JSON.stringify(n,null,2)}return JSON.stringify(y,null,2)}catch{return x(y)}},E=(y,n=!1)=>{if(!y)return"";let D=x(y);return n&&H(y)&&(D=D.replace(/(".*?")/g,'<span class="json-string">$1</span>').replace(/(\b\d+\b)/g,'<span class="json-number">$1</span>').replace(/(\btrue\b|\bfalse\b|\bnull\b)/g,'<span class="json-boolean">$1</span>').replace(/([{}[\],])/g,'<span class="json-key">$1</span>')),`<pre class="whitespace-pre-wrap"><code>${D}</code></pre>`},H=y=>{if(typeof y=="object")return!0;if(typeof y=="string")try{return JSON.parse(y),!0}catch{return!1}return!1},K=y=>x(y).split(`
`).length,z=y=>x(y).length,U=()=>{let y=0;if(T.requestBody)try{const n=typeof T.requestBody=="string"?JSON.parse(T.requestBody):T.requestBody;n.messages&&Array.isArray(n.messages)&&(y+=n.messages.length)}catch{}return y||"—"},J=()=>{const y=H(T.requestBody),n=H(T.responseBody);return y&&n?"JSON":y||n?"Mixed":T.requestBody||T.responseBody?"Text":"—"},g=y=>{if(!C.value||!y)return y;const n=C.value,D=new RegExp(`(${n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return y.replace(D,'<mark class="bg-yellow-200 dark:bg-yellow-800">$1</mark>')},s=async y=>{try{await navigator.clipboard.writeText(y),console.log("已复制到剪贴板")}catch(n){console.error("复制失败:",n)}},m=(y,n)=>{const D=new Blob([y],{type:"application/json"}),V=URL.createObjectURL(D),i=document.createElement("a");i.href=V,i.download=n,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(V)};return(y,n)=>(l(),d("div",oo,[t("div",no,[t("div",lo,[t("div",io,[t("div",null,[n[8]||(n[8]=t("p",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"请求体大小",-1)),t("p",uo,r(q(j(c.requestBody))),1)]),n[9]||(n[9]=t("i",{class:"fas fa-upload text-2xl text-blue-500"},null,-1))])]),t("div",co,[t("div",xo,[t("div",null,[n[10]||(n[10]=t("p",{class:"text-sm font-medium text-green-700 dark:text-green-300"},"响应体大小",-1)),t("p",go,r(q(j(c.responseBody))),1)]),n[11]||(n[11]=t("i",{class:"fas fa-download text-2xl text-green-500"},null,-1))])]),t("div",yo,[t("div",mo,[t("div",null,[n[12]||(n[12]=t("p",{class:"text-sm font-medium text-purple-700 dark:text-purple-300"},"消息数量",-1)),t("p",fo,r(U()),1)]),n[13]||(n[13]=t("i",{class:"fas fa-comments text-2xl text-purple-500"},null,-1))])]),t("div",bo,[t("div",po,[t("div",null,[n[14]||(n[14]=t("p",{class:"text-sm font-medium text-orange-700 dark:text-orange-300"},"数据格式",-1)),t("p",vo,r(J()),1)]),n[15]||(n[15]=t("i",{class:"fas fa-file-code text-2xl text-orange-500"},null,-1))])])]),t("div",ko,[t("div",ho,[t("button",{class:$(["rounded-lg px-4 py-2 text-sm font-medium transition-colors",S.value==="request"?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:n[0]||(n[0]=D=>S.value="request")},[...n[16]||(n[16]=[t("i",{class:"fas fa-upload mr-1"},null,-1),b(" 请求内容 ",-1)])],2),t("button",{class:$(["rounded-lg px-4 py-2 text-sm font-medium transition-colors",S.value==="response"?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:n[1]||(n[1]=D=>S.value="response")},[...n[17]||(n[17]=[t("i",{class:"fas fa-download mr-1"},null,-1),b(" 响应内容 ",-1)])],2)]),t("div",$o,[t("div",wo,[Z(t("input",{"onUpdate:modelValue":n[2]||(n[2]=D=>C.value=D),class:"rounded-lg border border-gray-300 bg-white py-2 pl-8 pr-4 text-sm text-gray-900 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",placeholder:"搜索内容...",type:"text"},null,512),[[yt,C.value]]),n[18]||(n[18]=t("i",{class:"fas fa-search absolute left-2.5 top-2.5 text-sm text-gray-400"},null,-1))]),Z(t("select",{"onUpdate:modelValue":n[3]||(n[3]=D=>B.value=D),class:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100"},[...n[19]||(n[19]=[t("option",{value:"formatted"},"格式化",-1),t("option",{value:"raw"},"原始",-1),t("option",{value:"pretty"},"美化",-1)])],512),[[gt,B.value]])])]),t("div",_o,[S.value==="request"?(l(),d("div",Co,[t("div",To,[t("div",Do,[t("h4",So,[n[20]||(n[20]=t("i",{class:"fas fa-upload mr-2 text-blue-500"},null,-1)),n[21]||(n[21]=b(" 请求内容 ",-1)),t("span",jo,r(j(c.requestBody)>0?q(j(c.requestBody)):"无内容"),1)]),t("div",Bo,[c.requestBody?(l(),d("button",{key:0,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"复制内容",onClick:n[4]||(n[4]=D=>s(x(c.requestBody)))},[...n[22]||(n[22]=[t("i",{class:"fas fa-copy"},null,-1)])])):k("",!0),c.requestBody?(l(),d("button",{key:1,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"下载内容",onClick:n[5]||(n[5]=D=>m(x(c.requestBody),"request.json"))},[...n[23]||(n[23]=[t("i",{class:"fas fa-download"},null,-1)])])):k("",!0)])])]),t("div",qo,[c.requestBody?(l(),d("div",No,[t("div",Oo,[B.value==="raw"?(l(),d("pre",Ro,[t("code",null,r(g(x(c.requestBody))),1)])):B.value==="formatted"?(l(),d("div",{key:1,class:"content-block formatted-content",innerHTML:E(c.requestBody,!0)},null,8,Ao)):(l(),d("pre",Io,[t("code",null,r(g(_(c.requestBody))),1)]))]),t("div",Ho,[t("span",null,[n[25]||(n[25]=t("i",{class:"fas fa-align-left mr-1"},null,-1)),b(r(K(c.requestBody))+" 行",1)]),t("span",null,[n[26]||(n[26]=t("i",{class:"fas fa-font mr-1"},null,-1)),b(r(z(c.requestBody))+" 字符",1)]),H(c.requestBody)?(l(),d("span",Ko,[...n[27]||(n[27]=[t("i",{class:"fas fa-code mr-1"},null,-1),b("JSON 格式 ",-1)])])):k("",!0)])])):(l(),d("div",Lo,[...n[24]||(n[24]=[t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1),t("p",{class:"text-gray-500 dark:text-gray-400"},"暂无请求内容",-1)])]))])])):k("",!0),S.value==="response"?(l(),d("div",Po,[t("div",Mo,[t("div",Fo,[t("h4",Eo,[n[28]||(n[28]=t("i",{class:"fas fa-download mr-2 text-green-500"},null,-1)),n[29]||(n[29]=b(" 响应内容 ",-1)),t("span",Uo,r(j(c.responseBody)>0?q(j(c.responseBody)):"无内容"),1)]),t("div",Vo,[c.responseBody?(l(),d("button",{key:0,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"复制内容",onClick:n[6]||(n[6]=D=>s(x(c.responseBody)))},[...n[30]||(n[30]=[t("i",{class:"fas fa-copy"},null,-1)])])):k("",!0),c.responseBody?(l(),d("button",{key:1,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"下载内容",onClick:n[7]||(n[7]=D=>m(x(c.responseBody),"response.json"))},[...n[31]||(n[31]=[t("i",{class:"fas fa-download"},null,-1)])])):k("",!0)])])]),t("div",zo,[c.responseBody?(l(),d("div",Wo,[t("div",Go,[B.value==="raw"?(l(),d("pre",Qo,[t("code",null,r(g(x(c.responseBody))),1)])):B.value==="formatted"?(l(),d("div",{key:1,class:"content-block formatted-content",innerHTML:E(c.responseBody,!0)},null,8,Yo)):(l(),d("pre",Zo,[t("code",null,r(g(_(c.responseBody))),1)]))]),t("div",Xo,[t("span",null,[n[33]||(n[33]=t("i",{class:"fas fa-align-left mr-1"},null,-1)),b(r(K(c.responseBody))+" 行",1)]),t("span",null,[n[34]||(n[34]=t("i",{class:"fas fa-font mr-1"},null,-1)),b(r(z(c.responseBody))+" 字符",1)]),H(c.responseBody)?(l(),d("span",tn,[...n[35]||(n[35]=[t("i",{class:"fas fa-code mr-1"},null,-1),b("JSON 格式 ",-1)])])):k("",!0)])])):(l(),d("div",Jo,[...n[32]||(n[32]=[t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1),t("p",{class:"text-gray-500 dark:text-gray-400"},"暂无响应内容",-1)])]))])])):k("",!0)]),c.requestBody&&c.responseBody?(l(),d("div",en,[t("div",sn,[n[38]||(n[38]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-balance-scale mr-2"}),b(" 内容对比 ")],-1)),t("div",an,[t("div",rn,[n[36]||(n[36]=t("h5",{class:"mb-2 font-medium text-blue-900 dark:text-blue-100"},"请求摘要",-1)),t("div",on,[t("div",null,"大小: "+r(q(j(c.requestBody))),1),t("div",null,"行数: "+r(K(c.requestBody)),1),t("div",null,"格式: "+r(H(c.requestBody)?"JSON":"文本"),1)])]),t("div",nn,[n[37]||(n[37]=t("h5",{class:"mb-2 font-medium text-green-900 dark:text-green-100"},"响应摘要",-1)),t("div",ln,[t("div",null,"大小: "+r(q(j(c.responseBody))),1),t("div",null,"行数: "+r(K(c.responseBody)),1),t("div",null,"格式: "+r(H(c.responseBody)?"JSON":"文本"),1)])])])])])):k("",!0)]))}},un=mt(dn,[["__scopeId","data-v-847c2f90"]]),cn={class:"request-logs-container"},xn={class:"mb-6 flex items-center justify-between"},gn={key:0,class:"mt-2 flex items-center text-sm text-red-600 dark:text-red-400"},yn={class:"flex items-center space-x-3"},mn=["aria-label","disabled"],fn={class:"relative"},bn=["aria-label","disabled"],pn={key:0,"aria-label":"导出格式选择",class:"absolute right-0 top-full z-50 mt-2 w-48 rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5 dark:bg-gray-800",role:"menu"},vn={class:"py-1"},kn={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},hn={class:"stat-card"},$n={class:"flex items-center justify-between"},wn={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},_n={class:"stat-card"},Cn={class:"flex items-center justify-between"},Tn={class:"text-2xl font-bold text-red-600 dark:text-red-400"},Dn={class:"stat-card"},Sn={class:"flex items-center justify-between"},jn={class:"text-2xl font-bold text-green-600 dark:text-green-400"},Bn={class:"stat-card"},qn={class:"flex items-center justify-between"},Ln={class:"text-2xl font-bold text-purple-600 dark:text-purple-400"},Nn={class:"card mb-6 p-4"},On={class:"mb-4 flex items-center justify-between"},Rn={class:"flex items-center space-x-2"},An=["aria-label"],In={class:"relative"},Hn={class:"relative"},Kn=["aria-describedby"],Pn={class:"absolute right-2 top-1/2 -translate-y-1/2"},Mn={key:0,class:"loading-spinner h-4 w-4"},Fn={key:2,class:"fas fa-search text-sm text-gray-400"},En={key:0,id:"search-results-info",class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Un={key:0},Vn={key:1},zn={class:"relative"},Jn=["disabled"],Wn=["value"],Gn={key:0,class:"absolute right-3 top-1/2 -translate-y-1/2"},Qn={key:0,class:"mt-1 text-xs text-red-600 dark:text-red-400"},Yn={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Zn={key:0,class:"mt-4"},Xn={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},tl={key:0,class:"mt-2 text-sm text-red-600 dark:text-red-400"},el={key:1,class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},sl={key:0,class:"card mb-6 p-6"},al={class:"text-center"},rl={class:"mb-4 text-sm text-gray-600 dark:text-gray-400"},ol={class:"flex flex-col items-center space-y-2 sm:flex-row sm:justify-center sm:space-x-4 sm:space-y-0"},nl={key:1,class:"card"},ll={class:"flex flex-col space-y-3 border-b border-gray-200 p-4 dark:border-gray-700 sm:flex-row sm:items-center sm:justify-between sm:space-y-0"},dl={class:"flex items-center space-x-4"},il={class:"text-sm text-gray-600 dark:text-gray-400"},ul={key:0,class:"flex items-center text-xs text-green-600 dark:text-green-400"},cl={class:"flex items-center space-x-2"},xl={class:"flex items-center space-x-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-800"},gl={key:0,class:"p-8"},yl={class:"space-y-3"},ml={key:1,class:"py-12 text-center"},fl={class:"mb-2 text-lg font-semibold text-gray-900 dark:text-gray-100"},bl={class:"space-y-2 text-sm text-gray-600 dark:text-gray-400"},pl={key:0},vl={key:1},kl={class:"mt-4 flex flex-col items-center space-y-2 sm:flex-row sm:justify-center sm:space-x-4 sm:space-y-0"},hl={key:2,class:"overflow-x-auto"},$l={"aria-label":"请求日志列表",class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",role:"table"},wl={class:"bg-gray-50 dark:bg-gray-800"},_l={class:"flex items-center space-x-1"},Cl={class:"flex items-center space-x-1"},Tl={class:"flex items-center space-x-1"},Dl={class:"flex items-center space-x-1"},Sl={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},jl={class:"table-cell"},Bl={class:"text-sm text-gray-900 dark:text-gray-100"},ql={class:"table-cell"},Ll={class:"flex items-center space-x-2"},Nl=["title"],Ol={class:"table-cell"},Rl={class:"table-cell"},Al=["title"],Il={class:"table-cell"},Hl={class:"flex items-center gap-2"},Kl=["title"],Pl={class:"table-cell"},Ml={class:"flex items-center space-x-1"},Fl={class:"text-sm text-gray-900 dark:text-gray-100"},El=["title"],Ul={key:1,class:"fas fa-rocket text-xs text-green-500",title:"高性能请求"},Vl={class:"table-cell"},zl={class:"space-y-1 text-sm"},Jl={class:"flex items-center space-x-1 text-blue-600 dark:text-blue-400"},Wl=["title"],Gl={key:0,class:"flex items-center space-x-1 text-green-600 dark:text-green-400"},Ql={class:"text-xs"},Yl=["title"],Zl={key:1,class:"flex items-center space-x-1"},Xl=["title"],td={class:"text-xs text-gray-500"},ed={class:"table-cell"},sd={class:"space-y-1 text-sm"},ad={class:"font-medium"},rd={key:0,class:"text-green-600 dark:text-green-400"},od={key:1,class:"text-gray-400"},nd=["title"],ld={key:0},dd=["title"],id={class:"table-cell"},ud={class:"text-sm text-gray-600 dark:text-gray-400"},cd={class:"table-cell"},xd=["aria-label","onClick"],gd={key:3,class:"divide-y divide-gray-200 dark:divide-gray-700"},yd={class:"flex items-start justify-between"},md={class:"flex-1 space-y-2"},fd={class:"flex items-center justify-between"},bd={class:"flex items-center space-x-3"},pd={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},vd={class:"flex items-center space-x-1"},kd=["title"],hd=["onClick"],$d={class:"flex items-center space-x-2"},wd={class:"truncate text-sm text-gray-900 dark:text-gray-100"},_d={class:"flex items-center justify-between text-sm"},Cd={class:"flex items-center space-x-2"},Td={class:"text-gray-600 dark:text-gray-400"},Dd={class:"flex flex-col items-end text-xs"},Sd={class:"flex items-center space-x-1 text-blue-600 dark:text-blue-400"},jd={key:0,class:"text-green-600 dark:text-green-400"},Bd={class:"mt-2 text-xs text-gray-500 dark:text-gray-500"},qd={key:4,class:"flex items-center justify-between border-t border-gray-200 px-4 py-3 dark:border-gray-700"},Ld={class:"flex items-center space-x-2"},Nd=["disabled"],Od={class:"text-sm text-gray-600 dark:text-gray-400"},Rd=["disabled"],Ad={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},Id={class:"modal-content relative mx-auto flex max-h-[95vh] w-[95%] max-w-6xl flex-col p-4 sm:w-full sm:p-6"},Hd={class:"mb-4 flex items-center justify-between sm:mb-6"},Kd={class:"flex items-center gap-3"},Pd={class:"text-sm text-gray-600 dark:text-gray-400"},Md={class:"mb-6 border-b border-gray-200 dark:border-gray-700"},Fd={"aria-label":"Tabs",class:"-mb-px flex space-x-8"},Ed=["onClick"],Ud={key:0,class:"ml-2 inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"},Vd={class:"modal-scroll-content custom-scrollbar flex-1 overflow-y-auto"},zd={key:0,class:"tab-content"},Jd={key:1,class:"tab-content"},Wd={key:2,class:"tab-content"},Gd={key:3,class:"tab-content"},Qd={class:"mt-6 flex justify-between border-t border-gray-200 pt-6 dark:border-gray-700"},Yd={class:"flex items-center space-x-4"},Zd={class:"text-sm text-gray-500 dark:text-gray-400"},Xd={class:"text-sm text-gray-500 dark:text-gray-400"},t0={class:"flex gap-3"},e0=["disabled"],s0={class:"max-h-[90vh] w-full max-w-2xl overflow-hidden rounded-lg bg-white shadow-xl dark:bg-gray-800"},a0={class:"flex items-center justify-between border-b border-gray-200 px-6 py-4 dark:border-gray-700"},r0={class:"max-h-[calc(90vh-120px)] overflow-y-auto p-6"},o0={class:"space-y-4"},n0={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},l0={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},d0={key:0},i0={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},u0={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},c0={class:"mt-1 space-y-2 text-sm text-gray-600 dark:text-gray-400"},x0={key:0},g0={key:1},y0={key:2},m0={key:3},f0={__name:"RequestLogsView",setup(c){const T=(o,e)=>{let f;return(...w)=>{clearTimeout(f),f=setTimeout(()=>o.apply(this,w),e)}},S=qe(),{logs:B,loading:C,exporting:q,stats:j,filters:x,pagination:_,filteredLogs:E,hasFilters:H,apiKeyLoading:K,apiKeyMap:z}=Te(S),{fetchLogs:U,fetchStats:J,exportLogs:g,updateFilters:s,clearFilters:m,refreshLogs:y,formatLogEntry:n,getStatusClass:D,getMethodClass:V,formatDuration:i,fetchApiKeys:u,fetchLogDetails:P}=S,L=O(!1),v=O(null),A=O("24h"),F=O(""),I=O(null),W=O(!1),Q=O(null),nt=O(!1),dt=O(!1),it=O("table"),jt=O(!1),ft=O(!1),Bt=O(0),et=O("overview"),me=O([{id:"overview",name:"概览",icon:"fas fa-info-circle"},{id:"tokens",name:"Token详情",icon:"fas fa-coins",badge:!0},{id:"headers",name:"请求头",icon:"fas fa-list-ul",badge:!0},{id:"content",name:"消息内容",icon:"fas fa-file-text",badge:!0}]),ut=o=>{var f;if(!o||o===null||o===void 0)return"Unknown";if(Q.value)return`${o} (无法验证)`;if(K.value)return`${o} (加载中...)`;const e=(f=z.value)==null?void 0:f.get(o);return e!=null&&e.name?e.name:`${o} (已删除)`},fe=X(()=>{var e;return(((e=j.value)==null?void 0:e.topApiKeys)||[]).map(f=>({id:f.keyId,name:ut(f.keyId),count:f.count,displayText:`${ut(f.keyId)} (${f.count}次使用)`}))}),ct=X(()=>{const o=Array.isArray(B.value)?B.value:[];if(!x.search)return o;const e=String(x.search||"").toLowerCase();return e?o.filter(f=>{var w,h,R,M;return((w=f==null?void 0:f.keyName)==null?void 0:w.toLowerCase().includes(e))||((h=f==null?void 0:f.userAgent)==null?void 0:h.toLowerCase().includes(e))||((R=f==null?void 0:f.ipAddress)==null?void 0:R.includes(e))||((M=f==null?void 0:f.path)==null?void 0:M.toLowerCase().includes(e))}):o}),bt=X(()=>{let o=[];return o=Array.isArray(E.value)?E.value:[],o.map(e=>({...e,formattedKeyName:e.keyName||ut(e.keyId),mergeInfo:e._mergedCount>1?{count:e._mergedCount,tooltip:`此记录合并了 ${e._mergedCount} 条相关日志`}:null}))}),qt=T(async()=>{nt.value=!0;try{await st()}finally{nt.value=!1}},500),be=X(()=>A.value!=="custom"?{"1h":"最近 1 小时","24h":"最近 24 小时","7d":"最近 7 天","30d":"最近 30 天"}[A.value]||"":x.startDate&&x.endDate?`${x.startDate} 至 ${x.endDate}`:"请设置时间范围");ye(()=>[x.startDate,x.endDate],([o,e])=>{A.value==="custom"&&o&&e&&(F.value="",pe())});const pe=T(async()=>{A.value==="custom"&&await It()},1e3),ve=()=>{var f;const o=(_==null?void 0:_.total)||0,e=((f=bt.value)==null?void 0:f.length)||0;return x!=null&&x.search?`找到 ${ct.value?ct.value.length:0} 条匹配结果，共 ${o} 条记录`:`显示 ${e} 条记录，共 ${o} 条`},ke=o=>o?o.code==="NETWORK_ERROR"?"网络连接失败，请检查网络连接后重试":o.code==="TIMEOUT"?"请求超时，服务器响应缓慢":o.status===401?"认证失败，请重新登录":o.status===403?"没有权限访问此资源":o.status>=500?"服务器内部错误，请稍后重试或联系技术支持":o.message||"请求失败，请重试":"未知错误",he=()=>{s({search:""}),st()},Lt=()=>{m(),st()},Nt=async()=>{I.value=null,W.value=!1,Bt.value++;try{await Ct(),rt("数据加载成功","success")}catch(o){I.value=o,rt("重试失败，请检查网络连接","error")}},$e=o=>`${(o*100).toFixed(1)}%`,Ot=o=>{if(o.tokenDetails){const R=o.tokenDetails.inputTokens||0,M=o.tokenDetails.outputTokens||0,N=o.tokenDetails.totalTokens||R+M;if(N>0){if(R>0&&M>0){const lt=o._mergedCount>1?` (×${o._mergedCount})`:"";return`${R}→${M}${lt}`}return N.toString()}}const e=o.usage||{},f=e.input_tokens||o.inputTokens||0,w=e.output_tokens||o.outputTokens||0,h=o.tokens||f+w;if(h>0){if(f>0&&w>0){const R=o._mergedCount>1?` (×${o._mergedCount})`:"";return`${f}→${w}${R}`}return h.toString()}return"-"},Rt=o=>{var e;if(typeof o=="object"&&o!==null){const f=o;o=((e=f.costDetails)==null?void 0:e.totalCost)||f.cost||0}return!o||o===0?"0.00":o<.01?"< 0.01":o.toFixed(4)},G=o=>{var e;return((e=o.costDetails)==null?void 0:e.totalCost)||o.cost||0},At=o=>{var w,h;if(o.tokenDetails)return(o.tokenDetails.cacheReadTokens||0)+(o.tokenDetails.cacheCreateTokens||0);const e=((w=o.usage)==null?void 0:w.cache_read_input_tokens)||0,f=((h=o.usage)==null?void 0:h.cache_creation_input_tokens)||0;return e+f},st=async()=>{try{I.value=null,W.value=!1,A.value==="custom"?await It():await U()}catch(o){console.error("Apply filters failed:",o),I.value=o,W.value=!0}},It=async()=>{const o=x.startDate,e=x.endDate;if(!o||!e){F.value="请设置完整的时间范围";return}const f=new Date(o),w=new Date(e);if(f>=w){F.value="结束时间必须大于开始时间";return}if((w-f)/(1e3*60*60*24)>90){F.value="时间范围不能超过90天";return}F.value="",await Ht(f.toISOString(),w.toISOString())},Ht=async(o,e)=>{console.log("📅 applyFiltersWithTimeRange被调用:",{startDateISO:o,endDateISO:e});const f=x.startDate,w=x.endDate;s({startDate:o,endDate:e}),console.log("📊 调用fetchLogs前，filters状态:",x.value),await U(),console.log("✅ fetchLogs调用完成"),A.value!=="custom"&&s({startDate:f,endDate:w})},we=(o,e)=>{const f=new Date(e);switch(o){case"1h":return new Date(f.getTime()-60*60*1e3);case"24h":return new Date(f.getTime()-24*60*60*1e3);case"7d":return new Date(f.getTime()-7*24*60*60*1e3);case"30d":return new Date(f.getTime()-30*24*60*60*1e3);default:return new Date(f.getTime()-24*60*60*1e3)}},Kt=o=>{const e=new Date(o);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e.toISOString().slice(0,16)},Pt=()=>{if(console.log("🕐 applyTimeRange被调用, timeRange.value:",A.value),F.value="",A.value==="custom"){console.log("⚠️ timeRange是custom，跳过自动更新");return}try{const o=new Date,e=we(A.value,o),f=o,w=e.toISOString(),h=f.toISOString(),R=Kt(e),M=Kt(f);s({startDate:R,endDate:M}),Ht(w,h)}catch(o){console.error("时间范围设置错误:",o),F.value=o.message}},pt=o=>{const e=x==null?void 0:x.sortBy,f=x==null?void 0:x.sortOrder;s(e===o?{sortOrder:f==="asc"?"desc":"asc"}:{sortBy:o,sortOrder:"desc"}),st()},vt=o=>(x==null?void 0:x.sortBy)!==o?"fa-sort":(x==null?void 0:x.sortOrder)==="asc"?"fa-sort-up":"fa-sort-down",Mt=o=>{const e=(_==null?void 0:_.totalPages)||1;o>=1&&o<=e&&(s({page:o}),st())},Ft=async o=>{var e,f,w;if(v.value=o,et.value="overview",!o.tokenDetails&&!o.costDetails&&!o.requestHeaders&&!o.responseHeaders)try{console.log("获取日志详情:",o.id||o.logId);const h=await P(o.id||o.logId);if(h){console.log("获取到的详细日志:",h);const R=tt=>{if(!tt)return{};if(typeof tt=="object")return tt;if(typeof tt=="string")try{return JSON.parse(tt)}catch($t){return console.warn("Failed to parse JSON data:",$t,tt),{}}return{}},M=R(h.tokenDetails)||h.usage||h.tokenSummary||{},N=St(M),lt=R(h.costDetails)||{totalCost:h.cost||0,currency:"USD"},ht={totalTokens:N.totalTokens,inputTokens:N.inputTokens,outputTokens:N.outputTokens,cacheCreateTokens:N.cacheCreateTokens,cacheReadTokens:N.cacheReadTokens,efficiency:((e=h.tokenSummary)==null?void 0:e.efficiency)??(N.totalTokens>0?(N.outputTokens/N.totalTokens*100).toFixed(2):0)};v.value={...o,...h,tokenDetails:N,costDetails:lt,tokenSummary:{...h.tokenSummary||{},...ht},requestHeaders:R(h.requestHeaders),responseHeaders:R(h.responseHeaders),request:h.request||o.request||{},response:h.response||o.response||{},requestBody:h.requestBody||((f=h.request)==null?void 0:f.body),responseBody:h.responseBody||((w=h.response)==null?void 0:w.body)},console.log("合并后的日志对象:",v.value)}}catch(h){console.error("获取日志详情失败:",h),rt("获取日志详情失败","error")}},_t=()=>{v.value=null,et.value="overview"},Et=o=>{var e,f;if(!v.value)return 0;switch(o){case"tokens":{const w=v.value.tokenDetails&&Object.keys(v.value.tokenDetails).length>0,h=v.value.costDetails&&Object.keys(v.value.costDetails).length>0;return(w?1:0)+(h?1:0)}case"headers":{const w=v.value.requestHeaders?Object.keys(v.value.requestHeaders).length:0,h=v.value.responseHeaders?Object.keys(v.value.responseHeaders).length:0;return w+h}case"content":{let w=0;return((e=v.value.request)!=null&&e.body||v.value.requestBody)&&w++,((f=v.value.response)!=null&&f.body||v.value.responseBody)&&w++,w}default:return 0}},_e=async()=>{var o,e,f,w;if(v.value)try{const h={metadata:{timestamp:v.value.timestamp,apiKey:v.value.formattedKeyName||ut(v.value.keyId)||"Unknown",method:((o=v.value.request)==null?void 0:o.method)||"N/A",path:((e=v.value.request)==null?void 0:e.path)||"/",statusCode:((f=v.value.response)==null?void 0:f.statusCode)||"N/A",responseTime:v.value.responseTime||"N/A",ipAddress:((w=v.value.request)==null?void 0:w.ip)||"N/A"},request:v.value.request||{},response:v.value.response||{},usage:v.value.usage||{}},R=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),M=URL.createObjectURL(R),N=document.createElement("a");N.href=M,N.download=`log-detail-${new Date(v.value.timestamp).getTime()}.json`,N.style.display="none",document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(M),rt("日志详情已导出","success")}catch(h){console.error("导出日志详情失败:",h),rt("导出失败","error")}},Ut=async o=>{L.value=!1,await g(o)},Ce=async()=>{try{Q.value=null,await u(!0),rt("API Key数据重新加载成功","success")}catch(o){console.error("API Key重试失败:",o),Q.value="重试失败，请稍后再试",rt("API Key重新加载失败","error")}},Ct=async()=>{try{I.value=null,W.value=!1,Q.value=null;try{await u(!0)}catch(o){console.warn("API Key加载失败，使用现有数据:",o),Q.value="API Key数据加载失败"}await y()}catch(o){throw console.error("Refresh failed:",o),I.value=o,W.value=!0,o}};let kt=null;Dt(async()=>{try{try{await u()}catch(o){console.warn("API Key初始加载失败:",o),Q.value="API Key数据加载失败，可能影响显示效果"}Pt(),await J(),jt.value&&(kt=setInterval(async()=>{try{await J()}catch(o){console.warn("Auto refresh failed:",o),W.value=!0}},3e4))}catch(o){console.error("Initial load failed:",o),I.value=o}});const Vt=o=>{o.target.closest(".relative")||(L.value=!1)},zt=()=>{W.value=!1,I.value&&Nt()},Jt=()=>{W.value=!0};return Dt(()=>{document.addEventListener("click",Vt),window.addEventListener("online",zt),window.addEventListener("offline",Jt),navigator.onLine||(W.value=!0)}),De(()=>{kt&&(clearInterval(kt),kt=null),document.removeEventListener("click",Vt),window.removeEventListener("online",zt),window.removeEventListener("offline",Jt)}),(o,e)=>{var f,w,h,R,M,N,lt,ht,tt,$t,Wt,Gt,Qt,Yt,Zt,Xt,te,ee,se,ae,re,oe;return l(),d("div",cn,[t("div",xn,[t("div",null,[e[24]||(e[24]=t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},"请求日志",-1)),e[25]||(e[25]=t("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},"查看和管理 API 请求日志记录",-1)),W.value?(l(),d("div",gn,[...e[23]||(e[23]=[t("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1),b(" 连接异常，数据可能不是最新的 ",-1)])])):k("",!0)]),t("div",yn,[t("button",{"aria-label":p(C)?"正在刷新数据":"刷新日志数据",class:"btn btn-secondary",disabled:p(C),onClick:Ct},[t("i",{class:$(["fas fa-sync-alt mr-2",{"animate-spin":p(C)}])},null,2),b(" "+r(p(C)?"刷新中...":"刷新"),1)],8,mn),t("div",fn,[t("button",{"aria-label":p(q)?"正在导出数据":"导出日志数据",class:"btn btn-primary",disabled:p(q)||(Array.isArray(p(B))?p(B).length:0)===0,onClick:e[0]||(e[0]=a=>L.value=!L.value)},[t("i",{class:$(["fas fa-download mr-2",{"animate-spin":p(q)}])},null,2),b(" "+r(p(q)?"导出中...":"导出"),1)],8,bn),L.value?(l(),d("div",pn,[t("div",vn,[t("button",{class:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",role:"menuitem",onClick:e[1]||(e[1]=a=>Ut("json"))},[...e[26]||(e[26]=[t("i",{class:"fas fa-file-code mr-2"},null,-1),b(" 导出为 JSON ",-1)])]),t("button",{class:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",role:"menuitem",onClick:e[2]||(e[2]=a=>Ut("csv"))},[...e[27]||(e[27]=[t("i",{class:"fas fa-file-csv mr-2"},null,-1),b(" 导出为 CSV ",-1)])])])])):k("",!0)])])]),t("div",kn,[t("div",hn,[t("div",$n,[t("div",null,[e[28]||(e[28]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"总请求数",-1)),t("p",wn,r(((f=p(j))==null?void 0:f.totalRequests)||((w=p(_))==null?void 0:w.total)||0),1)]),e[29]||(e[29]=t("i",{class:"fas fa-chart-line text-2xl text-blue-500"},null,-1))])]),t("div",_n,[t("div",Cn,[t("div",null,[e[30]||(e[30]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"错误率",-1)),t("p",Tn,r($e(((h=p(j))==null?void 0:h.errorRate)||0)),1)]),e[31]||(e[31]=t("i",{class:"fas fa-exclamation-triangle text-2xl text-red-500"},null,-1))])]),t("div",Dn,[t("div",Sn,[t("div",null,[e[32]||(e[32]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"平均响应时间",-1)),t("p",jn,r(p(i)(((R=p(j))==null?void 0:R.averageResponseTime)||0)),1)]),e[33]||(e[33]=t("i",{class:"fas fa-clock text-2xl text-green-500"},null,-1))])]),t("div",Bn,[t("div",qn,[t("div",null,[e[34]||(e[34]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"活跃 API Keys",-1)),t("p",Ln,r(((N=(M=p(j))==null?void 0:M.topApiKeys)==null?void 0:N.length)||0),1)]),e[35]||(e[35]=t("i",{class:"fas fa-key text-2xl text-purple-500"},null,-1))])])]),t("div",Nn,[t("div",On,[t("div",Rn,[e[36]||(e[36]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"筛选条件",-1)),t("button",{"aria-label":dt.value?"收起筛选面板":"展开筛选面板",class:"rounded-md bg-gray-100 px-2 py-1 text-xs text-gray-600 dark:bg-gray-700 dark:text-gray-300 md:hidden",onClick:e[3]||(e[3]=a=>dt.value=!dt.value)},[t("i",{class:$(["fas",dt.value?"fa-chevron-up":"fa-chevron-down"])},null,2)],8,An)]),p(H)?(l(),d("button",{key:0,class:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",onClick:Lt},[...e[37]||(e[37]=[t("i",{class:"fas fa-times mr-1"},null,-1),b(" 清除筛选 ",-1)])])):k("",!0)]),t("div",{class:$(["grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",{"hidden md:grid":!dt.value}])},[t("div",In,[e[40]||(e[40]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 搜索 ",-1)),t("div",Hn,[Z(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>p(x).search=a),"aria-describedby":p(x).search&&(ct.value||[]).length>0?"search-results-info":void 0,"aria-label":"搜索日志记录",class:"form-input w-full pr-8",placeholder:"API Key、IP、路径...",onInput:e[5]||(e[5]=(...a)=>p(qt)&&p(qt)(...a))},null,40,Kn),[[yt,p(x).search]]),t("div",Pn,[nt.value?(l(),d("div",Mn)):p(x).search?(l(),d("button",{key:1,"aria-label":"清除搜索",class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:he},[...e[38]||(e[38]=[t("i",{class:"fas fa-times text-sm"},null,-1)])])):(l(),d("i",Fn))])]),p(x).search&&!nt.value?(l(),d("div",En,[p(x).search&&((lt=ct.value)==null?void 0:lt.length)>0?(l(),d("span",Un,"找到 "+r(((ht=ct.value)==null?void 0:ht.length)||0)+" 条结果",1)):(l(),d("span",Vn,"未找到匹配结果")),e[39]||(e[39]=t("span",{class:"ml-2"},"💡 试试搜索IP地址或完整路径",-1))])):k("",!0)]),t("div",null,[e[44]||(e[44]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," API Key ",-1)),t("div",zn,[Z(t("select",{"onUpdate:modelValue":e[6]||(e[6]=a=>p(x).apiKeyId=a),class:"form-select w-full",disabled:p(K),onChange:st},[e[41]||(e[41]=t("option",{value:""},"全部",-1)),(l(!0),d(at,null,ot(fe.value,a=>(l(),d("option",{key:a.id,value:a.id},r(a.displayText),9,Wn))),128))],40,Jn),[[gt,p(x).apiKeyId]]),p(K)?(l(),d("div",Gn,[...e[42]||(e[42]=[t("div",{class:"loading-spinner h-4 w-4"},null,-1)])])):k("",!0)]),Q.value?(l(),d("div",Qn,[e[43]||(e[43]=t("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1)),b(" "+r(Q.value)+" ",1),t("button",{class:"ml-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",onClick:Ce}," 重试 ")])):k("",!0)]),t("div",null,[e[46]||(e[46]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 状态码 ",-1)),Z(t("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>p(x).statusCode=a),class:"form-select w-full",onChange:st},[...e[45]||(e[45]=[Tt('<option value="" data-v-be112487>全部</option><option value="200" data-v-be112487>200 (成功)</option><option value="400" data-v-be112487>400 (请求错误)</option><option value="401" data-v-be112487>401 (未授权)</option><option value="403" data-v-be112487>403 (禁止访问)</option><option value="429" data-v-be112487>429 (限流)</option><option value="500" data-v-be112487>500 (服务器错误)</option>',7)])],544),[[gt,p(x).statusCode]])]),t("div",null,[e[48]||(e[48]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 时间范围 ",-1)),Z(t("select",{"onUpdate:modelValue":e[8]||(e[8]=a=>A.value=a),class:"form-select w-full",onChange:Pt},[...e[47]||(e[47]=[Tt('<option value="1h" data-v-be112487>最近 1 小时</option><option value="24h" data-v-be112487>最近 24 小时</option><option value="7d" data-v-be112487>最近 7 天</option><option value="30d" data-v-be112487>最近 30 天</option><option value="custom" data-v-be112487>自定义</option>',5)])],544),[[gt,A.value]]),t("p",Yn,r(be.value),1)])],2),A.value==="custom"?(l(),d("div",Zn,[t("div",Xn,[t("div",null,[e[49]||(e[49]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 开始时间 ",-1)),Z(t("input",{"onUpdate:modelValue":e[9]||(e[9]=a=>p(x).startDate=a),class:$(["form-input w-full",{"border-red-300 focus:border-red-500 focus:ring-red-500":F.value}]),placeholder:"选择开始时间",type:"datetime-local"},null,2),[[yt,p(x).startDate]])]),t("div",null,[e[50]||(e[50]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 结束时间 ",-1)),Z(t("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>p(x).endDate=a),class:$(["form-input w-full",{"border-red-300 focus:border-red-500 focus:ring-red-500":F.value}]),placeholder:"选择结束时间",type:"datetime-local"},null,2),[[yt,p(x).endDate]])])]),F.value?(l(),d("div",tl,[e[51]||(e[51]=t("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),b(" "+r(F.value),1)])):(l(),d("div",el,[...e[52]||(e[52]=[t("i",{class:"fas fa-info-circle mr-1"},null,-1),b(" 支持最长90天的时间范围查询。修改时间后将自动查询。 ",-1)])]))])):k("",!0)]),I.value&&!p(C)?(l(),d("div",sl,[t("div",al,[e[55]||(e[55]=t("div",{class:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900"},[t("i",{class:"fas fa-exclamation-triangle text-2xl text-red-600 dark:text-red-400"})],-1)),e[56]||(e[56]=t("h3",{class:"mb-2 text-lg font-semibold text-gray-900 dark:text-gray-100"},"加载失败",-1)),t("p",rl,r(ke(I.value)),1),t("div",ol,[t("button",{class:"btn btn-primary",onClick:Nt},[...e[53]||(e[53]=[t("i",{class:"fas fa-redo mr-2"},null,-1),b(" 重试 ",-1)])]),t("button",{class:"btn btn-secondary",onClick:e[11]||(e[11]=a=>ft.value=!0)},[...e[54]||(e[54]=[t("i",{class:"fas fa-info-circle mr-2"},null,-1),b(" 查看详情 ",-1)])])])])])):(l(),d("div",nl,[t("div",ll,[t("div",dl,[t("span",il,r(ve()),1),jt.value?(l(),d("div",ul,[...e[57]||(e[57]=[t("div",{class:"mr-1 h-2 w-2 animate-pulse rounded-full bg-green-500"},null,-1),b(" 实时更新 ",-1)])])):k("",!0)]),t("div",cl,[t("div",xl,[t("button",{class:$(["rounded px-2 py-1 text-xs font-medium transition-colors",it.value==="table"?"bg-white text-blue-600 shadow-sm dark:bg-gray-700 dark:text-blue-400":"text-gray-600 dark:text-gray-400"]),onClick:e[12]||(e[12]=a=>it.value="table")},[...e[58]||(e[58]=[t("i",{class:"fas fa-table mr-1"},null,-1),b(" 表格 ",-1)])],2),t("button",{class:$(["rounded px-2 py-1 text-xs font-medium transition-colors",it.value==="cards"?"bg-white text-blue-600 shadow-sm dark:bg-gray-700 dark:text-blue-400":"text-gray-600 dark:text-gray-400"]),onClick:e[13]||(e[13]=a=>it.value="cards")},[...e[59]||(e[59]=[t("i",{class:"fas fa-th-large mr-1"},null,-1),b(" 卡片 ",-1)])],2)]),Z(t("select",{"onUpdate:modelValue":e[14]||(e[14]=a=>p(x).limit=a),"aria-label":"每页显示条数",class:"form-select text-sm",onChange:st},[...e[60]||(e[60]=[t("option",{value:"25"},"25 条/页",-1),t("option",{value:"50"},"50 条/页",-1),t("option",{value:"100"},"100 条/页",-1)])],544),[[gt,p(x).limit]])])]),p(C)?(l(),d("div",gl,[t("div",yl,[(l(),d(at,null,ot(5,a=>t("div",{key:a,class:"animate-pulse"},[...e[61]||(e[61]=[Tt('<div class="flex items-center space-x-4" data-v-be112487><div class="h-4 w-20 rounded bg-gray-200 dark:bg-gray-700" data-v-be112487></div><div class="h-4 w-16 rounded bg-gray-200 dark:bg-gray-700" data-v-be112487></div><div class="h-4 w-12 rounded bg-gray-200 dark:bg-gray-700" data-v-be112487></div><div class="h-4 flex-1 rounded bg-gray-200 dark:bg-gray-700" data-v-be112487></div><div class="h-4 w-16 rounded bg-gray-200 dark:bg-gray-700" data-v-be112487></div><div class="h-4 w-12 rounded bg-gray-200 dark:bg-gray-700" data-v-be112487></div></div>',1)])])),64)),e[62]||(e[62]=t("div",{class:"mt-4 text-center"},[t("div",{class:"inline-flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400"},[t("div",{class:"loading-spinner"}),t("span",null,"正在加载日志数据...")])],-1))])])):bt.value.length===0?(l(),d("div",ml,[e[65]||(e[65]=t("div",{class:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800"},[t("i",{class:"fas fa-inbox text-2xl text-gray-400"})],-1)),t("h3",fl,r(p(x).search?"未找到匹配的日志":"暂无日志记录"),1),t("div",bl,[p(x).search?(l(),d("p",pl,'未找到包含 "'+r(p(x).search)+'" 的日志记录',1)):(l(),d("p",vl,"当前时间范围内没有日志记录")),t("div",kl,[p(H)?(l(),d("button",{key:0,class:"btn btn-primary",onClick:Lt},[...e[63]||(e[63]=[t("i",{class:"fas fa-filter mr-2"},null,-1),b(" 清除所有筛选 ",-1)])])):k("",!0),t("button",{class:"btn btn-secondary",onClick:Ct},[...e[64]||(e[64]=[t("i",{class:"fas fa-sync-alt mr-2"},null,-1),b(" 刷新数据 ",-1)])])])])])):it.value==="table"?(l(),d("div",hl,[t("table",$l,[t("thead",wl,[t("tr",null,[t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[15]||(e[15]=a=>pt("timestamp"))},[t("div",_l,[e[66]||(e[66]=t("span",null,"时间",-1)),t("i",{class:$(["fas fa-sort text-gray-400",vt("timestamp")])},null,2)])]),e[70]||(e[70]=t("th",{class:"table-header",role:"columnheader"},"API Key",-1)),t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[16]||(e[16]=a=>pt("request.method"))},[t("div",Cl,[e[67]||(e[67]=t("span",null,"方法",-1)),t("i",{class:$(["fas fa-sort text-gray-400",vt("request.method")])},null,2)])]),e[71]||(e[71]=t("th",{class:"table-header",role:"columnheader"},"路径",-1)),t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[17]||(e[17]=a=>pt("response.statusCode"))},[t("div",Tl,[e[68]||(e[68]=t("span",null,"状态码",-1)),t("i",{class:$(["fas fa-sort text-gray-400",vt("response.statusCode")])},null,2)])]),t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[18]||(e[18]=a=>pt("response.duration"))},[t("div",Dl,[e[69]||(e[69]=t("span",null,"响应时间",-1)),t("i",{class:$(["fas fa-sort text-gray-400",vt("response.duration")])},null,2)])]),e[72]||(e[72]=t("th",{class:"table-header",role:"columnheader"},"Tokens",-1)),e[73]||(e[73]=t("th",{class:"table-header",role:"columnheader"},"成本",-1)),e[74]||(e[74]=t("th",{class:"table-header",role:"columnheader"},"IP 地址",-1)),e[75]||(e[75]=t("th",{class:"table-header",role:"columnheader"},"操作",-1))])]),t("tbody",Sl,[(l(!0),d(at,null,ot(bt.value,a=>{var Y,ne,le,de,ie,ue,ce,xe;return l(),d("tr",{key:a.logId||a.timestamp,class:$(["transition-colors hover:bg-gray-50 dark:hover:bg-gray-800",{"animate-pulse bg-green-50 dark:bg-green-900/20":a._isNew}])},[t("td",jl,[t("div",Bl,r(new Date(a.timestamp).toLocaleString("zh-CN")),1)]),t("td",ql,[t("div",Ll,[e[77]||(e[77]=t("div",{"aria-label":"API Key 活跃",class:"h-2 w-2 rounded-full bg-green-500"},null,-1)),t("span",{class:$(["text-sm font-medium",a.formattedKeyName&&a.formattedKeyName.includes("(已删除)")?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-gray-100"])},r(a.formattedKeyName),3),a.mergeInfo?(l(),d("div",{key:0,class:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",title:a.mergeInfo.tooltip},[e[76]||(e[76]=t("i",{class:"fas fa-layer-group mr-1 text-xs"},null,-1)),b(" "+r(a.mergeInfo.count),1)],8,Nl)):k("",!0)])]),t("td",Ol,[t("span",{class:$(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",p(V)(a.method)])},r(a.method||"N/A"),3)]),t("td",Rl,[t("span",{class:"max-w-32 truncate text-sm text-gray-900 dark:text-gray-100",title:a.path},r(a.path||"/"),9,Al)]),t("td",Il,[t("div",Hl,[t("span",{class:$(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",p(D)(a.status||a.statusCode)])},r(a.status||a.statusCode||"N/A"),3),a.statusCategory?(l(),d("span",{key:0,class:$(["inline-flex items-center gap-1 text-xs",{"text-green-600":a.statusCategory==="success","text-yellow-600":a.statusCategory==="redirect","text-red-600":a.statusCategory==="client_error"||a.statusCategory==="server_error","text-gray-600":a.statusCategory==="unknown"}]),title:`状态分类: ${a.statusCategory}`},[...e[78]||(e[78]=[t("i",{class:"fas fa-tag"},null,-1)])],10,Kl)):k("",!0)])]),t("td",Pl,[t("div",Ml,[t("span",Fl,r(a.duration||a.responseTime?`${a.duration||a.responseTime}ms`:"N/A"),1),a.performanceLevel==="slow"||a.performanceLevel==="very_slow"?(l(),d("i",{key:0,class:$(["fas fa-exclamation-triangle text-xs",{"text-yellow-500":a.performanceLevel==="slow","text-red-500":a.performanceLevel==="very_slow"}]),title:`性能等级: ${a.performanceLevel}`},null,10,El)):a.performanceLevel==="fast"?(l(),d("i",Ul)):k("",!0)])]),t("td",Vl,[t("div",zl,[t("div",Jl,[e[79]||(e[79]=t("i",{class:"fas fa-coins text-xs"},null,-1)),t("span",null,r(Ot(a)),1),(Y=a.tokenSummary)!=null&&Y.efficiency&&a.tokenSummary.efficiency>0?(l(),d("span",{key:0,class:"text-xs text-gray-500",title:`Token使用效率: ${a.tokenSummary.efficiency}%`}," ("+r(a.tokenSummary.efficiency)+"%) ",9,Wl)):k("",!0)]),At(a)>0?(l(),d("div",Gl,[e[80]||(e[80]=t("i",{class:"fas fa-memory text-xs"},null,-1)),t("span",Ql,"缓存: "+r(At(a)),1),((ne=a.tokenSummary)==null?void 0:ne.cacheCreateTokens)>0||((le=a.tokenSummary)==null?void 0:le.cacheReadTokens)>0?(l(),d("span",{key:0,class:"text-xs text-gray-500",title:`缓存创建: ${((de=a.tokenSummary)==null?void 0:de.cacheCreateTokens)||0}, 缓存读取: ${((ie=a.tokenSummary)==null?void 0:ie.cacheReadTokens)||0}`}," (C:"+r(((ue=a.tokenSummary)==null?void 0:ue.cacheCreateTokens)||0)+" R:"+r(((ce=a.tokenSummary)==null?void 0:ce.cacheReadTokens)||0)+") ",9,Yl)):k("",!0)])):k("",!0),a.dataCompleteness&&a.dataCompleteness.completenessScore?(l(),d("div",Zl,[t("i",{class:$(["fas text-xs",{"fa-check-circle text-green-500":parseInt(a.dataCompleteness.completenessScore)>=80,"fa-exclamation-triangle text-yellow-500":parseInt(a.dataCompleteness.completenessScore)>=50,"fa-times-circle text-red-500":parseInt(a.dataCompleteness.completenessScore)<50}]),title:`数据完整性: ${a.dataCompleteness.completenessScore}%`},null,10,Xl),t("span",td,r(a.dataCompleteness.completenessScore)+"%",1)])):k("",!0)])]),t("td",ed,[t("div",sd,[t("div",ad,[G(a)>0?(l(),d("span",rd," $"+r(Rt(G(a))),1)):(l(),d("span",od,"-"))]),a.costDetails&&(a.costDetails.costPerToken||a.costDetails.currency)?(l(),d("div",{key:0,class:"text-xs text-gray-500",title:`单价: $${a.costDetails.costPerToken||"N/A"}/token, 货币: ${a.costDetails.currency||"USD"}`},[e[81]||(e[81]=t("i",{class:"fas fa-info-circle"},null,-1)),b(" "+r(a.costDetails.currency||"USD")+" ",1),a.costDetails.costPerToken?(l(),d("span",ld," @$"+r((a.costDetails.costPerToken*1e3).toFixed(6))+"/1k ",1)):k("",!0)],8,nd)):k("",!0),G(a)>0&&((xe=a.tokenSummary)!=null&&xe.totalTokens)?(l(),d("div",{key:1,class:$(["text-xs",{"text-green-600":G(a)/a.tokenSummary.totalTokens*1e3<.01,"text-yellow-600":G(a)/a.tokenSummary.totalTokens*1e3>=.01&&G(a)/a.tokenSummary.totalTokens*1e3<.05,"text-red-600":G(a)/a.tokenSummary.totalTokens*1e3>=.05}]),title:`成本效率: $${(G(a)/a.tokenSummary.totalTokens*1e3).toFixed(4)}/1k tokens`},[e[82]||(e[82]=t("i",{class:"fas fa-chart-line"},null,-1)),b(" $"+r((G(a)/a.tokenSummary.totalTokens*1e3).toFixed(4))+"/1k ",1)],10,dd)):k("",!0)])]),t("td",id,[t("span",ud,r(a.ipAddress||"N/A"),1)]),t("td",cd,[t("button",{"aria-label":`查看日志详情: ${a.formattedKeyName||"Unknown"} ${a.method} ${a.path}`,class:"rounded p-1 text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-800 dark:text-blue-400 dark:hover:bg-blue-900/20 dark:hover:text-blue-300",onClick:b0=>Ft(a)},[...e[83]||(e[83]=[t("i",{class:"fas fa-eye"},null,-1)])],8,xd)])],2)}),128))])])])):(l(),d("div",gd,[(l(!0),d(at,null,ot(bt.value,a=>(l(),d("div",{key:a.logId||a.timestamp,class:$(["p-4 transition-colors hover:bg-gray-50 dark:hover:bg-gray-800",{"animate-pulse bg-green-50 dark:bg-green-900/20":a._isNew}])},[t("div",yd,[t("div",md,[t("div",fd,[t("div",bd,[t("span",pd,r(new Date(a.timestamp).toLocaleString("zh-CN").split(" ")[1]),1),t("div",vd,[e[85]||(e[85]=t("div",{class:"h-2 w-2 rounded-full bg-green-500"},null,-1)),t("span",{class:$(["text-sm",a.formattedKeyName&&a.formattedKeyName.includes("(已删除)")?"text-gray-500 dark:text-gray-400":"text-gray-600 dark:text-gray-400"])},r(a.formattedKeyName),3),a.mergeInfo?(l(),d("div",{key:0,class:"inline-flex items-center rounded-full bg-blue-100 px-1.5 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",title:a.mergeInfo.tooltip},[e[84]||(e[84]=t("i",{class:"fas fa-layer-group mr-0.5 text-xs"},null,-1)),b(" "+r(a.mergeInfo.count),1)],8,kd)):k("",!0)])]),t("button",{"aria-label":"查看详情",class:"rounded p-2 text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-800 dark:text-blue-400 dark:hover:bg-blue-900/20 dark:hover:text-blue-300",onClick:Y=>Ft(a)},[...e[86]||(e[86]=[t("i",{class:"fas fa-eye"},null,-1)])],8,hd)]),t("div",$d,[t("span",{class:$(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",p(V)(a.method)])},r(a.method||"N/A"),3),t("span",wd,r(a.path||"/"),1)]),t("div",_d,[t("div",Cd,[t("span",{class:$(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",p(D)(a.statusCode)])},r(a.statusCode||"N/A"),3),t("span",Td," ⏱️ "+r(a.responseTime?`${a.responseTime}ms`:"N/A"),1)]),t("div",Dd,[t("div",Sd,[e[87]||(e[87]=t("i",{class:"fas fa-coins"},null,-1)),t("span",null,r(Ot(a)),1)]),G(a)>0?(l(),d("div",jd," $"+r(Rt(G(a))),1)):k("",!0)])]),t("div",Bd," 🌐 "+r(a.ipAddress||"N/A"),1)])])],2))),128))])),(((tt=p(_))==null?void 0:tt.totalPages)||0)>1?(l(),d("div",qd,[t("div",Ld,[t("button",{class:"btn btn-secondary btn-sm",disabled:((($t=p(_))==null?void 0:$t.page)||1)<=1,onClick:e[19]||(e[19]=a=>{var Y;return Mt((((Y=p(_))==null?void 0:Y.page)||1)-1)})},[...e[88]||(e[88]=[t("i",{class:"fas fa-chevron-left"},null,-1)])],8,Nd),t("span",Od," 第 "+r(((Wt=p(_))==null?void 0:Wt.page)||1)+" 页，共 "+r(((Gt=p(_))==null?void 0:Gt.totalPages)||1)+" 页 ",1),t("button",{class:"btn btn-secondary btn-sm",disabled:(((Qt=p(_))==null?void 0:Qt.page)||1)>=(((Yt=p(_))==null?void 0:Yt.totalPages)||1),onClick:e[20]||(e[20]=a=>{var Y;return Mt((((Y=p(_))==null?void 0:Y.page)||1)+1)})},[...e[89]||(e[89]=[t("i",{class:"fas fa-chevron-right"},null,-1)])],8,Rd)])])):k("",!0)])),(l(),Se(je,{to:"body"},[v.value?(l(),d("div",Ad,[t("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm",onClick:_t}),t("div",Id,[t("div",Hd,[t("div",Kd,[e[91]||(e[91]=t("div",{class:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600"},[t("i",{class:"fas fa-file-alt text-white"})],-1)),t("div",null,[e[90]||(e[90]=t("h3",{class:"text-xl font-bold text-gray-900 dark:text-gray-100"},"日志详情",-1)),t("p",Pd,r(v.value.formattedKeyName||ut(v.value.keyId)||"Unknown"),1)])]),t("button",{class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",onClick:_t},[...e[92]||(e[92]=[t("i",{class:"fas fa-times text-xl"},null,-1)])])]),t("div",Md,[t("nav",Fd,[(l(!0),d(at,null,ot(me.value,a=>(l(),d("button",{key:a.id,class:$([et.value===a.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300","flex items-center gap-2 whitespace-nowrap border-b-2 px-1 py-2 text-sm font-medium"]),onClick:Y=>et.value=a.id},[t("i",{class:$(a.icon)},null,2),b(" "+r(a.name)+" ",1),a.badge&&Et(a.id)?(l(),d("span",Ud,r(Et(a.id)),1)):k("",!0)],10,Ed))),128))])]),t("div",Vd,[et.value==="overview"?(l(),d("div",zd,[wt(Xs,{log:v.value},null,8,["log"])])):k("",!0),et.value==="tokens"?(l(),d("div",Jd,[wt(er,{"cost-details":v.value.costDetails||{},"token-details":v.value.tokenDetails||{}},null,8,["cost-details","token-details"])])):k("",!0),et.value==="headers"?(l(),d("div",Wd,[wt(ro,{"request-headers":v.value.requestHeaders||{},"response-headers":v.value.responseHeaders||{}},null,8,["request-headers","response-headers"])])):k("",!0),et.value==="content"?(l(),d("div",Gd,[wt(un,{"request-body":((Zt=v.value.request)==null?void 0:Zt.body)||v.value.requestBody,"response-body":((Xt=v.value.response)==null?void 0:Xt.body)||v.value.responseBody},null,8,["request-body","response-body"])])):k("",!0)]),t("div",Qd,[t("div",Yd,[t("div",Zd,[e[93]||(e[93]=t("i",{class:"fas fa-clock mr-1"},null,-1)),b(" "+r(p(n)(v.value).timestamp),1)]),t("div",Xd,[e[94]||(e[94]=t("i",{class:"fas fa-tachometer-alt mr-1"},null,-1)),b(" "+r(p(n)(v.value).duration),1)])]),t("div",t0,[t("button",{class:"btn btn-secondary px-4 py-2 text-sm",disabled:p(q),type:"button",onClick:_e},[t("i",{class:$(["fas fa-download mr-2",{"animate-spin":p(q)}])},null,2),e[95]||(e[95]=b(" 导出 ",-1))],8,e0),t("button",{class:"btn btn-primary px-4 py-2 text-sm",type:"button",onClick:_t}," 关闭 ")])])])])):k("",!0)])),ft.value?(l(),d("div",{key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e[22]||(e[22]=Be(a=>ft.value=!1,["self"]))},[t("div",s0,[t("div",a0,[e[97]||(e[97]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"错误详情",-1)),t("button",{class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:e[21]||(e[21]=a=>ft.value=!1)},[...e[96]||(e[96]=[t("i",{class:"fas fa-times text-xl"},null,-1)])])]),t("div",r0,[t("div",o0,[t("div",null,[e[98]||(e[98]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"错误类型",-1)),t("p",n0,r(((te=I.value)==null?void 0:te.code)||"未知错误"),1)]),t("div",null,[e[99]||(e[99]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"错误信息",-1)),t("p",l0,r(((ee=I.value)==null?void 0:ee.message)||"无详细信息"),1)]),(se=I.value)!=null&&se.status?(l(),d("div",d0,[e[100]||(e[100]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"状态码",-1)),t("p",i0,r(I.value.status),1)])):k("",!0),t("div",null,[e[101]||(e[101]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"重试次数",-1)),t("p",u0,r(Bt.value),1)]),t("div",null,[e[106]||(e[106]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"建议操作",-1)),t("div",c0,[((ae=I.value)==null?void 0:ae.code)==="NETWORK_ERROR"?(l(),d("p",x0,[...e[102]||(e[102]=[b(" • 检查网络连接是否正常",-1),t("br",null,null,-1),b(" • 检查VPN或代理设置",-1),t("br",null,null,-1),b(" • 尝试刷新页面 ",-1)])])):((re=I.value)==null?void 0:re.status)===401?(l(),d("p",g0,[...e[103]||(e[103]=[b(" • 重新登录系统",-1),t("br",null,null,-1),b(" • 检查登录凭据是否过期 ",-1)])])):((oe=I.value)==null?void 0:oe.status)>=500?(l(),d("p",y0,[...e[104]||(e[104]=[b(" • 稍后再试",-1),t("br",null,null,-1),b(" • 如问题持续，请联系技术支持 ",-1)])])):(l(),d("p",m0,[...e[105]||(e[105]=[b(" • 检查网络连接",-1),t("br",null,null,-1),b(" • 刷新页面后重试 ",-1)])]))])])])])])])):k("",!0)])}}},C0=mt(f0,[["__scopeId","data-v-be112487"]]);export{C0 as default};
