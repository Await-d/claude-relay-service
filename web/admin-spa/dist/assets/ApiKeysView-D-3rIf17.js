import{a as mt,E as Et}from"./element-plus-C-1FTG0y.js";import{aT as pt,r as D,c as F,q as Me,V as Ut,o as we,x as o,y as r,z as e,I as le,C as G,P as g,R as ie,J as Pt,L as w,B as Le,K as M,aq as Z,Q as Y,ac as N,T as Ot,a5 as fe,D as Gt,_ as Te,Y as me,an as ae,O as T,aa as Ee,aW as ge,al as ve}from"./vue-vendor-CcFZMz-v.js";import{s as q}from"./toast-BvwA7Mwb.js";import{b as z,_ as xe}from"./index-BZqqNmWF.js";import{_ as Be}from"./WindowCountdown-DEPTPq8A.js";import{C as xt}from"./CustomDropdown-CSdbJhX-.js";import{b as Ke,P as qt}from"./vendor-B90ziCBp.js";const We=pt("clients",{state:()=>({supportedClients:[],loading:!1,error:null}),actions:{async loadSupportedClients(){if(this.supportedClients.length>0)return this.supportedClients;this.loading=!0,this.error=null;try{const _=await z.get("/admin/supported-clients");return _.success?this.supportedClients=_.data||[]:(this.error=_.message||"加载支持的客户端失败",console.error("Failed to load supported clients:",this.error)),this.supportedClients}catch(_){return this.error=_.message||"加载支持的客户端失败",console.error("Error loading supported clients:",_),[]}finally{this.loading=!1}}}}),Fe=pt("apiKeys",()=>{const _=D([]),Q=D(!1),x=D(null),K=D("all"),V=D(""),$=D("asc"),k=async()=>{Q.value=!0,x.value=null;try{const j=await z.get("/admin/api-keys");if(j.success)_.value=j.data||[];else throw new Error(j.message||"获取API Keys失败")}catch(j){throw x.value=j.message,j}finally{Q.value=!1}};return{apiKeys:_,loading:Q,error:x,statsTimeRange:K,sortBy:V,sortOrder:$,fetchApiKeys:k,createApiKey:async j=>{Q.value=!0,x.value=null;try{const L=await z.post("/admin/api-keys",j);if(L.success)return await k(),L.data;throw new Error(L.message||"创建API Key失败")}catch(L){throw x.value=L.message,L}finally{Q.value=!1}},updateApiKey:async(j,L)=>{Q.value=!0,x.value=null;try{const y=await z.put(`/admin/api-keys/${j}`,L);if(y.success)return await k(),y;throw new Error(y.message||"更新API Key失败")}catch(y){throw x.value=y.message,y}finally{Q.value=!1}},toggleApiKey:async j=>{Q.value=!0,x.value=null;try{const L=await z.put(`/admin/api-keys/${j}/toggle`);if(L.success)return await k(),L;throw new Error(L.message||"切换状态失败")}catch(L){throw x.value=L.message,L}finally{Q.value=!1}},renewApiKey:async(j,L)=>{Q.value=!0,x.value=null;try{const y=await z.put(`/admin/api-keys/${j}`,L);if(y.success)return await k(),y;throw new Error(y.message||"续期失败")}catch(y){throw x.value=y.message,y}finally{Q.value=!1}},deleteApiKey:async j=>{Q.value=!0,x.value=null;try{const L=await z.delete(`/admin/api-keys/${j}`);if(L.success)return await k(),L;throw new Error(L.message||"删除失败")}catch(L){throw x.value=L.message,L}finally{Q.value=!1}},fetchApiKeyStats:async(j,L="all")=>{try{const y=await z.get(`/admin/api-keys/${j}/stats`,{params:{timeRange:L}});if(y.success)return y.stats;throw new Error(y.message||"获取统计失败")}catch(y){return console.error("获取API Key统计失败:",y),null}},fetchTags:async()=>{try{const j=await z.get("/admin/api-keys/tags");if(j.success)return j.data||[];throw new Error(j.message||"获取标签失败")}catch(j){return console.error("获取标签失败:",j),[]}},sortApiKeys:j=>{V.value===j?$.value=$.value==="asc"?"desc":"asc":(V.value=j,$.value="asc")},reset:()=>{_.value=[],Q.value=!1,x.value=null,K.value="all",V.value="",$.value="asc"}}}),Bt={class:"flex-shrink-0 border-b border-gray-200 p-3 dark:border-gray-600"},Wt={class:"relative"},Ft={class:"custom-scrollbar flex-1 overflow-y-auto"},zt={class:"text-gray-700 dark:text-gray-300"},Yt={key:0},Ht=["onClick"],Nt={class:"flex items-center justify-between"},Qt={class:"text-gray-700 dark:text-gray-300"},Jt={class:"text-xs text-gray-500 dark:text-gray-400"},Xt={key:1},Zt={class:"bg-gray-50 px-4 py-2 text-xs font-semibold text-gray-500 dark:bg-gray-700 dark:text-gray-400"},es=["onClick"],ts={class:"flex items-center justify-between"},ss={class:"text-gray-700 dark:text-gray-300"},as={class:"text-xs text-gray-400 dark:text-gray-500"},rs={key:2},ls=["onClick"],os={class:"flex items-center justify-between"},ns={class:"text-gray-700 dark:text-gray-300"},is={class:"text-xs text-gray-400 dark:text-gray-500"},ds={key:3,class:"px-4 py-8 text-center text-gray-500 dark:text-gray-400"},us={__name:"AccountSelector",props:{modelValue:{type:String,default:""},platform:{type:String,required:!0,validator:_=>["claude","gemini"].includes(_)},accounts:{type:Array,default:()=>[]},groups:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:"请选择账号"},defaultOptionText:{type:String,default:"使用共享账号池"}},emits:["update:modelValue"],setup(_,{emit:Q}){const x=_,K=Q,V=D(!1),$=D(""),k=D(null),U=D(null),S=D({}),W=D(null),R=D(""),h=F(()=>{if(!x.modelValue)return x.defaultOptionText;if(x.modelValue.startsWith("group:")){const p=x.modelValue.substring(6),C=x.groups.find(X=>X.id===p);return C?`${C.name} (${C.memberCount||0} 个成员)`:""}if(x.modelValue.startsWith("console:")){const p=x.modelValue.substring(8),C=x.accounts.find(X=>X.id===p&&X.platform==="claude-console");return C?`${C.name} (${f(C)})`:""}const l=x.accounts.find(p=>p.id===x.modelValue);return l?`${l.name} (${f(l)})`:""}),f=l=>{if(!l)return"未知";if(l.isActive===!1)switch(l.status){case"unauthorized":return"未授权";case"error":return"Token错误";case"created":return"待验证";case"rate_limited":return"限流中";default:return"异常"}return"正常"},m=F(()=>[...x.accounts].sort((l,p)=>{const C=new Date(l.createdAt||0);return new Date(p.createdAt||0)-C})),a=F(()=>{if(!$.value)return x.groups;const l=$.value.toLowerCase();return x.groups.filter(p=>p.name.toLowerCase().includes(l))}),d=F(()=>{let l=m.value.filter(p=>p.accountType==="dedicated"&&(x.platform==="claude"?p.platform==="claude-oauth":p.platform!=="claude-console"));if($.value){const p=$.value.toLowerCase();l=l.filter(C=>C.name.toLowerCase().includes(p))}return l}),j=F(()=>{if(x.platform!=="claude")return[];let l=m.value.filter(p=>p.accountType==="dedicated"&&p.platform==="claude-console");if($.value){const p=$.value.toLowerCase();l=l.filter(C=>C.name.toLowerCase().includes(p))}return l}),L=F(()=>a.value.length>0||d.value.length>0||j.value.length>0),y=l=>{if(!l)return"";const p=new Date(l),X=(new Date-p)/(1e3*60*60);return X<24?"今天创建":X<48?"昨天创建":X<168?`${Math.floor(X/24)} 天前`:p.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"})},b=()=>{if(!V.value||!U.value||!W.value)return;const l=W.value;if(!l)return;const p=l.getBoundingClientRect(),C=window.innerHeight,X=window.innerWidth,P=C-p.bottom,i=p.top,v=8,ee=P-v,J=i-v;let se=!1,ce=ee;R.value==="above"&&J>=150?(se=!0,ce=J):R.value==="below"&&ee>=150?(se=!1,ce=ee):J>ee&&ee<200&&(se=!0,ce=J),R.value=se?"above":"below";let pe=p.left;const ke=p.width;pe+ke>X-v&&(pe=X-ke-v),pe<v&&(pe=v),S.value={position:"fixed",left:`${pe}px`,width:`${p.width}px`,maxHeight:`${Math.min(ce,400)}px`,...se?{bottom:`${C-p.top}px`}:{top:`${p.bottom}px`}}},c=()=>{if(!V.value&&W.value){const l=W.value.getBoundingClientRect(),C=window.innerHeight-l.bottom,X=8;S.value={position:"fixed",left:`${l.left}px`,width:`${l.width}px`,maxHeight:`${Math.min(C-X,400)}px`,top:`${l.bottom}px`}}V.value=!V.value,V.value&&Gt(()=>{var l;b(),(l=k.value)==null||l.focus()})},n=l=>{K("update:modelValue",l||""),V.value=!1,$.value=""},I=()=>{},oe=()=>{var l;$.value="",(l=k.value)==null||l.focus()},de=l=>{var p,C;!((p=W.value)!=null&&p.contains(l.target))&&!((C=U.value)!=null&&C.contains(l.target))&&(V.value=!1)},O=()=>{V.value&&b()};return Me(()=>{document.addEventListener("click",de),window.addEventListener("scroll",O,!0),window.addEventListener("resize",b)}),Ut(()=>{document.removeEventListener("click",de),window.removeEventListener("scroll",O,!0),window.removeEventListener("resize",b)}),we(V,l=>{l||($.value="",R.value="")}),(l,p)=>(r(),o("div",{ref_key:"triggerRef",ref:W,class:"relative"},[e("div",{class:G(["form-input flex w-full cursor-pointer items-center justify-between dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",{"opacity-50":_.disabled}]),onClick:p[0]||(p[0]=C=>!_.disabled&&c())},[e("span",{class:G(_.modelValue?"text-gray-900 dark:text-gray-200":"text-gray-500 dark:text-gray-400")},g(h.value),3),e("i",{class:G(["fas fa-chevron-down text-gray-400 transition-transform duration-200 dark:text-gray-500",{"rotate-180":V.value}])},null,2)],2),(r(),le(fe,{to:"body"},[ie(Ot,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:Pt(()=>[V.value?(r(),o("div",{key:0,ref_key:"dropdownRef",ref:U,class:"absolute z-50 flex flex-col rounded-lg border border-gray-200 bg-white shadow-lg dark:border-gray-600 dark:bg-gray-800",style:Le(S.value)},[e("div",Bt,[e("div",Wt,[M(e("input",{ref_key:"searchInput",ref:k,"onUpdate:modelValue":p[1]||(p[1]=C=>$.value=C),class:"form-input w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"搜索账号名称...",style:{"padding-left":"40px","padding-right":"36px"},type:"text",onInput:I},null,544),[[Z,$.value]]),p[4]||(p[4]=e("i",{class:"fas fa-search pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-400 dark:text-gray-500"},null,-1)),$.value?(r(),o("button",{key:0,class:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400",type:"button",onClick:oe},[...p[3]||(p[3]=[e("i",{class:"fas fa-times text-sm"},null,-1)])])):w("",!0)])]),e("div",Ft,[e("div",{class:G(["cursor-pointer px-4 py-2 transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",{"bg-blue-50 dark:bg-blue-900/20":!_.modelValue}]),onClick:p[2]||(p[2]=C=>n(null))},[e("span",zt,g(_.defaultOptionText),1)],2),a.value.length>0?(r(),o("div",Yt,[p[5]||(p[5]=e("div",{class:"bg-gray-50 px-4 py-2 text-xs font-semibold text-gray-500 dark:bg-gray-700 dark:text-gray-400"}," 调度分组 ",-1)),(r(!0),o(Y,null,N(a.value,C=>(r(),o("div",{key:`group:${C.id}`,class:G(["cursor-pointer px-4 py-2 transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",{"bg-blue-50 dark:bg-blue-900/20":_.modelValue===`group:${C.id}`}]),onClick:X=>n(`group:${C.id}`)},[e("div",Nt,[e("span",Qt,g(C.name),1),e("span",Jt,g(C.memberCount||0)+" 个成员",1)])],10,Ht))),128))])):w("",!0),d.value.length>0?(r(),o("div",Xt,[e("div",Zt,g(_.platform==="claude"?"Claude OAuth 专属账号":"OAuth 专属账号"),1),(r(!0),o(Y,null,N(d.value,C=>(r(),o("div",{key:C.id,class:G(["cursor-pointer px-4 py-2 transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",{"bg-blue-50 dark:bg-blue-900/20":_.modelValue===C.id}]),onClick:X=>n(C.id)},[e("div",ts,[e("div",null,[e("span",ss,g(C.name),1),e("span",{class:G(["ml-2 rounded-full px-2 py-0.5 text-xs",C.isActive?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":C.status==="unauthorized"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"])},g(f(C)),3)]),e("span",as,g(y(C.createdAt)),1)])],10,es))),128))])):w("",!0),_.platform==="claude"&&j.value.length>0?(r(),o("div",rs,[p[6]||(p[6]=e("div",{class:"bg-gray-50 px-4 py-2 text-xs font-semibold text-gray-500 dark:bg-gray-700 dark:text-gray-400"}," Claude Console 专属账号 ",-1)),(r(!0),o(Y,null,N(j.value,C=>(r(),o("div",{key:C.id,class:G(["cursor-pointer px-4 py-2 transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",{"bg-blue-50 dark:bg-blue-900/20":_.modelValue===`console:${C.id}`}]),onClick:X=>n(`console:${C.id}`)},[e("div",os,[e("div",null,[e("span",ns,g(C.name),1),e("span",{class:G(["ml-2 rounded-full px-2 py-0.5 text-xs",C.isActive?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":C.status==="unauthorized"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"])},g(f(C)),3)]),e("span",is,g(y(C.createdAt)),1)])],10,ls))),128))])):w("",!0),$.value&&!L.value?(r(),o("div",ds,[...p[7]||(p[7]=[e("i",{class:"fas fa-search mb-2 text-2xl"},null,-1),e("p",{class:"text-sm"},"没有找到匹配的账号",-1)])])):w("",!0)])],4)):w("",!0)]),_:1})]))],512))}},Ie=xe(us,[["__scopeId","data-v-7e9dcf0d"]]),cs={class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},gs={class:"modal-content mx-auto flex max-h-[90vh] w-full max-w-4xl flex-col p-4 sm:p-6"},ms={class:"mb-4 flex items-center justify-between"},xs={class:"rounded-lg border border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-3 dark:border-blue-700 dark:from-blue-900/20 dark:to-indigo-900/20 sm:p-4"},ps={class:"flex items-center gap-3 sm:gap-4"},ys={class:"flex cursor-pointer items-center"},bs={class:"flex cursor-pointer items-center"},fs={key:0,class:"mt-3"},vs={class:"flex items-center gap-4"},ks={class:"flex-1"},ws={class:"flex items-center gap-2"},hs={class:"mt-2 flex items-start text-xs text-amber-600 dark:text-amber-400"},$s=["placeholder"],As={key:0,class:"mt-1 text-xs text-red-500 dark:text-red-400"},Cs={class:"space-y-4"},Is={key:0},Ks={class:"flex flex-wrap gap-2"},_s=["onClick"],Ds={key:1},Ls={class:"flex flex-wrap gap-2"},Ms=["onClick"],Ts={class:"flex gap-2"},Ss=["onKeypress"],js={class:"rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-700 dark:bg-blue-900/20"},Vs={class:"space-y-2"},Rs={class:"grid grid-cols-1 gap-2 lg:grid-cols-3"},Es={class:"rounded-lg border border-green-200 bg-gradient-to-br from-green-50 to-emerald-50 p-3 dark:border-green-700 dark:from-green-900/20 dark:to-emerald-900/20 sm:p-4"},Us={class:"space-y-3"},Ps={class:"grid grid-cols-2 gap-2 sm:grid-cols-3 lg:grid-cols-6"},Os=["onClick"],Gs={class:"flex items-center gap-1"},qs={class:"text-xs font-bold sm:text-sm"},Bs={key:0,class:"fas fa-check text-xs text-green-600 dark:text-green-400"},Ws={class:"text-xs text-gray-500 dark:text-gray-400"},Fs={class:"flex items-center gap-1"},zs={key:0,class:"fas fa-check text-xs text-blue-600 dark:text-blue-400"},Ys={class:"flex items-center gap-1"},Hs={key:0,class:"fas fa-check text-xs text-gray-600 dark:text-gray-400"},Ns={class:"relative"},Qs={key:0,class:"mt-3"},Js=["min"],Xs={key:1,class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},Zs={class:"flex gap-4"},ea={class:"flex cursor-pointer items-center"},ta={class:"flex cursor-pointer items-center"},sa={class:"flex cursor-pointer items-center"},aa={class:"flex cursor-pointer items-center"},ra={class:"mb-2 flex items-center justify-between"},la=["disabled"],oa={class:"grid grid-cols-1 gap-3"},na={class:"mb-2 flex items-center"},ia={key:0,class:"space-y-3"},da={class:"mb-3 flex min-h-[32px] flex-wrap gap-2 rounded-lg border border-gray-200 bg-gray-50 p-2"},ua=["onClick"],ca={key:0,class:"text-sm text-gray-400"},ga={class:"space-y-3"},ma={class:"flex flex-wrap gap-2"},xa=["onClick"],pa={key:0,class:"text-sm italic text-gray-400"},ya={class:"flex gap-2"},ba=["onKeydown"],fa={class:"mb-2 flex items-center"},va={key:0,class:"rounded-lg border border-green-200 bg-green-50 p-3 dark:border-green-700 dark:bg-green-900/20"},ka={class:"space-y-1"},wa=["id","value"],ha=["for"],$a={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Aa={class:"block text-xs text-gray-500 dark:text-gray-400"},Ca={class:"flex gap-3 pt-2"},Ia=["disabled"],Ka={key:0,class:"loading-spinner mr-2"},_a={key:1,class:"fas fa-plus mr-2"},Da={__name:"CreateApiKeyModal",props:{accounts:{type:Object,default:()=>({claude:[],gemini:[]})}},emits:["close","success","batch-success"],setup(_,{emit:Q}){const x=_,K=Q,V=We(),$=Fe(),k=D(!1),U=D(!1),S=D({claude:[],gemini:[],openai:[],bedrock:[],claudeGroups:[],geminiGroups:[],openaiGroups:[]}),W=D({name:""}),R=D(""),h=D([]),f=F(()=>h.value.filter(P=>!d.tags.includes(P))),m=D([]),a=D([{value:"10",label:"轻度使用"},{value:"50",label:"中度使用"},{value:"100",label:"重度使用"},{value:"200",label:"企业级"}]),d=Te({createType:"single",batchCount:10,name:"",description:"",tokenLimit:"",rateLimitWindow:"",rateLimitRequests:"",concurrencyLimit:"",dailyCostLimit:"",expireDuration:"",customExpireDate:"",expiresAt:null,permissions:"all",claudeAccountId:"",geminiAccountId:"",openaiAccountId:"",bedrockAccountId:"",enableModelRestriction:!1,restrictedModels:[],modelInput:"",enableClientRestriction:!1,allowedClients:[],tags:[]});Me(async()=>{m.value=await V.loadSupportedClients(),h.value=await $.fetchTags(),x.accounts&&(S.value={claude:x.accounts.claude||[],gemini:x.accounts.gemini||[],openai:x.accounts.openai||[],bedrock:x.accounts.bedrock||[],claudeGroups:x.accounts.claudeGroups||[],geminiGroups:x.accounts.geminiGroups||[],openaiGroups:x.accounts.openaiGroups||[]})});const j=async()=>{var P,i;U.value=!0;try{const[v,ee,J,se,ce,pe]=await Promise.all([z.get("/admin/claude-accounts"),z.get("/admin/claude-console-accounts"),z.get("/admin/gemini-accounts"),z.get("/admin/openai-accounts"),z.get("/admin/bedrock-accounts"),z.get("/admin/account-groups")]),ke=[];if(v.success&&((P=v.data)==null||P.forEach(re=>{ke.push({...re,platform:"claude-oauth",isDedicated:re.accountType==="dedicated"})})),ee.success&&((i=ee.data)==null||i.forEach(re=>{ke.push({...re,platform:"claude-console",isDedicated:re.accountType==="dedicated"})})),S.value.claude=ke,J.success&&(S.value.gemini=(J.data||[]).map(re=>({...re,isDedicated:re.accountType==="dedicated"}))),se.success&&(S.value.openai=(se.data||[]).map(re=>({...re,isDedicated:re.accountType==="dedicated"}))),ce.success&&(S.value.bedrock=(ce.data||[]).map(re=>({...re,isDedicated:re.accountType==="dedicated"}))),pe.success){const re=pe.data||[];S.value.claudeGroups=re.filter(he=>he.platform==="claude"),S.value.geminiGroups=re.filter(he=>he.platform==="gemini"),S.value.openaiGroups=re.filter(he=>he.platform==="openai")}q("账号列表已刷新","success")}catch{q("刷新账号列表失败","error")}finally{U.value=!1}},L=F(()=>{const P=new Date;return P.setMinutes(P.getMinutes()+1),P.toISOString().slice(0,16)}),y=()=>{if(!d.expireDuration){d.expiresAt=null;return}if(d.expireDuration==="custom")return;const P=new Date,v=d.expireDuration.match(/(\d+)([dhmy])/);if(v){const[,ee,J]=v,se=parseInt(ee);switch(J){case"d":P.setDate(P.getDate()+se);break;case"h":P.setHours(P.getHours()+se);break;case"m":P.setMonth(P.getMonth()+se);break;case"y":P.setFullYear(P.getFullYear()+se);break}d.expiresAt=P.toISOString()}},b=()=>{d.customExpireDate&&(d.expiresAt=new Date(d.customExpireDate).toISOString())},c=P=>new Date(P).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),n=()=>{d.modelInput&&!d.restrictedModels.includes(d.modelInput)&&(d.restrictedModels.push(d.modelInput),d.modelInput="")},I=P=>{d.restrictedModels.splice(P,1)},oe=D(["claude-opus-4-20250514","claude-opus-4-1-20250805"]),de=F(()=>oe.value.filter(P=>!d.restrictedModels.includes(P))),O=P=>{d.restrictedModels.includes(P)||d.restrictedModels.push(P)},l=()=>{if(R.value&&R.value.trim()){const P=R.value.trim();d.tags.includes(P)||d.tags.push(P),R.value=""}},p=P=>{d.tags.includes(P)||d.tags.push(P)},C=P=>{d.tags.splice(P,1)},X=async()=>{if(W.value.name="",!d.name||!d.name.trim()){W.value.name="请输入API Key名称";return}if(d.createType==="batch"&&(!d.batchCount||d.batchCount<2||d.batchCount>500)){q("批量创建数量必须在 2-500 之间","error");return}k.value=!0;try{const P={description:d.description||void 0,tokenLimit:d.tokenLimit!==""&&d.tokenLimit!==null?parseInt(d.tokenLimit):null,rateLimitWindow:d.rateLimitWindow!==""&&d.rateLimitWindow!==null?parseInt(d.rateLimitWindow):null,rateLimitRequests:d.rateLimitRequests!==""&&d.rateLimitRequests!==null?parseInt(d.rateLimitRequests):null,concurrencyLimit:d.concurrencyLimit!==""&&d.concurrencyLimit!==null?parseInt(d.concurrencyLimit):0,dailyCostLimit:d.dailyCostLimit!==""&&d.dailyCostLimit!==null?parseFloat(d.dailyCostLimit):0,expiresAt:d.expiresAt||void 0,permissions:d.permissions,tags:d.tags.length>0?d.tags:void 0,enableModelRestriction:d.enableModelRestriction,restrictedModels:d.restrictedModels,enableClientRestriction:d.enableClientRestriction,allowedClients:d.allowedClients};if(d.claudeAccountId&&(d.claudeAccountId.startsWith("console:")?(P.claudeConsoleAccountId=d.claudeAccountId.substring(8),delete P.claudeAccountId):(P.claudeAccountId=d.claudeAccountId,delete P.claudeConsoleAccountId)),d.geminiAccountId&&(P.geminiAccountId=d.geminiAccountId),d.openaiAccountId&&(P.openaiAccountId=d.openaiAccountId),d.bedrockAccountId&&(P.bedrockAccountId=d.bedrockAccountId),d.createType==="single"){const i={...P,name:d.name},v=await z.post("/admin/api-keys",i);v.success?(q("API Key 创建成功","success"),K("success",v.data),K("close")):q(v.message||"创建失败","error")}else{const i={...P,createType:"batch",baseName:d.name,count:d.batchCount},v=await z.post("/admin/api-keys/batch",i);v.success?(q(`成功创建 ${v.data.length} 个 API Key`,"success"),K("batch-success",v.data),K("close")):q(v.message||"批量创建失败","error")}}catch{q("创建失败","error")}finally{k.value=!1}};return(P,i)=>(r(),le(fe,{to:"body"},[e("div",cs,[e("div",gs,[e("div",ms,[i[31]||(i[31]=e("div",{class:"flex items-center gap-2 sm:gap-3"},[e("div",{class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 sm:h-10 sm:w-10 sm:rounded-xl"},[e("i",{class:"fas fa-key text-sm text-white sm:text-base"})]),e("h3",{class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"}," 创建新的 API Key ")],-1)),e("button",{class:"p-1 text-gray-400 transition-colors hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",onClick:i[0]||(i[0]=v=>P.$emit("close"))},[...i[30]||(i[30]=[e("i",{class:"fas fa-times text-lg sm:text-xl"},null,-1)])])]),e("form",{class:"modal-scroll-content custom-scrollbar flex-1 space-y-4",onSubmit:me(X,["prevent"])},[e("div",xs,[e("div",{class:G(["flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",d.createType==="batch"?"mb-3":""])},[i[34]||(i[34]=e("label",{class:"flex h-full items-center text-xs font-semibold text-gray-700 dark:text-gray-300 sm:text-sm"},"创建类型",-1)),e("div",ps,[e("label",ys,[M(e("input",{"onUpdate:modelValue":i[1]||(i[1]=v=>d.createType=v),class:"mr-1.5 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 sm:mr-2",type:"radio",value:"single"},null,512),[[ae,d.createType]]),i[32]||(i[32]=e("span",{class:"flex items-center text-xs text-gray-700 dark:text-gray-300 sm:text-sm"},[e("i",{class:"fas fa-key mr-1 text-xs"}),T(" 单个创建 ")],-1))]),e("label",bs,[M(e("input",{"onUpdate:modelValue":i[2]||(i[2]=v=>d.createType=v),class:"mr-1.5 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 sm:mr-2",type:"radio",value:"batch"},null,512),[[ae,d.createType]]),i[33]||(i[33]=e("span",{class:"flex items-center text-xs text-gray-700 dark:text-gray-300 sm:text-sm"},[e("i",{class:"fas fa-layer-group mr-1 text-xs"}),T(" 批量创建 ")],-1))])])],2),d.createType==="batch"?(r(),o("div",fs,[e("div",vs,[e("div",ks,[i[36]||(i[36]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600 dark:text-gray-400"},"创建数量",-1)),e("div",ws,[M(e("input",{"onUpdate:modelValue":i[3]||(i[3]=v=>d.batchCount=v),class:"form-input w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",max:"500",min:"2",placeholder:"输入数量 (2-500)",required:"",type:"number"},null,512),[[Z,d.batchCount,void 0,{number:!0}]]),i[35]||(i[35]=e("div",{class:"whitespace-nowrap text-xs text-gray-500 dark:text-gray-400"}," 最大支持 500 个 ",-1))])])]),e("p",hs,[i[37]||(i[37]=e("i",{class:"fas fa-info-circle mr-1 mt-0.5 flex-shrink-0"},null,-1)),e("span",null,"批量创建时，每个 Key 的名称会自动添加序号后缀，例如："+g(d.name||"MyKey")+"_1, "+g(d.name||"MyKey")+"_2 ...",1)])])):w("",!0)]),e("div",null,[i[38]||(i[38]=e("label",{class:"mb-1.5 block text-xs font-semibold text-gray-700 dark:text-gray-300 sm:mb-2 sm:text-sm"},[T("名称 "),e("span",{class:"text-red-500"},"*")],-1)),M(e("input",{"onUpdate:modelValue":i[4]||(i[4]=v=>d.name=v),class:G(["form-input w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":W.value.name}]),placeholder:d.createType==="batch"?"输入基础名称（将自动添加序号）":"为您的 API Key 取一个名称",required:"",type:"text",onInput:i[5]||(i[5]=v=>W.value.name="")},null,42,$s),[[Z,d.name]]),W.value.name?(r(),o("p",As,g(W.value.name),1)):w("",!0)]),e("div",null,[i[46]||(i[46]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"标签",-1)),e("div",Cs,[d.tags.length>0?(r(),o("div",Is,[i[40]||(i[40]=e("div",{class:"mb-2 text-xs font-medium text-gray-600 dark:text-gray-400"}," 已选择的标签: ",-1)),e("div",Ks,[(r(!0),o(Y,null,N(d.tags,(v,ee)=>(r(),o("span",{key:"selected-"+ee,class:"inline-flex items-center gap-1 rounded-full bg-blue-100 px-3 py-1 text-sm text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"},[T(g(v)+" ",1),e("button",{class:"ml-1 hover:text-blue-900 dark:hover:text-blue-300",type:"button",onClick:J=>C(ee)},[...i[39]||(i[39]=[e("i",{class:"fas fa-times text-xs"},null,-1)])],8,_s)]))),128))])])):w("",!0),f.value.length>0?(r(),o("div",Ds,[i[42]||(i[42]=e("div",{class:"mb-2 text-xs font-medium text-gray-600 dark:text-gray-400"}," 点击选择已有标签: ",-1)),e("div",Ls,[(r(!0),o(Y,null,N(f.value,v=>(r(),o("button",{key:"available-"+v,class:"inline-flex items-center gap-1 rounded-full bg-gray-100 px-3 py-1 text-sm text-gray-700 transition-colors hover:bg-blue-100 hover:text-blue-700 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-blue-900/30 dark:hover:text-blue-400",type:"button",onClick:ee=>p(v)},[i[41]||(i[41]=e("i",{class:"fas fa-tag text-xs text-gray-500 dark:text-gray-400"},null,-1)),T(" "+g(v),1)],8,Ms))),128))])])):w("",!0),e("div",null,[i[44]||(i[44]=e("div",{class:"mb-2 text-xs font-medium text-gray-600 dark:text-gray-400"}," 创建新标签: ",-1)),e("div",Ts,[M(e("input",{"onUpdate:modelValue":i[6]||(i[6]=v=>R.value=v),class:"form-input flex-1 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"输入新标签名称",type:"text",onKeypress:Ee(me(l,["prevent"]),["enter"])},null,40,Ss),[[Z,R.value]]),e("button",{class:"rounded-lg bg-green-500 px-4 py-2 text-white transition-colors hover:bg-green-600",type:"button",onClick:l},[...i[43]||(i[43]=[e("i",{class:"fas fa-plus"},null,-1)])])])]),i[45]||(i[45]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," 用于标记不同团队或用途，方便筛选管理 ",-1))])]),e("div",js,[i[54]||(i[54]=e("div",{class:"mb-2 flex items-center gap-2"},[e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded bg-blue-500"},[e("i",{class:"fas fa-tachometer-alt text-xs text-white"})]),e("h4",{class:"text-sm font-semibold text-gray-800 dark:text-gray-200"}," 速率限制设置 (可选) ")],-1)),e("div",Vs,[e("div",Rs,[e("div",null,[i[47]||(i[47]=e("label",{class:"mb-1 block text-xs font-medium text-gray-700 dark:text-gray-300"},"时间窗口 (分钟)",-1)),M(e("input",{"onUpdate:modelValue":i[7]||(i[7]=v=>d.rateLimitWindow=v),class:"form-input w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",min:"1",placeholder:"无限制",type:"number"},null,512),[[Z,d.rateLimitWindow]]),i[48]||(i[48]=e("p",{class:"ml-2 mt-0.5 text-xs text-gray-500 dark:text-gray-400"},"时间段单位",-1))]),e("div",null,[i[49]||(i[49]=e("label",{class:"mb-1 block text-xs font-medium text-gray-700 dark:text-gray-300"},"请求次数限制",-1)),M(e("input",{"onUpdate:modelValue":i[8]||(i[8]=v=>d.rateLimitRequests=v),class:"form-input w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",min:"1",placeholder:"无限制",type:"number"},null,512),[[Z,d.rateLimitRequests]]),i[50]||(i[50]=e("p",{class:"ml-2 mt-0.5 text-xs text-gray-500 dark:text-gray-400"},"窗口内最大请求",-1))]),e("div",null,[i[51]||(i[51]=e("label",{class:"mb-1 block text-xs font-medium text-gray-700 dark:text-gray-300"},"Token 限制",-1)),M(e("input",{"onUpdate:modelValue":i[9]||(i[9]=v=>d.tokenLimit=v),class:"form-input w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"无限制",type:"number"},null,512),[[Z,d.tokenLimit]]),i[52]||(i[52]=e("p",{class:"ml-2 mt-0.5 text-xs text-gray-500 dark:text-gray-400"}," 窗口内最大Token ",-1))])]),i[53]||(i[53]=e("div",{class:"rounded-lg bg-blue-100 p-2 dark:bg-blue-900/30"},[e("h5",{class:"mb-1 text-xs font-semibold text-blue-800 dark:text-blue-400"}," 💡 使用示例 "),e("div",{class:"space-y-0.5 text-xs text-blue-700 dark:text-blue-300"},[e("div",null,[e("strong",null,"示例1:"),T(" 时间窗口=60，请求次数=1000 → 每60分钟最多1000次请求 ")]),e("div",null,[e("strong",null,"示例2:"),T(" 时间窗口=1，Token=10000 → 每分钟最多10,000个Token ")]),e("div",null,[e("strong",null,"示例3:"),T(" 窗口=30，请求=50，Token=100000 → 每30分钟50次请求且不超10万Token ")])])],-1))])]),e("div",Es,[i[63]||(i[63]=e("div",{class:"mb-3 flex items-center gap-2"},[e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded bg-green-500"},[e("i",{class:"fas fa-dollar-sign text-xs text-white"})]),e("h4",{class:"text-sm font-semibold text-gray-800 dark:text-gray-200"}," 每日费用限制 (可选) ")],-1)),e("div",Us,[e("div",null,[i[59]||(i[59]=e("label",{class:"mb-2 block text-xs font-medium text-gray-600 dark:text-gray-400"},"选择预设限额",-1)),e("div",Ps,[(r(!0),o(Y,null,N(a.value,v=>(r(),o("button",{key:v.value,class:G(["group relative flex flex-col items-center justify-center rounded-lg border-2 p-2 text-center transition-all duration-200 hover:shadow-md sm:p-3",d.dailyCostLimit==v.value?"border-green-500 bg-green-100 text-green-800 dark:border-green-400 dark:bg-green-900/30 dark:text-green-300":"border-gray-200 bg-white hover:border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:hover:border-gray-500"]),type:"button",onClick:ee=>d.dailyCostLimit=v.value},[e("div",Gs,[e("span",qs,"$"+g(v.value),1),d.dailyCostLimit==v.value?(r(),o("i",Bs)):w("",!0)]),e("span",Ws,g(v.label),1)],10,Os))),128)),e("button",{class:G(["group relative flex flex-col items-center justify-center rounded-lg border-2 p-2 text-center transition-all duration-200 hover:shadow-md sm:p-3",!a.value.find(v=>v.value==d.dailyCostLimit)&&d.dailyCostLimit&&d.dailyCostLimit!="0"?"border-blue-500 bg-blue-100 text-blue-800 dark:border-blue-400 dark:bg-blue-900/30 dark:text-blue-300":"border-gray-200 bg-white hover:border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:hover:border-gray-500"]),type:"button",onClick:i[10]||(i[10]=v=>d.dailyCostLimit="")},[e("div",Fs,[i[55]||(i[55]=e("i",{class:"fas fa-edit text-xs sm:text-sm"},null,-1)),!a.value.find(v=>v.value==d.dailyCostLimit)&&d.dailyCostLimit&&d.dailyCostLimit!="0"?(r(),o("i",zs)):w("",!0)]),i[56]||(i[56]=e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"自定义",-1))],2),e("button",{class:G(["group relative flex flex-col items-center justify-center rounded-lg border-2 p-2 text-center transition-all duration-200 hover:shadow-md sm:p-3",!d.dailyCostLimit||d.dailyCostLimit=="0"?"border-gray-500 bg-gray-100 text-gray-800 dark:border-gray-400 dark:bg-gray-700 dark:text-gray-300":"border-gray-200 bg-white hover:border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:hover:border-gray-500"]),type:"button",onClick:i[11]||(i[11]=v=>d.dailyCostLimit="0")},[e("div",Ys,[i[57]||(i[57]=e("i",{class:"fas fa-infinity text-xs sm:text-sm"},null,-1)),!d.dailyCostLimit||d.dailyCostLimit=="0"?(r(),o("i",Hs)):w("",!0)]),i[58]||(i[58]=e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"无限制",-1))],2)])]),e("div",null,[i[61]||(i[61]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600 dark:text-gray-400"},"自定义金额 (美元)",-1)),e("div",Ns,[i[60]||(i[60]=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 dark:text-gray-400"},"$")],-1)),M(e("input",{"onUpdate:modelValue":i[12]||(i[12]=v=>d.dailyCostLimit=v),class:"form-input w-full pl-8 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",min:"0",placeholder:"输入自定义金额或0表示无限制",step:"0.01",type:"number"},null,512),[[Z,d.dailyCostLimit]])])]),i[62]||(i[62]=e("div",{class:"rounded-lg bg-green-100 p-3 dark:bg-green-900/30"},[e("div",{class:"mb-2 flex items-start gap-2"},[e("i",{class:"fas fa-lightbulb mt-0.5 text-xs text-green-600 dark:text-green-400"}),e("div",{class:"flex-1"},[e("h5",{class:"text-xs font-semibold text-green-800 dark:text-green-300"}," 费用控制说明 "),e("div",{class:"mt-1 space-y-1 text-xs text-green-700 dark:text-green-300"},[e("p",null,"• 达到限制后，新请求将被拒绝并返回 402 错误"),e("p",null,"• 费用统计每分钟更新一次，可能存在轻微延迟"),e("p",null,"• 建议根据使用场景设置合理的限制金额")])])]),e("div",{class:"mt-2 border-t border-green-200 pt-2 dark:border-green-800"},[e("div",{class:"text-xs font-medium text-green-800 dark:text-green-300"}," 参考费用 (Claude)： "),e("div",{class:"mt-1 grid grid-cols-1 gap-x-4 text-xs text-green-700 dark:text-green-300 sm:grid-cols-2"},[e("div",null,"• Haiku: ~$0.25/1M tokens"),e("div",null,"• Sonnet: ~$3/1M tokens"),e("div",null,"• Opus: ~$15/1M tokens"),e("div",null,"• 1万字约1.5K tokens")])])],-1))])]),e("div",null,[i[64]||(i[64]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"并发限制 (可选)",-1)),M(e("input",{"onUpdate:modelValue":i[13]||(i[13]=v=>d.concurrencyLimit=v),class:"form-input w-full dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",min:"0",placeholder:"0 表示无限制",type:"number"},null,512),[[Z,d.concurrencyLimit]]),i[65]||(i[65]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 设置此 API Key 可同时处理的最大请求数，0 或留空表示无限制 ",-1))]),e("div",null,[i[66]||(i[66]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"备注 (可选)",-1)),M(e("textarea",{"onUpdate:modelValue":i[14]||(i[14]=v=>d.description=v),class:"form-input w-full resize-none text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"描述此 API Key 的用途...",rows:"2"},null,512),[[Z,d.description]])]),e("div",null,[i[68]||(i[68]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"有效期限",-1)),M(e("select",{"onUpdate:modelValue":i[15]||(i[15]=v=>d.expireDuration=v),class:"form-input w-full dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",onChange:y},[...i[67]||(i[67]=[e("option",{value:""},"永不过期",-1),e("option",{value:"1d"},"1 天",-1),e("option",{value:"7d"},"7 天",-1),e("option",{value:"30d"},"30 天",-1),e("option",{value:"90d"},"90 天",-1),e("option",{value:"180d"},"180 天",-1),e("option",{value:"365d"},"365 天",-1),e("option",{value:"custom"},"自定义日期",-1)])],544),[[ge,d.expireDuration]]),d.expireDuration==="custom"?(r(),o("div",Qs,[M(e("input",{"onUpdate:modelValue":i[16]||(i[16]=v=>d.customExpireDate=v),class:"form-input w-full dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",min:L.value,type:"datetime-local",onChange:b},null,40,Js),[[Z,d.customExpireDate]])])):w("",!0),d.expiresAt?(r(),o("p",Xs," 将于 "+g(c(d.expiresAt))+" 过期 ",1)):w("",!0)]),e("div",null,[i[73]||(i[73]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"服务权限",-1)),e("div",Zs,[e("label",ea,[M(e("input",{"onUpdate:modelValue":i[17]||(i[17]=v=>d.permissions=v),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"all"},null,512),[[ae,d.permissions]]),i[69]||(i[69]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"全部服务",-1))]),e("label",ta,[M(e("input",{"onUpdate:modelValue":i[18]||(i[18]=v=>d.permissions=v),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"claude"},null,512),[[ae,d.permissions]]),i[70]||(i[70]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"仅 Claude",-1))]),e("label",sa,[M(e("input",{"onUpdate:modelValue":i[19]||(i[19]=v=>d.permissions=v),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"gemini"},null,512),[[ae,d.permissions]]),i[71]||(i[71]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"仅 Gemini",-1))]),e("label",aa,[M(e("input",{"onUpdate:modelValue":i[20]||(i[20]=v=>d.permissions=v),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"openai"},null,512),[[ae,d.permissions]]),i[72]||(i[72]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"仅 OpenAI",-1))])]),i[74]||(i[74]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 控制此 API Key 可以访问哪些服务 ",-1))]),e("div",null,[e("div",ra,[i[75]||(i[75]=e("label",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},"专属账号绑定 (可选)",-1)),e("button",{class:"flex items-center gap-1 text-sm text-blue-600 transition-colors hover:text-blue-800 disabled:cursor-not-allowed disabled:opacity-50 dark:text-blue-400 dark:hover:text-blue-300",disabled:U.value,title:"刷新账号列表",type:"button",onClick:j},[e("i",{class:G(["fas",U.value?"fa-spinner fa-spin":"fa-sync-alt","text-xs"])},null,2),e("span",null,g(U.value?"刷新中...":"刷新账号"),1)],8,la)]),e("div",oa,[e("div",null,[i[76]||(i[76]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"Claude 专属账号",-1)),ie(Ie,{modelValue:d.claudeAccountId,"onUpdate:modelValue":i[21]||(i[21]=v=>d.claudeAccountId=v),accounts:S.value.claude,"default-option-text":"使用共享账号池",disabled:d.permissions==="gemini"||d.permissions==="openai",groups:S.value.claudeGroups,placeholder:"请选择Claude账号",platform:"claude"},null,8,["modelValue","accounts","disabled","groups"])]),e("div",null,[i[77]||(i[77]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"Gemini 专属账号",-1)),ie(Ie,{modelValue:d.geminiAccountId,"onUpdate:modelValue":i[22]||(i[22]=v=>d.geminiAccountId=v),accounts:S.value.gemini,"default-option-text":"使用共享账号池",disabled:d.permissions==="claude"||d.permissions==="openai",groups:S.value.geminiGroups,placeholder:"请选择Gemini账号",platform:"gemini"},null,8,["modelValue","accounts","disabled","groups"])]),e("div",null,[i[78]||(i[78]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"OpenAI 专属账号",-1)),ie(Ie,{modelValue:d.openaiAccountId,"onUpdate:modelValue":i[23]||(i[23]=v=>d.openaiAccountId=v),accounts:S.value.openai,"default-option-text":"使用共享账号池",disabled:d.permissions==="claude"||d.permissions==="gemini",groups:S.value.openaiGroups,placeholder:"请选择OpenAI账号",platform:"openai"},null,8,["modelValue","accounts","disabled","groups"])]),e("div",null,[i[79]||(i[79]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"Bedrock 专属账号",-1)),ie(Ie,{modelValue:d.bedrockAccountId,"onUpdate:modelValue":i[24]||(i[24]=v=>d.bedrockAccountId=v),accounts:S.value.bedrock,"default-option-text":"使用共享账号池",disabled:d.permissions==="gemini"||d.permissions==="openai",groups:[],placeholder:"请选择Bedrock账号",platform:"bedrock"},null,8,["modelValue","accounts","disabled"])])]),i[80]||(i[80]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 选择专属账号后，此API Key将只使用该账号，不选择则使用共享账号池 ",-1))]),e("div",null,[e("div",na,[M(e("input",{id:"enableModelRestriction","onUpdate:modelValue":i[25]||(i[25]=v=>d.enableModelRestriction=v),class:"h-4 w-4 rounded border-gray-300 bg-gray-100 text-blue-600 focus:ring-blue-500",type:"checkbox"},null,512),[[ve,d.enableModelRestriction]]),i[81]||(i[81]=e("label",{class:"ml-2 cursor-pointer text-sm font-semibold text-gray-700 dark:text-gray-300",for:"enableModelRestriction"}," 启用模型限制 ",-1))]),d.enableModelRestriction?(r(),o("div",ia,[e("div",null,[i[84]||(i[84]=e("label",{class:"mb-2 block text-sm font-medium text-gray-600"},"限制的模型列表",-1)),e("div",da,[(r(!0),o(Y,null,N(d.restrictedModels,(v,ee)=>(r(),o("span",{key:ee,class:"inline-flex items-center rounded-full bg-red-100 px-3 py-1 text-sm text-red-800"},[T(g(v)+" ",1),e("button",{class:"ml-2 text-red-600 hover:text-red-800",type:"button",onClick:J=>I(ee)},[...i[82]||(i[82]=[e("i",{class:"fas fa-times text-xs"},null,-1)])],8,ua)]))),128)),d.restrictedModels.length===0?(r(),o("span",ca," 暂无限制的模型 ")):w("",!0)]),e("div",ga,[e("div",ma,[(r(!0),o(Y,null,N(de.value,v=>(r(),o("button",{key:v,class:"flex-shrink-0 rounded-lg bg-gray-100 px-3 py-1 text-xs text-gray-700 transition-colors hover:bg-gray-200 sm:text-sm",type:"button",onClick:ee=>O(v)},g(v),9,xa))),128)),de.value.length===0?(r(),o("span",pa," 所有常用模型已在限制列表中 ")):w("",!0)]),e("div",ya,[M(e("input",{"onUpdate:modelValue":i[26]||(i[26]=v=>d.modelInput=v),class:"form-input flex-1",placeholder:"输入模型名称，按回车添加",type:"text",onKeydown:Ee(me(n,["prevent"]),["enter"])},null,40,ba),[[Z,d.modelInput]]),e("button",{class:"rounded-lg bg-red-500 px-4 py-2 text-white transition-colors hover:bg-red-600",type:"button",onClick:n},[...i[83]||(i[83]=[e("i",{class:"fas fa-plus"},null,-1)])])])]),i[85]||(i[85]=e("p",{class:"mt-2 text-xs text-gray-500"}," 设置此API Key无法访问的模型，例如：claude-opus-4-20250514 ",-1))])])):w("",!0)]),e("div",null,[e("div",fa,[M(e("input",{id:"enableClientRestriction","onUpdate:modelValue":i[27]||(i[27]=v=>d.enableClientRestriction=v),class:"h-4 w-4 rounded border-gray-300 bg-gray-100 text-blue-600 focus:ring-blue-500",type:"checkbox"},null,512),[[ve,d.enableClientRestriction]]),i[86]||(i[86]=e("label",{class:"ml-2 cursor-pointer text-sm font-semibold text-gray-700 dark:text-gray-300",for:"enableClientRestriction"}," 启用客户端限制 ",-1))]),d.enableClientRestriction?(r(),o("div",va,[e("div",null,[i[87]||(i[87]=e("label",{class:"mb-2 block text-xs font-medium text-gray-700 dark:text-gray-300"},"允许的客户端",-1)),e("div",ka,[(r(!0),o(Y,null,N(m.value,v=>(r(),o("div",{key:v.id,class:"flex items-start"},[M(e("input",{id:`client_${v.id}`,"onUpdate:modelValue":i[28]||(i[28]=ee=>d.allowedClients=ee),class:"mt-0.5 h-4 w-4 rounded border-gray-300 bg-gray-100 text-blue-600 focus:ring-blue-500",type:"checkbox",value:v.id},null,8,wa),[[ve,d.allowedClients]]),e("label",{class:"ml-2 flex-1 cursor-pointer",for:`client_${v.id}`},[e("span",$a,g(v.name),1),e("span",Aa,g(v.description),1)],8,ha)]))),128))])])])):w("",!0)]),e("div",Ca,[e("button",{class:"flex-1 rounded-lg bg-gray-100 px-4 py-2.5 text-sm font-semibold text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",type:"button",onClick:i[29]||(i[29]=v=>P.$emit("close"))}," 取消 "),e("button",{class:"btn btn-primary flex-1 px-4 py-2.5 text-sm font-semibold",disabled:k.value,type:"submit"},[k.value?(r(),o("div",Ka)):(r(),o("i",_a)),T(" "+g(k.value?"创建中...":"创建"),1)],8,Ia)])],32)])])]))}},La=xe(Da,[["__scopeId","data-v-46e27c90"]]),Ma={class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},Ta={class:"modal-content mx-auto flex max-h-[90vh] w-full max-w-4xl flex-col p-4 sm:p-6 md:p-8"},Sa={class:"mb-4 flex items-center justify-between sm:mb-6"},ja=["value"],Va={class:"space-y-4"},Ra={key:0},Ea={class:"flex flex-wrap gap-2"},Ua=["onClick"],Pa={key:1},Oa={class:"flex flex-wrap gap-2"},Ga=["onClick"],qa={class:"flex gap-2"},Ba=["onKeypress"],Wa={class:"rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-700 dark:bg-blue-900/20"},Fa={class:"space-y-2"},za={class:"grid grid-cols-1 gap-2 lg:grid-cols-3"},Ya={class:"rounded-lg border border-green-200 bg-gradient-to-br from-green-50 to-emerald-50 p-4 dark:border-green-700 dark:from-green-900/20 dark:to-emerald-900/20"},Ha={class:"space-y-3"},Na={class:"grid grid-cols-2 gap-2 sm:grid-cols-4 lg:flex lg:gap-2"},Qa=["onClick"],Ja={class:"flex items-center gap-1"},Xa={class:"text-sm font-bold"},Za={key:0,class:"fas fa-check text-xs text-green-600 dark:text-green-400"},er={class:"text-xs text-gray-500 dark:text-gray-400"},tr={class:"flex items-center gap-1"},sr={key:0,class:"fas fa-check text-xs text-blue-600 dark:text-blue-400"},ar={class:"flex items-center gap-1"},rr={key:0,class:"fas fa-check text-xs text-gray-600 dark:text-gray-400"},lr={class:"relative"},or={class:"mb-3 flex items-center"},nr={class:"flex gap-4"},ir={class:"flex cursor-pointer items-center"},dr={class:"flex cursor-pointer items-center"},ur={class:"flex cursor-pointer items-center"},cr={class:"flex cursor-pointer items-center"},gr={class:"mb-3 flex items-center justify-between"},mr=["disabled"],xr={class:"grid grid-cols-1 gap-3"},pr={class:"mb-3 flex items-center"},yr={key:0,class:"space-y-3"},br={class:"mb-3 flex min-h-[32px] flex-wrap gap-2 rounded-lg border border-gray-200 bg-gray-50 p-2 dark:border-gray-600 dark:bg-gray-700"},fr=["onClick"],vr={key:0,class:"text-sm text-gray-400 dark:text-gray-500"},kr={class:"space-y-3"},wr={class:"flex flex-wrap gap-2"},hr=["onClick"],$r={key:0,class:"text-sm italic text-gray-400 dark:text-gray-500"},Ar={class:"flex gap-2"},Cr=["onKeydown"],Ir={class:"mb-3 flex items-center"},Kr={key:0,class:"space-y-3"},_r={class:"space-y-2"},Dr=["id","value"],Lr=["for"],Mr={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Tr={class:"block text-xs text-gray-500 dark:text-gray-400"},Sr={class:"flex gap-3 pt-4"},jr=["disabled"],Vr={key:0,class:"loading-spinner mr-2"},Rr={key:1,class:"fas fa-save mr-2"},Er={__name:"EditApiKeyModal",props:{apiKey:{type:Object,required:!0},accounts:{type:Object,default:()=>({claude:[],gemini:[]})}},emits:["close","success"],setup(_,{emit:Q}){const x=_,K=Q,V=We(),$=Fe(),k=D(!1),U=D(!1),S=D({claude:[],gemini:[],openai:[],bedrock:[],claudeGroups:[],geminiGroups:[],openaiGroups:[]}),W=D([]),R=D([{value:"10",label:"轻度使用"},{value:"50",label:"中度使用"},{value:"100",label:"重度使用"},{value:"200",label:"企业级"}]),h=D(""),f=D([]),m=F(()=>f.value.filter(O=>!a.tags.includes(O))),a=Te({name:"",tokenLimit:"",rateLimitWindow:"",rateLimitRequests:"",concurrencyLimit:"",dailyCostLimit:"",permissions:"all",claudeAccountId:"",geminiAccountId:"",openaiAccountId:"",bedrockAccountId:"",enableModelRestriction:!1,restrictedModels:[],modelInput:"",enableClientRestriction:!1,allowedClients:[],tags:[],isActive:!0}),d=()=>{a.modelInput&&!a.restrictedModels.includes(a.modelInput)&&(a.restrictedModels.push(a.modelInput),a.modelInput="")},j=O=>{a.restrictedModels.splice(O,1)},L=D(["claude-opus-4-20250514","claude-opus-4-1-20250805"]),y=F(()=>L.value.filter(O=>!a.restrictedModels.includes(O))),b=O=>{a.restrictedModels.includes(O)||a.restrictedModels.push(O)},c=()=>{if(h.value&&h.value.trim()){const O=h.value.trim();a.tags.includes(O)||a.tags.push(O),h.value=""}},n=O=>{a.tags.includes(O)||a.tags.push(O)},I=O=>{a.tags.splice(O,1)},oe=async()=>{k.value=!0;try{const O={tokenLimit:a.tokenLimit!==""&&a.tokenLimit!==null?parseInt(a.tokenLimit):0,rateLimitWindow:a.rateLimitWindow!==""&&a.rateLimitWindow!==null?parseInt(a.rateLimitWindow):0,rateLimitRequests:a.rateLimitRequests!==""&&a.rateLimitRequests!==null?parseInt(a.rateLimitRequests):0,concurrencyLimit:a.concurrencyLimit!==""&&a.concurrencyLimit!==null?parseInt(a.concurrencyLimit):0,dailyCostLimit:a.dailyCostLimit!==""&&a.dailyCostLimit!==null?parseFloat(a.dailyCostLimit):0,permissions:a.permissions,tags:a.tags};a.claudeAccountId?a.claudeAccountId.startsWith("console:")?(O.claudeConsoleAccountId=a.claudeAccountId.substring(8),O.claudeAccountId=null):(a.claudeAccountId.startsWith("group:"),O.claudeAccountId=a.claudeAccountId,O.claudeConsoleAccountId=null):(O.claudeAccountId=null,O.claudeConsoleAccountId=null),a.geminiAccountId?O.geminiAccountId=a.geminiAccountId:O.geminiAccountId=null,a.openaiAccountId?O.openaiAccountId=a.openaiAccountId:O.openaiAccountId=null,a.bedrockAccountId?O.bedrockAccountId=a.bedrockAccountId:O.bedrockAccountId=null,O.enableModelRestriction=a.enableModelRestriction,O.restrictedModels=a.restrictedModels,O.enableClientRestriction=a.enableClientRestriction,O.allowedClients=a.allowedClients,O.isActive=a.isActive;const l=await z.put(`/admin/api-keys/${x.apiKey.id}`,O);l.success?(K("success"),K("close")):q(l.message||"更新失败","error")}catch{q("更新失败","error")}finally{k.value=!1}},de=async()=>{var O,l;U.value=!0;try{const[p,C,X,P,i,v]=await Promise.all([z.get("/admin/claude-accounts"),z.get("/admin/claude-console-accounts"),z.get("/admin/gemini-accounts"),z.get("/admin/openai-accounts"),z.get("/admin/bedrock-accounts"),z.get("/admin/account-groups")]),ee=[];if(p.success&&((O=p.data)==null||O.forEach(J=>{ee.push({...J,platform:"claude-oauth",isDedicated:J.accountType==="dedicated"})})),C.success&&((l=C.data)==null||l.forEach(J=>{ee.push({...J,platform:"claude-console",isDedicated:J.accountType==="dedicated"})})),S.value.claude=ee,X.success&&(S.value.gemini=(X.data||[]).map(J=>({...J,isDedicated:J.accountType==="dedicated"}))),P.success&&(S.value.openai=(P.data||[]).map(J=>({...J,isDedicated:J.accountType==="dedicated"}))),i.success&&(S.value.bedrock=(i.data||[]).map(J=>({...J,isDedicated:J.accountType==="dedicated"}))),v.success){const J=v.data||[];S.value.claudeGroups=J.filter(se=>se.platform==="claude"),S.value.geminiGroups=J.filter(se=>se.platform==="gemini"),S.value.openaiGroups=J.filter(se=>se.platform==="openai")}q("账号列表已刷新","success")}catch{q("刷新账号列表失败","error")}finally{U.value=!1}};return Me(async()=>{W.value=await V.loadSupportedClients(),f.value=await $.fetchTags(),x.accounts&&(S.value={claude:x.accounts.claude||[],gemini:x.accounts.gemini||[],openai:x.accounts.openai||[],bedrock:x.accounts.bedrock||[],claudeGroups:x.accounts.claudeGroups||[],geminiGroups:x.accounts.geminiGroups||[],openaiGroups:x.accounts.openaiGroups||[]}),a.name=x.apiKey.name,a.tokenLimit=x.apiKey.tokenLimit||"",a.rateLimitWindow=x.apiKey.rateLimitWindow||"",a.rateLimitRequests=x.apiKey.rateLimitRequests||"",a.concurrencyLimit=x.apiKey.concurrencyLimit||"",a.dailyCostLimit=x.apiKey.dailyCostLimit||"",a.permissions=x.apiKey.permissions||"all",x.apiKey.claudeConsoleAccountId?a.claudeAccountId=`console:${x.apiKey.claudeConsoleAccountId}`:a.claudeAccountId=x.apiKey.claudeAccountId||"",a.geminiAccountId=x.apiKey.geminiAccountId||"",a.openaiAccountId=x.apiKey.openaiAccountId||"",a.bedrockAccountId=x.apiKey.bedrockAccountId||"",a.restrictedModels=x.apiKey.restrictedModels||[],a.allowedClients=x.apiKey.allowedClients||[],a.tags=x.apiKey.tags||[],a.enableModelRestriction=x.apiKey.enableModelRestriction||!1,a.enableClientRestriction=x.apiKey.enableClientRestriction||!1,a.isActive=x.apiKey.isActive!==void 0?x.apiKey.isActive:!0}),(O,l)=>(r(),le(fe,{to:"body"},[e("div",Ma,[e("div",Ta,[e("div",Sa,[l[24]||(l[24]=e("div",{class:"flex items-center gap-2 sm:gap-3"},[e("div",{class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 sm:h-10 sm:w-10 sm:rounded-xl"},[e("i",{class:"fas fa-edit text-sm text-white sm:text-base"})]),e("h3",{class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"}," 编辑 API Key ")],-1)),e("button",{class:"p-1 text-gray-400 transition-colors hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",onClick:l[0]||(l[0]=p=>O.$emit("close"))},[...l[23]||(l[23]=[e("i",{class:"fas fa-times text-lg sm:text-xl"},null,-1)])])]),e("form",{class:"modal-scroll-content custom-scrollbar flex-1 space-y-4 sm:space-y-6",onSubmit:me(oe,["prevent"])},[e("div",null,[l[25]||(l[25]=e("label",{class:"mb-1.5 block text-xs font-semibold text-gray-700 dark:text-gray-300 sm:mb-3 sm:text-sm"},"名称",-1)),e("input",{class:"form-input w-full cursor-not-allowed bg-gray-100 text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-gray-400",disabled:"",type:"text",value:a.name},null,8,ja),l[26]||(l[26]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400 sm:mt-2"},"名称不可修改",-1))]),e("div",null,[l[34]||(l[34]=e("label",{class:"mb-1.5 block text-xs font-semibold text-gray-700 dark:text-gray-300 sm:mb-3 sm:text-sm"},"标签",-1)),e("div",Va,[a.tags.length>0?(r(),o("div",Ra,[l[28]||(l[28]=e("div",{class:"mb-2 text-xs font-medium text-gray-600 dark:text-gray-400"}," 已选择的标签: ",-1)),e("div",Ea,[(r(!0),o(Y,null,N(a.tags,(p,C)=>(r(),o("span",{key:"selected-"+C,class:"inline-flex items-center gap-1 rounded-full bg-blue-100 px-3 py-1 text-sm text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"},[T(g(p)+" ",1),e("button",{class:"ml-1 hover:text-blue-900 dark:hover:text-blue-300",type:"button",onClick:X=>I(C)},[...l[27]||(l[27]=[e("i",{class:"fas fa-times text-xs"},null,-1)])],8,Ua)]))),128))])])):w("",!0),m.value.length>0?(r(),o("div",Pa,[l[30]||(l[30]=e("div",{class:"mb-2 text-xs font-medium text-gray-600 dark:text-gray-400"}," 点击选择已有标签: ",-1)),e("div",Oa,[(r(!0),o(Y,null,N(m.value,p=>(r(),o("button",{key:"available-"+p,class:"inline-flex items-center gap-1 rounded-full bg-gray-100 px-3 py-1 text-sm text-gray-700 transition-colors hover:bg-blue-100 hover:text-blue-700 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-blue-900/30 dark:hover:text-blue-400",type:"button",onClick:C=>n(p)},[l[29]||(l[29]=e("i",{class:"fas fa-tag text-xs text-gray-500 dark:text-gray-400"},null,-1)),T(" "+g(p),1)],8,Ga))),128))])])):w("",!0),e("div",null,[l[32]||(l[32]=e("div",{class:"mb-2 text-xs font-medium text-gray-600 dark:text-gray-400"}," 创建新标签: ",-1)),e("div",qa,[M(e("input",{"onUpdate:modelValue":l[1]||(l[1]=p=>h.value=p),class:"form-input flex-1 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"输入新标签名称",type:"text",onKeypress:Ee(me(c,["prevent"]),["enter"])},null,40,Ba),[[Z,h.value]]),e("button",{class:"rounded-lg bg-green-500 px-4 py-2 text-white transition-colors hover:bg-green-600",type:"button",onClick:c},[...l[31]||(l[31]=[e("i",{class:"fas fa-plus"},null,-1)])])])]),l[33]||(l[33]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," 用于标记不同团队或用途，方便筛选管理 ",-1))])]),e("div",Wa,[l[42]||(l[42]=e("div",{class:"mb-2 flex items-center gap-2"},[e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded bg-blue-500"},[e("i",{class:"fas fa-tachometer-alt text-xs text-white"})]),e("h4",{class:"text-sm font-semibold text-gray-800 dark:text-gray-200"}," 速率限制设置 (可选) ")],-1)),e("div",Fa,[e("div",za,[e("div",null,[l[35]||(l[35]=e("label",{class:"mb-1 block text-xs font-medium text-gray-700 dark:text-gray-300"},"时间窗口 (分钟)",-1)),M(e("input",{"onUpdate:modelValue":l[2]||(l[2]=p=>a.rateLimitWindow=p),class:"form-input w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",min:"1",placeholder:"无限制",type:"number"},null,512),[[Z,a.rateLimitWindow]]),l[36]||(l[36]=e("p",{class:"ml-2 mt-0.5 text-xs text-gray-500 dark:text-gray-400"},"时间段单位",-1))]),e("div",null,[l[37]||(l[37]=e("label",{class:"mb-1 block text-xs font-medium text-gray-700 dark:text-gray-300"},"请求次数限制",-1)),M(e("input",{"onUpdate:modelValue":l[3]||(l[3]=p=>a.rateLimitRequests=p),class:"form-input w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",min:"1",placeholder:"无限制",type:"number"},null,512),[[Z,a.rateLimitRequests]]),l[38]||(l[38]=e("p",{class:"ml-2 mt-0.5 text-xs text-gray-500 dark:text-gray-400"},"窗口内最大请求",-1))]),e("div",null,[l[39]||(l[39]=e("label",{class:"mb-1 block text-xs font-medium text-gray-700 dark:text-gray-300"},"Token 限制",-1)),M(e("input",{"onUpdate:modelValue":l[4]||(l[4]=p=>a.tokenLimit=p),class:"form-input w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"无限制",type:"number"},null,512),[[Z,a.tokenLimit]]),l[40]||(l[40]=e("p",{class:"ml-2 mt-0.5 text-xs text-gray-500 dark:text-gray-400"}," 窗口内最大Token ",-1))])]),l[41]||(l[41]=e("div",{class:"rounded-lg bg-blue-100 p-2 dark:bg-blue-900/30"},[e("h5",{class:"mb-1 text-xs font-semibold text-blue-800 dark:text-blue-400"}," 💡 使用示例 "),e("div",{class:"space-y-0.5 text-xs text-blue-700 dark:text-blue-300"},[e("div",null,[e("strong",null,"示例1:"),T(" 时间窗口=60，请求次数=1000 → 每60分钟最多1000次请求 ")]),e("div",null,[e("strong",null,"示例2:"),T(" 时间窗口=1，Token=10000 → 每分钟最多10,000个Token ")]),e("div",null,[e("strong",null,"示例3:"),T(" 窗口=30，请求=50，Token=100000 → 每30分钟50次请求且不超10万Token ")])])],-1))])]),e("div",Ya,[l[51]||(l[51]=e("div",{class:"mb-3 flex items-center gap-2"},[e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded bg-green-500"},[e("i",{class:"fas fa-dollar-sign text-xs text-white"})]),e("h4",{class:"text-sm font-semibold text-gray-800 dark:text-gray-200"}," 每日费用限制 (可选) ")],-1)),e("div",Ha,[e("div",null,[l[47]||(l[47]=e("label",{class:"mb-2 block text-xs font-medium text-gray-600 dark:text-gray-400"},"选择预设限额",-1)),e("div",Na,[(r(!0),o(Y,null,N(R.value,p=>(r(),o("button",{key:p.value,class:G(["group relative flex flex-col items-center justify-center rounded-lg border-2 p-3 text-center transition-all duration-200 hover:shadow-md",a.dailyCostLimit==p.value?"border-green-500 bg-green-100 text-green-800 dark:border-green-400 dark:bg-green-900/30 dark:text-green-300":"border-gray-200 bg-white hover:border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:hover:border-gray-500"]),type:"button",onClick:C=>a.dailyCostLimit=p.value},[e("div",Ja,[e("span",Xa,"$"+g(p.value),1),a.dailyCostLimit==p.value?(r(),o("i",Za)):w("",!0)]),e("span",er,g(p.label),1)],10,Qa))),128)),e("button",{class:G(["group relative flex flex-col items-center justify-center rounded-lg border-2 p-3 text-center transition-all duration-200 hover:shadow-md",!R.value.find(p=>p.value==a.dailyCostLimit)&&a.dailyCostLimit?"border-blue-500 bg-blue-100 text-blue-800 dark:border-blue-400 dark:bg-blue-900/30 dark:text-blue-300":"border-gray-200 bg-white hover:border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:hover:border-gray-500"]),type:"button",onClick:l[5]||(l[5]=p=>a.dailyCostLimit="")},[e("div",tr,[l[43]||(l[43]=e("i",{class:"fas fa-edit text-sm"},null,-1)),!R.value.find(p=>p.value==a.dailyCostLimit)&&a.dailyCostLimit?(r(),o("i",sr)):w("",!0)]),l[44]||(l[44]=e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"自定义",-1))],2),e("button",{class:G(["group relative flex flex-col items-center justify-center rounded-lg border-2 p-3 text-center transition-all duration-200 hover:shadow-md",!a.dailyCostLimit||a.dailyCostLimit=="0"?"border-gray-500 bg-gray-100 text-gray-800 dark:border-gray-400 dark:bg-gray-700 dark:text-gray-300":"border-gray-200 bg-white hover:border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:hover:border-gray-500"]),type:"button",onClick:l[6]||(l[6]=p=>a.dailyCostLimit="0")},[e("div",ar,[l[45]||(l[45]=e("i",{class:"fas fa-infinity text-sm"},null,-1)),!a.dailyCostLimit||a.dailyCostLimit=="0"?(r(),o("i",rr)):w("",!0)]),l[46]||(l[46]=e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"无限制",-1))],2)])]),e("div",null,[l[49]||(l[49]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600 dark:text-gray-400"},"自定义金额 (美元)",-1)),e("div",lr,[l[48]||(l[48]=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 dark:text-gray-400"},"$")],-1)),M(e("input",{"onUpdate:modelValue":l[7]||(l[7]=p=>a.dailyCostLimit=p),class:"form-input w-full pl-8 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",min:"0",placeholder:"输入自定义金额或0表示无限制",step:"0.01",type:"number"},null,512),[[Z,a.dailyCostLimit]])])]),l[50]||(l[50]=e("div",{class:"rounded-lg bg-green-100 p-3 dark:bg-green-900/30"},[e("div",{class:"mb-2 flex items-start gap-2"},[e("i",{class:"fas fa-lightbulb mt-0.5 text-xs text-green-600 dark:text-green-400"}),e("div",{class:"flex-1"},[e("h5",{class:"text-xs font-semibold text-green-800 dark:text-green-300"}," 费用控制说明 "),e("div",{class:"mt-1 space-y-1 text-xs text-green-700 dark:text-green-300"},[e("p",null,"• 达到限制后，新请求将被拒绝并返回 402 错误"),e("p",null,"• 费用统计每分钟更新一次，可能存在轻微延迟"),e("p",null,"• 建议根据使用场景设置合理的限制金额")])])]),e("div",{class:"mt-2 border-t border-green-200 pt-2 dark:border-green-800"},[e("div",{class:"text-xs font-medium text-green-800 dark:text-green-300"}," 参考费用 (Claude)： "),e("div",{class:"mt-1 grid grid-cols-2 gap-x-4 text-xs text-green-700 dark:text-green-300"},[e("div",null,"• Haiku: ~$0.25/1M tokens"),e("div",null,"• Sonnet: ~$3/1M tokens"),e("div",null,"• Opus: ~$15/1M tokens"),e("div",null,"• 1万字约1.5K tokens")])])],-1))])]),e("div",null,[l[52]||(l[52]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"并发限制",-1)),M(e("input",{"onUpdate:modelValue":l[8]||(l[8]=p=>a.concurrencyLimit=p),class:"form-input w-full dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",min:"0",placeholder:"0 表示无限制",type:"number"},null,512),[[Z,a.concurrencyLimit]]),l[53]||(l[53]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 设置此 API Key 可同时处理的最大请求数 ",-1))]),e("div",null,[e("div",or,[M(e("input",{id:"editIsActive","onUpdate:modelValue":l[9]||(l[9]=p=>a.isActive=p),class:"h-4 w-4 rounded border-gray-300 bg-gray-100 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox"},null,512),[[ve,a.isActive]]),l[54]||(l[54]=e("label",{class:"ml-2 cursor-pointer text-sm font-semibold text-gray-700 dark:text-gray-300",for:"editIsActive"}," 激活账号 ",-1))]),l[55]||(l[55]=e("p",{class:"mb-4 text-xs text-gray-500 dark:text-gray-400"}," 取消勾选将禁用此 API Key，暂停所有请求，客户端返回 401 错误 ",-1))]),e("div",null,[l[60]||(l[60]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"服务权限",-1)),e("div",nr,[e("label",ir,[M(e("input",{"onUpdate:modelValue":l[10]||(l[10]=p=>a.permissions=p),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"all"},null,512),[[ae,a.permissions]]),l[56]||(l[56]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"全部服务",-1))]),e("label",dr,[M(e("input",{"onUpdate:modelValue":l[11]||(l[11]=p=>a.permissions=p),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"claude"},null,512),[[ae,a.permissions]]),l[57]||(l[57]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"仅 Claude",-1))]),e("label",ur,[M(e("input",{"onUpdate:modelValue":l[12]||(l[12]=p=>a.permissions=p),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"gemini"},null,512),[[ae,a.permissions]]),l[58]||(l[58]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"仅 Gemini",-1))]),e("label",cr,[M(e("input",{"onUpdate:modelValue":l[13]||(l[13]=p=>a.permissions=p),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"openai"},null,512),[[ae,a.permissions]]),l[59]||(l[59]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"仅 OpenAI",-1))])]),l[61]||(l[61]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 控制此 API Key 可以访问哪些服务 ",-1))]),e("div",null,[e("div",gr,[l[62]||(l[62]=e("label",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},"专属账号绑定",-1)),e("button",{class:"flex items-center gap-1 text-sm text-blue-600 transition-colors hover:text-blue-800 disabled:cursor-not-allowed disabled:opacity-50 dark:text-blue-400 dark:hover:text-blue-300",disabled:U.value,title:"刷新账号列表",type:"button",onClick:de},[e("i",{class:G(["fas",U.value?"fa-spinner fa-spin":"fa-sync-alt","text-xs"])},null,2),e("span",null,g(U.value?"刷新中...":"刷新账号"),1)],8,mr)]),e("div",xr,[e("div",null,[l[63]||(l[63]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"Claude 专属账号",-1)),ie(Ie,{modelValue:a.claudeAccountId,"onUpdate:modelValue":l[14]||(l[14]=p=>a.claudeAccountId=p),accounts:S.value.claude,"default-option-text":"使用共享账号池",disabled:a.permissions==="gemini"||a.permissions==="openai",groups:S.value.claudeGroups,placeholder:"请选择Claude账号",platform:"claude"},null,8,["modelValue","accounts","disabled","groups"])]),e("div",null,[l[64]||(l[64]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"Gemini 专属账号",-1)),ie(Ie,{modelValue:a.geminiAccountId,"onUpdate:modelValue":l[15]||(l[15]=p=>a.geminiAccountId=p),accounts:S.value.gemini,"default-option-text":"使用共享账号池",disabled:a.permissions==="claude"||a.permissions==="openai",groups:S.value.geminiGroups,placeholder:"请选择Gemini账号",platform:"gemini"},null,8,["modelValue","accounts","disabled","groups"])]),e("div",null,[l[65]||(l[65]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"OpenAI 专属账号",-1)),ie(Ie,{modelValue:a.openaiAccountId,"onUpdate:modelValue":l[16]||(l[16]=p=>a.openaiAccountId=p),accounts:S.value.openai,"default-option-text":"使用共享账号池",disabled:a.permissions==="claude"||a.permissions==="gemini",groups:S.value.openaiGroups,placeholder:"请选择OpenAI账号",platform:"openai"},null,8,["modelValue","accounts","disabled","groups"])]),e("div",null,[l[66]||(l[66]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"Bedrock 专属账号",-1)),ie(Ie,{modelValue:a.bedrockAccountId,"onUpdate:modelValue":l[17]||(l[17]=p=>a.bedrockAccountId=p),accounts:S.value.bedrock,"default-option-text":"使用共享账号池",disabled:a.permissions==="gemini"||a.permissions==="openai",groups:[],placeholder:"请选择Bedrock账号",platform:"bedrock"},null,8,["modelValue","accounts","disabled"])])]),l[67]||(l[67]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 修改绑定账号将影响此API Key的请求路由 ",-1))]),e("div",null,[e("div",pr,[M(e("input",{id:"editEnableModelRestriction","onUpdate:modelValue":l[18]||(l[18]=p=>a.enableModelRestriction=p),class:"h-4 w-4 rounded border-gray-300 bg-gray-100 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox"},null,512),[[ve,a.enableModelRestriction]]),l[68]||(l[68]=e("label",{class:"ml-2 cursor-pointer text-sm font-semibold text-gray-700 dark:text-gray-300",for:"editEnableModelRestriction"}," 启用模型限制 ",-1))]),a.enableModelRestriction?(r(),o("div",yr,[e("div",null,[l[71]||(l[71]=e("label",{class:"mb-2 block text-sm font-medium text-gray-600 dark:text-gray-400"},"限制的模型列表",-1)),e("div",br,[(r(!0),o(Y,null,N(a.restrictedModels,(p,C)=>(r(),o("span",{key:C,class:"inline-flex items-center rounded-full bg-red-100 px-3 py-1 text-sm text-red-800 dark:bg-red-900/30 dark:text-red-400"},[T(g(p)+" ",1),e("button",{class:"ml-2 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",type:"button",onClick:X=>j(C)},[...l[69]||(l[69]=[e("i",{class:"fas fa-times text-xs"},null,-1)])],8,fr)]))),128)),a.restrictedModels.length===0?(r(),o("span",vr," 暂无限制的模型 ")):w("",!0)]),e("div",kr,[e("div",wr,[(r(!0),o(Y,null,N(y.value,p=>(r(),o("button",{key:p,class:"flex-shrink-0 rounded-lg bg-gray-100 px-3 py-1 text-xs text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 sm:text-sm",type:"button",onClick:C=>b(p)},g(p),9,hr))),128)),y.value.length===0?(r(),o("span",$r," 所有常用模型已在限制列表中 ")):w("",!0)]),e("div",Ar,[M(e("input",{"onUpdate:modelValue":l[19]||(l[19]=p=>a.modelInput=p),class:"form-input flex-1 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"输入模型名称，按回车添加",type:"text",onKeydown:Ee(me(d,["prevent"]),["enter"])},null,40,Cr),[[Z,a.modelInput]]),e("button",{class:"rounded-lg bg-red-500 px-4 py-2 text-white transition-colors hover:bg-red-600",type:"button",onClick:d},[...l[70]||(l[70]=[e("i",{class:"fas fa-plus"},null,-1)])])])]),l[72]||(l[72]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 设置此API Key无法访问的模型，例如：claude-opus-4-20250514 ",-1))])])):w("",!0)]),e("div",null,[e("div",Ir,[M(e("input",{id:"editEnableClientRestriction","onUpdate:modelValue":l[20]||(l[20]=p=>a.enableClientRestriction=p),class:"h-4 w-4 rounded border-gray-300 bg-gray-100 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox"},null,512),[[ve,a.enableClientRestriction]]),l[73]||(l[73]=e("label",{class:"ml-2 cursor-pointer text-sm font-semibold text-gray-700 dark:text-gray-300",for:"editEnableClientRestriction"}," 启用客户端限制 ",-1))]),a.enableClientRestriction?(r(),o("div",Kr,[e("div",null,[l[74]||(l[74]=e("label",{class:"mb-2 block text-sm font-medium text-gray-600 dark:text-gray-400"},"允许的客户端",-1)),l[75]||(l[75]=e("p",{class:"mb-3 text-xs text-gray-500 dark:text-gray-400"}," 勾选允许使用此API Key的客户端 ",-1)),e("div",_r,[(r(!0),o(Y,null,N(W.value,p=>(r(),o("div",{key:p.id,class:"flex items-start"},[M(e("input",{id:`edit_client_${p.id}`,"onUpdate:modelValue":l[21]||(l[21]=C=>a.allowedClients=C),class:"mt-0.5 h-4 w-4 rounded border-gray-300 bg-gray-100 text-blue-600 focus:ring-blue-500",type:"checkbox",value:p.id},null,8,Dr),[[ve,a.allowedClients]]),e("label",{class:"ml-2 flex-1 cursor-pointer",for:`edit_client_${p.id}`},[e("span",Mr,g(p.name),1),e("span",Tr,g(p.description),1)],8,Lr)]))),128))])])])):w("",!0)]),e("div",Sr,[e("button",{class:"flex-1 rounded-xl bg-gray-100 px-6 py-3 font-semibold text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",type:"button",onClick:l[22]||(l[22]=p=>O.$emit("close"))}," 取消 "),e("button",{class:"btn btn-primary flex-1 px-6 py-3 font-semibold",disabled:k.value,type:"submit"},[k.value?(r(),o("div",Vr)):(r(),o("i",Rr)),T(" "+g(k.value?"保存中...":"保存修改"),1)],8,jr)])],32)])])]))}},Ur=xe(Er,[["__scopeId","data-v-0c07e640"]]),Pr={class:"modal fixed inset-0 z-50 flex items-center justify-center p-4"},Or={class:"modal-content mx-auto flex max-h-[90vh] w-full max-w-md flex-col p-8"},Gr={class:"mb-6 flex items-center justify-between"},qr={class:"modal-scroll-content custom-scrollbar flex-1 space-y-6"},Br={class:"rounded-lg border border-blue-200 bg-blue-50 p-4"},Wr={class:"flex items-start gap-3"},Fr={class:"text-sm text-gray-700"},zr={class:"mt-1 text-xs text-gray-600"},Yr={key:0,class:"mt-3"},Hr=["min"],Nr={key:1,class:"mt-2 text-xs text-gray-500"},Qr={class:"flex gap-3 pt-4"},Jr=["disabled"],Xr={key:0,class:"loading-spinner mr-2"},Zr={key:1,class:"fas fa-clock mr-2"},el={__name:"RenewApiKeyModal",props:{apiKey:{type:Object,required:!0}},emits:["close","success"],setup(_,{emit:Q}){const x=_,K=Q,V=D(!1),$=Te({renewDuration:"30d",customExpireDate:"",newExpiresAt:null}),k=F(()=>{const h=new Date;return x.apiKey.expiresAt&&new Date(x.apiKey.expiresAt)>h?new Date(x.apiKey.expiresAt).toISOString().slice(0,16):(h.setMinutes(h.getMinutes()+1),h.toISOString().slice(0,16))}),U=h=>new Date(h).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),S=()=>{if(!$.renewDuration){$.newExpiresAt=null;return}if($.renewDuration==="permanent"){$.newExpiresAt=null;return}if($.renewDuration==="custom")return;const h=x.apiKey.expiresAt&&new Date(x.apiKey.expiresAt)>new Date?new Date(x.apiKey.expiresAt):new Date,m=$.renewDuration.match(/(\d+)([dhmy])/);if(m){const[,a,d]=m,j=parseInt(a);switch(d){case"d":h.setDate(h.getDate()+j);break;case"h":h.setHours(h.getHours()+j);break;case"m":h.setMonth(h.getMonth()+j);break;case"y":h.setFullYear(h.getFullYear()+j);break}$.newExpiresAt=h.toISOString()}},W=()=>{$.customExpireDate&&($.newExpiresAt=new Date($.customExpireDate).toISOString())},R=async()=>{V.value=!0;try{const h={expiresAt:$.renewDuration==="permanent"?null:$.newExpiresAt},f=await z.put(`/admin/api-keys/${x.apiKey.id}`,h);f.success?(q("API Key 续期成功","success"),K("success"),K("close")):q(f.message||"续期失败","error")}catch{q("续期失败","error")}finally{V.value=!1}};return S(),(h,f)=>(r(),le(fe,{to:"body"},[e("div",Pr,[e("div",Or,[e("div",Gr,[f[5]||(f[5]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-green-500 to-green-600"},[e("i",{class:"fas fa-clock text-white"})]),e("h3",{class:"text-xl font-bold text-gray-900"},"续期 API Key")],-1)),e("button",{class:"text-gray-400 transition-colors hover:text-gray-600",onClick:f[0]||(f[0]=m=>h.$emit("close"))},[...f[4]||(f[4]=[e("i",{class:"fas fa-times text-xl"},null,-1)])])]),e("div",qr,[e("div",Br,[e("div",Wr,[f[7]||(f[7]=e("div",{class:"flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-blue-500"},[e("i",{class:"fas fa-info text-sm text-white"})],-1)),e("div",null,[f[6]||(f[6]=e("h4",{class:"mb-1 font-semibold text-gray-800"},"API Key 信息",-1)),e("p",Fr,g(_.apiKey.name),1),e("p",zr," 当前过期时间："+g(_.apiKey.expiresAt?U(_.apiKey.expiresAt):"永不过期"),1)])])]),e("div",null,[f[9]||(f[9]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"续期时长",-1)),M(e("select",{"onUpdate:modelValue":f[1]||(f[1]=m=>$.renewDuration=m),class:"form-input w-full",onChange:S},[...f[8]||(f[8]=[e("option",{value:"7d"},"延长 7 天",-1),e("option",{value:"30d"},"延长 30 天",-1),e("option",{value:"90d"},"延长 90 天",-1),e("option",{value:"180d"},"延长 180 天",-1),e("option",{value:"365d"},"延长 365 天",-1),e("option",{value:"custom"},"自定义日期",-1),e("option",{value:"permanent"},"设为永不过期",-1)])],544),[[ge,$.renewDuration]]),$.renewDuration==="custom"?(r(),o("div",Yr,[M(e("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>$.customExpireDate=m),class:"form-input w-full",min:k.value,type:"datetime-local",onChange:W},null,40,Hr),[[Z,$.customExpireDate]])])):w("",!0),$.newExpiresAt?(r(),o("p",Nr," 新的过期时间："+g(U($.newExpiresAt)),1)):w("",!0)])]),e("div",Qr,[e("button",{class:"flex-1 rounded-xl bg-gray-100 px-6 py-3 font-semibold text-gray-700 transition-colors hover:bg-gray-200",type:"button",onClick:f[3]||(f[3]=m=>h.$emit("close"))}," 取消 "),e("button",{class:"btn btn-primary flex-1 px-6 py-3 font-semibold",disabled:V.value||!$.renewDuration,type:"button",onClick:R},[V.value?(r(),o("div",Xr)):(r(),o("i",Zr)),T(" "+g(V.value?"续期中...":"确认续期"),1)],8,Jr)])])])]))}},tl=xe(el,[["__scopeId","data-v-2fba52a3"]]),sl={class:"modal fixed inset-0 z-50 flex items-center justify-center p-4"},al={class:"modal-content custom-scrollbar mx-auto max-h-[90vh] w-full max-w-lg overflow-y-auto p-8"},rl={class:"mb-6 space-y-4"},ll={class:"rounded-lg border border-gray-200 bg-gray-50 p-3 dark:border-gray-600 dark:bg-gray-800"},ol={class:"font-medium text-gray-900 dark:text-gray-100"},nl={key:0},il={class:"rounded-lg border border-gray-200 bg-gray-50 p-3 dark:border-gray-600 dark:bg-gray-800"},dl={class:"text-gray-700 dark:text-gray-300"},ul={class:"relative"},cl={class:"flex min-h-[60px] items-center break-all rounded-lg border border-gray-700 bg-gray-900 p-4 pr-14 font-mono text-sm text-white dark:border-gray-600 dark:bg-gray-900"},gl={class:"absolute right-3 top-3"},ml=["title"],xl={__name:"NewApiKeyModal",props:{apiKey:{type:Object,required:!0}},emits:["close"],setup(_,{emit:Q}){const x=_,K=Q,V=D(!1),$=()=>{V.value=!V.value},k=()=>{const R=x.apiKey.apiKey||x.apiKey.key||"";return R?V.value||R.length<=12?R:R.substring(0,8)+"●".repeat(Math.max(0,R.length-12))+R.substring(R.length-4):""},U=async()=>{const R=x.apiKey.apiKey||x.apiKey.key||"";if(!R){q("API Key 不存在","error");return}try{await navigator.clipboard.writeText(R),q("API Key 已复制到剪贴板","success")}catch(h){console.error("Failed to copy:",h);const f=document.createElement("textarea");f.value=R,document.body.appendChild(f),f.select();try{document.execCommand("copy"),q("API Key 已复制到剪贴板","success")}catch{q("复制失败，请手动复制","error")}finally{document.body.removeChild(f)}}},S=async()=>{window.showConfirm?await window.showConfirm("关闭提醒",`关闭后将无法再次查看完整的API Key，请确保已经妥善保存。

确定要关闭吗？`,"确定关闭","取消")&&K("close"):confirm(`关闭后将无法再次查看完整的API Key，请确保已经妥善保存。

确定要关闭吗？`)&&K("close")},W=async()=>{window.showConfirm?await window.showConfirm("确定要关闭吗？",`您还没有保存API Key，关闭后将无法再次查看。

建议您先复制API Key再关闭。`,"仍然关闭","返回复制")&&K("close"):confirm(`您还没有保存API Key，关闭后将无法再次查看。

确定要关闭吗？`)&&K("close")};return(R,h)=>(r(),le(fe,{to:"body"},[e("div",sl,[e("div",al,[e("div",{class:"mb-6 flex items-center justify-between"},[h[1]||(h[1]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-green-500 to-green-600"},[e("i",{class:"fas fa-check text-lg text-white"})]),e("div",null,[e("h3",{class:"text-xl font-bold text-gray-900 dark:text-gray-100"},"API Key 创建成功"),e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"请妥善保存您的 API Key")])],-1)),e("button",{class:"text-gray-400 transition-colors hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",title:"直接关闭（不推荐）",onClick:W},[...h[0]||(h[0]=[e("i",{class:"fas fa-times text-xl"},null,-1)])])]),h[7]||(h[7]=e("div",{class:"mb-6 border-l-4 border-amber-400 bg-amber-50 p-4 dark:border-amber-500 dark:bg-amber-900/20"},[e("div",{class:"flex items-start"},[e("div",{class:"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-lg bg-amber-400 dark:bg-amber-500"},[e("i",{class:"fas fa-exclamation-triangle text-sm text-white"})]),e("div",{class:"ml-3"},[e("h5",{class:"mb-1 font-semibold text-amber-900 dark:text-amber-400"},"重要提醒"),e("p",{class:"text-sm text-amber-800 dark:text-amber-300"}," 这是您唯一能看到完整 API Key 的机会。关闭此窗口后，系统将不再显示完整的 API Key。请立即复制并妥善保存。 ")])])],-1)),e("div",rl,[e("div",null,[h[2]||(h[2]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"API Key 名称",-1)),e("div",ll,[e("span",ol,g(_.apiKey.name),1)])]),_.apiKey.description?(r(),o("div",nl,[h[3]||(h[3]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"备注",-1)),e("div",il,[e("span",dl,g(_.apiKey.description||"无描述"),1)])])):w("",!0),e("div",null,[h[4]||(h[4]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"API Key",-1)),e("div",ul,[e("div",cl,g(k()),1),e("div",gl,[e("button",{class:"btn-icon-sm bg-gray-700 hover:bg-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600",title:V.value?"隐藏API Key":"显示完整API Key",type:"button",onClick:$},[e("i",{class:G(["fas",V.value?"fa-eye-slash":"fa-eye","text-gray-300"])},null,2)],8,ml)])]),h[5]||(h[5]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 点击眼睛图标切换显示模式，使用下方按钮复制完整 API Key ",-1))])]),e("div",{class:"flex gap-3"},[e("button",{class:"btn btn-primary flex flex-1 items-center justify-center gap-2 px-6 py-3 font-semibold",onClick:U},[...h[6]||(h[6]=[e("i",{class:"fas fa-copy"},null,-1),T(" 复制 API Key ",-1)])]),e("button",{class:"rounded-xl border border-gray-300 bg-gray-200 px-6 py-3 font-semibold text-gray-800 transition-colors hover:bg-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",onClick:S}," 我已保存 ")])])])]))}},pl=xe(xl,[["__scopeId","data-v-aa36c8d5"]]),yl={class:"modal fixed inset-0 z-50 flex items-center justify-center p-4"},bl={class:"modal-content custom-scrollbar mx-auto max-h-[90vh] w-full max-w-2xl overflow-y-auto p-8"},fl={class:"mb-6 flex items-center justify-between"},vl={class:"flex items-center gap-3"},kl={class:"text-sm text-gray-600"},wl={class:"mb-6 grid grid-cols-2 gap-4 md:grid-cols-4"},hl={class:"rounded-lg border border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100 p-4"},$l={class:"flex items-center justify-between"},Al={class:"mt-1 text-2xl font-bold text-blue-900"},Cl={class:"rounded-lg border border-green-200 bg-gradient-to-br from-green-50 to-green-100 p-4"},Il={class:"flex items-center justify-between"},Kl={class:"mt-1 truncate text-lg font-bold text-green-900"},_l={class:"rounded-lg border border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100 p-4"},Dl={class:"flex items-center justify-between"},Ll={class:"mt-1 text-lg font-bold text-purple-900"},Ml={class:"rounded-lg border border-orange-200 bg-gradient-to-br from-orange-50 to-orange-100 p-4"},Tl={class:"flex items-center justify-between"},Sl={class:"mt-1 text-lg font-bold text-orange-900"},jl={class:"mb-6"},Vl={class:"mb-3 flex items-center justify-between"},Rl={class:"flex items-center gap-2"},El={key:0,class:"custom-scrollbar max-h-48 overflow-y-auto rounded-lg bg-gray-900 p-4"},Ul={class:"font-mono text-xs text-gray-300"},Pl={__name:"BatchApiKeyModal",props:{apiKeys:{type:Array,required:!0}},emits:["close"],setup(_,{emit:Q}){const x=_,K=Q,V=D(!1),$=F(()=>{if(x.apiKeys.length>0){const m=x.apiKeys[0],a=m.name.match(/^(.+)_\d+$/);return a?a[1]:m.name}return""}),k=()=>{if(x.apiKeys.length===0)return"未知";const m=x.apiKeys[0].permissions;return{all:"全部服务",claude:"仅 Claude",gemini:"仅 Gemini"}[m]||m},U=()=>{if(x.apiKeys.length===0)return"未知";const m=x.apiKeys[0].expiresAt;if(!m)return"永不过期";const a=new Date(m),j=Math.ceil((a-new Date)/(1e3*60*60*24));return j<=7?`${j}天`:j<=30?`${Math.ceil(j/7)}周`:j<=365?`${Math.ceil(j/30)}个月`:`${Math.ceil(j/365)}年`},S=()=>{V.value=!V.value},W=()=>{const a=x.apiKeys.slice(0,10).map(d=>`${d.name}: ${d.apiKey||d.key||""}`);return x.apiKeys.length>10&&a.push(`... 还有 ${x.apiKeys.length-10} 个 API Key`),a.join(`
`)},R=()=>{const m=x.apiKeys.map(y=>`${y.name}: ${y.apiKey||y.key||""}`).join(`
`),a=new Blob([m],{type:"text/plain;charset=utf-8"}),d=URL.createObjectURL(a),j=document.createElement("a");j.href=d;const L=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);j.download=`api-keys-${$.value}-${L}.txt`,document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(d),q("API Keys 文件已下载","success")},h=async()=>{window.showConfirm?await window.showConfirm("关闭提醒",`关闭后将无法再次查看这些 API Key，请确保已经下载并妥善保存。

确定要关闭吗？`,"确定关闭","返回下载")&&K("close"):confirm(`关闭后将无法再次查看这些 API Key，请确保已经下载并妥善保存。

确定要关闭吗？`)&&K("close")},f=async()=>{window.showConfirm?await window.showConfirm("确定要关闭吗？",`您还没有下载 API Keys，关闭后将无法再次查看。

强烈建议您先下载保存。`,"仍然关闭","返回下载")&&K("close"):confirm(`您还没有下载 API Keys，关闭后将无法再次查看。

确定要关闭吗？`)&&K("close")};return(m,a)=>(r(),le(fe,{to:"body"},[e("div",yl,[e("div",bl,[e("div",fl,[e("div",vl,[a[1]||(a[1]=e("div",{class:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-green-500 to-green-600"},[e("i",{class:"fas fa-layer-group text-lg text-white"})],-1)),e("div",null,[a[0]||(a[0]=e("h3",{class:"text-xl font-bold text-gray-900"},"批量创建成功",-1)),e("p",kl,"成功创建 "+g(_.apiKeys.length)+" 个 API Key",1)])]),e("button",{class:"text-gray-400 transition-colors hover:text-gray-600",title:"直接关闭（不推荐）",onClick:f},[...a[2]||(a[2]=[e("i",{class:"fas fa-times text-xl"},null,-1)])])]),a[14]||(a[14]=e("div",{class:"mb-6 border-l-4 border-amber-400 bg-amber-50 p-4"},[e("div",{class:"flex items-start"},[e("div",{class:"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-lg bg-amber-400"},[e("i",{class:"fas fa-exclamation-triangle text-sm text-white"})]),e("div",{class:"ml-3"},[e("h5",{class:"mb-1 font-semibold text-amber-900"},"重要提醒"),e("p",{class:"text-sm text-amber-800"}," 这是您唯一能看到所有 API Key 的机会。关闭此窗口后，系统将不再显示完整的 API Key。请立即下载并妥善保存。 ")])])],-1)),e("div",wl,[e("div",hl,[e("div",$l,[e("div",null,[a[3]||(a[3]=e("p",{class:"text-xs font-medium text-blue-600"},"创建数量",-1)),e("p",Al,g(_.apiKeys.length),1)]),a[4]||(a[4]=e("div",{class:"flex h-10 w-10 items-center justify-center rounded-lg bg-blue-500 bg-opacity-20"},[e("i",{class:"fas fa-key text-blue-600"})],-1))])]),e("div",Cl,[e("div",Il,[e("div",null,[a[5]||(a[5]=e("p",{class:"text-xs font-medium text-green-600"},"基础名称",-1)),e("p",Kl,g($.value),1)]),a[6]||(a[6]=e("div",{class:"flex h-10 w-10 items-center justify-center rounded-lg bg-green-500 bg-opacity-20"},[e("i",{class:"fas fa-tag text-green-600"})],-1))])]),e("div",_l,[e("div",Dl,[e("div",null,[a[7]||(a[7]=e("p",{class:"text-xs font-medium text-purple-600"},"权限范围",-1)),e("p",Ll,g(k()),1)]),a[8]||(a[8]=e("div",{class:"flex h-10 w-10 items-center justify-center rounded-lg bg-purple-500 bg-opacity-20"},[e("i",{class:"fas fa-shield-alt text-purple-600"})],-1))])]),e("div",Ml,[e("div",Tl,[e("div",null,[a[9]||(a[9]=e("p",{class:"text-xs font-medium text-orange-600"},"过期时间",-1)),e("p",Sl,g(U()),1)]),a[10]||(a[10]=e("div",{class:"flex h-10 w-10 items-center justify-center rounded-lg bg-orange-500 bg-opacity-20"},[e("i",{class:"fas fa-clock text-orange-600"})],-1))])])]),e("div",jl,[e("div",Vl,[a[12]||(a[12]=e("label",{class:"text-sm font-semibold text-gray-700"},"API Keys 预览",-1)),e("div",Rl,[e("button",{class:"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800",type:"button",onClick:S},[e("i",{class:G(["fas",V.value?"fa-eye-slash":"fa-eye"])},null,2),T(" "+g(V.value?"隐藏":"显示")+"预览 ",1)]),a[11]||(a[11]=e("span",{class:"text-xs text-gray-500"},"（最多显示前10个）",-1))])]),V.value?(r(),o("div",El,[e("pre",Ul,g(W()),1)])):w("",!0)]),e("div",{class:"flex gap-3"},[e("button",{class:"btn btn-primary flex flex-1 items-center justify-center gap-2 px-6 py-3 font-semibold",onClick:R},[...a[13]||(a[13]=[e("i",{class:"fas fa-download"},null,-1),T(" 下载所有 API Keys ",-1)])]),e("button",{class:"rounded-xl border border-gray-300 bg-gray-200 px-6 py-3 font-semibold text-gray-800 transition-colors hover:bg-gray-300",onClick:h}," 我已保存 ")]),a[15]||(a[15]=e("div",{class:"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-3"},[e("p",{class:"flex items-start text-xs text-blue-700"},[e("i",{class:"fas fa-info-circle mr-2 mt-0.5 flex-shrink-0"}),e("span",null," 下载的文件格式为文本文件（.txt），每行包含一个 API Key。 请将文件保存在安全的位置，避免泄露。 ")])],-1))])])]))}},Ol=xe(Pl,[["__scopeId","data-v-b0b904b9"]]),Gl={class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},ql={class:"modal-content mx-auto flex max-h-[90vh] w-full max-w-4xl flex-col p-4 sm:p-6 md:p-8"},Bl={class:"mb-4 flex items-center justify-between sm:mb-6"},Wl={class:"flex items-center gap-2 sm:gap-3"},Fl={class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"},zl={class:"rounded-lg bg-blue-50 p-4 dark:bg-blue-900/20"},Yl={class:"flex items-start gap-3"},Hl={class:"mt-1 text-sm text-blue-700 dark:text-blue-400"},Nl={class:"space-y-4"},Ql={class:"flex flex-wrap gap-4"},Jl={class:"flex cursor-pointer items-center"},Xl={class:"flex cursor-pointer items-center"},Zl={class:"flex cursor-pointer items-center"},eo={class:"flex cursor-pointer items-center"},to={key:0,class:"space-y-3"},so={key:0},ao={class:"mb-2 text-xs font-medium text-gray-600 dark:text-gray-400"},ro={class:"flex flex-wrap gap-2"},lo=["onClick"],oo={key:1},no={class:"flex flex-wrap gap-2"},io=["onClick"],uo={class:"flex gap-2"},co=["onKeypress"],go={class:"rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-700 dark:bg-blue-900/20"},mo={class:"space-y-2"},xo={class:"grid grid-cols-1 gap-2 lg:grid-cols-3"},po={class:"mb-3 flex items-center gap-4"},yo={class:"flex gap-4"},bo={class:"flex cursor-pointer items-center"},fo={class:"flex cursor-pointer items-center"},vo={class:"flex cursor-pointer items-center"},ko={class:"flex flex-wrap gap-4"},wo={class:"flex cursor-pointer items-center"},ho={class:"flex cursor-pointer items-center"},$o={class:"flex cursor-pointer items-center"},Ao={class:"flex cursor-pointer items-center"},Co={class:"flex cursor-pointer items-center"},Io={class:"mb-3 flex items-center justify-between"},Ko=["disabled"],_o={class:"grid grid-cols-1 gap-3"},Do=["disabled"],Lo={key:0,label:"账号分组"},Mo=["value"],To={key:1,label:"专属账号"},So=["value"],jo=["disabled"],Vo={key:0,label:"账号分组"},Ro=["value"],Eo={key:1,label:"专属账号"},Uo=["value"],Po=["disabled"],Oo={key:0,label:"账号分组"},Go=["value"],qo={key:1,label:"专属账号"},Bo=["value"],Wo=["disabled"],Fo={key:0,label:"专属账号"},zo=["value"],Yo={class:"flex gap-3 pt-4"},Ho=["disabled"],No={key:0,class:"loading-spinner mr-2"},Qo={key:1,class:"fas fa-save mr-2"},Jo={__name:"BatchEditApiKeyModal",props:{selectedKeys:{type:Array,required:!0},accounts:{type:Object,default:()=>({claude:[],gemini:[],openai:[],bedrock:[]})}},emits:["close","success"],setup(_,{emit:Q}){const x=_,K=Q,V=Fe(),$=D(!1),k=D(!1),U=D({claude:[],gemini:[],openai:[],bedrock:[],claudeGroups:[],geminiGroups:[],openaiGroups:[]}),S=D(""),W=D([]),R=D("none"),h=F(()=>x.selectedKeys.length),f=F(()=>W.value.filter(b=>!m.tags.includes(b))),m=Te({tokenLimit:"",rateLimitWindow:"",rateLimitRequests:"",concurrencyLimit:"",dailyCostLimit:"",permissions:"",claudeAccountId:"",geminiAccountId:"",openaiAccountId:"",bedrockAccountId:"",tags:[],isActive:null}),a=()=>{if(S.value&&S.value.trim()){const b=S.value.trim();m.tags.includes(b)||m.tags.push(b),S.value=""}},d=b=>{m.tags.includes(b)||m.tags.push(b)},j=b=>{m.tags.splice(b,1)},L=async()=>{var b,c;k.value=!0;try{const[n,I,oe,de,O,l]=await Promise.all([z.get("/admin/claude-accounts"),z.get("/admin/claude-console-accounts"),z.get("/admin/gemini-accounts"),z.get("/admin/openai-accounts"),z.get("/admin/bedrock-accounts"),z.get("/admin/account-groups")]),p=[];if(n.success&&((b=n.data)==null||b.forEach(C=>{p.push({...C,platform:"claude-oauth",isDedicated:C.accountType==="dedicated"})})),I.success&&((c=I.data)==null||c.forEach(C=>{p.push({...C,platform:"claude-console",isDedicated:C.accountType==="dedicated"})})),U.value.claude=p,oe.success&&(U.value.gemini=(oe.data||[]).map(C=>({...C,isDedicated:C.accountType==="dedicated"}))),de.success&&(U.value.openai=(de.data||[]).map(C=>({...C,isDedicated:C.accountType==="dedicated"}))),O.success&&(U.value.bedrock=(O.data||[]).map(C=>({...C,isDedicated:C.accountType==="dedicated"}))),l.success){const C=l.data||[];U.value.claudeGroups=C.filter(X=>X.platform==="claude"),U.value.geminiGroups=C.filter(X=>X.platform==="gemini"),U.value.openaiGroups=C.filter(X=>X.platform==="openai")}q("账号列表已刷新","success")}catch{q("刷新账号列表失败","error")}finally{k.value=!1}},y=async()=>{$.value=!0;try{const b={};m.tokenLimit!==""&&m.tokenLimit!==null&&(b.tokenLimit=parseInt(m.tokenLimit)),m.rateLimitWindow!==""&&m.rateLimitWindow!==null&&(b.rateLimitWindow=parseInt(m.rateLimitWindow)),m.rateLimitRequests!==""&&m.rateLimitRequests!==null&&(b.rateLimitRequests=parseInt(m.rateLimitRequests)),m.concurrencyLimit!==""&&m.concurrencyLimit!==null&&(b.concurrencyLimit=parseInt(m.concurrencyLimit)),m.dailyCostLimit!==""&&m.dailyCostLimit!==null&&(b.dailyCostLimit=parseFloat(m.dailyCostLimit)),m.permissions!==""&&(b.permissions=m.permissions),m.claudeAccountId!==""&&(m.claudeAccountId==="SHARED_POOL"?(b.claudeAccountId=null,b.claudeConsoleAccountId=null):m.claudeAccountId.startsWith("console:")?(b.claudeConsoleAccountId=m.claudeAccountId.substring(8),b.claudeAccountId=null):(m.claudeAccountId.startsWith("group:"),b.claudeAccountId=m.claudeAccountId,b.claudeConsoleAccountId=null)),m.geminiAccountId!==""&&(m.geminiAccountId==="SHARED_POOL"?b.geminiAccountId=null:b.geminiAccountId=m.geminiAccountId),m.openaiAccountId!==""&&(m.openaiAccountId==="SHARED_POOL"?b.openaiAccountId=null:b.openaiAccountId=m.openaiAccountId),m.bedrockAccountId!==""&&(m.bedrockAccountId==="SHARED_POOL"?b.bedrockAccountId=null:b.bedrockAccountId=m.bedrockAccountId),m.isActive!==null&&(b.isActive=m.isActive),R.value!=="none"&&(b.tags=m.tags,b.tagOperation=R.value);const c=await z.put("/admin/api-keys/batch",{keyIds:x.selectedKeys,updates:b});if(c.success){const{successCount:n,failedCount:I,errors:oe}=c.data;if(n>0){if(q(`成功批量编辑 ${n} 个 API Keys`,"success"),I>0){const de=oe.map(O=>`${O.keyId}: ${O.error}`).join(`
`);q(`${I} 个编辑失败:
${de}`,"warning")}}else q("所有 API Keys 编辑失败","error");K("success"),K("close")}else q(c.message||"批量编辑失败","error")}catch(b){q("批量编辑失败","error"),console.error("批量编辑 API Keys 失败:",b)}finally{$.value=!1}};return Me(async()=>{W.value=await V.fetchTags(),x.accounts&&(U.value={claude:x.accounts.claude||[],gemini:x.accounts.gemini||[],openai:x.accounts.openai||[],bedrock:x.accounts.bedrock||[],claudeGroups:x.accounts.claudeGroups||[],geminiGroups:x.accounts.geminiGroups||[],openaiGroups:x.accounts.openaiGroups||[]})}),(b,c)=>(r(),le(fe,{to:"body"},[e("div",Gl,[e("div",ql,[e("div",Bl,[e("div",Wl,[c[24]||(c[24]=e("div",{class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 sm:h-10 sm:w-10 sm:rounded-xl"},[e("i",{class:"fas fa-edit text-sm text-white sm:text-base"})],-1)),e("h3",Fl," 批量编辑 API Keys ("+g(h.value)+" 个) ",1)]),e("button",{class:"p-1 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",onClick:c[0]||(c[0]=n=>b.$emit("close"))},[...c[25]||(c[25]=[e("i",{class:"fas fa-times text-lg sm:text-xl"},null,-1)])])]),e("form",{class:"modal-scroll-content custom-scrollbar flex-1 space-y-4 sm:space-y-6",onSubmit:me(y,["prevent"])},[e("div",zl,[e("div",Yl,[c[27]||(c[27]=e("i",{class:"fas fa-info-circle mt-1 text-blue-500"},null,-1)),e("div",null,[c[26]||(c[26]=e("p",{class:"text-sm font-medium text-blue-800 dark:text-blue-300"},"批量编辑说明",-1)),e("p",Hl," 以下设置将应用到所选的 "+g(h.value)+" 个 API Key。只有填写或修改的字段才会被更新，空白字段将保持原值不变。 ",1)])])]),e("div",null,[c[37]||(c[37]=e("label",{class:"mb-1.5 block text-xs font-semibold text-gray-700 dark:text-gray-300 sm:mb-3 sm:text-sm"}," 标签 (批量操作) ",-1)),e("div",Nl,[e("div",Ql,[e("label",Jl,[M(e("input",{"onUpdate:modelValue":c[1]||(c[1]=n=>R.value=n),class:"mr-2",type:"radio",value:"replace"},null,512),[[ae,R.value]]),c[28]||(c[28]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"替换标签",-1))]),e("label",Xl,[M(e("input",{"onUpdate:modelValue":c[2]||(c[2]=n=>R.value=n),class:"mr-2",type:"radio",value:"add"},null,512),[[ae,R.value]]),c[29]||(c[29]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"添加标签",-1))]),e("label",Zl,[M(e("input",{"onUpdate:modelValue":c[3]||(c[3]=n=>R.value=n),class:"mr-2",type:"radio",value:"remove"},null,512),[[ae,R.value]]),c[30]||(c[30]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"移除标签",-1))]),e("label",eo,[M(e("input",{"onUpdate:modelValue":c[4]||(c[4]=n=>R.value=n),class:"mr-2",type:"radio",value:"none"},null,512),[[ae,R.value]]),c[31]||(c[31]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"不修改标签",-1))])]),R.value!=="none"?(r(),o("div",to,[m.tags.length>0?(r(),o("div",so,[e("div",ao,g(R.value==="replace"?"新标签列表:":R.value==="add"?"要添加的标签:":"要移除的标签:"),1),e("div",ro,[(r(!0),o(Y,null,N(m.tags,(n,I)=>(r(),o("span",{key:"selected-"+I,class:"inline-flex items-center gap-1 rounded-full bg-blue-100 px-3 py-1 text-sm text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"},[T(g(n)+" ",1),e("button",{class:"ml-1 hover:text-blue-900",type:"button",onClick:oe=>j(I)},[...c[32]||(c[32]=[e("i",{class:"fas fa-times text-xs"},null,-1)])],8,lo)]))),128))])])):w("",!0),f.value.length>0?(r(),o("div",oo,[c[34]||(c[34]=e("div",{class:"mb-2 text-xs font-medium text-gray-600 dark:text-gray-400"}," 点击选择已有标签: ",-1)),e("div",no,[(r(!0),o(Y,null,N(f.value,n=>(r(),o("button",{key:"available-"+n,class:"inline-flex items-center gap-1 rounded-full bg-gray-100 px-3 py-1 text-sm text-gray-700 transition-colors hover:bg-blue-100 hover:text-blue-700 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-blue-900/30 dark:hover:text-blue-300",type:"button",onClick:I=>d(n)},[c[33]||(c[33]=e("i",{class:"fas fa-tag text-xs text-gray-500 dark:text-gray-400"},null,-1)),T(" "+g(n),1)],8,io))),128))])])):w("",!0),e("div",null,[c[36]||(c[36]=e("div",{class:"mb-2 text-xs font-medium text-gray-600 dark:text-gray-400"}," 创建新标签: ",-1)),e("div",uo,[M(e("input",{"onUpdate:modelValue":c[5]||(c[5]=n=>S.value=n),class:"form-input flex-1 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",placeholder:"输入新标签名称",type:"text",onKeypress:Ee(me(a,["prevent"]),["enter"])},null,40,co),[[Z,S.value]]),e("button",{class:"rounded-lg bg-green-500 px-4 py-2 text-white transition-colors hover:bg-green-600 dark:bg-green-600 dark:hover:bg-green-700",type:"button",onClick:a},[...c[35]||(c[35]=[e("i",{class:"fas fa-plus"},null,-1)])])])])])):w("",!0)])]),e("div",go,[c[41]||(c[41]=e("div",{class:"mb-2 flex items-center gap-2"},[e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded bg-blue-500"},[e("i",{class:"fas fa-tachometer-alt text-xs text-white"})]),e("h4",{class:"text-sm font-semibold text-gray-800 dark:text-gray-200"},"速率限制设置")],-1)),e("div",mo,[e("div",xo,[e("div",null,[c[38]||(c[38]=e("label",{class:"mb-1 block text-xs font-medium text-gray-700 dark:text-gray-300"}," 时间窗口 (分钟) ",-1)),M(e("input",{"onUpdate:modelValue":c[6]||(c[6]=n=>m.rateLimitWindow=n),class:"form-input w-full text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",min:"1",placeholder:"不修改",type:"number"},null,512),[[Z,m.rateLimitWindow]])]),e("div",null,[c[39]||(c[39]=e("label",{class:"mb-1 block text-xs font-medium text-gray-700 dark:text-gray-300"},"请求次数限制",-1)),M(e("input",{"onUpdate:modelValue":c[7]||(c[7]=n=>m.rateLimitRequests=n),class:"form-input w-full text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",min:"1",placeholder:"不修改",type:"number"},null,512),[[Z,m.rateLimitRequests]])]),e("div",null,[c[40]||(c[40]=e("label",{class:"mb-1 block text-xs font-medium text-gray-700 dark:text-gray-300"},"Token 限制",-1)),M(e("input",{"onUpdate:modelValue":c[8]||(c[8]=n=>m.tokenLimit=n),class:"form-input w-full text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",placeholder:"不修改",type:"number"},null,512),[[Z,m.tokenLimit]])])])])]),e("div",null,[c[42]||(c[42]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"}," 每日费用限制 (美元) ",-1)),M(e("input",{"onUpdate:modelValue":c[9]||(c[9]=n=>m.dailyCostLimit=n),class:"form-input w-full dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",min:"0",placeholder:"不修改 (0 表示无限制)",step:"0.01",type:"number"},null,512),[[Z,m.dailyCostLimit]])]),e("div",null,[c[43]||(c[43]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"并发限制",-1)),M(e("input",{"onUpdate:modelValue":c[10]||(c[10]=n=>m.concurrencyLimit=n),class:"form-input w-full dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",min:"0",placeholder:"不修改 (0 表示无限制)",type:"number"},null,512),[[Z,m.concurrencyLimit]])]),e("div",null,[e("div",po,[c[47]||(c[47]=e("label",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},"激活状态",-1)),e("div",yo,[e("label",bo,[M(e("input",{"onUpdate:modelValue":c[11]||(c[11]=n=>m.isActive=n),class:"mr-2",type:"radio",value:!0},null,512),[[ae,m.isActive]]),c[44]||(c[44]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"激活",-1))]),e("label",fo,[M(e("input",{"onUpdate:modelValue":c[12]||(c[12]=n=>m.isActive=n),class:"mr-2",type:"radio",value:!1},null,512),[[ae,m.isActive]]),c[45]||(c[45]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"禁用",-1))]),e("label",vo,[M(e("input",{"onUpdate:modelValue":c[13]||(c[13]=n=>m.isActive=n),class:"mr-2",type:"radio",value:null},null,512),[[ae,m.isActive]]),c[46]||(c[46]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"不修改",-1))])])])]),e("div",null,[c[53]||(c[53]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"服务权限",-1)),e("div",ko,[e("label",wo,[M(e("input",{"onUpdate:modelValue":c[14]||(c[14]=n=>m.permissions=n),class:"mr-2",type:"radio",value:""},null,512),[[ae,m.permissions]]),c[48]||(c[48]=e("span",{class:"text-sm text-gray-700"},"不修改",-1))]),e("label",ho,[M(e("input",{"onUpdate:modelValue":c[15]||(c[15]=n=>m.permissions=n),class:"mr-2",type:"radio",value:"all"},null,512),[[ae,m.permissions]]),c[49]||(c[49]=e("span",{class:"text-sm text-gray-700"},"全部服务",-1))]),e("label",$o,[M(e("input",{"onUpdate:modelValue":c[16]||(c[16]=n=>m.permissions=n),class:"mr-2",type:"radio",value:"claude"},null,512),[[ae,m.permissions]]),c[50]||(c[50]=e("span",{class:"text-sm text-gray-700"},"仅 Claude",-1))]),e("label",Ao,[M(e("input",{"onUpdate:modelValue":c[17]||(c[17]=n=>m.permissions=n),class:"mr-2",type:"radio",value:"gemini"},null,512),[[ae,m.permissions]]),c[51]||(c[51]=e("span",{class:"text-sm text-gray-700"},"仅 Gemini",-1))]),e("label",Co,[M(e("input",{"onUpdate:modelValue":c[18]||(c[18]=n=>m.permissions=n),class:"mr-2",type:"radio",value:"openai"},null,512),[[ae,m.permissions]]),c[52]||(c[52]=e("span",{class:"text-sm text-gray-700"},"仅 OpenAI",-1))])])]),e("div",null,[e("div",Io,[c[54]||(c[54]=e("label",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},"专属账号绑定",-1)),e("button",{class:"flex items-center gap-1 text-sm text-blue-600 transition-colors hover:text-blue-800 disabled:cursor-not-allowed disabled:opacity-50 dark:text-blue-400 dark:hover:text-blue-300",disabled:k.value,title:"刷新账号列表",type:"button",onClick:L},[e("i",{class:G(["fas",k.value?"fa-spinner fa-spin":"fa-sync-alt","text-xs"])},null,2),e("span",null,g(k.value?"刷新中...":"刷新账号"),1)],8,Ko)]),e("div",_o,[e("div",null,[c[57]||(c[57]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"Claude 专属账号",-1)),M(e("select",{"onUpdate:modelValue":c[19]||(c[19]=n=>m.claudeAccountId=n),class:"form-input w-full dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",disabled:m.permissions==="gemini"||m.permissions==="openai"},[c[55]||(c[55]=e("option",{value:""},"不修改",-1)),c[56]||(c[56]=e("option",{value:"SHARED_POOL"},"使用共享账号池",-1)),U.value.claudeGroups.length>0?(r(),o("optgroup",Lo,[(r(!0),o(Y,null,N(U.value.claudeGroups,n=>(r(),o("option",{key:n.id,value:`group:${n.id}`}," 分组 - "+g(n.name),9,Mo))),128))])):w("",!0),U.value.claude.length>0?(r(),o("optgroup",To,[(r(!0),o(Y,null,N(U.value.claude,n=>(r(),o("option",{key:n.id,value:n.platform==="claude-console"?`console:${n.id}`:n.id},g(n.name)+" ("+g(n.platform==="claude-console"?"Console":"OAuth")+") ",9,So))),128))])):w("",!0)],8,Do),[[ge,m.claudeAccountId]])]),e("div",null,[c[60]||(c[60]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"Gemini 专属账号",-1)),M(e("select",{"onUpdate:modelValue":c[20]||(c[20]=n=>m.geminiAccountId=n),class:"form-input w-full dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",disabled:m.permissions==="claude"||m.permissions==="openai"},[c[58]||(c[58]=e("option",{value:""},"不修改",-1)),c[59]||(c[59]=e("option",{value:"SHARED_POOL"},"使用共享账号池",-1)),U.value.geminiGroups.length>0?(r(),o("optgroup",Vo,[(r(!0),o(Y,null,N(U.value.geminiGroups,n=>(r(),o("option",{key:n.id,value:`group:${n.id}`}," 分组 - "+g(n.name),9,Ro))),128))])):w("",!0),U.value.gemini.length>0?(r(),o("optgroup",Eo,[(r(!0),o(Y,null,N(U.value.gemini,n=>(r(),o("option",{key:n.id,value:n.id},g(n.name),9,Uo))),128))])):w("",!0)],8,jo),[[ge,m.geminiAccountId]])]),e("div",null,[c[63]||(c[63]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"OpenAI 专属账号",-1)),M(e("select",{"onUpdate:modelValue":c[21]||(c[21]=n=>m.openaiAccountId=n),class:"form-input w-full dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",disabled:m.permissions==="claude"||m.permissions==="gemini"},[c[61]||(c[61]=e("option",{value:""},"不修改",-1)),c[62]||(c[62]=e("option",{value:"SHARED_POOL"},"使用共享账号池",-1)),U.value.openaiGroups.length>0?(r(),o("optgroup",Oo,[(r(!0),o(Y,null,N(U.value.openaiGroups,n=>(r(),o("option",{key:n.id,value:`group:${n.id}`}," 分组 - "+g(n.name),9,Go))),128))])):w("",!0),U.value.openai.length>0?(r(),o("optgroup",qo,[(r(!0),o(Y,null,N(U.value.openai,n=>(r(),o("option",{key:n.id,value:n.id},g(n.name),9,Bo))),128))])):w("",!0)],8,Po),[[ge,m.openaiAccountId]])]),e("div",null,[c[66]||(c[66]=e("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"},"Bedrock 专属账号",-1)),M(e("select",{"onUpdate:modelValue":c[22]||(c[22]=n=>m.bedrockAccountId=n),class:"form-input w-full dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",disabled:m.permissions==="gemini"||m.permissions==="openai"},[c[64]||(c[64]=e("option",{value:""},"不修改",-1)),c[65]||(c[65]=e("option",{value:"SHARED_POOL"},"使用共享账号池",-1)),U.value.bedrock.length>0?(r(),o("optgroup",Fo,[(r(!0),o(Y,null,N(U.value.bedrock,n=>(r(),o("option",{key:n.id,value:n.id},g(n.name),9,zo))),128))])):w("",!0)],8,Wo),[[ge,m.bedrockAccountId]])])])]),e("div",Yo,[e("button",{class:"flex-1 rounded-xl bg-gray-100 px-6 py-3 font-semibold text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",type:"button",onClick:c[23]||(c[23]=n=>b.$emit("close"))}," 取消 "),e("button",{class:"btn btn-primary flex-1 px-6 py-3 font-semibold",disabled:$.value,type:"submit"},[$.value?(r(),o("div",No)):(r(),o("i",Qo)),T(" "+g($.value?"保存中...":"批量保存"),1)],8,Ho)])],32)])])]))}},Xo=xe(Jo,[["__scopeId","data-v-be660ab9"]]),Zo={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-4"},en={class:"modal-content relative mx-auto w-full max-w-lg p-8"},tn={class:"mb-6 flex items-center justify-between"},sn={class:"flex items-center gap-3"},an={class:"text-sm text-gray-600 dark:text-gray-400"},rn={class:"space-y-6"},ln={class:"rounded-lg border border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100 p-4 dark:border-gray-600 dark:from-gray-700 dark:to-gray-800"},on={class:"flex items-center justify-between"},nn={class:"text-sm font-semibold text-gray-800 dark:text-gray-200"},dn={class:"flex h-12 w-12 items-center justify-center rounded-lg bg-white shadow-sm dark:bg-gray-700"},un={class:"mb-3 grid grid-cols-3 gap-2"},cn=["onClick"],gn={key:0,class:"animate-fadeIn"},mn=["min"],xn={key:1,class:"rounded-lg border border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-4 dark:border-blue-700 dark:from-blue-900/20 dark:to-indigo-900/20"},pn={class:"flex items-center justify-between"},yn={class:"text-sm font-semibold text-blue-900 dark:text-blue-200"},bn={class:"flex gap-3 pt-2"},fn=["disabled"],vn={key:0,class:"loading-spinner mr-2"},kn={key:1,class:"fas fa-save mr-2"},wn={__name:"ExpiryEditModal",props:{show:{type:Boolean,required:!0},apiKey:{type:Object,required:!0}},emits:["close","save"],setup(_,{expose:Q,emit:x}){const K=_,V=x,$=D(!1),k=Te({expireDuration:"",customExpireDate:"",expiresAt:null}),U=[{value:"",label:"永不过期"},{value:"1d",label:"1 天"},{value:"7d",label:"7 天"},{value:"30d",label:"30 天"},{value:"90d",label:"90 天"},{value:"180d",label:"180 天"},{value:"365d",label:"1 年"},{value:"730d",label:"2 年"}],S=F(()=>{const L=new Date;return L.setMinutes(L.getMinutes()+1),L.toISOString().slice(0,16)});we(()=>K.show,L=>{L&&W()}),we(()=>{var L;return(L=K.apiKey)==null?void 0:L.id},L=>{L&&K.show&&W()});const W=()=>{$.value=!1,K.apiKey.expiresAt?(k.expireDuration="custom",k.customExpireDate=new Date(K.apiKey.expiresAt).toISOString().slice(0,16),k.expiresAt=K.apiKey.expiresAt):(k.expireDuration="",k.customExpireDate="",k.expiresAt=null)},R=L=>{if(k.expireDuration=L,!L){k.expiresAt=null;return}if(L==="custom")return;const y=new Date,b=L.match(/(\d+)([dhmy])/);if(b){const[,c,n]=b,I=parseInt(c);switch(n){case"d":y.setDate(y.getDate()+I);break;case"h":y.setHours(y.getHours()+I);break;case"m":y.setMonth(y.getMonth()+I);break;case"y":y.setFullYear(y.getFullYear()+I);break}k.expiresAt=y.toISOString()}},h=()=>{k.customExpireDate&&(k.expiresAt=new Date(k.customExpireDate).toISOString())},f=L=>L?new Date(L).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",m=L=>L?new Date(L)<new Date:!1,a=L=>{if(!L)return null;const y=new Date,c=new Date(L)-y,n=Math.ceil(c/(1e3*60*60*24));return c<0?{text:"已过期",class:"text-red-600"}:n<=7?{text:`${n} 天后过期`,class:"text-orange-600"}:n<=30?{text:`${n} 天后过期`,class:"text-yellow-600"}:{text:`${Math.ceil(n/30)} 个月后过期`,class:"text-green-600"}},d=()=>{$.value=!0,V("save",{keyId:K.apiKey.id,expiresAt:k.expiresAt})};return Q({resetSaving:()=>{$.value=!1}}),(L,y)=>(r(),le(fe,{to:"body"},[_.show?(r(),o("div",Zo,[e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm",onClick:y[0]||(y[0]=b=>L.$emit("close"))}),e("div",en,[e("div",tn,[e("div",sn,[y[6]||(y[6]=e("div",{class:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-amber-500 to-orange-600"},[e("i",{class:"fas fa-clock text-white"})],-1)),e("div",null,[y[5]||(y[5]=e("h3",{class:"text-xl font-bold text-gray-900 dark:text-gray-100"},"修改过期时间",-1)),e("p",an,' 为 "'+g(_.apiKey.name||"API Key")+'" 设置新的过期时间 ',1)])]),e("button",{class:"text-gray-400 transition-colors hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",onClick:y[1]||(y[1]=b=>L.$emit("close"))},[...y[7]||(y[7]=[e("i",{class:"fas fa-times text-xl"},null,-1)])])]),e("div",rn,[e("div",ln,[e("div",on,[e("div",null,[y[10]||(y[10]=e("p",{class:"mb-1 text-xs font-medium text-gray-600 dark:text-gray-400"}," 当前过期时间 ",-1)),e("p",nn,[_.apiKey.expiresAt?(r(),o(Y,{key:0},[T(g(f(_.apiKey.expiresAt))+" ",1),a(_.apiKey.expiresAt)?(r(),o("span",{key:0,class:G(["ml-2 text-xs font-normal",a(_.apiKey.expiresAt).class])}," ("+g(a(_.apiKey.expiresAt).text)+") ",3)):w("",!0)],64)):(r(),o(Y,{key:1},[y[8]||(y[8]=e("i",{class:"fas fa-infinity mr-1 text-gray-500"},null,-1)),y[9]||(y[9]=T(" 永不过期 ",-1))],64))])]),e("div",dn,[e("i",{class:G(["fas fa-hourglass-half text-lg",_.apiKey.expiresAt&&m(_.apiKey.expiresAt)?"text-red-500":"text-gray-400"])},null,2)])])]),e("div",null,[y[12]||(y[12]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"选择新的期限",-1)),e("div",un,[(r(),o(Y,null,N(U,b=>e("button",{key:b.value,class:G(["rounded-lg px-3 py-2 text-sm font-medium transition-all",k.expireDuration===b.value?"bg-blue-500 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:c=>R(b.value)},g(b.label),11,cn)),64)),e("button",{class:G(["rounded-lg px-3 py-2 text-sm font-medium transition-all",k.expireDuration==="custom"?"bg-blue-500 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:y[2]||(y[2]=b=>R("custom"))},[...y[11]||(y[11]=[e("i",{class:"fas fa-calendar-alt mr-1"},null,-1),T(" 自定义 ",-1)])],2)])]),k.expireDuration==="custom"?(r(),o("div",gn,[y[13]||(y[13]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"选择日期和时间",-1)),M(e("input",{"onUpdate:modelValue":y[3]||(y[3]=b=>k.customExpireDate=b),class:"form-input w-full dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",min:S.value,type:"datetime-local",onChange:h},null,40,mn),[[Z,k.customExpireDate]]),y[14]||(y[14]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 选择一个未来的日期和时间作为过期时间 ",-1))])):w("",!0),k.expiresAt!==_.apiKey.expiresAt?(r(),o("div",xn,[e("div",pn,[e("div",null,[y[17]||(y[17]=e("p",{class:"mb-1 text-xs font-medium text-blue-700 dark:text-blue-400"},[e("i",{class:"fas fa-arrow-right mr-1"}),T(" 新的过期时间 ")],-1)),e("p",yn,[k.expiresAt?(r(),o(Y,{key:0},[T(g(f(k.expiresAt))+" ",1),a(k.expiresAt)?(r(),o("span",{key:0,class:G(["ml-2 text-xs font-normal",a(k.expiresAt).class])}," ("+g(a(k.expiresAt).text)+") ",3)):w("",!0)],64)):(r(),o(Y,{key:1},[y[15]||(y[15]=e("i",{class:"fas fa-infinity mr-1"},null,-1)),y[16]||(y[16]=T(" 永不过期 ",-1))],64))])]),y[18]||(y[18]=e("div",{class:"flex h-12 w-12 items-center justify-center rounded-lg bg-white shadow-sm dark:bg-gray-700"},[e("i",{class:"fas fa-check text-lg text-green-500"})],-1))])])):w("",!0),e("div",bn,[e("button",{class:"flex-1 rounded-lg bg-gray-100 px-4 py-2.5 font-semibold text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",onClick:y[4]||(y[4]=b=>L.$emit("close"))}," 取消 "),e("button",{class:"btn btn-primary flex-1 px-4 py-2.5 font-semibold",disabled:$.value||k.expiresAt===_.apiKey.expiresAt,onClick:d},[$.value?(r(),o("div",vn)):(r(),o("i",kn)),T(" "+g($.value?"保存中...":"保存更改"),1)],8,fn)])])])])):w("",!0)]))}},hn=xe(wn,[["__scopeId","data-v-ce7524cf"]]),$n={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},An={class:"modal-content relative mx-auto flex max-h-[90vh] w-[95%] max-w-2xl flex-col p-4 sm:w-full sm:max-w-3xl sm:p-6 md:p-8"},Cn={class:"mb-4 flex items-center justify-between sm:mb-6"},In={class:"flex items-center gap-2 sm:gap-3"},Kn={class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"},_n={class:"modal-scroll-content custom-scrollbar flex-1 overflow-y-auto"},Dn={class:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-2"},Ln={class:"rounded-lg border border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100 p-4 dark:border-blue-700 dark:from-blue-900/20 dark:to-blue-800/20"},Mn={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},Tn={class:"mt-1 text-xs text-gray-600 dark:text-gray-400"},Sn={class:"rounded-lg border border-green-200 bg-gradient-to-br from-green-50 to-green-100 p-4 dark:border-green-700 dark:from-green-900/20 dark:to-green-800/20"},jn={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},Vn={class:"mt-1 text-xs text-gray-600 dark:text-gray-400"},Rn={class:"rounded-lg border border-yellow-200 bg-gradient-to-br from-yellow-50 to-yellow-100 p-4 dark:border-yellow-700 dark:from-yellow-900/20 dark:to-yellow-800/20"},En={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},Un={class:"mt-1 text-xs text-gray-600 dark:text-gray-400"},Pn={class:"rounded-lg border border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100 p-4 dark:border-purple-700 dark:from-purple-900/20 dark:to-purple-800/20"},On={class:"space-y-1 text-sm"},Gn={class:"flex justify-between"},qn={class:"font-semibold text-gray-900 dark:text-gray-100"},Bn={class:"flex justify-between"},Wn={class:"font-semibold text-gray-900 dark:text-gray-100"},Fn={class:"mb-6"},zn={class:"space-y-3 rounded-lg bg-gray-50 p-4 dark:bg-gray-700/50"},Yn={class:"flex items-center justify-between"},Hn={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},Nn={class:"flex items-center justify-between"},Qn={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},Jn={key:0,class:"flex items-center justify-between"},Xn={class:"text-sm font-semibold text-purple-600"},Zn={key:1,class:"flex items-center justify-between"},ei={class:"text-sm font-semibold text-purple-600"},ti={key:0,class:"mb-6"},si={class:"space-y-3 rounded-lg bg-gray-50 p-4 dark:bg-gray-700/50"},ai={key:0,class:"space-y-2"},ri={class:"flex items-center justify-between text-sm"},li={class:"font-semibold text-gray-900 dark:text-gray-100"},oi={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-600"},ni={class:"text-right text-xs text-gray-500 dark:text-gray-400"},ii={key:1,class:"flex items-center justify-between text-sm"},di={class:"font-semibold text-purple-600"},ui={key:2,class:"space-y-2"},ci={__name:"UsageDetailModal",props:{show:{type:Boolean,required:!0},apiKey:{type:Object,required:!0}},emits:["close"],setup(_,{emit:Q}){const x=_,K=Q,V=F(()=>{var n,I;return((I=(n=x.apiKey.usage)==null?void 0:n.total)==null?void 0:I.requests)||0}),$=F(()=>{var n,I;return((I=(n=x.apiKey.usage)==null?void 0:n.daily)==null?void 0:I.requests)||0}),k=F(()=>{var n,I;return((I=(n=x.apiKey.usage)==null?void 0:n.total)==null?void 0:I.tokens)||0}),U=F(()=>{var n,I;return((I=(n=x.apiKey.usage)==null?void 0:n.daily)==null?void 0:I.tokens)||0}),S=F(()=>{var n,I;return((I=(n=x.apiKey.usage)==null?void 0:n.total)==null?void 0:I.cost)||0}),W=F(()=>x.apiKey.dailyCost||0),R=F(()=>{var n,I;return((I=(n=x.apiKey.usage)==null?void 0:n.total)==null?void 0:I.inputTokens)||0}),h=F(()=>{var n,I;return((I=(n=x.apiKey.usage)==null?void 0:n.total)==null?void 0:I.outputTokens)||0}),f=F(()=>{var n,I;return((I=(n=x.apiKey.usage)==null?void 0:n.total)==null?void 0:I.cacheCreateTokens)||0}),m=F(()=>{var n,I;return((I=(n=x.apiKey.usage)==null?void 0:n.total)==null?void 0:I.cacheReadTokens)||0}),a=F(()=>{var n,I;return((I=(n=x.apiKey.usage)==null?void 0:n.averages)==null?void 0:I.rpm)||0}),d=F(()=>{var n,I;return((I=(n=x.apiKey.usage)==null?void 0:n.averages)==null?void 0:I.tpm)||0}),j=F(()=>x.apiKey.dailyCostLimit>0||x.apiKey.concurrencyLimit>0||x.apiKey.rateLimitWindow>0||x.apiKey.tokenLimit>0),L=F(()=>!x.apiKey.dailyCostLimit||x.apiKey.dailyCostLimit===0?0:W.value/x.apiKey.dailyCostLimit*100),y=n=>!n&&n!==0?"0":n.toLocaleString("zh-CN"),b=n=>n>=1e6?(n/1e6).toFixed(1)+"M":n>=1e3?(n/1e3).toFixed(1)+"K":n.toString(),c=()=>{K("close")};return(n,I)=>(r(),le(fe,{to:"body"},[_.show?(r(),o("div",$n,[e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm",onClick:c}),e("div",An,[e("div",Cn,[e("div",In,[I[0]||(I[0]=e("div",{class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 sm:h-10 sm:w-10 sm:rounded-xl"},[e("i",{class:"fas fa-chart-line text-sm text-white sm:text-base"})],-1)),e("h3",Kn," 使用统计详情 - "+g(_.apiKey.name),1)]),e("button",{class:"p-1 text-gray-400 transition-colors hover:text-gray-600",onClick:c},[...I[1]||(I[1]=[e("i",{class:"fas fa-times text-lg sm:text-xl"},null,-1)])])]),e("div",_n,[e("div",Dn,[e("div",Ln,[I[2]||(I[2]=e("div",{class:"mb-3 flex items-center justify-between"},[e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"总请求数"),e("i",{class:"fas fa-paper-plane text-blue-500"})],-1)),e("div",Mn,g(y(V.value)),1),e("div",Tn," 今日: "+g(y($.value))+" 次 ",1)]),e("div",Sn,[I[3]||(I[3]=e("div",{class:"mb-3 flex items-center justify-between"},[e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"总Token数"),e("i",{class:"fas fa-coins text-green-500"})],-1)),e("div",jn,g(b(k.value)),1),e("div",Vn," 今日: "+g(b(U.value)),1)]),e("div",Rn,[I[4]||(I[4]=e("div",{class:"mb-3 flex items-center justify-between"},[e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"总费用"),e("i",{class:"fas fa-dollar-sign text-yellow-600"})],-1)),e("div",En," $"+g(S.value.toFixed(4)),1),e("div",Un," 今日: $"+g(W.value.toFixed(4)),1)]),e("div",Pn,[I[7]||(I[7]=e("div",{class:"mb-3 flex items-center justify-between"},[e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"平均速率"),e("i",{class:"fas fa-tachometer-alt text-purple-500"})],-1)),e("div",On,[e("div",Gn,[I[5]||(I[5]=e("span",{class:"text-gray-600 dark:text-gray-400"},"RPM:",-1)),e("span",qn,g(a.value),1)]),e("div",Bn,[I[6]||(I[6]=e("span",{class:"text-gray-600 dark:text-gray-400"},"TPM:",-1)),e("span",Wn,g(d.value),1)])])])]),e("div",Fn,[I[12]||(I[12]=e("h4",{class:"mb-3 flex items-center text-sm font-semibold text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-chart-pie mr-2 text-indigo-500"}),T(" Token 使用分布 ")],-1)),e("div",zn,[e("div",Yn,[I[8]||(I[8]=e("div",{class:"flex items-center"},[e("i",{class:"fas fa-arrow-down mr-2 text-green-500"}),e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"输入 Token")],-1)),e("span",Hn,g(b(R.value)),1)]),e("div",Nn,[I[9]||(I[9]=e("div",{class:"flex items-center"},[e("i",{class:"fas fa-arrow-up mr-2 text-blue-500"}),e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"输出 Token")],-1)),e("span",Qn,g(b(h.value)),1)]),f.value>0?(r(),o("div",Jn,[I[10]||(I[10]=e("div",{class:"flex items-center"},[e("i",{class:"fas fa-save mr-2 text-purple-500"}),e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"缓存创建 Token")],-1)),e("span",Xn,g(b(f.value)),1)])):w("",!0),m.value>0?(r(),o("div",Zn,[I[11]||(I[11]=e("div",{class:"flex items-center"},[e("i",{class:"fas fa-download mr-2 text-purple-500"}),e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"缓存读取 Token")],-1)),e("span",ei,g(b(m.value)),1)])):w("",!0)])]),j.value?(r(),o("div",ti,[I[16]||(I[16]=e("h4",{class:"mb-3 flex items-center text-sm font-semibold text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-shield-alt mr-2 text-red-500"}),T(" 限制设置 ")],-1)),e("div",si,[_.apiKey.dailyCostLimit>0?(r(),o("div",ai,[e("div",ri,[I[13]||(I[13]=e("span",{class:"text-gray-600 dark:text-gray-400"},"每日费用限制",-1)),e("span",li," $"+g(_.apiKey.dailyCostLimit.toFixed(2)),1)]),e("div",oi,[e("div",{class:G(["h-2 rounded-full transition-all duration-300",L.value>=100?"bg-red-500":L.value>=80?"bg-yellow-500":"bg-green-500"]),style:Le({width:Math.min(L.value,100)+"%"})},null,6)]),e("div",ni," 已使用 "+g(L.value.toFixed(1))+"% ",1)])):w("",!0),_.apiKey.concurrencyLimit>0?(r(),o("div",ii,[I[14]||(I[14]=e("span",{class:"text-gray-600 dark:text-gray-400"},"并发限制",-1)),e("span",di,g(_.apiKey.currentConcurrency||0)+" / "+g(_.apiKey.concurrencyLimit),1)])):w("",!0),_.apiKey.rateLimitWindow>0?(r(),o("div",ui,[I[15]||(I[15]=e("h5",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-clock mr-1 text-blue-500"}),T(" 时间窗口限制 ")],-1)),ie(Be,{"current-requests":_.apiKey.currentWindowRequests,"current-tokens":_.apiKey.currentWindowTokens,label:"窗口状态","rate-limit-window":_.apiKey.rateLimitWindow,"request-limit":_.apiKey.rateLimitRequests,"show-progress":!0,"show-tooltip":!0,"token-limit":_.apiKey.tokenLimit,"window-end-time":_.apiKey.windowEndTime,"window-remaining-seconds":_.apiKey.windowRemainingSeconds,"window-start-time":_.apiKey.windowStartTime},null,8,["current-requests","current-tokens","rate-limit-window","request-limit","token-limit","window-end-time","window-remaining-seconds","window-start-time"])])):w("",!0)])])):w("",!0)]),e("div",{class:"mt-4 flex justify-end gap-2 sm:mt-6 sm:gap-3"},[e("button",{class:"btn btn-secondary px-4 py-2 text-sm",type:"button",onClick:c}," 关闭 ")])])])):w("",!0)]))}},gi=xe(ci,[["__scopeId","data-v-6679d647"]]),mi={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},xi={class:"modal-content mx-auto flex max-h-[90vh] w-full max-w-lg flex-col p-4 sm:p-6"},pi={class:"mb-4 flex items-center justify-between sm:mb-6"},yi={class:"mb-4 rounded-lg bg-gray-50 p-3 dark:bg-gray-800 sm:mb-6"},bi={class:"flex items-center gap-2"},fi={class:"font-medium text-gray-700 dark:text-gray-300"},vi=["disabled"],ki={key:0,label:"OAuth 账户"},wi=["value"],hi={key:1,label:"Console 账户"},$i=["value"],Ai=["disabled"],Ci=["value"],Ii=["disabled"],Ki=["value"],_i=["disabled"],Di=["value"],Li={class:"flex gap-3 pt-4"},Mi=["disabled"],Ti={key:0,class:"loading-spinner mr-2"},Si={key:1,class:"fas fa-save mr-2"},ji={__name:"QuickBindModal",props:{apiKey:{type:Object,required:!0},accounts:{type:Object,default:()=>({claude:[],gemini:[],openai:[],bedrock:[]})},show:{type:Boolean,default:!1}},emits:["close","success"],setup(_,{emit:Q}){const x=_,K=Q,V=D(!1),$=Te({claudeAccountId:"",geminiAccountId:"",openaiAccountId:"",bedrockAccountId:""}),k=F(()=>(x.accounts.claude||[]).filter(y=>y.accountType==="dedicated"&&y.platform==="claude-oauth")),U=F(()=>(x.accounts.claude||[]).filter(y=>y.accountType==="dedicated"&&y.platform==="claude-console")),S=F(()=>(x.accounts.gemini||[]).filter(y=>y.accountType==="dedicated")),W=F(()=>(x.accounts.openai||[]).filter(y=>y.accountType==="dedicated")),R=F(()=>(x.accounts.bedrock||[]).filter(y=>y.accountType==="dedicated")),h=F(()=>k.value.length>0||U.value.length>0),f=F(()=>S.value.length>0),m=F(()=>W.value.length>0),a=F(()=>R.value.length>0),d=y=>{if(!y)return"未知";if(y.isActive===!1)switch(y.status){case"unauthorized":return"未授权";case"error":return"Token错误";case"created":return"待验证";case"rate_limited":return"限流中";default:return"异常"}return"正常"},j=()=>{x.apiKey&&(x.apiKey.claudeConsoleAccountId?$.claudeAccountId=`console:${x.apiKey.claudeConsoleAccountId}`:$.claudeAccountId=x.apiKey.claudeAccountId||"",$.geminiAccountId=x.apiKey.geminiAccountId||"",$.openaiAccountId=x.apiKey.openaiAccountId||"",$.bedrockAccountId=x.apiKey.bedrockAccountId||"")},L=async()=>{V.value=!0;try{const y={};$.claudeAccountId?$.claudeAccountId.startsWith("console:")?(y.claudeConsoleAccountId=$.claudeAccountId.substring(8),y.claudeAccountId=null):(y.claudeAccountId=$.claudeAccountId,y.claudeConsoleAccountId=null):(y.claudeAccountId=null,y.claudeConsoleAccountId=null),y.geminiAccountId=$.geminiAccountId||null,y.openaiAccountId=$.openaiAccountId||null,y.bedrockAccountId=$.bedrockAccountId||null;const b=await z.put(`/admin/api-keys/${x.apiKey.id}`,y);b.success?(q("专属账号绑定已更新","success"),K("success"),K("close")):q(b.message||"更新失败","error")}catch(y){console.error("保存绑定失败:",y),q("保存失败，请稍后重试","error")}finally{V.value=!1}};return we(()=>x.show,y=>{y&&j()},{immediate:!0}),we(()=>x.apiKey,()=>{x.show&&j()},{immediate:!0}),(y,b)=>{var c;return r(),le(fe,{to:"body"},[_.show?(r(),o("div",mi,[e("div",xi,[e("div",pi,[b[7]||(b[7]=e("div",{class:"flex items-center gap-2 sm:gap-3"},[e("div",{class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-purple-500 to-purple-600 sm:h-10 sm:w-10 sm:rounded-xl"},[e("i",{class:"fas fa-link text-sm text-white sm:text-base"})]),e("h3",{class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"}," 快速绑定专属账号 ")],-1)),e("button",{class:"p-1 text-gray-400 transition-colors hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",onClick:b[0]||(b[0]=n=>y.$emit("close"))},[...b[6]||(b[6]=[e("i",{class:"fas fa-times text-lg sm:text-xl"},null,-1)])])]),e("div",yi,[e("div",bi,[b[8]||(b[8]=e("i",{class:"fas fa-key text-gray-400"},null,-1)),e("span",fi,g(((c=_.apiKey)==null?void 0:c.name)||"API Key"),1)])]),e("form",{class:"modal-scroll-content custom-scrollbar flex-1 space-y-4",onSubmit:me(L,["prevent"])},[e("div",null,[b[10]||(b[10]=e("div",{class:"mb-2 flex items-center gap-2"},[e("div",{class:"flex h-5 w-5 items-center justify-center rounded bg-orange-500"},[e("i",{class:"fas fa-robot text-xs text-white"})]),e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," Claude 专属账号 ")],-1)),M(e("select",{"onUpdate:modelValue":b[1]||(b[1]=n=>$.claudeAccountId=n),class:"form-select w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",disabled:V.value||!h.value},[b[9]||(b[9]=e("option",{value:""},"使用共享池",-1)),k.value.length>0?(r(),o("optgroup",ki,[(r(!0),o(Y,null,N(k.value,n=>(r(),o("option",{key:n.id,value:n.id},g(n.name)+" (专属) - "+g(d(n)),9,wi))),128))])):w("",!0),U.value.length>0?(r(),o("optgroup",hi,[(r(!0),o(Y,null,N(U.value,n=>(r(),o("option",{key:n.id,value:`console:${n.id}`},g(n.name)+" (专属) - "+g(d(n)),9,$i))),128))])):w("",!0)],8,vi),[[ge,$.claudeAccountId]])]),e("div",null,[b[12]||(b[12]=e("div",{class:"mb-2 flex items-center gap-2"},[e("div",{class:"flex h-5 w-5 items-center justify-center rounded bg-blue-500"},[e("i",{class:"fas fa-gem text-xs text-white"})]),e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," Gemini 专属账号 ")],-1)),M(e("select",{"onUpdate:modelValue":b[2]||(b[2]=n=>$.geminiAccountId=n),class:"form-select w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",disabled:V.value||!f.value},[b[11]||(b[11]=e("option",{value:""},"使用共享池",-1)),(r(!0),o(Y,null,N(S.value,n=>(r(),o("option",{key:n.id,value:n.id},g(n.name)+" (专属) - "+g(d(n)),9,Ci))),128))],8,Ai),[[ge,$.geminiAccountId]])]),e("div",null,[b[14]||(b[14]=e("div",{class:"mb-2 flex items-center gap-2"},[e("div",{class:"flex h-5 w-5 items-center justify-center rounded bg-green-500"},[e("i",{class:"fas fa-brain text-xs text-white"})]),e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," OpenAI 专属账号 ")],-1)),M(e("select",{"onUpdate:modelValue":b[3]||(b[3]=n=>$.openaiAccountId=n),class:"form-select w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",disabled:V.value||!m.value},[b[13]||(b[13]=e("option",{value:""},"使用共享池",-1)),(r(!0),o(Y,null,N(W.value,n=>(r(),o("option",{key:n.id,value:n.id},g(n.name)+" (专属) - "+g(d(n)),9,Ki))),128))],8,Ii),[[ge,$.openaiAccountId]])]),e("div",null,[b[16]||(b[16]=e("div",{class:"mb-2 flex items-center gap-2"},[e("div",{class:"flex h-5 w-5 items-center justify-center rounded bg-amber-500"},[e("i",{class:"fas fa-aws text-xs text-white"})]),e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," Bedrock 专属账号 ")],-1)),M(e("select",{"onUpdate:modelValue":b[4]||(b[4]=n=>$.bedrockAccountId=n),class:"form-select w-full text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",disabled:V.value||!a.value},[b[15]||(b[15]=e("option",{value:""},"使用共享池",-1)),(r(!0),o(Y,null,N(R.value,n=>(r(),o("option",{key:n.id,value:n.id},g(n.name)+" (专属) - "+g(d(n)),9,Di))),128))],8,_i),[[ge,$.bedrockAccountId]])]),b[17]||(b[17]=e("div",{class:"rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},[e("div",{class:"flex items-start gap-2"},[e("i",{class:"fas fa-info-circle mt-0.5 text-sm text-blue-500"}),e("div",{class:"text-xs text-blue-700 dark:text-blue-300"},[e("p",{class:"font-medium"},"绑定说明："),e("ul",{class:"mt-1 space-y-0.5"},[e("li",null,"• 绑定专属账号后，该API Key的请求将只使用指定账号"),e("li",null,'• 选择"使用共享池"则使用系统的共享账号池'),e("li",null,'• 只有"专属"类型的账号才会显示在选项中')])])])],-1)),e("div",Li,[e("button",{class:"flex-1 rounded-xl bg-gray-100 px-6 py-3 font-semibold text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",type:"button",onClick:b[5]||(b[5]=n=>y.$emit("close"))}," 取消 "),e("button",{class:"btn btn-primary flex-1 px-6 py-3 font-semibold",disabled:V.value,type:"submit"},[V.value?(r(),o("div",Ti)):(r(),o("i",Si)),T(" "+g(V.value?"保存中...":"保存绑定"),1)],8,Mi)])],32)])])):w("",!0)])}}},Vi=xe(ji,[["__scopeId","data-v-23fe584d"]]),Ri={class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},Ei={class:"modal-content mx-auto flex max-h-[90vh] w-full max-w-2xl flex-col p-4 sm:p-6"},Ui={class:"mb-4 flex items-center justify-between"},Pi=["disabled"],Oi={class:"modal-scroll-content custom-scrollbar flex-1 space-y-6"},Gi={key:0,class:"rounded-lg border border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-4 dark:border-blue-700 dark:from-blue-900/20 dark:to-indigo-900/20"},qi={class:"mb-3 flex items-center justify-between"},Bi={class:"text-sm font-medium text-blue-700 dark:text-blue-300"},Wi={class:"text-sm text-blue-600 dark:text-blue-400"},Fi={class:"h-2 w-full overflow-hidden rounded-full bg-blue-200 dark:bg-blue-800"},zi={class:"space-y-3"},Yi={class:"grid grid-cols-2 gap-3"},Hi=["onUpdate:modelValue","disabled","value"],Ni={class:"flex items-center gap-3 rounded-lg border-2 border-gray-200 bg-white p-3 transition-all duration-200 hover:border-gray-300 peer-checked:border-emerald-500 peer-checked:bg-emerald-50 peer-checked:hover:border-emerald-600 dark:border-gray-600 dark:bg-gray-800 dark:hover:border-gray-500 dark:peer-checked:border-emerald-400 dark:peer-checked:bg-emerald-900/20"},Qi={class:"flex-1"},Ji={class:"font-medium text-gray-900 dark:text-gray-100"},Xi={class:"text-xs text-gray-500 dark:text-gray-400"},Zi={class:"space-y-3"},ed={class:"grid grid-cols-1 gap-3 sm:grid-cols-2"},td={class:"space-y-2"},sd=["disabled"],ad={class:"space-y-2"},rd=["disabled"],ld={class:"flex flex-wrap gap-2"},od=["disabled","onClick"],nd={class:"space-y-3"},id=["disabled"],dd={class:"space-y-3"},ud={class:"grid grid-cols-1 gap-3 sm:grid-cols-2"},cd={class:"space-y-2"},gd=["disabled"],md={class:"space-y-2"},xd=["disabled"],pd={class:"space-y-3"},yd=["disabled"],bd={class:"mt-6 flex flex-col gap-3 sm:flex-row sm:justify-end"},fd=["disabled"],vd=["disabled"],kd={class:"relative flex items-center gap-2"},wd={__name:"ExportApiKeysModal",props:{apiKeys:{type:Array,default:()=>[]}},emits:["close","export-complete"],setup(_,{emit:Q}){const x=Q,K=D(!1),V=D(0),$=D(""),k=D({format:"csv",startDate:Ke().subtract(30,"day").format("YYYY-MM-DD"),endDate:Ke().format("YYYY-MM-DD"),status:"",minUsage:"",maxUsage:"",search:""}),U=[{value:"csv",label:"CSV 文件",description:"纯文本格式，兼容性强",icon:"fas fa-file-csv",color:"text-blue-600"},{value:"xlsx",label:"Excel 文件",description:"支持多表格和格式化",icon:"fas fa-file-excel",color:"text-green-600"}],S=[{label:"最近7天",value:7},{label:"最近30天",value:30},{label:"最近90天",value:90},{label:"全部",value:0}];F(()=>k.value.startDate&&k.value.endDate&&Ke(k.value.startDate).isBefore(Ke(k.value.endDate)));const W=h=>{h===0?(k.value.startDate="2020-01-01",k.value.endDate=Ke().format("YYYY-MM-DD")):(k.value.startDate=Ke().subtract(h,"day").format("YYYY-MM-DD"),k.value.endDate=Ke().format("YYYY-MM-DD"))},R=async()=>{try{K.value=!0,V.value=0,$.value="准备导出数据...";const h=setInterval(()=>{V.value<90&&(V.value+=10)},200),f={format:k.value.format,dateFrom:k.value.startDate,dateTo:k.value.endDate};k.value.status&&(f.status=k.value.status),k.value.minUsage&&(f.minUsage=parseInt(k.value.minUsage)),k.value.maxUsage&&(f.maxUsage=parseInt(k.value.maxUsage)),k.value.search&&(f.search=k.value.search),$.value="正在导出数据...";const m=await qt.post("/admin/api-keys/export",f,{responseType:"blob",timeout:12e4});clearInterval(h),V.value=100,$.value="导出完成！";const a=m.headers["content-disposition"];let d=`api_keys_export_${Date.now()}.${k.value.format}`;if(a){const b=a.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);b&&(d=b[1].replace(/['"]/g,""))}const j=new Blob([m.data]),L=window.URL.createObjectURL(j),y=document.createElement("a");y.href=L,y.download=d,y.style.display="none",document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL(L),mt.success("数据导出完成！"),x("export-complete"),setTimeout(()=>{x("close")},1500)}catch(h){console.error("导出失败:",h);let f="导出失败，请重试";h.response?h.response.status===404?f="没有找到符合条件的数据":h.response.status===403?f="没有权限执行此操作":h.response.data&&h.response.data.message&&(f=h.response.data.message):h.code==="ECONNABORTED"&&(f="导出超时，请尝试缩小导出范围"),mt.error(f),K.value=!1,V.value=0,$.value=""}};return Me(()=>{W(30)}),(h,f)=>(r(),le(fe,{to:"body"},[e("div",Ri,[e("div",Ei,[e("div",Ui,[f[9]||(f[9]=e("div",{class:"flex items-center gap-2 sm:gap-3"},[e("div",{class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-emerald-500 to-emerald-600 sm:h-10 sm:w-10 sm:rounded-xl"},[e("i",{class:"fas fa-download text-sm text-white sm:text-base"})]),e("h3",{class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"}," 导出 API Keys 数据 ")],-1)),e("button",{class:"p-1 text-gray-400 transition-colors hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",disabled:K.value,onClick:f[0]||(f[0]=m=>h.$emit("close"))},[...f[8]||(f[8]=[e("i",{class:"fas fa-times text-lg sm:text-xl"},null,-1)])],8,Pi)]),e("div",Oi,[K.value?(r(),o("div",Gi,[e("div",qi,[e("span",Bi,g($.value),1),e("span",Wi,g(V.value)+"% ",1)]),e("div",Fi,[e("div",{class:"h-full bg-gradient-to-r from-blue-500 to-blue-600 transition-all duration-300 ease-out",style:Le({width:`${V.value}%`})},null,4)])])):w("",!0),e("div",zi,[f[11]||(f[11]=e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 文件格式 ",-1)),e("div",Yi,[(r(),o(Y,null,N(U,m=>e("label",{key:m.value,class:"group relative cursor-pointer"},[M(e("input",{"onUpdate:modelValue":a=>k.value.format=a,class:"peer sr-only",disabled:K.value,type:"radio",value:m.value},null,8,Hi),[[ae,k.value.format]]),e("div",Ni,[e("i",{class:G([m.icon,"text-lg",m.color])},null,2),e("div",Qi,[e("div",Ji,g(m.label),1),e("div",Xi,g(m.description),1)]),f[10]||(f[10]=e("i",{class:"fas fa-check-circle text-emerald-500 opacity-0 transition-opacity peer-checked:opacity-100"},null,-1))])])),64))])]),e("div",Zi,[f[14]||(f[14]=e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 时间范围 ",-1)),e("div",ed,[e("div",td,[f[12]||(f[12]=e("label",{class:"text-xs text-gray-600 dark:text-gray-400"},"开始时间",-1)),M(e("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>k.value.startDate=m),class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:border-gray-500",disabled:K.value,type:"date"},null,8,sd),[[Z,k.value.startDate]])]),e("div",ad,[f[13]||(f[13]=e("label",{class:"text-xs text-gray-600 dark:text-gray-400"},"结束时间",-1)),M(e("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>k.value.endDate=m),class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:border-gray-500",disabled:K.value,type:"date"},null,8,rd),[[Z,k.value.endDate]])])]),e("div",ld,[(r(),o(Y,null,N(S,m=>e("button",{key:m.value,class:"rounded-lg border border-gray-200 bg-white px-3 py-1.5 text-xs text-gray-600 transition-all duration-200 hover:border-gray-300 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-400 dark:hover:border-gray-500 dark:hover:bg-gray-700",disabled:K.value,type:"button",onClick:a=>W(m.value)},g(m.label),9,od)),64))])]),e("div",nd,[f[16]||(f[16]=e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 状态过滤 (可选) ",-1)),M(e("select",{"onUpdate:modelValue":f[3]||(f[3]=m=>k.value.status=m),class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:border-gray-500",disabled:K.value},[...f[15]||(f[15]=[e("option",{value:""},"全部状态",-1),e("option",{value:"active"},"活跃",-1),e("option",{value:"disabled"},"已禁用",-1),e("option",{value:"suspended"},"已暂停",-1)])],8,id),[[ge,k.value.status]])]),e("div",dd,[f[19]||(f[19]=e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 使用量过滤 (可选) ",-1)),e("div",ud,[e("div",cd,[f[17]||(f[17]=e("label",{class:"text-xs text-gray-600 dark:text-gray-400"},"最小使用量 (Tokens)",-1)),M(e("input",{"onUpdate:modelValue":f[4]||(f[4]=m=>k.value.minUsage=m),class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:border-gray-500",disabled:K.value,min:"0",placeholder:"例如: 1000",type:"number"},null,8,gd),[[Z,k.value.minUsage]])]),e("div",md,[f[18]||(f[18]=e("label",{class:"text-xs text-gray-600 dark:text-gray-400"},"最大使用量 (Tokens)",-1)),M(e("input",{"onUpdate:modelValue":f[5]||(f[5]=m=>k.value.maxUsage=m),class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:border-gray-500",disabled:K.value,min:"0",placeholder:"例如: 100000",type:"number"},null,8,xd),[[Z,k.value.maxUsage]])])])]),e("div",pd,[f[20]||(f[20]=e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 搜索过滤 (可选) ",-1)),M(e("input",{"onUpdate:modelValue":f[6]||(f[6]=m=>k.value.search=m),class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:border-gray-500",disabled:K.value,placeholder:"搜索API Key名称或描述...",type:"text"},null,8,yd),[[Z,k.value.search]])])]),e("div",bd,[e("button",{class:"order-2 rounded-lg border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-700 transition-all duration-200 hover:border-gray-300 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:border-gray-500 dark:hover:bg-gray-700 sm:order-1",disabled:K.value,type:"button",onClick:f[7]||(f[7]=m=>h.$emit("close"))}," 取消 ",8,fd),e("button",{class:"group relative order-1 overflow-hidden rounded-lg bg-gradient-to-r from-emerald-500 to-emerald-600 px-4 py-2 text-sm font-medium text-white transition-all duration-200 hover:from-emerald-600 hover:to-emerald-700 disabled:cursor-not-allowed disabled:opacity-50 sm:order-2",disabled:K.value,type:"button",onClick:R},[f[21]||(f[21]=e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-emerald-400 to-emerald-500 opacity-0 blur transition duration-300 group-hover:opacity-30 group-disabled:opacity-0"},null,-1)),e("span",kd,[e("i",{class:G(["fas text-sm",K.value?"fa-spinner fa-spin":"fa-download"])},null,2),T(" "+g(K.value?"导出中...":"开始导出"),1)])],8,vd)])])])]))}},hd=xe(wd,[["__scopeId","data-v-c765551f"]]),$d={class:"tab-content"},Ad={class:"card p-4 sm:p-6"},Cd={class:"mb-4 flex flex-col gap-4 sm:mb-6"},Id={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Kd={class:"flex flex-col gap-3 sm:flex-row sm:flex-wrap sm:items-center sm:gap-3"},_d={class:"group relative min-w-[140px]"},Dd={class:"group relative min-w-[140px]"},Ld={class:"relative"},Md={key:0,class:"absolute -right-2 -top-2 z-10 flex h-5 w-5 items-center justify-center rounded-full bg-purple-500 text-xs text-white shadow-sm"},Td={class:"group relative min-w-[200px]"},Sd={class:"relative flex items-center"},jd=["disabled"],Vd={class:"relative"},Rd={class:"relative"},Ed={class:"flex flex-col gap-2 sm:flex-row"},Ud={key:0,class:"py-12 text-center"},Pd={key:1,class:"py-12 text-center"},Od={key:2,class:"table-container hidden md:block"},Gd={class:"table-scroll-wrapper relative overflow-x-auto"},qd={class:"w-full table-fixed lg:min-w-[950px] xl:min-w-full"},Bd={class:"bg-gray-50/80 backdrop-blur-sm dark:bg-gray-700/80"},Wd={class:"w-[50px] px-3 py-4 text-left"},Fd={class:"flex items-center"},zd=["indeterminate"],Yd={key:1,class:"fas fa-sort ml-1 text-gray-400"},Hd={key:1,class:"fas fa-sort ml-1 text-gray-400"},Nd={class:"w-[17%] min-w-[120px] px-2 py-3 text-left text-xs font-bold uppercase tracking-wider text-gray-700 dark:text-gray-300 lg:w-[22%]"},Qd={key:1,class:"fas fa-sort ml-1 text-gray-400"},Jd={key:1,class:"fas fa-sort ml-1 text-gray-400"},Xd={key:1,class:"fas fa-sort ml-1 text-gray-400"},Zd={class:"divide-y divide-gray-200/50 dark:divide-gray-600/50"},e0={class:"table-row"},t0={class:"px-3 py-4"},s0={class:"flex items-center"},a0=["value"],r0={class:"px-3 py-4"},l0={class:"flex items-center"},o0={class:"min-w-0"},n0=["title"],i0=["title"],d0={class:"mt-1.5 space-y-1"},u0={key:0,class:"flex items-center gap-1 text-xs"},c0={class:"truncate text-gray-600 dark:text-gray-400"},g0={key:1,class:"flex items-center gap-1 text-xs"},m0={class:"truncate text-gray-600 dark:text-gray-400"},x0={key:2,class:"flex items-center gap-1 text-xs"},p0={class:"truncate text-gray-600 dark:text-gray-400"},y0={key:3,class:"flex items-center gap-1 text-xs"},b0={class:"truncate text-gray-600"},f0={key:4,class:"text-xs text-gray-500"},v0={class:"hidden px-3 py-4 lg:table-cell"},k0={class:"flex flex-wrap gap-1"},w0={key:0,class:"text-xs text-gray-400"},h0={class:"whitespace-nowrap px-3 py-4"},$0={class:"px-3 py-4"},A0={class:"space-y-2"},C0={class:"mb-2"},I0={class:"mb-1 flex items-center justify-between text-sm"},K0={class:"font-semibold text-gray-900 dark:text-gray-100"},_0={class:"flex items-center justify-between text-sm"},D0={class:"font-semibold text-green-600"},L0={class:"flex items-center justify-between text-sm"},M0={class:"font-medium text-gray-700 dark:text-gray-300"},T0={key:0,class:"space-y-2"},S0={class:"rounded-lg border border-green-200 bg-green-50 p-2 dark:border-green-700 dark:bg-green-900/20"},j0={class:"mb-1 flex items-center justify-between"},V0={class:"relative"},R0={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-600"},E0={class:"absolute inset-0 flex items-center justify-center"},U0={class:"text-xs font-medium text-white drop-shadow-sm"},P0={key:0,class:"mt-1 flex items-center gap-1"},O0={class:"pt-1"},G0=["onClick"],q0={class:"hidden whitespace-nowrap px-3 py-4 text-sm text-gray-500 xl:table-cell"},B0={class:"hidden whitespace-nowrap px-3 py-4 text-sm lg:table-cell"},W0={class:"inline-flex items-center gap-1.5"},F0={key:0},z0={key:0,class:"inline-flex items-center text-red-600"},Y0={key:1,class:"inline-flex items-center text-orange-600"},H0={key:2,class:"text-gray-600"},N0={key:1,class:"inline-flex items-center text-gray-400"},Q0=["onClick"],J0={class:"whitespace-nowrap px-3 py-4 text-sm"},X0={class:"flex gap-1"},Z0=["onClick"],eu=["onClick"],tu=["onClick"],su=["onClick"],au=["onClick"],ru=["title","onClick"],lu={class:"ml-1 hidden xl:inline"},ou=["onClick"],nu={key:0},iu={class:"bg-gray-50 px-3 py-4 dark:bg-gray-700",colspan:"8"},du={key:0,class:"py-4 text-center"},uu={class:"space-y-4"},cu={class:"mb-4 flex items-center justify-between"},gu={class:"flex items-center gap-2"},mu={key:0,class:"rounded-full bg-gray-100 px-2 py-1 text-xs text-gray-500 dark:bg-gray-700 dark:text-gray-400"},xu={class:"flex items-center gap-1"},pu={class:"flex gap-1 rounded bg-gray-100 p-1 dark:bg-gray-700"},yu=["onClick"],bu={key:0,class:"py-8 text-center"},fu={class:"mb-3 flex items-center justify-center gap-2"},vu=["onClick"],ku={key:1,class:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"},wu={class:"mb-3 flex items-start justify-between"},hu={class:"flex-1"},$u={class:"mb-1 block text-sm font-semibold text-gray-800 dark:text-gray-200"},Au={class:"rounded-full bg-blue-50 px-2 py-1 text-xs text-gray-500 dark:bg-blue-900/30 dark:text-gray-400"},Cu={class:"mb-3 space-y-2"},Iu={class:"flex items-center justify-between text-sm"},Ku={class:"font-semibold text-gray-900 dark:text-gray-100"},_u={class:"flex items-center justify-between text-sm"},Du={class:"font-semibold text-green-600"},Lu={class:"mt-2 border-t border-gray-100 pt-2 dark:border-gray-600"},Mu={class:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400"},Tu={class:"font-medium"},Su={class:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400"},ju={class:"font-medium"},Vu={key:0,class:"flex items-center justify-between text-xs text-purple-600"},Ru={class:"font-medium"},Eu={key:1,class:"flex items-center justify-between text-xs text-purple-600"},Uu={class:"font-medium"},Pu={class:"mt-3 h-2 w-full rounded-full bg-gray-200"},Ou={class:"mt-1 text-right"},Gu={class:"text-xs font-medium text-indigo-600"},qu={key:2,class:"mt-4 rounded-lg border border-indigo-100 bg-gradient-to-r from-indigo-50 to-purple-50 p-3 dark:border-indigo-700 dark:from-indigo-900/20 dark:to-purple-900/20"},Bu={class:"flex items-center justify-between text-sm"},Wu={class:"flex gap-4 text-xs"},Fu={class:"text-gray-600 dark:text-gray-400"},zu={class:"font-semibold text-gray-800 dark:text-gray-200"},Yu={class:"text-gray-600 dark:text-gray-400"},Hu={class:"font-semibold text-gray-800 dark:text-gray-200"},Nu={key:3,class:"space-y-3 md:hidden"},Qu={class:"mb-3 flex items-start justify-between"},Ju={class:"flex items-center gap-3"},Xu=["value"],Zu={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},ec={class:"mt-0.5 text-xs text-gray-500 dark:text-gray-400"},tc={class:"mb-3 space-y-1.5"},sc={key:0,class:"flex flex-wrap items-center gap-1 text-xs"},ac={class:"text-gray-600"},rc={key:1,class:"flex flex-wrap items-center gap-1 text-xs"},lc={class:"text-gray-600"},oc={key:2,class:"flex flex-wrap items-center gap-1 text-xs"},nc={class:"text-gray-600"},ic={key:3,class:"flex flex-wrap items-center gap-1 text-xs"},dc={class:"text-gray-600"},uc={key:4,class:"text-xs text-gray-500"},cc={class:"mb-3 space-y-2"},gc={class:"rounded-lg bg-gray-50 p-3"},mc={class:"mb-2 flex items-center justify-between"},xc=["onClick"],pc={class:"grid grid-cols-2 gap-3"},yc={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},bc={class:"text-sm font-semibold text-green-600"},fc={class:"mt-2 flex items-center justify-between"},vc={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},kc={key:0,class:"space-y-2"},wc={class:"rounded-lg border border-green-200 bg-green-50 p-3 dark:border-green-700 dark:bg-green-900/20"},hc={class:"mb-2 flex items-center justify-between"},$c={class:"relative"},Ac={class:"h-2.5 w-full rounded-full bg-gray-200 dark:bg-gray-600"},Cc={class:"absolute inset-0 flex items-center justify-center"},Ic={class:"text-xs font-medium text-white drop-shadow-sm"},Kc={key:0,class:"mt-2 flex items-start gap-1"},_c={class:"mb-3 text-xs text-gray-500"},Dc={class:"mb-1 flex justify-between"},Lc={class:"flex items-center justify-between"},Mc={class:"flex items-center gap-1"},Tc=["onClick"],Sc={key:0,class:"mb-3 flex flex-wrap gap-1"},jc={class:"mt-3 flex gap-2 border-t border-gray-100 pt-3"},Vc=["onClick"],Rc=["onClick"],Ec=["onClick"],Uc=["onClick"],Pc=["onClick"],Oc=["onClick"],Gc={key:4,class:"mt-4 flex flex-col items-center justify-between gap-4 sm:mt-6 sm:flex-row"},qc={class:"flex w-full flex-col items-center gap-3 sm:w-auto sm:flex-row"},Bc={class:"text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},Wc={class:"flex items-center gap-2"},Fc=["value"],zc={class:"flex items-center gap-2"},Yc=["disabled"],Hc={class:"flex items-center gap-1"},Nc={key:1,class:"hidden px-2 text-gray-500 dark:text-gray-400 sm:inline"},Qc=["onClick"],Jc={key:2,class:"hidden px-2 text-gray-500 dark:text-gray-400 sm:inline"},Xc=["disabled"],Zc={__name:"ApiKeysView",setup(_){const Q=We(),x=D([]),K=D([]),V=D(!1),$=D(!1),k=D(!1),U=D("today"),S=D(""),W=D("asc"),R=D({}),h=D({}),f=D({}),m=D([new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)]),a=D({claude:[],gemini:[],openai:[],bedrock:[],claudeGroups:[],geminiGroups:[],openaiGroups:[]}),d=D(null),j=D(null),L=D(!1),y=D(null),b=D(!1),c=D(null),n=D(""),I=D([]),oe=D(""),de=D([{value:"today",label:"今日",icon:"fa-clock"},{value:"7days",label:"最近7天",icon:"fa-calendar-week"},{value:"monthly",label:"本月",icon:"fa-calendar"},{value:"all",label:"全部时间",icon:"fa-infinity"}]),O=F(()=>{const u=[{value:"",label:"所有标签",icon:"fa-asterisk"}];return I.value.forEach(t=>{u.push({value:t,label:t,icon:"fa-tag"})}),u}),l=F(()=>n.value?x.value.filter(u=>u.tags&&u.tags.includes(n.value)).length:0),p=D(1),C=D(10),X=[10,20,50,100],P=D(!1),i=D(!1),v=D(!1),ee=D(!1),J=D(!1),se=D(!1),ce=D(!1),pe=D(null),ke=D(null),re=D(null),he=D([]),Se=F(()=>{let u=x.value;if(n.value&&(u=x.value.filter(A=>A.tags&&A.tags.includes(n.value))),oe.value){const A=oe.value.toLowerCase().trim();u=u.filter(s=>s.name&&s.name.toLowerCase().includes(A))}return S.value?[...u].sort((A,s)=>{let B=A[S.value],H=s[S.value];return S.value==="status"?(B=A.isActive?1:0,H=s.isActive?1:0):S.value==="cost"?(B=parseFloat(Ye(A.usage).replace("$","")),H=parseFloat(Ye(s.usage).replace("$",""))):(S.value==="createdAt"||S.value==="expiresAt")&&(B=B?new Date(B).getTime():0,H=H?new Date(H).getTime():0),B<H?W.value==="asc"?-1:1:B>H?W.value==="asc"?1:-1:0}):u}),$e=F(()=>{const u=Se.value.length;return Math.ceil(u/C.value)||0}),yt=F(()=>{const u=[],t=p.value,A=$e.value;if(A<=7)for(let s=1;s<=A;s++)u.push(s);else{let s=Math.max(1,t-2),B=Math.min(A,t+2);t<=3?B=5:t>=A-2&&(s=A-4);for(let H=s;H<=B;H++)u.push(H)}return u}),_e=F(()=>{const u=(p.value-1)*C.value,t=u+C.value;return Se.value.slice(u,t)}),je=async()=>{var u,t;try{const[A,s,B,H,E,ne]=await Promise.all([z.get("/admin/claude-accounts"),z.get("/admin/claude-console-accounts"),z.get("/admin/gemini-accounts"),z.get("/admin/openai-accounts"),z.get("/admin/bedrock-accounts"),z.get("/admin/account-groups")]),Ce=[];if(A.success&&((u=A.data)==null||u.forEach(te=>{Ce.push({...te,platform:"claude-oauth",isDedicated:te.accountType==="dedicated"})})),s.success&&((t=s.data)==null||t.forEach(te=>{Ce.push({...te,platform:"claude-console",isDedicated:te.accountType==="dedicated"})})),a.value.claude=Ce,B.success&&(a.value.gemini=(B.data||[]).map(te=>({...te,isDedicated:te.accountType==="dedicated"}))),H.success&&(a.value.openai=(H.data||[]).map(te=>({...te,isDedicated:te.accountType==="dedicated"}))),E.success&&(a.value.bedrock=(E.data||[]).map(te=>({...te,isDedicated:te.accountType==="dedicated"}))),ne.success){const te=ne.data||[];a.value.claudeGroups=te.filter(Re=>Re.platform==="claude"),a.value.geminiGroups=te.filter(Re=>Re.platform==="gemini"),a.value.openaiGroups=te.filter(Re=>Re.platform==="openai")}}catch(A){console.error("加载账户列表失败:",A)}},ye=async()=>{k.value=!0;try{const u=await z.get(`/admin/api-keys?timeRange=${U.value}`);if(u.success){x.value=u.data||[];const t=new Set;x.value.forEach(A=>{A.tags&&Array.isArray(A.tags)&&A.tags.forEach(s=>t.add(s))}),I.value=Array.from(t).sort()}}catch{q("加载 API Keys 失败","error")}finally{k.value=!1}},Ve=u=>{S.value===u?W.value=W.value==="asc"?"desc":"asc":(S.value=u,W.value="asc")},ze=u=>!u&&u!==0?"0":u.toLocaleString("zh-CN"),Ye=u=>!u||!u.total?"$0.0000":`$${(u.total.cost||0).toFixed(4)}`,Ue=u=>{if(!u)return"未知账户";if(u.startsWith("group:")){const H=u.substring(6),E=a.value.claudeGroups.find(te=>te.id===H);if(E)return`分组-${E.name}`;const ne=a.value.geminiGroups.find(te=>te.id===H);if(ne)return`分组-${ne.name}`;const Ce=a.value.openaiGroups.find(te=>te.id===H);return Ce?`分组-${Ce.name}`:`分组-${H.substring(0,8)}`}const t=a.value.claude.find(H=>H.id===u);if(t)return`${t.name}`;const A=a.value.gemini.find(H=>H.id===u);if(A)return`${A.name}`;const s=a.value.openai.find(H=>H.id===u);if(s)return`${s.name}`;const B=a.value.bedrock.find(H=>H.id===u);return B?`${B.name}`:`${u.substring(0,8)}`},He=u=>{if(u.claudeAccountId){const t=Ue(u.claudeAccountId);if(u.claudeAccountId.startsWith("group:"))return t;const A=a.value.claude.find(s=>s.id===u.claudeAccountId);return A?A.accountType==="dedicated"?`🔒 专属-${t}`:t:`⚠️ ${t} (账户不存在)`}if(u.claudeConsoleAccountId){const t=a.value.claude.find(A=>A.id===u.claudeConsoleAccountId&&A.platform==="claude-console");return t?`Console-${t.name}`:"⚠️ Console账户不存在"}return""},Ne=u=>{if(u.geminiAccountId){const t=Ue(u.geminiAccountId);if(u.geminiAccountId.startsWith("group:"))return t;const A=a.value.gemini.find(s=>s.id===u.geminiAccountId);return A?A.accountType==="dedicated"?`🔒 专属-${t}`:t:`⚠️ ${t} (账户不存在)`}return""},Qe=u=>{if(u.openaiAccountId){const t=Ue(u.openaiAccountId);if(u.openaiAccountId.startsWith("group:"))return t;const A=a.value.openai.find(s=>s.id===u.openaiAccountId);return A?A.accountType==="dedicated"?`🔒 专属-${t}`:t:`⚠️ ${t} (账户不存在)`}return""},Je=u=>{if(u.bedrockAccountId){const t=Ue(u.bedrockAccountId);if(u.bedrockAccountId.startsWith("group:"))return t;const A=a.value.bedrock.find(s=>s.id===u.bedrockAccountId);return A?A.accountType==="dedicated"?`🔒 专属-${t}`:t:`⚠️ ${t} (账户不存在)`}return""},Pe=u=>u?new Date(u)<new Date:!1,Oe=u=>!u||Pe(u)?!1:(new Date(u)-new Date)/(1e3*60*60*24)<=7,Xe=u=>u?new Date(u).toLocaleDateString("zh-CN"):"",bt=async u=>{R.value[u]?R.value[u]=!1:(R.value[u]=!0,f.value[u]||et(u),await Ge(u,!0))},Ge=async(u,t=!1)=>{if(!t&&h.value[u]&&h.value[u].length>0)return;const A=Ae(u);try{let s=`/admin/api-keys/${u}/model-stats`;const B=new URLSearchParams;if(A.customStart&&A.customEnd)B.append("startDate",A.customStart),B.append("endDate",A.customEnd),B.append("period","custom");else{const E=A.preset==="today"||A.preset==="7days"?"daily":"monthly";B.append("period",E)}s+="?"+B.toString();const H=await z.get(s);H.success&&(h.value[u]=H.data||[])}catch{q("加载模型统计失败","error"),h.value[u]=[]}},Ze=(u,t)=>{const A=t.reduce((s,B)=>s+(B.allTokens||0),0);return A===0?0:Math.round(u/A*100)},ft=u=>u.formatted&&u.formatted.total?u.formatted.total:u.cost!==void 0?`$${u.cost.toFixed(6)}`:"$0.000000",et=u=>{const t=new Date,A=new Date(t);A.setDate(t.getDate()-6),f.value[u]={type:"preset",preset:"7days",customStart:A.toISOString().split("T")[0],customEnd:t.toISOString().split("T")[0],customRange:null,presetOptions:[{value:"today",label:"今日",days:1},{value:"7days",label:"7天",days:7},{value:"30days",label:"30天",days:30}]}},Ae=u=>(f.value[u]||et(u),f.value[u]),tt=(u,t)=>{const A=Ae(t);A.type="preset",A.preset=u;const s=A.presetOptions.find(B=>B.value===u);if(s){const B=new Date,H=new Date(B);H.setDate(B.getDate()-(s.days-1)),A.customStart=H.toISOString().split("T")[0],A.customEnd=B.toISOString().split("T")[0];const E=ne=>ne.getFullYear()+"-"+String(ne.getMonth()+1).padStart(2,"0")+"-"+String(ne.getDate()).padStart(2,"0")+" 00:00:00";A.customRange=[E(H),E(B)]}Ge(t,!0)},vt=(u,t)=>{const A=Ae(u);t&&t.length===2?(A.type="custom",A.preset="",A.customRange=t,A.customStart=t[0].split(" ")[0],A.customEnd=t[1].split(" ")[0],Ge(u,!0)):t===null&&tt("7days",u)},kt=u=>u>new Date,wt=u=>{const t=Ae(u);t.type="preset",t.preset="7days";const A=new Date,s=new Date(A);s.setDate(A.getDate()-6),t.customStart=s.toISOString().split("T")[0],t.customEnd=A.toISOString().split("T")[0],t.customRange=null,Ge(u,!0),q("已重置筛选条件并刷新数据","info")},ht=async()=>{await je(),P.value=!0},st=async u=>{await je(),pe.value=u,i.value=!0},at=u=>{ke.value=u,v.value=!0},$t=()=>{ce.value=!0},At=u=>{P.value=!1,re.value=u,ee.value=!0,ye()},Ct=u=>{P.value=!1,he.value=u,J.value=!0,ye()},It=async()=>{if(K.value.length===0){q("请先选择要编辑的 API Keys","warning");return}await je(),se.value=!0},Kt=()=>{se.value=!1,K.value=[],be(),ye()},_t=()=>{i.value=!1,q("API Key 更新成功","success"),ye()},Dt=()=>{v.value=!1,q("API Key 续期成功","success"),ye()},rt=async u=>{let t=!0;if(u.isActive&&(window.showConfirm?t=await window.showConfirm("禁用 API Key",`确定要禁用 API Key "${u.name}" 吗？禁用后所有使用此 Key 的请求将返回 401 错误。`,"确定禁用","取消"):t=confirm(`确定要禁用 API Key "${u.name}" 吗？禁用后所有使用此 Key 的请求将返回 401 错误。`)),!!t)try{const A=await z.put(`/admin/api-keys/${u.id}`,{isActive:!u.isActive});if(A.success){q(`API Key 已${u.isActive?"禁用":"激活"}`,"success");const s=x.value.find(B=>B.id===u.id);s&&(s.isActive=!u.isActive)}else q(A.message||"操作失败","error")}catch{q("操作失败","error")}},lt=async u=>{let t=!1;if(window.showConfirm?t=await window.showConfirm("删除 API Key","确定要删除这个 API Key 吗？此操作不可恢复。","确定删除","取消"):t=confirm("确定要删除这个 API Key 吗？此操作不可恢复。"),!!t)try{const A=await z.delete(`/admin/api-keys/${u}`);if(A.success){q("API Key 已删除","success");const s=K.value.indexOf(u);s>-1&&K.value.splice(s,1),be(),ye()}else q(A.message||"删除失败","error")}catch{q("删除失败","error")}},Lt=async()=>{const u=K.value.length;if(u===0){q("请先选择要删除的 API Keys","warning");return}let t=!1;const A=`确定要删除选中的 ${u} 个 API Key 吗？此操作不可恢复。`;if(window.showConfirm?t=await window.showConfirm("批量删除 API Keys",A,"确定删除","取消"):t=confirm(A),!t)return;const s=[...K.value];try{const B=await z.delete("/admin/api-keys/batch",{data:{keyIds:s}});if(B.success){const{successCount:H,failedCount:E,errors:ne}=B.data;if(H>0){if(q(`成功删除 ${H} 个 API Keys`,"success"),E>0){const Ce=ne.map(te=>`${te.keyId}: ${te.error}`).join(`
`);q(`${E} 个删除失败:
${Ce}`,"warning")}}else q("所有 API Keys 删除失败","error");K.value=[],be(),ye()}else q(B.message||"批量删除失败","error")}catch(B){q("批量删除失败","error"),console.error("批量删除 API Keys 失败:",B)}},Mt=()=>{if(V.value)_e.value.forEach(u=>{K.value.includes(u.id)||K.value.push(u.id)});else{const u=new Set(_e.value.map(t=>t.id));K.value=K.value.filter(t=>!u.has(t))}be()},be=()=>{const u=_e.value.length,t=_e.value.filter(A=>K.value.includes(A.id)).length;t===0?(V.value=!1,$.value=!1):t===u?(V.value=!0,$.value=!1):(V.value=!1,$.value=!0)},Tt=u=>{const A=`${window.location.origin}/admin-next/api-stats?apiId=${u.id}`,s=document.createElement("textarea");s.value=A,s.style.position="fixed",s.style.opacity="0",s.style.left="-9999px",document.body.appendChild(s),s.select(),s.setSelectionRange(0,99999);try{document.execCommand("copy")?q("已复制统计页面链接","success"):(q("复制失败，请手动复制","error"),console.log("统计页面链接:",A))}catch(B){q("复制失败，请手动复制","error"),console.error("复制错误:",B),console.log("统计页面链接:",A)}finally{document.body.removeChild(s)}},ot=u=>{d.value=u},nt=()=>{d.value=null},St=async({keyId:u,expiresAt:t})=>{try{const A=await z.put(`/admin/api-keys/${u}`,{expiresAt:t||null});if(A.success){q("过期时间已更新","success");const s=x.value.find(B=>B.id===u);s&&(s.expiresAt=t||null),nt()}else q(A.message||"更新失败","error"),j.value&&j.value.resetSaving()}catch{q("更新失败","error"),j.value&&j.value.resetSaving()}},it=u=>u?new Date(u).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/\//g,"-"):"",ue=u=>{if(!u.dailyCostLimit||u.dailyCostLimit===0)return 0;const t=(u.dailyCost||0)/u.dailyCostLimit*100;return Math.min(t,100)},dt=u=>{const t=ue(u);return t>=100?"bg-gradient-to-r from-red-500 to-red-600":t>=90?"bg-gradient-to-r from-red-400 to-red-500":t>=80?"bg-gradient-to-r from-yellow-400 to-orange-500":t>=60?"bg-gradient-to-r from-yellow-400 to-yellow-500":"bg-gradient-to-r from-green-400 to-green-500"},ut=u=>{const t=ue(u);return t>=100?"text-red-600 dark:text-red-400":t>=80?"text-yellow-600 dark:text-yellow-400":"text-gray-700 dark:text-gray-300"},qe=u=>{y.value=u,L.value=!0},ct=async u=>{await je(),c.value=u,b.value=!0},jt=()=>{b.value=!1,q("账户绑定更新成功","success"),ye()},Vt=()=>{ce.value=!1,q("数据导出完成","success")},De=u=>u>=1e6?(u/1e6).toFixed(1)+"M":u>=1e3?(u/1e3).toFixed(1)+"K":u.toString(),gt=u=>{if(!u)return"从未使用";const t=new Date(u),s=new Date-t;return s<6e4?"刚刚":s<36e5?`${Math.floor(s/6e4)} 分钟前`:s<864e5?`${Math.floor(s/36e5)} 小时前`:s<6048e5?`${Math.floor(s/864e5)} 天前`:t.toLocaleDateString("zh-CN")},Rt=()=>{oe.value="",p.value=1};return we([n,U],()=>{p.value=1,K.value=[],be()}),we(oe,()=>{p.value=1,be()}),we([p,C],()=>{be()}),we(x,()=>{const u=new Set(x.value.map(t=>t.id));K.value=K.value.filter(t=>u.has(t)),be()}),Me(async()=>{await Promise.all([Q.loadSupportedClients(),je(),ye()]),be()}),(u,t)=>{const A=Et;return r(),o("div",$d,[e("div",Ad,[e("div",Cd,[t[45]||(t[45]=e("div",null,[e("h3",{class:"mb-1 text-lg font-bold text-gray-900 dark:text-gray-100 sm:mb-2 sm:text-xl"}," API Keys 管理 "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 sm:text-base"}," 管理和监控您的 API 密钥 ")],-1)),e("div",Id,[e("div",Kd,[e("div",_d,[t[32]||(t[32]=e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-blue-500 to-purple-500 opacity-0 blur transition duration-300 group-hover:opacity-20"},null,-1)),ie(xt,{modelValue:U.value,"onUpdate:modelValue":t[0]||(t[0]=s=>U.value=s),icon:"fa-calendar-alt","icon-color":"text-blue-500",options:de.value,placeholder:"选择时间范围",onChange:t[1]||(t[1]=s=>ye())},null,8,["modelValue","options"])]),e("div",Dd,[t[33]||(t[33]=e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-purple-500 to-pink-500 opacity-0 blur transition duration-300 group-hover:opacity-20"},null,-1)),e("div",Ld,[ie(xt,{modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=s=>n.value=s),icon:"fa-tags","icon-color":"text-purple-500",options:O.value,placeholder:"所有标签",onChange:t[3]||(t[3]=s=>p.value=1)},null,8,["modelValue","options"]),n.value?(r(),o("span",Md,g(l.value),1)):w("",!0)])]),e("div",Td,[t[36]||(t[36]=e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-cyan-500 to-teal-500 opacity-0 blur transition duration-300 group-hover:opacity-20"},null,-1)),e("div",Sd,[M(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>oe.value=s),class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 pl-9 text-sm text-gray-700 placeholder-gray-400 shadow-sm transition-all duration-200 hover:border-gray-300 focus:border-cyan-500 focus:outline-none focus:ring-2 focus:ring-cyan-500/20 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:placeholder-gray-500 dark:hover:border-gray-500",placeholder:"搜索名称...",type:"text",onInput:t[5]||(t[5]=s=>p.value=1)},null,544),[[Z,oe.value]]),t[35]||(t[35]=e("i",{class:"fas fa-search absolute left-3 text-sm text-cyan-500"},null,-1)),oe.value?(r(),o("button",{key:0,class:"absolute right-2 flex h-5 w-5 items-center justify-center rounded-full text-gray-400 hover:bg-gray-100 hover:text-gray-600 dark:hover:bg-gray-700 dark:hover:text-gray-300",onClick:Rt},[...t[34]||(t[34]=[e("i",{class:"fas fa-times text-xs"},null,-1)])])):w("",!0)])]),e("button",{class:"group relative flex items-center justify-center gap-2 rounded-lg border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:border-gray-500 sm:w-auto",disabled:k.value,onClick:t[6]||(t[6]=s=>ye())},[t[37]||(t[37]=e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-green-500 to-teal-500 opacity-0 blur transition duration-300 group-hover:opacity-20"},null,-1)),e("i",{class:G(["fas relative text-green-500",k.value?"fa-spinner fa-spin":"fa-sync-alt"])},null,2),t[38]||(t[38]=e("span",{class:"relative"},"刷新",-1))],8,jd),K.value.length>0?(r(),o("button",{key:0,class:"group relative flex items-center justify-center gap-2 rounded-lg border border-blue-200 bg-blue-50 px-4 py-2 text-sm font-medium text-blue-700 shadow-sm transition-all duration-200 hover:border-blue-300 hover:bg-blue-100 hover:shadow-md sm:w-auto",onClick:t[7]||(t[7]=s=>It())},[t[39]||(t[39]=e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-500 opacity-0 blur transition duration-300 group-hover:opacity-20"},null,-1)),t[40]||(t[40]=e("i",{class:"fas fa-edit relative text-blue-600"},null,-1)),e("span",Vd,"编辑选中 ("+g(K.value.length)+")",1)])):w("",!0),K.value.length>0?(r(),o("button",{key:1,class:"group relative flex items-center justify-center gap-2 rounded-lg border border-red-200 bg-red-50 px-4 py-2 text-sm font-medium text-red-700 shadow-sm transition-all duration-200 hover:border-red-300 hover:bg-red-100 hover:shadow-md sm:w-auto",onClick:t[8]||(t[8]=s=>Lt())},[t[41]||(t[41]=e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-red-500 to-pink-500 opacity-0 blur transition duration-300 group-hover:opacity-20"},null,-1)),t[42]||(t[42]=e("i",{class:"fas fa-trash relative text-red-600"},null,-1)),e("span",Rd,"删除选中 ("+g(K.value.length)+")",1)])):w("",!0)]),e("div",Ed,[e("button",{class:"group relative flex items-center justify-center gap-2 rounded-lg border border-emerald-200 bg-emerald-50 px-4 py-2 text-sm font-medium text-emerald-700 shadow-sm transition-all duration-200 hover:border-emerald-300 hover:bg-emerald-100 hover:shadow-md dark:border-emerald-700 dark:bg-emerald-900/20 dark:text-emerald-300 dark:hover:border-emerald-600 dark:hover:bg-emerald-800/30",onClick:$t},[...t[43]||(t[43]=[e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-emerald-500 to-teal-500 opacity-0 blur transition duration-300 group-hover:opacity-20"},null,-1),e("i",{class:"fas fa-download relative text-emerald-600 dark:text-emerald-400"},null,-1),e("span",{class:"relative"},"导出数据",-1)])]),e("button",{class:"flex w-full items-center justify-center gap-2 rounded-lg bg-gradient-to-r from-blue-500 to-blue-600 px-5 py-2.5 text-sm font-medium text-white shadow-md transition-all duration-200 hover:from-blue-600 hover:to-blue-700 hover:shadow-lg sm:w-auto",onClick:me(ht,["stop"])},[...t[44]||(t[44]=[e("i",{class:"fas fa-plus"},null,-1),e("span",null,"创建新 Key",-1)])])])])]),k.value?(r(),o("div",Ud,[...t[46]||(t[46]=[e("div",{class:"loading-spinner mx-auto mb-4"},null,-1),e("p",{class:"text-gray-500"},"正在加载 API Keys...",-1)])])):x.value.length===0?(r(),o("div",Pd,[...t[47]||(t[47]=[e("div",{class:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gray-100"},[e("i",{class:"fas fa-key text-xl text-gray-400"})],-1),e("p",{class:"text-lg text-gray-500"},"暂无 API Keys",-1),e("p",{class:"mt-2 text-sm text-gray-400"},"点击上方按钮创建您的第一个 API Key",-1)])])):(r(),o("div",Od,[e("div",Gd,[e("table",qd,[e("thead",Bd,[e("tr",null,[e("th",Wd,[e("div",Fd,[M(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>V.value=s),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",indeterminate:$.value,type:"checkbox",onChange:Mt},null,40,zd),[[ve,V.value]])])]),e("th",{class:"w-[25%] min-w-[180px] cursor-pointer px-2 py-3 text-left text-xs font-bold uppercase tracking-wider text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600 lg:w-[28%] lg:min-w-[220px] xl:w-[25%]",onClick:t[10]||(t[10]=s=>Ve("name"))},[t[48]||(t[48]=T(" 名称 ",-1)),S.value==="name"?(r(),o("i",{key:0,class:G(["fas",W.value==="asc"?"fa-sort-up":"fa-sort-down","ml-1"])},null,2)):(r(),o("i",Yd))]),t[55]||(t[55]=e("th",{class:"hidden w-[10%] min-w-[80px] px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 dark:text-gray-300 lg:table-cell"}," 标签 ",-1)),e("th",{class:"w-[8%] min-w-[60px] cursor-pointer px-2 py-3 text-left text-xs font-bold uppercase tracking-wider text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600 lg:w-[9%]",onClick:t[11]||(t[11]=s=>Ve("status"))},[t[49]||(t[49]=T(" 状态 ",-1)),S.value==="status"?(r(),o("i",{key:0,class:G(["fas",W.value==="asc"?"fa-sort-up":"fa-sort-down","ml-1"])},null,2)):(r(),o("i",Hd))]),e("th",Nd,[t[52]||(t[52]=T(" 统计 ",-1)),e("span",{class:"cursor-pointer rounded px-2 py-1 hover:bg-gray-100 dark:hover:bg-gray-600",onClick:t[12]||(t[12]=s=>Ve("cost"))},[t[50]||(t[50]=T(" (费用 ",-1)),S.value==="cost"?(r(),o("i",{key:0,class:G(["fas",W.value==="asc"?"fa-sort-up":"fa-sort-down","ml-1"])},null,2)):(r(),o("i",Qd)),t[51]||(t[51]=T(") ",-1))])]),e("th",{class:"hidden w-[10%] min-w-[90px] cursor-pointer px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600 xl:table-cell",onClick:t[13]||(t[13]=s=>Ve("createdAt"))},[t[53]||(t[53]=T(" 创建时间 ",-1)),S.value==="createdAt"?(r(),o("i",{key:0,class:G(["fas",W.value==="asc"?"fa-sort-up":"fa-sort-down","ml-1"])},null,2)):(r(),o("i",Jd))]),e("th",{class:"hidden w-[10%] min-w-[90px] cursor-pointer px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600 lg:table-cell",onClick:t[14]||(t[14]=s=>Ve("expiresAt"))},[t[54]||(t[54]=T(" 过期时间 ",-1)),S.value==="expiresAt"?(r(),o("i",{key:0,class:G(["fas",W.value==="asc"?"fa-sort-up":"fa-sort-down","ml-1"])},null,2)):(r(),o("i",Xd))]),t[56]||(t[56]=e("th",{class:"w-[20%] min-w-[180px] px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 dark:text-gray-300 lg:w-[25%] xl:w-[20%]"}," 操作 ",-1))])]),e("tbody",Zd,[(r(!0),o(Y,null,N(_e.value,s=>{var B,H;return r(),o(Y,{key:s.id},[e("tr",e0,[e("td",t0,[e("div",s0,[M(e("input",{"onUpdate:modelValue":t[15]||(t[15]=E=>K.value=E),class:"mr-3 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",type:"checkbox",value:s.id,onChange:be},null,40,a0),[[ve,K.value]])])]),e("td",r0,[e("div",l0,[t[62]||(t[62]=e("div",{class:"mr-2 flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600"},[e("i",{class:"fas fa-key text-xs text-white"})],-1)),e("div",o0,[e("div",{class:"truncate text-sm font-semibold text-gray-900 dark:text-gray-100",title:s.name},g(s.name),9,n0),e("div",{class:"truncate text-xs text-gray-500 dark:text-gray-400",title:s.id},g(s.id),9,i0),e("div",d0,[s.claudeAccountId||s.claudeConsoleAccountId?(r(),o("div",u0,[t[57]||(t[57]=e("span",{class:"inline-flex items-center rounded bg-indigo-100 px-1.5 py-0.5 text-indigo-700"},[e("i",{class:"fas fa-brain mr-1 text-[10px]"}),T(" Claude ")],-1)),e("span",c0,g(He(s)),1)])):w("",!0),s.geminiAccountId?(r(),o("div",g0,[t[58]||(t[58]=e("span",{class:"inline-flex items-center rounded bg-yellow-100 px-1.5 py-0.5 text-yellow-700"},[e("i",{class:"fas fa-robot mr-1 text-[10px]"}),T(" Gemini ")],-1)),e("span",m0,g(Ne(s)),1)])):w("",!0),s.openaiAccountId?(r(),o("div",x0,[t[59]||(t[59]=e("span",{class:"inline-flex items-center rounded bg-gray-100 px-1.5 py-0.5 text-gray-700"},[e("i",{class:"fa-openai mr-1 text-[10px]"}),T(" OpenAI ")],-1)),e("span",p0,g(Qe(s)),1)])):w("",!0),s.bedrockAccountId?(r(),o("div",y0,[t[60]||(t[60]=e("span",{class:"inline-flex items-center rounded bg-orange-100 px-1.5 py-0.5 text-orange-700"},[e("i",{class:"fas fa-cloud mr-1 text-[10px]"}),T(" Bedrock ")],-1)),e("span",b0,g(Je(s)),1)])):w("",!0),!s.claudeAccountId&&!s.claudeConsoleAccountId&&!s.geminiAccountId&&!s.openaiAccountId&&!s.bedrockAccountId?(r(),o("div",f0,[...t[61]||(t[61]=[e("i",{class:"fas fa-share-alt mr-1"},null,-1),T(" 使用共享池 ",-1)])])):w("",!0)])])])]),e("td",v0,[e("div",k0,[(r(!0),o(Y,null,N(s.tags||[],E=>(r(),o("span",{key:E,class:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs text-blue-800"},g(E),1))),128)),!s.tags||s.tags.length===0?(r(),o("span",w0,"无标签")):w("",!0)])]),e("td",h0,[e("span",{class:G(["inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",s.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},[e("div",{class:G(["mr-2 h-2 w-2 rounded-full",s.isActive?"bg-green-500":"bg-red-500"])},null,2),T(" "+g(s.isActive?"活跃":"禁用"),1)],2)]),e("td",$0,[e("div",A0,[e("div",C0,[e("div",I0,[t[63]||(t[63]=e("span",{class:"text-gray-600 dark:text-gray-400"},"今日请求",-1)),e("span",K0,g(ze(((H=(B=s.usage)==null?void 0:B.daily)==null?void 0:H.requests)||0))+"次",1)]),e("div",_0,[t[64]||(t[64]=e("span",{class:"text-gray-600 dark:text-gray-400"},"今日费用",-1)),e("span",D0,"$"+g((s.dailyCost||0).toFixed(4)),1)]),e("div",L0,[t[65]||(t[65]=e("span",{class:"text-gray-600 dark:text-gray-400"},"最后使用",-1)),e("span",M0,g(gt(s.lastUsedAt)),1)])]),s.dailyCostLimit>0?(r(),o("div",T0,[e("div",S0,[e("div",j0,[t[66]||(t[66]=e("div",{class:"flex items-center gap-1"},[e("i",{class:"fas fa-dollar-sign text-xs text-green-600 dark:text-green-400"}),e("span",{class:"text-xs font-medium text-green-700 dark:text-green-300"},"费用限额")],-1)),e("span",{class:G(["text-xs font-semibold",ut(s)])}," $"+g((s.dailyCost||0).toFixed(2))+" / $"+g(s.dailyCostLimit.toFixed(2)),3)]),e("div",V0,[e("div",R0,[e("div",{class:G(["h-2 rounded-full transition-all duration-300 ease-in-out",dt(s)]),style:Le({width:ue(s)+"%"})},null,6)]),e("div",E0,[e("span",U0,g(Math.round(ue(s)))+"% ",1)])]),ue(s)>=80?(r(),o("div",P0,[e("i",{class:G(["fas fa-exclamation-triangle text-xs",ue(s)>=100?"text-red-500":"text-yellow-500"])},null,2),e("span",{class:G(["text-xs",ue(s)>=100?"text-red-600 dark:text-red-400":"text-yellow-600 dark:text-yellow-400"])},g(ue(s)>=100?"已超过限额":"接近限额"),3)])):w("",!0)])])):w("",!0),s.rateLimitWindow>0?(r(),le(Be,{key:1,"current-requests":s.currentWindowRequests,"current-tokens":s.currentWindowTokens,"rate-limit-window":s.rateLimitWindow,"request-limit":s.rateLimitRequests,"show-progress":!0,"show-tooltip":!1,"token-limit":s.tokenLimit,"window-end-time":s.windowEndTime,"window-remaining-seconds":s.windowRemainingSeconds,"window-start-time":s.windowStartTime},null,8,["current-requests","current-tokens","rate-limit-window","request-limit","token-limit","window-end-time","window-remaining-seconds","window-start-time"])):w("",!0),e("div",O0,[e("button",{class:"flex w-full items-center justify-center gap-1 rounded py-1 text-xs font-medium text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-800 dark:hover:bg-blue-900/20 dark:hover:text-blue-400",onClick:E=>qe(s)},[...t[67]||(t[67]=[e("i",{class:"fas fa-chart-line"},null,-1),T(" 查看详细统计 ",-1)])],8,G0)])])]),e("td",q0,g(new Date(s.createdAt).toLocaleDateString()),1),e("td",B0,[e("div",W0,[s.expiresAt?(r(),o("span",F0,[Pe(s.expiresAt)?(r(),o("span",z0,[...t[68]||(t[68]=[e("i",{class:"fas fa-exclamation-circle mr-1"},null,-1),T(" 已过期 ",-1)])])):Oe(s.expiresAt)?(r(),o("span",Y0,[t[69]||(t[69]=e("i",{class:"fas fa-clock mr-1"},null,-1)),T(" "+g(Xe(s.expiresAt)),1)])):(r(),o("span",H0,g(Xe(s.expiresAt)),1))])):(r(),o("span",N0,[...t[70]||(t[70]=[e("i",{class:"fas fa-infinity mr-1"},null,-1),T(" 永不过期 ",-1)])])),e("button",{class:"inline-flex h-6 w-6 items-center justify-center rounded-md text-gray-300 transition-all duration-200 hover:bg-blue-50 hover:text-blue-500",title:"编辑过期时间",onClick:me(E=>ot(s),["stop"])},[...t[71]||(t[71]=[e("svg",{class:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1)])],8,Q0)])]),e("td",J0,[e("div",X0,[s&&s.id?(r(),o("button",{key:0,class:"rounded px-2 py-1 text-xs font-medium text-indigo-600 transition-colors hover:bg-indigo-50 hover:text-indigo-900",title:"模型使用分布",onClick:E=>bt(s.id)},[e("i",{class:G(["fas",R.value[s.id]?"fa-chevron-up":"fa-chevron-down"])},null,2),t[72]||(t[72]=e("span",{class:"ml-1 hidden xl:inline"},"模型",-1))],8,Z0)):w("",!0),e("button",{class:"rounded px-2 py-1 text-xs font-medium text-purple-600 transition-colors hover:bg-purple-50 hover:text-purple-900",title:"复制统计页面链接",onClick:E=>Tt(s)},[...t[73]||(t[73]=[e("i",{class:"fas fa-chart-bar"},null,-1),e("span",{class:"ml-1 hidden xl:inline"},"统计",-1)])],8,eu),e("button",{class:"rounded px-2 py-1 text-xs font-medium text-cyan-600 transition-colors hover:bg-cyan-50 hover:text-cyan-900",title:"快速绑定",onClick:E=>ct(s)},[...t[74]||(t[74]=[e("i",{class:"fas fa-link"},null,-1),e("span",{class:"ml-1 hidden xl:inline"},"绑定",-1)])],8,tu),e("button",{class:"rounded px-2 py-1 text-xs font-medium text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-900",title:"编辑",onClick:E=>st(s)},[...t[75]||(t[75]=[e("i",{class:"fas fa-edit"},null,-1),e("span",{class:"ml-1 hidden xl:inline"},"编辑",-1)])],8,su),s.expiresAt&&(Pe(s.expiresAt)||Oe(s.expiresAt))?(r(),o("button",{key:1,class:"rounded px-2 py-1 text-xs font-medium text-green-600 transition-colors hover:bg-green-50 hover:text-green-900",title:"续期",onClick:E=>at(s)},[...t[76]||(t[76]=[e("i",{class:"fas fa-clock"},null,-1),e("span",{class:"ml-1 hidden xl:inline"},"续期",-1)])],8,au)):w("",!0),e("button",{class:G([s.isActive?"text-orange-600 hover:bg-orange-50 hover:text-orange-900":"text-green-600 hover:bg-green-50 hover:text-green-900","rounded px-2 py-1 text-xs font-medium transition-colors"]),title:s.isActive?"禁用":"激活",onClick:E=>rt(s)},[e("i",{class:G(["fas",s.isActive?"fa-ban":"fa-check-circle"])},null,2),e("span",lu,g(s.isActive?"禁用":"激活"),1)],10,ru),e("button",{class:"rounded px-2 py-1 text-xs font-medium text-red-600 transition-colors hover:bg-red-50 hover:text-red-900",title:"删除",onClick:E=>lt(s.id)},[...t[77]||(t[77]=[e("i",{class:"fas fa-trash"},null,-1),e("span",{class:"ml-1 hidden xl:inline"},"删除",-1)])],8,ou)])])]),s&&s.id&&R.value[s.id]?(r(),o("tr",nu,[e("td",iu,[h.value[s.id]?w("",!0):(r(),o("div",du,[...t[78]||(t[78]=[e("div",{class:"loading-spinner mx-auto"},null,-1),e("p",{class:"mt-2 text-sm text-gray-500"},"加载模型统计...",-1)])])),e("div",uu,[e("div",cu,[t[79]||(t[79]=e("h5",{class:"flex items-center text-sm font-semibold text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-chart-pie mr-2 text-indigo-500"}),T(" 模型使用分布 ")],-1)),e("div",gu,[h.value[s.id]&&h.value[s.id].length>0?(r(),o("span",mu,g(h.value[s.id].length)+" 个模型 ",1)):w("",!0),e("div",xu,[e("div",pu,[(r(!0),o(Y,null,N(Ae(s.id).presetOptions,E=>(r(),o("button",{key:E.value,class:G(["rounded px-2 py-1 text-xs font-medium transition-colors",Ae(s.id).preset===E.value&&Ae(s.id).type==="preset"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"]),onClick:ne=>tt(E.value,s.id)},g(E.label),11,yu))),128))]),ie(A,{class:"api-key-date-picker",clearable:!0,"default-time":m.value,"disabled-date":kt,"end-placeholder":"结束日期",format:"YYYY-MM-DD HH:mm:ss","model-value":Ae(s.id).customRange,"range-separator":"至",size:"small","start-placeholder":"开始日期",style:{width:"280px"},type:"datetimerange","unlink-panels":!1,"value-format":"YYYY-MM-DD HH:mm:ss","onUpdate:modelValue":E=>vt(s.id,E)},null,8,["default-time","model-value","onUpdate:modelValue"])])])]),h.value[s.id]&&h.value[s.id].length===0?(r(),o("div",bu,[e("div",fu,[t[81]||(t[81]=e("i",{class:"fas fa-chart-line text-lg text-gray-400"},null,-1)),t[82]||(t[82]=e("p",{class:"text-sm text-gray-500"},"暂无模型使用数据",-1)),e("button",{class:"ml-2 flex items-center gap-1 text-sm text-blue-500 transition-colors hover:text-blue-700",title:"重置筛选条件并刷新",onClick:E=>wt(s.id)},[...t[80]||(t[80]=[e("i",{class:"fas fa-sync-alt text-xs"},null,-1),e("span",{class:"text-xs"},"刷新",-1)])],8,vu)]),t[83]||(t[83]=e("p",{class:"text-xs text-gray-400"},"尝试调整时间范围或点击刷新重新加载数据",-1))])):h.value[s.id]&&h.value[s.id].length>0?(r(),o("div",ku,[(r(!0),o(Y,null,N(h.value[s.id],E=>(r(),o("div",{key:E.model,class:"rounded-xl border border-gray-200 bg-gradient-to-br from-white to-gray-50 p-4 transition-all duration-200 hover:border-indigo-300 hover:shadow-lg dark:border-gray-600 dark:from-gray-800 dark:to-gray-700 dark:hover:border-indigo-500"},[e("div",wu,[e("div",hu,[e("span",$u,g(E.model),1),e("span",Au,g(E.requests)+" 次请求",1)])]),e("div",Cu,[e("div",Iu,[t[84]||(t[84]=e("span",{class:"flex items-center text-gray-600 dark:text-gray-400"},[e("i",{class:"fas fa-coins mr-1 text-xs text-yellow-500"}),T(" 总Token: ")],-1)),e("span",Ku,g(De(E.allTokens)),1)]),e("div",_u,[t[85]||(t[85]=e("span",{class:"flex items-center text-gray-600 dark:text-gray-400"},[e("i",{class:"fas fa-dollar-sign mr-1 text-xs text-green-500"}),T(" 费用: ")],-1)),e("span",Du,g(ft(E)),1)]),e("div",Lu,[e("div",Mu,[t[86]||(t[86]=e("span",{class:"flex items-center"},[e("i",{class:"fas fa-arrow-down mr-1 text-green-500"}),T(" 输入: ")],-1)),e("span",Tu,g(De(E.inputTokens)),1)]),e("div",Su,[t[87]||(t[87]=e("span",{class:"flex items-center"},[e("i",{class:"fas fa-arrow-up mr-1 text-blue-500"}),T(" 输出: ")],-1)),e("span",ju,g(De(E.outputTokens)),1)]),E.cacheCreateTokens>0?(r(),o("div",Vu,[t[88]||(t[88]=e("span",{class:"flex items-center"},[e("i",{class:"fas fa-save mr-1"}),T(" 缓存创建: ")],-1)),e("span",Ru,g(De(E.cacheCreateTokens)),1)])):w("",!0),E.cacheReadTokens>0?(r(),o("div",Eu,[t[89]||(t[89]=e("span",{class:"flex items-center"},[e("i",{class:"fas fa-download mr-1"}),T(" 缓存读取: ")],-1)),e("span",Uu,g(De(E.cacheReadTokens)),1)])):w("",!0)])]),e("div",Pu,[e("div",{class:"h-2 rounded-full bg-gradient-to-r from-indigo-500 to-purple-600 transition-all duration-500",style:Le({width:Ze(E.allTokens,h.value[s.id])+"%"})},null,4)]),e("div",Ou,[e("span",Gu,g(Ze(E.allTokens,h.value[s.id]))+"% ",1)])]))),128))])):w("",!0),h.value[s.id]&&h.value[s.id].length>0?(r(),o("div",qu,[e("div",Bu,[t[92]||(t[92]=e("span",{class:"flex items-center font-semibold text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-calculator mr-2 text-indigo-500"}),T(" 总计统计 ")],-1)),e("div",Wu,[e("span",Fu,[t[90]||(t[90]=T(" 总请求: ",-1)),e("span",zu,g(h.value[s.id].reduce((E,ne)=>E+ne.requests,0)),1)]),e("span",Yu,[t[91]||(t[91]=T(" 总Token: ",-1)),e("span",Hu,g(De(h.value[s.id].reduce((E,ne)=>E+ne.allTokens,0))),1)])])])])):w("",!0)])])])):w("",!0)],64)}),128))])])])])),!k.value&&Se.value.length>0?(r(),o("div",Nu,[(r(!0),o(Y,null,N(_e.value,s=>{var B,H;return r(),o("div",{key:s.id,class:"card p-4 transition-shadow hover:shadow-lg"},[e("div",Qu,[e("div",Ju,[M(e("input",{"onUpdate:modelValue":t[16]||(t[16]=E=>K.value=E),class:"mt-1 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",type:"checkbox",value:s.id,onChange:be},null,40,Xu),[[ve,K.value]]),t[93]||(t[93]=e("div",{class:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600"},[e("i",{class:"fas fa-key text-sm text-white"})],-1)),e("div",null,[e("h4",Zu,g(s.name),1),e("p",ec,g(s.id),1)])]),e("span",{class:G(["inline-flex items-center rounded-full px-2 py-1 text-xs font-semibold",s.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},[e("div",{class:G(["mr-1.5 h-1.5 w-1.5 rounded-full",s.isActive?"bg-green-500":"bg-red-500"])},null,2),T(" "+g(s.isActive?"活跃":"已停用"),1)],2)]),e("div",tc,[s.claudeAccountId||s.claudeConsoleAccountId?(r(),o("div",sc,[t[94]||(t[94]=e("span",{class:"inline-flex items-center rounded bg-indigo-100 px-2 py-0.5 text-indigo-700"},[e("i",{class:"fas fa-brain mr-1"}),T(" Claude ")],-1)),e("span",ac,g(He(s)),1)])):w("",!0),s.geminiAccountId?(r(),o("div",rc,[t[95]||(t[95]=e("span",{class:"inline-flex items-center rounded bg-yellow-100 px-2 py-0.5 text-yellow-700"},[e("i",{class:"fas fa-robot mr-1"}),T(" Gemini ")],-1)),e("span",lc,g(Ne(s)),1)])):w("",!0),s.openaiAccountId?(r(),o("div",oc,[t[96]||(t[96]=e("span",{class:"inline-flex items-center rounded bg-gray-100 px-2 py-0.5 text-gray-700"},[e("i",{class:"fa-openai mr-1"}),T(" OpenAI ")],-1)),e("span",nc,g(Qe(s)),1)])):w("",!0),s.bedrockAccountId?(r(),o("div",ic,[t[97]||(t[97]=e("span",{class:"inline-flex items-center rounded bg-orange-100 px-2 py-0.5 text-orange-700"},[e("i",{class:"fas fa-cloud mr-1"}),T(" Bedrock ")],-1)),e("span",dc,g(Je(s)),1)])):w("",!0),!s.claudeAccountId&&!s.claudeConsoleAccountId&&!s.geminiAccountId&&!s.openaiAccountId&&!s.bedrockAccountId?(r(),o("div",uc,[...t[98]||(t[98]=[e("i",{class:"fas fa-share-alt mr-1"},null,-1),T(" 使用共享池 ",-1)])])):w("",!0)]),e("div",cc,[e("div",gc,[e("div",mc,[t[100]||(t[100]=e("span",{class:"text-xs text-gray-600"},"今日使用",-1)),e("button",{class:"text-xs text-blue-600 hover:text-blue-800",onClick:E=>qe(s)},[...t[99]||(t[99]=[e("i",{class:"fas fa-chart-line mr-1"},null,-1),T("详情 ",-1)])],8,xc)]),e("div",pc,[e("div",null,[e("p",yc,g(ze(((H=(B=s.usage)==null?void 0:B.daily)==null?void 0:H.requests)||0))+" 次 ",1),t[101]||(t[101]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"请求",-1))]),e("div",null,[e("p",bc," $"+g((s.dailyCost||0).toFixed(4)),1),t[102]||(t[102]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"费用",-1))])]),e("div",fc,[t[103]||(t[103]=e("span",{class:"text-xs text-gray-600 dark:text-gray-400"},"最后使用",-1)),e("span",vc,g(gt(s.lastUsedAt)),1)])]),s.dailyCostLimit>0?(r(),o("div",kc,[e("div",wc,[e("div",hc,[t[104]||(t[104]=e("div",{class:"flex items-center gap-1"},[e("i",{class:"fas fa-dollar-sign text-xs text-green-600 dark:text-green-400"}),e("span",{class:"text-xs font-medium text-green-700 dark:text-green-300"},"每日费用限额")],-1)),e("span",{class:G(["text-xs font-semibold",ut(s)])}," $"+g((s.dailyCost||0).toFixed(2))+" / $"+g(s.dailyCostLimit.toFixed(2)),3)]),e("div",$c,[e("div",Ac,[e("div",{class:G(["h-2.5 rounded-full transition-all duration-300 ease-in-out",dt(s)]),style:Le({width:ue(s)+"%"})},null,6)]),e("div",Cc,[e("span",Ic,g(Math.round(ue(s)))+"% ",1)])]),ue(s)>=80?(r(),o("div",Kc,[e("i",{class:G(["fas fa-exclamation-triangle mt-0.5 text-xs",ue(s)>=100?"text-red-500":"text-yellow-500"])},null,2),e("span",{class:G(["text-xs",ue(s)>=100?"text-red-600 dark:text-red-400":"text-yellow-600 dark:text-yellow-400"])},g(ue(s)>=100?"已超过费用限额，新请求将被拒绝":"费用即将达到限额，请注意控制"),3)])):w("",!0)])])):w("",!0),s.rateLimitWindow>0&&(s.rateLimitRequests>0||s.tokenLimit>0)?(r(),le(Be,{key:1,"current-requests":s.currentWindowRequests,"current-tokens":s.currentWindowTokens,"rate-limit-window":s.rateLimitWindow,"request-limit":s.rateLimitRequests,"show-progress":!0,"show-tooltip":!1,"token-limit":s.tokenLimit,"window-end-time":s.windowEndTime,"window-remaining-seconds":s.windowRemainingSeconds,"window-start-time":s.windowStartTime},null,8,["current-requests","current-tokens","rate-limit-window","request-limit","token-limit","window-end-time","window-remaining-seconds","window-start-time"])):w("",!0)]),e("div",_c,[e("div",Dc,[t[105]||(t[105]=e("span",null,"创建时间",-1)),e("span",null,g(it(s.createdAt)),1)]),e("div",Lc,[t[107]||(t[107]=e("span",null,"过期时间",-1)),e("div",Mc,[e("span",{class:G(Oe(s.expiresAt)?"font-semibold text-orange-600":"")},g(s.expiresAt?it(s.expiresAt):"永不过期"),3),e("button",{class:"inline-flex h-5 w-5 items-center justify-center rounded text-gray-300 transition-all duration-200 hover:bg-blue-50 hover:text-blue-500",title:"编辑过期时间",onClick:me(E=>ot(s),["stop"])},[...t[106]||(t[106]=[e("svg",{class:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1)])],8,Tc)])])]),s.tags&&s.tags.length>0?(r(),o("div",Sc,[(r(!0),o(Y,null,N(s.tags,E=>(r(),o("span",{key:E,class:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs text-blue-800"},g(E),1))),128))])):w("",!0),e("div",jc,[e("button",{class:"flex flex-1 items-center justify-center gap-1 rounded-lg bg-blue-50 px-3 py-2 text-xs text-blue-600 transition-colors hover:bg-blue-100",onClick:E=>qe(s)},[...t[108]||(t[108]=[e("i",{class:"fas fa-chart-line"},null,-1),T(" 查看详情 ",-1)])],8,Vc),e("button",{class:"flex-1 rounded-lg bg-cyan-50 px-3 py-2 text-xs text-cyan-600 transition-colors hover:bg-cyan-100",onClick:E=>ct(s)},[...t[109]||(t[109]=[e("i",{class:"fas fa-link mr-1"},null,-1),T(" 绑定 ",-1)])],8,Rc),e("button",{class:"flex-1 rounded-lg bg-gray-50 px-3 py-2 text-xs text-gray-600 transition-colors hover:bg-gray-100",onClick:E=>st(s)},[...t[110]||(t[110]=[e("i",{class:"fas fa-edit mr-1"},null,-1),T(" 编辑 ",-1)])],8,Ec),s.expiresAt&&(Pe(s.expiresAt)||Oe(s.expiresAt))?(r(),o("button",{key:0,class:"flex-1 rounded-lg bg-orange-50 px-3 py-2 text-xs text-orange-600 transition-colors hover:bg-orange-100",onClick:E=>at(s)},[...t[111]||(t[111]=[e("i",{class:"fas fa-clock mr-1"},null,-1),T(" 续期 ",-1)])],8,Uc)):w("",!0),e("button",{class:G([s.isActive?"bg-orange-50 text-orange-600 hover:bg-orange-100":"bg-green-50 text-green-600 hover:bg-green-100","rounded-lg px-3 py-2 text-xs transition-colors"]),onClick:E=>rt(s)},[e("i",{class:G(["fas",s.isActive?"fa-ban":"fa-check-circle","mr-1"])},null,2),T(" "+g(s.isActive?"禁用":"激活"),1)],10,Pc),e("button",{class:"rounded-lg bg-red-50 px-3 py-2 text-xs text-red-600 transition-colors hover:bg-red-100",onClick:E=>lt(s.id)},[...t[112]||(t[112]=[e("i",{class:"fas fa-trash"},null,-1)])],8,Oc)])])}),128))])):w("",!0),Se.value.length>0?(r(),o("div",Gc,[e("div",qc,[e("span",Bc," 共 "+g(Se.value.length)+" 条记录 ",1),e("div",Wc,[t[113]||(t[113]=e("span",{class:"text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},"每页显示",-1)),M(e("select",{"onUpdate:modelValue":t[17]||(t[17]=s=>C.value=s),class:"rounded-md border border-gray-200 bg-white px-2 py-1 text-xs text-gray-700 transition-colors hover:border-gray-300 focus:border-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:border-gray-500 sm:text-sm",onChange:t[18]||(t[18]=s=>p.value=1)},[(r(),o(Y,null,N(X,s=>e("option",{key:s,value:s},g(s),9,Fc)),64))],544),[[ge,C.value]]),t[114]||(t[114]=e("span",{class:"text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},"条",-1))])]),e("div",zc,[e("button",{class:"rounded-md border border-gray-300 bg-white px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 sm:py-1 sm:text-sm",disabled:p.value===1,onClick:t[19]||(t[19]=s=>p.value--)},[...t[115]||(t[115]=[e("i",{class:"fas fa-chevron-left"},null,-1)])],8,Yc),e("div",Hc,[p.value>3?(r(),o("button",{key:0,class:"hidden rounded-md border border-gray-300 bg-white px-3 py-1 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 sm:block",onClick:t[20]||(t[20]=s=>p.value=1)}," 1 ")):w("",!0),p.value>4?(r(),o("span",Nc,"...")):w("",!0),(r(!0),o(Y,null,N(yt.value,s=>(r(),o("button",{key:s,class:G(["rounded-md px-2 py-1 text-xs font-medium sm:px-3 sm:text-sm",s===p.value?"bg-blue-600 text-white":"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"]),onClick:B=>p.value=s},g(s),11,Qc))),128)),p.value<$e.value-3?(r(),o("span",Jc,"...")):w("",!0),$e.value>1&&p.value<$e.value-2?(r(),o("button",{key:3,class:"hidden rounded-md border border-gray-300 bg-white px-3 py-1 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 sm:block",onClick:t[21]||(t[21]=s=>p.value=$e.value)},g($e.value),1)):w("",!0)]),e("button",{class:"rounded-md border border-gray-300 bg-white px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 sm:py-1 sm:text-sm",disabled:p.value===$e.value||$e.value===0,onClick:t[22]||(t[22]=s=>p.value++)},[...t[116]||(t[116]=[e("i",{class:"fas fa-chevron-right"},null,-1)])],8,Xc)])])):w("",!0)]),P.value?(r(),le(La,{key:0,accounts:a.value,onBatchSuccess:Ct,onClose:t[23]||(t[23]=s=>P.value=!1),onSuccess:At},null,8,["accounts"])):w("",!0),i.value?(r(),le(Ur,{key:1,accounts:a.value,"api-key":pe.value,onClose:t[24]||(t[24]=s=>i.value=!1),onSuccess:_t},null,8,["accounts","api-key"])):w("",!0),v.value?(r(),le(tl,{key:2,"api-key":ke.value,onClose:t[25]||(t[25]=s=>v.value=!1),onSuccess:Dt},null,8,["api-key"])):w("",!0),ee.value?(r(),le(pl,{key:3,"api-key":re.value,onClose:t[26]||(t[26]=s=>ee.value=!1)},null,8,["api-key"])):w("",!0),J.value?(r(),le(Ol,{key:4,"api-keys":he.value,onClose:t[27]||(t[27]=s=>J.value=!1)},null,8,["api-keys"])):w("",!0),se.value?(r(),le(Xo,{key:5,accounts:a.value,"selected-keys":K.value,onClose:t[28]||(t[28]=s=>se.value=!1),onSuccess:Kt},null,8,["accounts","selected-keys"])):w("",!0),ie(hn,{ref_key:"expiryEditModalRef",ref:j,"api-key":d.value||{id:null,expiresAt:null,name:""},show:!!d.value,onClose:nt,onSave:St},null,8,["api-key","show"]),ie(gi,{"api-key":y.value||{},show:L.value,onClose:t[29]||(t[29]=s=>L.value=!1)},null,8,["api-key","show"]),b.value?(r(),le(Vi,{key:6,accounts:a.value,"api-key":c.value,onClose:t[30]||(t[30]=s=>b.value=!1),onSuccess:jt},null,8,["accounts","api-key"])):w("",!0),ce.value?(r(),le(hd,{key:7,"api-keys":x.value,onClose:t[31]||(t[31]=s=>ce.value=!1),onExportComplete:Vt},null,8,["api-keys"])):w("",!0)])}}},ng=xe(Zc,[["__scopeId","data-v-d85047f0"]]);export{ng as default};
