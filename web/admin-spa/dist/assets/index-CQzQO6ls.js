const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginView-DG051uhR.js","assets/ThemeToggle-ttUb9eOE.js","assets/vue-vendor-CngTbNDx.js","assets/ThemeToggle-BuyAUIqu.css","assets/element-plus-dC9ox4YM.js","assets/vendor-yff5vP9v.js","assets/element-plus-6gb5osKz.css","assets/LoginView-CtfuafU8.css","assets/UserLoginView-B0pPmtyV.js","assets/UserLoginView-tn0RQdqM.css","assets/UserDashboardView-DKt1x_-g.js","assets/ConfirmModal-Wm3_KZBR.js","assets/ConfirmModal-BvCtxUSJ.css","assets/TutorialView-BJRQcZVF.js","assets/TutorialView-Bk8HKBsr.css","assets/UserManagementView-CrkXfyM6.js","assets/MainLayout-BLl3p9Ly.js","assets/LogoTitle-CGW7ekC6.js","assets/LogoTitle-DXipqypn.css","assets/MainLayout-YFecWkVM.css","assets/DashboardView-BUAMHUiv.js","assets/chart-CUr5ITHQ.js","assets/DashboardView-pI_wVP7g.css","assets/ApiKeysView-DaN8g-lc.js","assets/WindowCountdown-DzdmYFMU.js","assets/CustomDropdown-lsDechlb.js","assets/CustomDropdown-jjrvIxsf.css","assets/ApiKeysView-BxRaQygy.css","assets/AccountsView-BGpixcFL.js","assets/AccountsView-6A77ZC2n.css","assets/SettingsView-TMdNO_M8.js","assets/SettingsView-C-dUFnp6.css","assets/ApiStatsView-C-IMLn13.js","assets/ApiStatsView-BFFMYj6J.css"])))=>i.map(i=>d[i]);
import{aR as B,aS as me,aT as fe,r as f,c as O,o as W,q as F,V as Q,I as Y,z as y,x,ac as ge,Q as pe,a5 as Z,y as k,C as z,L as M,P as C,Y as ee,B as ve,R as q,J as ye,T as we,O as _e,ax as Te,aO as Ae,aU as Ie}from"./vue-vendor-CngTbNDx.js";import{i as ke,z as Se}from"./element-plus-dC9ox4YM.js";import{P as A}from"./vendor-yff5vP9v.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();const be="modulepreload",xe=function(s){return"/admin-next/"+s},X={},T=function(e,t,a){let o=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),u=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));o=Promise.allSettled(t.map(d=>{if(d=xe(d),d in X)return;X[d]=!0;const h=d.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${g}`))return;const n=document.createElement("link");if(n.rel=h?"stylesheet":be,h||(n.as="script"),n.crossOrigin="",n.href=d,u&&n.setAttribute("nonce",u),document.head.appendChild(n),h)return new Promise((m,p)=>{n.addEventListener("load",m),n.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(r){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=r,window.dispatchEvent(u),!u.defaultPrevented)throw r}return o.then(r=>{for(const u of r||[])u.status==="rejected"&&i(u.reason);return e().catch(i)})};let P=null,Ee=0;function te(s,e="info",t="",a=3e3){P||(P=document.createElement("div"),P.id="toast-container",P.style.cssText="position: fixed; top: 20px; right: 20px; z-index: 10000;",document.body.appendChild(P));const o=++Ee,i=document.createElement("div");i.className=`toast rounded-2xl p-4 shadow-2xl backdrop-blur-sm toast-${e}`,i.style.cssText=`
    position: relative;
    min-width: 320px;
    max-width: 500px;
    margin-bottom: 16px;
    transform: translateX(100%);
    transition: transform 0.3s ease-in-out;
  `;const r={success:"fas fa-check-circle",error:"fas fa-times-circle",warning:"fas fa-exclamation-triangle",info:"fas fa-info-circle"},u=s.replace(/\n/g,"<br>");return i.innerHTML=`
    <div class="flex items-start gap-3">
      <div class="flex-shrink-0 mt-0.5">
        <i class="${r[e]} text-lg"></i>
      </div>
      <div class="flex-1 min-w-0">
        ${t?`<h4 class="font-semibold text-sm mb-1">${t}</h4>`:""}
        <p class="text-sm opacity-90 leading-relaxed">${u}</p>
      </div>
      <button onclick="this.parentElement.parentElement.remove()" 
              class="flex-shrink-0 text-white/70 hover:text-white transition-colors ml-2">
        <i class="fas fa-times"></i>
      </button>
    </div>
  `,P.appendChild(i),setTimeout(()=>{i.style.transform="translateX(0)"},10),a>0&&setTimeout(()=>{i.style.transform="translateX(100%)",setTimeout(()=>{i.remove()},300)},a),o}const Pe=Object.freeze(Object.defineProperty({__proto__:null,showToast:te},Symbol.toStringTag,{value:"Module"})),S="/users",se=B("user",{state:()=>({user:null,isAuthenticated:!1,sessionToken:null,loading:!1,config:null}),getters:{isLoggedIn:s=>s.isAuthenticated&&s.user,userName:s=>{var e,t;return((e=s.user)==null?void 0:e.displayName)||((t=s.user)==null?void 0:t.username)},userRole:s=>{var e;return(e=s.user)==null?void 0:e.role}},actions:{async login(s){this.loading=!0;try{const e=await A.post(`${S}/login`,s);if(e.data.success)return this.user=e.data.user,this.sessionToken=e.data.sessionToken,this.isAuthenticated=!0,localStorage.setItem("userToken",this.sessionToken),localStorage.setItem("userData",JSON.stringify(this.user)),this.setAuthHeader(),e.data;throw new Error(e.data.message||"Login failed")}catch(e){throw this.clearAuth(),e}finally{this.loading=!1}},async logout(){try{this.sessionToken&&await A.post(`${S}/logout`,{},{headers:{"x-user-token":this.sessionToken}})}catch(s){console.error("Logout request failed:",s)}finally{this.clearAuth()}},async checkAuth(){const s=localStorage.getItem("userToken"),e=localStorage.getItem("userData"),t=localStorage.getItem("userConfig");if(!s||!e)return this.clearAuth(),!1;try{return this.sessionToken=s,this.user=JSON.parse(e),this.config=t?JSON.parse(t):null,this.isAuthenticated=!0,this.setAuthHeader(),await this.getUserProfile(),!0}catch(a){return console.error("Auth check failed:",a),this.clearAuth(),!1}},async getUserProfile(){var s,e,t,a;try{const o=await A.get(`${S}/profile`);if(o.data.success)return this.user=o.data.user,this.config=o.data.config,localStorage.setItem("userData",JSON.stringify(this.user)),localStorage.setItem("userConfig",JSON.stringify(this.config)),o.data.user}catch(o){throw(((s=o.response)==null?void 0:s.status)===401||((e=o.response)==null?void 0:e.status)===403)&&(this.clearAuth(),((t=o.response)==null?void 0:t.status)===403)?new Error(((a=o.response.data)==null?void 0:a.message)||"Your account has been disabled"):o}},async getUserApiKeys(s=!1){try{const e={};s&&(e.includeDeleted="true");const t=await A.get(`${S}/api-keys`,{params:e});return t.data.success?t.data.apiKeys:[]}catch(e){throw console.error("Failed to fetch API keys:",e),e}},async createApiKey(s){try{return(await A.post(`${S}/api-keys`,s)).data}catch(e){throw console.error("Failed to create API key:",e),e}},async deleteApiKey(s){try{return(await A.delete(`${S}/api-keys/${s}`)).data}catch(e){throw console.error("Failed to delete API key:",e),e}},async getUserUsageStats(s={}){try{const e=await A.get(`${S}/usage-stats`,{params:s});return e.data.success?e.data.stats:null}catch(e){throw console.error("Failed to fetch usage stats:",e),e}},clearAuth(){this.user=null,this.sessionToken=null,this.isAuthenticated=!1,this.config=null,localStorage.removeItem("userToken"),localStorage.removeItem("userData"),localStorage.removeItem("userConfig"),delete A.defaults.headers.common["x-user-token"]},setAuthHeader(){this.sessionToken&&(A.defaults.headers.common["x-user-token"]=this.sessionToken)},setupAxiosInterceptors(){A.interceptors.response.use(s=>s,s=>{var e,t;if(((e=s.response)==null?void 0:e.status)===403){const a=(t=s.response.data)==null?void 0:t.message;a&&(a.includes("disabled")||a.includes("Account disabled"))&&(this.clearAuth(),te(a,"error"),window.location.pathname!=="/user-login"&&(window.location.href="/user-login"))}return Promise.reject(s)})}}}),j={basePath:"/admin-next/",apiPrefix:""};function Le(s=""){return s&&!s.startsWith("/")&&(s="/"+s),j.basePath+(s.startsWith("#")?s:"#"+s)}function Oe(){return Le("/login")}const Ce=()=>T(()=>import("./LoginView-DG051uhR.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])),Ue=()=>T(()=>import("./UserLoginView-B0pPmtyV.js"),__vite__mapDeps([8,2,1,3,4,5,6,9])),De=()=>T(()=>import("./UserDashboardView-DKt1x_-g.js"),__vite__mapDeps([10,2,1,3,11,12,13,4,5,6,14,9])),Re=()=>T(()=>import("./UserManagementView-CrkXfyM6.js"),__vite__mapDeps([15,2,11,12,5,4,6,9])),L=()=>T(()=>import("./MainLayout-BLl3p9Ly.js"),__vite__mapDeps([16,2,17,18,1,3,4,5,6,19])),$e=()=>T(()=>import("./DashboardView-BUAMHUiv.js"),__vite__mapDeps([20,4,2,5,6,21,22])),Ve=()=>T(()=>import("./ApiKeysView-DaN8g-lc.js"),__vite__mapDeps([23,4,2,5,6,24,25,26,27])),Ne=()=>T(()=>import("./AccountsView-BGpixcFL.js"),__vite__mapDeps([28,4,2,5,6,11,12,21,25,26,29])),qe=()=>T(()=>import("./TutorialView-BJRQcZVF.js"),__vite__mapDeps([13,2,4,5,6,14])),Me=()=>T(()=>import("./SettingsView-TMdNO_M8.js"),__vite__mapDeps([30,2,4,5,6,31])),je=()=>T(()=>import("./ApiStatsView-C-IMLn13.js"),__vite__mapDeps([32,2,17,18,1,3,5,24,13,4,6,14,33])),Ke=[{path:"/",redirect:()=>{const s=window.location.pathname,e=j.basePath.replace(/\/$/,"");return s===e||s===e+"/","/api-stats"}},{path:"/login",name:"Login",component:Ce,meta:{requiresAuth:!1}},{path:"/admin-login",redirect:"/login"},{path:"/user-login",name:"UserLogin",component:Ue,meta:{requiresAuth:!1,userAuth:!0}},{path:"/user-dashboard",name:"UserDashboard",component:De,meta:{requiresUserAuth:!0}},{path:"/api-stats",name:"ApiStats",component:je,meta:{requiresAuth:!1}},{path:"/dashboard",component:L,meta:{requiresAuth:!0},children:[{path:"",name:"Dashboard",component:$e}]},{path:"/api-keys",component:L,meta:{requiresAuth:!0},children:[{path:"",name:"ApiKeys",component:Ve}]},{path:"/accounts",component:L,meta:{requiresAuth:!0},children:[{path:"",name:"Accounts",component:Ne}]},{path:"/tutorial",component:L,meta:{requiresAuth:!0},children:[{path:"",name:"Tutorial",component:qe}]},{path:"/settings",component:L,meta:{requiresAuth:!0},children:[{path:"",name:"Settings",component:Me}]},{path:"/user-management",component:L,meta:{requiresAuth:!0},children:[{path:"",name:"UserManagement",component:Re}]},{path:"/:pathMatch(.*)*",redirect:"/api-stats"}],U=me({history:fe(j.basePath),routes:Ke});U.beforeEach(async(s,e,t)=>{const a=ae(),o=se();if(console.log("路由导航:",{to:s.path,from:e.path,fullPath:s.fullPath,requiresAuth:s.meta.requiresAuth,requiresUserAuth:s.meta.requiresUserAuth,isAuthenticated:a.isAuthenticated,isUserAuthenticated:o.isAuthenticated}),s.path===e.path&&s.fullPath===e.fullPath)return t();if(s.meta.requiresUserAuth){if(!o.isAuthenticated)try{if(!await o.checkAuth())return t("/user-login")}catch(i){if(i.message&&i.message.includes("disabled")){const{showToast:r}=await T(async()=>{const{showToast:u}=await Promise.resolve().then(()=>Pe);return{showToast:u}},void 0);r(i.message,"error")}return t("/user-login")}return t()}s.path==="/api-stats"||s.path.startsWith("/api-stats")?t():s.path==="/user-login"?o.isAuthenticated?t("/user-dashboard"):t():s.meta.requiresAuth&&!a.isAuthenticated?t("/login"):s.path==="/login"&&a.isAuthenticated?t("/dashboard"):t()});const oe=j.apiPrefix;function $(s){return s.startsWith("/")||(s="/"+s),oe+s}class He{constructor(){this.baseURL=oe}getAuthToken(){return localStorage.getItem("authToken")||null}buildConfig(e={}){const t={headers:{"Content-Type":"application/json",...e.headers},...e},a=this.getAuthToken();return a&&(t.headers.Authorization=`Bearer ${a}`),t}async handleResponse(e){if(e.status===401){const a=window.location.pathname+window.location.hash;throw a.includes("/login")||a.endsWith("/")||(localStorage.removeItem("authToken"),window.location.href=Oe()),new Error("Unauthorized")}const t=e.headers.get("content-type");if(t&&t.includes("application/json")){const a=await e.json();if(!e.ok){const o=new Error(a.message||`HTTP ${e.status}`);throw o.response={status:e.status,data:a},o.message=a.message||o.message,o}return a}if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return e}async get(e,t={}){let a=$(e);if(t.params){const u=new URLSearchParams(t.params);a+="?"+u.toString()}const{params:o,...i}=t,r=this.buildConfig({...i,method:"GET"});try{const u=await fetch(a,r);return await this.handleResponse(u)}catch(u){throw console.error("API GET Error:",u),u}}async post(e,t=null,a={}){const o=$(e),i=this.buildConfig({...a,method:"POST",body:t?JSON.stringify(t):void 0});try{const r=await fetch(o,i);return await this.handleResponse(r)}catch(r){throw console.error("API POST Error:",r),r}}async put(e,t=null,a={}){const o=$(e),i=this.buildConfig({...a,method:"PUT",body:t?JSON.stringify(t):void 0});try{const r=await fetch(o,i);return await this.handleResponse(r)}catch(r){throw console.error("API PUT Error:",r),r}}async patch(e,t=null,a={}){const o=$(e),i=this.buildConfig({...a,method:"PATCH",body:t?JSON.stringify(t):void 0});try{const r=await fetch(o,i);return await this.handleResponse(r)}catch(r){throw console.error("API PATCH Error:",r),r}}async delete(e,t={}){const a=$(e),{data:o,...i}=t,r=this.buildConfig({...i,method:"DELETE",body:o?JSON.stringify(o):void 0});try{const u=await fetch(a,r);return await this.handleResponse(u)}catch(u){throw console.error("API DELETE Error:",u),u}}}const b=new He,ae=B("auth",()=>{const s=f(!1),e=f(localStorage.getItem("authToken")||""),t=f(localStorage.getItem("sessionToken")||""),a=f(""),o=f(null),i=f(null),r=f(localStorage.getItem("sessionType")||""),u=f(""),d=f(!1),h=f(!1),g=f({siteName:"Claude Relay Service",siteIcon:"",siteIconData:"",faviconData:""}),n=f(!0),m=O(()=>{var l;return((l=i.value)==null?void 0:l.username)||""}),p=O(()=>!!t.value),I=O(()=>t.value),H=O(()=>e.value);function E(l){if(!l){i.value=null,localStorage.removeItem("user");return}const c={id:l.id||l.username||"",username:l.username||l.id||"",role:l.role||"admin",...l};i.value=c;try{localStorage.setItem("user",JSON.stringify(c))}catch(v){console.warn("Persist user failed:",v)}}function V(){const l=localStorage.getItem("user");if(!l){i.value=null;return}try{const c=JSON.parse(l);i.value={id:c.id||c.username||"",username:c.username||c.id||"",role:c.role||"admin",...c}}catch(c){console.warn("Restore user failed:",c),i.value=null}}async function re(l){d.value=!0,u.value="";try{const c=await b.post("/web/auth/login",l);if(c!=null&&c.success){const v=c.data||{},_=v.sessionToken||c.sessionToken||c.token||"";if(!_)throw new Error(c.message||"登录失败");const N=v.sessionId||c.sessionId||_;let R=v.expiresAt||c.expiresAt||null;if(!R&&c.expiresIn)try{R=new Date(Date.now()+c.expiresIn).toISOString()}catch(he){console.warn("Calculate expiry failed:",he)}const de=v.user||{id:v.userId||c.userId||c.username||l.username,username:v.username||c.username||l.username,role:v.role||"admin"};t.value=_,a.value=N,o.value=R,E(de),s.value=!0,r.value=_.includes(".")?"jwt":"legacy",localStorage.setItem("sessionType",r.value),localStorage.setItem("sessionToken",_),localStorage.setItem("sessionId",N),R&&localStorage.setItem("expiresAt",R),e.value=_,localStorage.setItem("authToken",_),await U.push("/dashboard")}else u.value=c.message||"登录失败"}catch(c){u.value=c.message||"登录失败，请检查用户名和密码"}finally{d.value=!1}}async function ne(){try{t.value&&(r.value==="legacy"?await b.post("/web/auth/logout"):await b.post("/auth/logout"))}catch(l){console.warn("Logout API call failed:",l.message)}D(),U.push("/login")}function D(){s.value=!1,e.value="",t.value="",a.value="",o.value=null,E(null),r.value="",localStorage.removeItem("authToken"),localStorage.removeItem("sessionToken"),localStorage.removeItem("sessionId"),localStorage.removeItem("expiresAt"),localStorage.removeItem("sessionType")}function ie(){const l=localStorage.getItem("sessionToken"),c=localStorage.getItem("sessionId"),v=localStorage.getItem("expiresAt"),_=localStorage.getItem("sessionType");if(l){if(t.value=l,a.value=c||"",o.value=v,r.value=_||(l.includes(".")?"jwt":"legacy"),e.value=l,V(),v&&new Date(v)<=new Date){D();return}s.value=!0,r.value==="jwt"&&J()}else e.value&&(t.value=e.value,s.value=!0,V(),r.value=e.value.includes(".")?"jwt":"legacy",r.value==="jwt"&&J())}async function J(){if(!(!t.value||r.value!=="jwt"))try{const l=await b.get("/auth/validate");if(l.success&&l.data)E(l.data.user),s.value=!0;else throw new Error("Session validation failed")}catch(l){console.warn("Session validation failed:",l.message),D(),U.push("/login")}}async function le(){if(h.value||!t.value||r.value!=="jwt")return!1;h.value=!0;try{const l=await b.post("/auth/refresh");if(l.success&&l.data){const{sessionToken:c,sessionId:v,expiresAt:_,user:N}=l.data;return t.value=c,a.value=v,o.value=_,E(N),localStorage.setItem("sessionToken",c),localStorage.setItem("sessionId",v),_&&localStorage.setItem("expiresAt",_),e.value=c,localStorage.setItem("authToken",c),!0}else throw new Error(l.message||"Session refresh failed")}catch(l){return console.error("Session refresh failed:",l.message),D(),U.push("/login"),!1}finally{h.value=!1}}async function ce(l,c){try{const v=await b.post("/auth/change-password",{oldPassword:l,newPassword:c});if(v.success)return{success:!0,message:v.message};throw new Error(v.message||"Password change failed")}catch(v){throw new Error(v.message||"Password change failed")}}async function ue(){n.value=!0;try{const l=await b.get("/admin/oem-settings");if(l.success&&l.data){if(g.value={...g.value,...l.data},l.data.siteIconData||l.data.siteIcon){const c=document.querySelector("link[rel*='icon']")||document.createElement("link");c.type="image/x-icon",c.rel="shortcut icon",c.href=l.data.siteIconData||l.data.siteIcon,document.getElementsByTagName("head")[0].appendChild(c)}l.data.siteName&&(document.title=`${l.data.siteName} - 管理后台`)}}catch(l){console.error("加载OEM设置失败:",l)}finally{n.value=!1}}return{isLoggedIn:s,authToken:e,sessionToken:t,sessionId:a,expiresAt:o,user:i,sessionType:r,username:m,loginError:u,loginLoading:d,refreshing:h,oemSettings:g,oemLoading:n,isAuthenticated:p,token:I,legacyToken:H,login:re,logout:ne,checkAuth:ie,verifySession:J,refreshSession:le,changePassword:ce,clearAuthState:D,loadOemSettings:ue}}),w={LIGHT:"light",DARK:"dark",AUTO:"auto"},Je=B("theme",()=>{const s=f(w.AUTO),e=f(!1),t=O(()=>s.value===w.DARK?!0:s.value===w.LIGHT?!1:e.value),a=O(()=>t.value?w.DARK:w.LIGHT),o=()=>{const n=window.matchMedia("(prefers-color-scheme: dark)");e.value=n.matches;const m=localStorage.getItem("themeMode");m&&Object.values(w).includes(m)?s.value=m:s.value=w.AUTO,i(),d()},i=()=>{const n=document.documentElement;t.value?n.classList.add("dark"):n.classList.remove("dark")},r=n=>{Object.values(w).includes(n)&&(s.value=n)},u=()=>{const n=[w.LIGHT,w.DARK,w.AUTO],p=(n.indexOf(s.value)+1)%n.length;s.value=n[p]};W(s,n=>{localStorage.setItem("themeMode",n),i()}),W(e,()=>{s.value===w.AUTO&&i()});const d=()=>{const n=window.matchMedia("(prefers-color-scheme: dark)"),m=p=>{e.value=p.matches};return e.value=n.matches,n.addEventListener("change",m),()=>{n.removeEventListener("change",m)}};return{themeMode:s,isDarkMode:t,currentTheme:a,systemPrefersDark:e,ThemeMode:w,initTheme:o,setThemeMode:r,cycleThemeMode:u,watchSystemTheme:d,toggleTheme:()=>{u()},setTheme:n=>{n==="dark"?r(w.DARK):n==="light"&&r(w.LIGHT)}}}),G=(s,e)=>{const t=s.__vccOpts||s;for(const[a,o]of e)t[a]=o;return t},ze={class:"toast-container"},Be=["onClick"],Fe={class:"toast-content"},Ge={class:"toast-icon"},We={class:"toast-body"},Xe={key:0,class:"toast-title"},Qe={class:"toast-message"},Ye=["onClick"],Ze={__name:"ToastNotification",setup(s,{expose:e}){const t=f([]);let a=0;const o=h=>{const g={success:"fas fa-check-circle",error:"fas fa-exclamation-circle",warning:"fas fa-exclamation-triangle",info:"fas fa-info-circle"};return g[h]||g.info},i=(h,g="info",n=null,m=5e3)=>{const p=++a,I={id:p,message:h,type:g,title:n,duration:m,isVisible:!1};return t.value.push(I),setTimeout(()=>{I.isVisible=!0},10),m>0&&setTimeout(()=>{r(p)},m),p},r=h=>{const g=t.value.findIndex(n=>n.id===h);if(g>-1){const n=t.value[g];n.isVisible=!1,setTimeout(()=>{const m=t.value.findIndex(p=>p.id===h);m>-1&&t.value.splice(m,1)},300)}},u=()=>{t.value.forEach(h=>{h.isVisible=!1}),setTimeout(()=>{t.value.length=0},300)},d=(h,g="info",n=null,m=5e3)=>i(h,g,n,m);return F(()=>{window.showToast=d}),Q(()=>{window.showToast===d&&delete window.showToast}),e({showToast:d,removeToast:r,clearAllToasts:u}),(h,g)=>(k(),Y(Z,{to:"body"},[y("div",ze,[(k(!0),x(pe,null,ge(t.value,n=>(k(),x("div",{key:n.id,class:z(["toast",`toast-${n.type}`,n.isVisible?"toast-show":"toast-hide"]),onClick:m=>r(n.id)},[y("div",Fe,[y("div",Ge,[y("i",{class:z(o(n.type))},null,2)]),y("div",We,[n.title?(k(),x("div",Xe,C(n.title),1)):M("",!0),y("div",Qe,C(n.message),1)]),y("button",{class:"toast-close",onClick:ee(m=>r(n.id),["stop"])},[...g[0]||(g[0]=[y("i",{class:"fas fa-times"},null,-1)])],8,Ye)]),n.duration>0?(k(),x("div",{key:0,class:"toast-progress",style:ve({animationDuration:`${n.duration}ms`})},null,4)):M("",!0)],10,Be))),128))])]))}},et=G(Ze,[["__scopeId","data-v-c8b24ff5"]]),tt={class:"modal-content mx-auto w-full max-w-md p-6"},st={class:"mb-6 flex items-start gap-4"},ot={class:"flex-1"},at={class:"mb-2 text-lg font-semibold text-gray-900 dark:text-white"},rt={class:"whitespace-pre-line leading-relaxed text-gray-700 dark:text-gray-400"},nt={class:"flex items-center justify-end gap-3"},it=["disabled"],lt=["disabled"],ct={key:0,class:"loading-spinner mr-2"},ut={__name:"ConfirmDialog",setup(s,{expose:e}){const t=f(!1),a=f(!1),o=f(""),i=f(""),r=f("确认"),u=f("取消");let d=null;const h=(p,I,H="确认",E="取消")=>new Promise(V=>{o.value=p,i.value=I,r.value=H,u.value=E,t.value=!0,a.value=!1,d=V}),g=()=>{a.value||(a.value=!0,setTimeout(()=>{t.value=!1,a.value=!1,d&&(d(!0),d=null)},200))},n=()=>{a.value||(t.value=!1,d&&(d(!1),d=null))},m=p=>{t.value&&(p.key==="Escape"?n():p.key==="Enter"&&!p.shiftKey&&!p.ctrlKey&&!p.altKey&&g())};return F(()=>{window.showConfirm=h,document.addEventListener("keydown",m)}),Q(()=>{window.showConfirm===h&&delete window.showConfirm,document.removeEventListener("keydown",m)}),e({showConfirm:h}),(p,I)=>(k(),Y(Z,{to:"body"},[q(we,{appear:"",name:"modal"},{default:ye(()=>[t.value?(k(),x("div",{key:0,class:"modal fixed inset-0 z-[100] flex items-center justify-center p-4",onClick:ee(n,["self"])},[y("div",tt,[y("div",st,[I[0]||(I[0]=y("div",{class:"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-amber-500 to-amber-600"},[y("i",{class:"fas fa-exclamation-triangle text-lg text-white"})],-1)),y("div",ot,[y("h3",at,C(o.value),1),y("div",rt,C(i.value),1)])]),y("div",nt,[y("button",{class:"btn bg-gray-100 px-6 py-3 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",disabled:a.value,onClick:n},C(u.value),9,it),y("button",{class:z(["btn btn-warning px-6 py-3",{"cursor-not-allowed opacity-50":a.value}]),disabled:a.value,onClick:g},[a.value?(k(),x("div",ct)):M("",!0),_e(" "+C(r.value),1)],10,lt)])])])):M("",!0)]),_:1})]))}},dt=G(ut,[["__scopeId","data-v-6b3390a6"]]),ht={id:"app"},mt={__name:"App",setup(s){const e=ae(),t=Je(),a=f(),o=f();return F(()=>{t.initTheme(),t.watchSystemTheme(),e.checkAuth(),e.loadOemSettings()}),(i,r)=>{const u=Te("router-view");return k(),x("div",ht,[q(u),q(et,{ref_key:"toastRef",ref:a},null,512),q(dt,{ref_key:"confirmRef",ref:o},null,512)])}}},ft=G(mt,[["__scopeId","data-v-dab04b7e"]]),K=Ae(ft),gt=Ie();K.use(gt);K.use(U);K.use(ke,{locale:Se});const pt=se();pt.setupAxiosInterceptors();K.mount("#app");export{G as _,Je as a,se as b,b as c,te as s,ae as u};
