import{aR as xt,r as i,aV as pt,o as mt,q as kt,Z as wt,x as o,z as e,L as p,C as O,O as c,u as A,K as u,S as ee,aq as D,P as g,aX as H,aW as ce,al as E,Q as be,ac as _e,R as Ve,J as Te,av as ht,T as _t,Y as Ct,y as n}from"./vue-vendor-Ig-GgGwA.js";import{s as d}from"./toast-BvwA7Mwb.js";import{b as f,_ as St}from"./index-DHcZKH3L.js";import"./element-plus-lTawJ3jz.js";import"./vendor-DuCvjFhD.js";const At=xt("settings",()=>{const j=i({siteName:"Claude Relay Service",siteIcon:"",siteIconData:"",updatedAt:null}),I=i(!1),K=i(!1),q=async()=>{I.value=!0;try{const b=await f.get("/admin/oem-settings");return b&&b.success&&(j.value={...j.value,...b.data},x()),b}catch(b){throw console.error("Failed to load OEM settings:",b),b}finally{I.value=!1}},S=async b=>{K.value=!0;try{const k=await f.put("/admin/oem-settings",b);return k&&k.success&&(j.value={...j.value,...k.data},x()),k}catch(k){throw console.error("Failed to save OEM settings:",k),k}finally{K.value=!1}},fe=async()=>{const b={siteName:"Claude Relay Service",siteIcon:"",siteIconData:"",updatedAt:null};return j.value={...b},await S(b)},x=()=>{if(j.value.siteName&&(document.title=`${j.value.siteName} - 管理后台`),j.value.siteIconData||j.value.siteIcon){const b=document.querySelector('link[rel="icon"]')||document.createElement("link");b.rel="icon",b.href=j.value.siteIconData||j.value.siteIcon,document.querySelector('link[rel="icon"]')||document.head.appendChild(b)}};return{oemSettings:j,loading:I,saving:K,loadOemSettings:q,saveOemSettings:S,resetOemSettings:fe,applyOemSettings:x,formatDateTime:b=>b?new Date(b).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"",validateIconFile:b=>{const k=[];return b.size>350*1024&&k.push("图标文件大小不能超过 350KB"),["image/x-icon","image/png","image/jpeg","image/jpg","image/svg+xml"].includes(b.type)||k.push("不支持的文件类型，请选择 .ico, .png, .jpg 或 .svg 文件"),{isValid:k.length===0,errors:k}},fileToBase64:b=>new Promise((k,R)=>{const _=new FileReader;_.onload=M=>k(M.target.result),_.onerror=R,_.readAsDataURL(b)})}}),Dt={class:"settings-container"},Ft={class:"card p-4 sm:p-6"},Ot={class:"mb-6"},jt={class:"flex space-x-8"},Et={key:0,class:"py-12 text-center"},It={key:1},Ut={class:"table-container hidden sm:block"},Vt={class:"min-w-full"},Tt={class:"divide-y divide-gray-200/50 dark:divide-gray-600/50"},Rt={class:"table-row"},Lt={class:"px-6 py-4"},Mt={class:"table-row"},Wt={class:"px-6 py-4"},qt={class:"space-y-3"},Bt={key:0,class:"inline-flex items-center gap-3 rounded-lg bg-gray-50 p-3 dark:bg-gray-700"},$t=["src"],zt={class:"px-6 py-6",colspan:"2"},Nt={class:"flex items-center justify-between"},Pt={class:"flex gap-3"},Gt=["disabled"],Ht={key:0,class:"loading-spinner mr-2"},Kt={key:1,class:"fas fa-save mr-2"},Qt=["disabled"],Jt={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Zt={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Xt={class:"mb-4 flex items-center justify-between"},Yt={class:"text-xs text-gray-500 dark:text-gray-400"},er={class:"space-y-4"},tr={class:"rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-blue-700 dark:bg-blue-900/30"},rr={class:"flex items-start gap-2"},ar={class:"text-sm text-blue-700 dark:text-blue-300"},sr={class:"mb-1 font-medium"},lr={key:0,class:"space-y-2"},or={key:1,class:"space-y-2"},nr={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},dr={class:"space-y-4"},ir={class:"flex items-center justify-between"},ur={class:"relative inline-flex cursor-pointer items-center"},gr={class:"flex items-center justify-between"},cr={class:"relative inline-flex cursor-pointer items-center"},br={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},fr={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},yr={class:"rounded-lg border border-gray-200 p-4 dark:border-gray-700"},vr={class:"flex items-center justify-between"},xr={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},pr={class:"rounded-lg border border-gray-200 p-4 dark:border-gray-700"},mr={class:"flex items-center justify-between"},kr={class:"text-2xl font-bold text-green-600 dark:text-green-400"},wr={class:"rounded-lg border border-gray-200 p-4 dark:border-gray-700"},hr={class:"flex items-center justify-between"},_r={class:"text-2xl font-bold text-purple-600 dark:text-purple-400"},Cr={class:"flex items-center justify-between"},Sr={class:"flex gap-3"},Ar=["disabled"],Dr={key:0,class:"loading-spinner mr-2"},Fr={key:1,class:"fas fa-save mr-2"},Or=["disabled"],jr={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Er={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Ir={class:"flex items-center justify-between"},Ur={class:"relative inline-flex cursor-pointer items-center"},Vr={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Tr={class:"space-y-3"},Rr={class:"font-medium text-gray-700 dark:text-gray-300"},Lr={class:"ml-2 text-sm text-gray-500 dark:text-gray-400"},Mr={class:"relative inline-flex cursor-pointer items-center"},Wr=["onUpdate:modelValue"],qr={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Br={class:"mb-4 flex items-center justify-between"},$r={key:0,class:"space-y-4"},zr={class:"flex items-start justify-between"},Nr={class:"flex-1"},Pr={class:"flex items-center"},Gr={class:"font-semibold text-gray-800 dark:text-gray-200"},Hr={class:"text-sm text-gray-500 dark:text-gray-400"},Kr={class:"mt-3 space-y-1 text-sm"},Qr={class:"flex items-center text-gray-600 dark:text-gray-400"},Jr={class:"truncate"},Zr={key:0,class:"flex items-center text-gray-600 dark:text-gray-400"},Xr={class:"ml-4 flex items-center space-x-2"},Yr={class:"relative inline-flex cursor-pointer items-center"},ea=["checked","onChange"],ta=["onClick"],ra=["onClick"],aa=["onClick"],sa={key:1,class:"py-8 text-center text-gray-500 dark:text-gray-400"},la={class:"rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},oa={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},na={class:"overview-section mb-6 rounded-lg bg-white p-6 dark:bg-gray-800"},da={class:"grid grid-cols-2 gap-4 md:grid-cols-4"},ia={class:"stat-card"},ua={class:"text-2xl font-bold text-blue-600"},ga={class:"stat-card"},ca={class:"text-2xl font-bold text-green-600"},ba={class:"stat-card"},fa={class:"text-2xl font-bold text-purple-600"},ya={class:"stat-card"},va={class:"text-2xl font-bold text-orange-600"},xa={class:"mt-4 border-t border-gray-200 pt-4 dark:border-gray-700"},pa={class:"flex items-center justify-between"},ma={class:"flex items-center space-x-4"},ka={class:"flex items-center"},wa={class:"text-sm text-gray-600 dark:text-gray-400"},ha={key:0,class:"text-sm text-gray-500"},_a={key:0,class:"mb-6"},Ca={class:"grid grid-cols-1 gap-6 md:grid-cols-3"},Sa={class:"feature-card"},Aa={class:"mb-4 space-y-3"},Da={class:"flex items-center"},Fa=["disabled"],Oa={key:0},ja={key:1},Ea={class:"feature-card"},Ia={class:"mb-4 space-y-3"},Ua=["disabled"],Va={key:0},Ta={key:1},Ra={class:"feature-card"},La={class:"mb-4 space-y-3"},Ma={class:"flex items-center"},Wa=["disabled"],qa={key:0},Ba={key:1},$a={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},za={class:"flex items-center justify-between"},Na={class:"relative inline-flex cursor-pointer items-center"},Pa={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Ga={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},Ha={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Ka={class:"space-y-4"},Qa={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Ja={class:"flex items-center justify-between"},Za={class:"relative inline-flex cursor-pointer items-center"},Xa={class:"flex items-center justify-between"},Ya={class:"relative inline-flex cursor-pointer items-center"},es={class:"flex items-center justify-between"},ts={class:"relative inline-flex cursor-pointer items-center"},rs={class:"flex items-center justify-between"},as={class:"relative inline-flex cursor-pointer items-center"},ss={class:"mt-6 space-y-3"},ls={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800"},os={class:"flex items-center justify-between"},ns={class:"flex cursor-pointer items-center"},ds={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},is={class:"grid grid-cols-1 gap-4 md:grid-cols-4"},us={class:"rounded-lg border border-gray-200 p-4 dark:border-gray-700"},gs={class:"flex items-center justify-between"},cs={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},bs={class:"rounded-lg border border-gray-200 p-4 dark:border-gray-700"},fs={class:"flex items-center justify-between"},ys={class:"text-2xl font-bold text-green-600 dark:text-green-400"},vs={class:"rounded-lg border border-gray-200 p-4 dark:border-gray-700"},xs={class:"flex items-center justify-between"},ps={class:"text-2xl font-bold text-orange-600 dark:text-orange-400"},ms={class:"rounded-lg border border-gray-200 p-4 dark:border-gray-700"},ks={class:"flex items-center justify-between"},ws={class:"text-2xl font-bold text-red-600 dark:text-red-400"},hs={class:"flex items-center justify-between"},_s={class:"flex gap-3"},Cs=["disabled"],Ss={key:0,class:"loading-spinner mr-2"},As={key:1,class:"fas fa-save mr-2"},Ds=["disabled"],Fs={key:0,class:"loading-spinner mr-2"},Os={key:1,class:"fas fa-broom mr-2"},js={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Es={class:"dark:to-gray-750 relative border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-5 dark:border-gray-700 dark:from-gray-800"},Is={class:"flex items-center justify-between"},Us={class:"flex items-center space-x-3"},Vs={class:"text-xl font-semibold text-gray-900 dark:text-white"},Ts={class:"mt-0.5 text-sm text-gray-600 dark:text-gray-400"},Rs={class:"p-6"},Ls={class:"space-y-5"},Ms={class:"relative"},Ws=["disabled"],qs={key:0,class:"mt-1 text-xs text-amber-600 dark:text-amber-400"},Bs={class:"relative"},$s={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-3"},zs={key:1,class:"absolute inset-y-0 right-0 flex items-center pr-3"},Ns={key:0,class:"mt-2 flex items-start rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},Ps={class:"text-sm text-blue-700 dark:text-blue-300"},Gs={key:0,class:"rounded-xl border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-900/50"},Hs={class:"space-y-4"},Ks={class:"flex items-center justify-between"},Qs={class:"flex cursor-pointer items-center",for:"enableSign"},Js={key:0,class:"rounded-full bg-green-100 px-2 py-1 text-xs font-medium text-green-700 dark:bg-green-900/50 dark:text-green-400"},Zs={key:0},Xs={class:"border-t border-gray-200 bg-gray-50 px-6 py-4 dark:border-gray-700 dark:bg-gray-900/50"},Ys={class:"flex items-center justify-between"},el={class:"flex space-x-3"},tl=["disabled"],rl=["disabled"],al={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},sl={class:"mx-4 w-full max-w-md rounded-lg bg-white p-6 dark:bg-gray-800"},ll={class:"mb-4 flex items-center justify-between"},ol={key:0},nl={key:0,class:"mb-4 text-center"},dl=["src"],il={key:1,class:"mb-4"},ul={class:"rounded bg-gray-100 px-2 py-1 text-sm dark:bg-gray-700"},gl={key:1},cl={class:"flex space-x-3"},bl=["disabled"],fl={key:2},yl={class:"mb-4 rounded-md bg-gray-100 p-4 dark:bg-gray-700"},vl={class:"grid grid-cols-2 gap-2 font-mono text-sm"},xl={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},pl={class:"mx-4 w-full max-w-md rounded-lg bg-white p-6 dark:bg-gray-800"},ml={class:"mb-4 flex items-center justify-between"},kl={class:"space-y-4"},wl={class:"flex space-x-3 pt-4"},hl=["disabled"],_l={key:0},Cl={key:1},Sl=Object.assign({name:"SettingsView"},{__name:"SettingsView",setup(j){const I=At(),{loading:K,saving:q,oemSettings:S}=pt(I),fe=i(),x=i("branding"),s=i(!0),h=i(new AbortController),T=i(!1),b=i(!1),k=i(!1),R=i(!1),_=i({enabled:!1,platforms:[],notificationTypes:{accountAnomaly:!0,quotaWarning:!0,systemError:!0,securityAlert:!0},retrySettings:{maxRetries:3,retryDelay:1e3,timeout:1e4}}),M=i(!1),U=i(null),y=i({type:"wechat_work",name:"",url:"",enableSign:!1,secret:""}),m=i({globalDefaultStrategy:"least_recent",globalDefaultWeight:5,globalDefaultOrder:1,enableAccountOverride:!0,enableGroupOverride:!0,updatedAt:null}),te=i({globalStrategyCount:0,customStrategyCount:0,groupStrategyCount:0}),L=i(!1),Ce=mt(x,async r=>{s.value&&(r==="webhook"?await Q():r==="scheduling"?await De():r==="data-management"?await ge():r==="request-logging"&&await Ie())});kt(async()=>{try{await I.loadOemSettings(),x.value==="webhook"?await Q():x.value==="scheduling"?await De():x.value==="data-management"?await ge():x.value==="request-logging"&&await Ie()}catch{d("加载设置失败","error")}}),wt(()=>{s.value=!1,h.value&&h.value.abort(),Ce&&Ce(),M.value&&(M.value=!1,U.value=null)});const Q=async()=>{if(s.value)try{const r=await f.get("/admin/webhook/config",{signal:h.value.signal});r.success&&s.value&&(_.value=r.config)}catch(r){if(r.name==="AbortError"||!s.value)return;d("获取webhook配置失败","error"),console.error(r)}},J=async()=>{if(s.value)try{(await f.post("/admin/webhook/config",_.value,{signal:h.value.signal})).success&&s.value&&d("配置已保存","success")}catch(r){if(r.name==="AbortError"||!s.value)return;d("保存配置失败","error"),console.error(r)}},Re=()=>{const r=y.value.url;if(!r){T.value=!1,b.value=!1;return}try{new URL(r),r.startsWith("http://")||r.startsWith("https://")?(T.value=!1,b.value=!0):(T.value=!0,b.value=!1)}catch{T.value=!0,b.value=!1}},Le=async()=>{if(s.value){if(!y.value.url){d("请输入Webhook URL","error");return}if(T.value){d("请输入有效的Webhook URL","error");return}R.value=!0;try{let r;U.value?r=await f.put(`/admin/webhook/platforms/${U.value.id}`,y.value,{signal:h.value.signal}):r=await f.post("/admin/webhook/platforms",y.value,{signal:h.value.signal}),r.success&&s.value&&(d(U.value?"平台已更新":"平台已添加","success"),await Q(),re())}catch(r){if(r.name==="AbortError"||!s.value)return;d(r.message||"操作失败","error"),console.error(r)}finally{s.value&&(R.value=!1)}}},Me=r=>{U.value=r,y.value={...r},M.value=!0},We=async r=>{if(s.value&&confirm("确定要删除这个平台吗？"))try{(await f.delete(`/admin/webhook/platforms/${r}`,{signal:h.value.signal})).success&&s.value&&(d("平台已删除","success"),await Q())}catch(t){if(t.name==="AbortError"||!s.value)return;d("删除失败","error"),console.error(t)}},qe=async r=>{if(s.value)try{const t=await f.post(`/admin/webhook/platforms/${r}/toggle`,{},{signal:h.value.signal});t.success&&s.value&&(d(t.message,"success"),await Q())}catch(t){if(t.name==="AbortError"||!s.value)return;d("操作失败","error"),console.error(t)}},Be=async r=>{if(s.value)try{(await f.post("/admin/webhook/test",{url:r.url,type:r.type,secret:r.secret,enableSign:r.enableSign},{signal:h.value.signal})).success&&s.value&&d("测试成功，webhook连接正常","success")}catch(t){if(t.name==="AbortError"||!s.value)return;d(t.error||t.message||"测试失败","error"),console.error(t)}},$e=async()=>{if(s.value){if(!y.value.url){d("请先输入Webhook URL","error");return}if(T.value){d("请输入有效的Webhook URL","error");return}k.value=!0;try{(await f.post("/admin/webhook/test",y.value,{signal:h.value.signal})).success&&s.value&&d("测试成功，webhook连接正常","success")}catch(r){if(r.name==="AbortError"||!s.value)return;d(r.error||r.message||"测试失败","error"),console.error(r)}finally{s.value&&(k.value=!1)}}},ze=async()=>{if(s.value)try{(await f.post("/admin/webhook/test-notification",{},{signal:h.value.signal})).success&&s.value&&d("测试通知已发送","success")}catch(r){if(r.name==="AbortError"||!s.value)return;d("发送失败","error"),console.error(r)}},re=()=>{s.value&&(M.value=!1,setTimeout(()=>{s.value&&(U.value=null,y.value={type:"wechat_work",name:"",url:"",enableSign:!1,secret:""},T.value=!1,b.value=!1,k.value=!1,R.value=!1)},0))},Se=r=>({wechat_work:"企业微信",dingtalk:"钉钉",feishu:"飞书",slack:"Slack",discord:"Discord",custom:"自定义"})[r]||r,Ne=r=>({wechat_work:"fab fa-weixin text-green-600",dingtalk:"fas fa-comment-dots text-blue-500",feishu:"fas fa-dove text-blue-600",slack:"fab fa-slack text-purple-600",discord:"fab fa-discord text-indigo-600",custom:"fas fa-webhook text-gray-600"})[r]||"fas fa-bell",Ae=r=>({wechat_work:"请在企业微信群机器人设置中获取Webhook地址",dingtalk:"请在钉钉群机器人设置中获取Webhook地址",feishu:"请在飞书群机器人设置中获取Webhook地址",slack:"请在Slack应用的Incoming Webhooks中获取地址",discord:"请在Discord服务器的集成设置中创建Webhook",custom:"请输入完整的Webhook接收地址"})[r]||"",Pe=r=>({accountAnomaly:"账号异常",quotaWarning:"配额警告",systemError:"系统错误",securityAlert:"安全警报"})[r]||r,Ge=r=>({accountAnomaly:"账号状态异常、认证失败等",quotaWarning:"API调用配额不足警告",systemError:"系统运行错误和故障",securityAlert:"安全相关的警报通知"})[r]||"",He=async()=>{try{const r={siteName:S.value.siteName,siteIcon:S.value.siteIcon,siteIconData:S.value.siteIconData},t=await I.saveOemSettings(r);t&&t.success?d("OEM设置保存成功","success"):d((t==null?void 0:t.message)||"保存失败","error")}catch{d("保存OEM设置失败","error")}},Ke=async()=>{if(confirm(`确定要重置为默认设置吗？

这将清除所有自定义的网站名称和图标设置。`))try{const r=await I.resetOemSettings();r&&r.success?d("已重置为默认设置","success"):d("重置失败","error")}catch{d("重置失败","error")}},Qe=async r=>{const t=r.target.files[0];if(!t)return;const l=I.validateIconFile(t);if(!l.isValid){l.errors.forEach(a=>d(a,"error"));return}try{const a=await I.fileToBase64(t);S.value.siteIconData=a}catch{d("文件读取失败","error")}r.target.value=""},Je=()=>{S.value.siteIcon="",S.value.siteIconData=""},Ze=()=>{console.warn("Icon failed to load")},De=async()=>{if(s.value)try{const r=await f.get("/admin/scheduling/config",{signal:h.value.signal});if(r.success&&s.value){const t=r.data;m.value={globalDefaultStrategy:(t==null?void 0:t.defaultStrategy)||"least_recent",globalDefaultWeight:parseInt((t==null?void 0:t.globalDefaultWeight)||5),globalDefaultOrder:parseInt((t==null?void 0:t.globalDefaultOrder)||1),enableAccountOverride:(t==null?void 0:t.enableAccountOverride)==="true",enableGroupOverride:(t==null?void 0:t.enableGroupOverride)==="true",updatedAt:t==null?void 0:t.updatedAt},await ye()}}catch(r){if(r.name==="AbortError"||!s.value)return;console.error("加载调度配置失败:",r)}},z=async()=>{if(s.value){L.value=!0;try{(await f.post("/admin/scheduling/config",m.value,{signal:h.value.signal})).success&&s.value&&(m.value.updatedAt=new Date().toISOString(),d("调度策略配置已保存","success"),await ye())}catch(r){if(r.name==="AbortError"||!s.value)return;d("保存配置失败","error"),console.error(r)}finally{s.value&&(L.value=!1)}}},Xe=async()=>{if(confirm("确定要重置调度策略配置为默认设置吗？")){L.value=!0;try{(await f.post("/admin/scheduling/config/reset",{},{signal:h.value.signal})).success&&s.value&&(m.value={globalDefaultStrategy:"least_recent",globalDefaultWeight:5,globalDefaultOrder:1,enableAccountOverride:!0,enableGroupOverride:!0,updatedAt:new Date().toISOString()},d("调度策略配置已重置","success"),await ye())}catch(r){if(r.name==="AbortError"||!s.value)return;d("重置配置失败","error"),console.error(r)}finally{s.value&&(L.value=!1)}}},ye=async()=>{if(s.value)try{const r=await f.get("/admin/scheduling/stats",{signal:h.value.signal});r.success&&s.value&&(te.value=r.stats)}catch(r){if(r.name==="AbortError"||!s.value)return;console.error("加载使用统计失败:",r)}},Ye=()=>Fe(m.value.globalDefaultStrategy),et=r=>({round_robin:"fas fa-sync-alt text-blue-500",least_used:"fas fa-chart-bar text-green-500",least_recent:"fas fa-clock text-orange-500",random:"fas fa-random text-purple-500",weighted_random:"fas fa-balance-scale text-amber-500",sequential:"fas fa-list-ol text-indigo-500"})[r]||"fas fa-clock text-orange-500",Fe=r=>({round_robin:"轮询调度",least_used:"最少使用",least_recent:"最近最少使用",random:"随机调度",weighted_random:"加权随机",sequential:"顺序调度"})[r]||"最近最少使用",tt=r=>({round_robin:"按顺序循环选择账户，确保每个账户被平均使用",least_used:"优先选择使用次数最少的账户，实现负载均衡",least_recent:"优先选择最长时间未被使用的账户，适合大部分场景",random:"随机选择可用账户，分布相对均匀",weighted_random:"根据权重随机选择，权重越高被选中概率越大",sequential:"按配置顺序逐一使用账户，适合有优先级要求的场景"})[r]||"优先选择最长时间未被使用的账户",F=i({apiKeys:0,claudeAccounts:0,openaiAccounts:0,systemConfig:0,is2FAEnabled:!1,lastExport:null}),ae=i(!1),W=i(1),ve=i(""),xe=i(""),pe=i(null),N=i(""),B=i(!1),C=i({password:"",token:"",sessionToken:""}),se=i(!1);let P=null;const me=i({includeStats:!0}),le=i(!1),ke=i({conflictStrategy:"skip"}),oe=i(!1),ne=i(null),rt=i(),de=i({validateOnly:!1}),ie=i(!1),ue=i(null),at=i(),v=i({enabled:!1,level:"info",retentionDays:7,maxFileSize:10,maxFiles:10,includeHeaders:!0,includeBody:!1,includeResponse:!1,includeErrors:!0,filterSensitiveData:!0,updatedAt:null}),Z=i({todayLogs:0,totalLogs:0,storageUsed:0,errorLogs:0}),G=i(!1),X=i(!1),ge=async()=>{var r,t;try{const l=await f.get("/admin/data/overview");Object.assign(F.value,l.data)}catch(l){d("获取数据概览失败: "+(((t=(r=l.response)==null?void 0:r.data)==null?void 0:t.error)||l.message),"error")}},st=async()=>{var r,t;try{const a=(await f.post("/admin/data/2fa/generate")).data;ve.value=a.qrCode,xe.value=a.manualEntryKey,pe.value=a.backupCodes,ae.value=!0,W.value=1}catch(l){d("生成2FA密钥失败: "+(((t=(r=l.response)==null?void 0:r.data)==null?void 0:t.error)||l.message),"error")}},lt=async()=>{var r,t;try{await f.post("/admin/data/2fa/enable",{token:N.value}),W.value=3,d("2FA启用成功","success")}catch(l){d("2FA启用失败: "+(((t=(r=l.response)==null?void 0:r.data)==null?void 0:t.error)||l.message),"error")}},ot=()=>{ae.value=!1,W.value=1,N.value="",F.value.is2FAEnabled=!0},nt=async()=>{var r,t;se.value=!0;try{const l=await f.post("/admin/data/2fa/verify",{password:C.value.password,token:C.value.token});C.value.sessionToken=l.data.sessionToken,B.value=!1,P&&(await P(),P=null),C.value.password="",C.value.token=""}catch(l){d("验证失败: "+(((t=(r=l.response)==null?void 0:r.data)==null?void 0:t.error)||l.message),"error")}finally{se.value=!1}},dt=()=>{if(!C.value.sessionToken){P=Oe,B.value=!0;return}Oe()},Oe=async()=>{var r,t;le.value=!0;try{const l=await f.post("/admin/data/export",{sessionToken:C.value.sessionToken,includeStats:me.value.includeStats},{responseType:"blob",timeout:6e4});if(!l.data||l.data.size===0)throw new Error("下载的文件为空");const a=l.headers["content-type"]||((t=(r=l.headers).get)==null?void 0:t.call(r,"content-type"));if(a&&!a.includes("application/zip")){const vt=await l.data.text();try{const Ue=JSON.parse(vt);throw new Error(Ue.error||"导出失败")}catch{throw new Error("导出文件格式错误")}}const w=new Blob([l.data],{type:"application/zip"}),$=window.URL.createObjectURL(w),Y=document.createElement("a");Y.href=$,Y.download=`claude-relay-data-${Date.now()}.zip`,document.body.appendChild(Y),Y.click(),setTimeout(()=>{document.body.removeChild(Y),window.URL.revokeObjectURL($)},100),d("数据导出成功","success"),ge()}catch(l){console.error("导出错误:",l);let a="导出失败";if(l.response){if(l.response.data)try{if(l.response.data instanceof Blob){const w=await l.response.data.text();a=JSON.parse(w).error||"导出失败"}else a=l.response.data.error||"导出失败"}catch{a=`导出失败 (状态码: ${l.response.status})`}}else l.message&&(a=l.message);d("数据导出失败: "+a,"error")}finally{le.value=!1,C.value.sessionToken=""}},it=r=>{ne.value=r.target.files[0]},ut=()=>{if(!C.value.sessionToken){P=je,B.value=!0;return}je()},je=async()=>{var r,t;oe.value=!0;try{const l=new FormData;l.append("dataFile",ne.value),l.append("sessionToken",C.value.sessionToken),l.append("conflictStrategy",ke.value.conflictStrategy);const w=(await f.post("/admin/data/import",l)).data;d(`数据导入成功: 导入${w.importedRecords}条记录，跳过${w.skippedRecords}条记录`,"success"),ge()}catch(l){d("数据导入失败: "+(((t=(r=l.response)==null?void 0:r.data)==null?void 0:t.error)||l.message),"error")}finally{oe.value=!1,C.value.sessionToken="",ne.value=null}},gt=r=>{ue.value=r.target.files[0]},ct=()=>{if(!C.value.sessionToken){P=Ee,B.value=!0;return}Ee()},Ee=async()=>{var r,t;ie.value=!0;try{const l=new FormData;l.append("configFile",ue.value),l.append("sessionToken",C.value.sessionToken),l.append("validateOnly",de.value.validateOnly);const w=(await f.post("/admin/data/migrate",l)).data,$=de.value.validateOnly?`迁移验证完成: ${w.sourceDatabase} → ${w.targetDatabase}`:`数据库迁移完成: ${w.totalRecords}条记录`;d($,"success")}catch(l){d("迁移操作失败: "+(((t=(r=l.response)==null?void 0:r.data)==null?void 0:t.error)||l.message),"error")}finally{ie.value=!1,C.value.sessionToken="",ue.value=null}},bt=r=>new Date(r).toLocaleString("zh-CN"),Ie=async()=>{if(s.value)try{const r=await f.get("/admin/request-logs/config",{signal:h.value.signal});r.success&&s.value&&(Object.assign(v.value,r.data),await we())}catch(r){if(r.name==="AbortError"||!s.value)return;console.error("加载请求日志配置失败:",r)}},V=async()=>{if(s.value){G.value=!0;try{(await f.post("/admin/request-logs/config",v.value,{signal:h.value.signal})).success&&s.value&&(v.value.updatedAt=new Date().toISOString(),d("请求日志配置已保存","success"),await we())}catch(r){if(r.name==="AbortError"||!s.value)return;d("保存配置失败","error"),console.error(r)}finally{s.value&&(G.value=!1)}}},we=async()=>{if(s.value)try{const r=await f.get("/admin/request-logs/stats",{signal:h.value.signal});r.success&&s.value&&Object.assign(Z.value,r.data)}catch(r){if(r.name==="AbortError"||!s.value)return;console.error("加载请求日志统计失败:",r)}},ft=async()=>{if(s.value&&confirm(`确定要清理过期的日志文件吗？

这将删除超过保留期限的所有日志记录。`)){X.value=!0;try{const r=await f.post("/admin/request-logs/cleanup",{},{signal:h.value.signal});r.success&&s.value&&(d(`清理完成，删除了 ${r.data.deletedFiles} 个文件`,"success"),await we())}catch(r){if(r.name==="AbortError"||!s.value)return;d("清理失败","error"),console.error(r)}finally{s.value&&(X.value=!1)}}},yt=r=>{if(r===0)return"0 B";const t=1024,l=["B","KB","MB","GB","TB"],a=Math.floor(Math.log(r)/Math.log(t));return parseFloat((r/Math.pow(t,a)).toFixed(2))+" "+l[a]},he=I.formatDateTime;return(r,t)=>{const l=ht("router-link");return n(),o(be,null,[e("div",Dt,[e("div",Ft,[t[152]||(t[152]=e("div",{class:"mb-4 sm:mb-6"},[e("h3",{class:"mb-1 text-lg font-bold text-gray-900 dark:text-gray-100 sm:mb-2 sm:text-xl"}," 系统设置 "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 sm:text-base"},"网站定制和通知配置")],-1)),e("div",Ot,[e("nav",jt,[e("button",{class:O(["border-b-2 pb-2 text-sm font-medium transition-colors",x.value==="branding"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:t[0]||(t[0]=a=>x.value="branding")},t[44]||(t[44]=[e("i",{class:"fas fa-palette mr-2"},null,-1),c(" 品牌设置 ",-1)]),2),e("button",{class:O(["border-b-2 pb-2 text-sm font-medium transition-colors",x.value==="scheduling"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:t[1]||(t[1]=a=>x.value="scheduling")},t[45]||(t[45]=[e("i",{class:"fas fa-route mr-2"},null,-1),c(" 调度策略配置 ",-1)]),2),e("button",{class:O(["border-b-2 pb-2 text-sm font-medium transition-colors",x.value==="webhook"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:t[2]||(t[2]=a=>x.value="webhook")},t[46]||(t[46]=[e("i",{class:"fas fa-bell mr-2"},null,-1),c(" 通知设置 ",-1)]),2),e("button",{class:O(["border-b-2 pb-2 text-sm font-medium transition-colors",x.value==="data-management"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:t[3]||(t[3]=a=>x.value="data-management")},t[47]||(t[47]=[e("i",{class:"fas fa-database mr-2"},null,-1),c(" 数据管理 ",-1)]),2),e("button",{class:O(["border-b-2 pb-2 text-sm font-medium transition-colors",x.value==="request-logging"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:t[4]||(t[4]=a=>x.value="request-logging")},t[48]||(t[48]=[e("i",{class:"fas fa-file-alt mr-2"},null,-1),c(" 请求日志 ",-1)]),2)])]),A(K)?(n(),o("div",Et,t[49]||(t[49]=[e("div",{class:"loading-spinner mx-auto mb-4"},[e("p",{class:"text-gray-500 dark:text-gray-400"},"正在加载设置...")],-1)]))):(n(),o("div",It,[u(e("div",null,[e("div",Ut,[e("table",Vt,[e("tbody",Tt,[e("tr",Rt,[t[51]||(t[51]=e("td",{class:"w-48 whitespace-nowrap px-6 py-4"},[e("div",{class:"flex items-center"},[e("div",{class:"mr-3 flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600"},[e("i",{class:"fas fa-font text-xs text-white"})]),e("div",null,[e("div",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"}," 网站名称 "),e("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"品牌标识")])])],-1)),e("td",Lt,[u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>A(S).siteName=a),class:"form-input w-full max-w-md dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",maxlength:"100",placeholder:"Claude Relay Service",type:"text"},null,512),[[D,A(S).siteName]]),t[50]||(t[50]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 将显示在浏览器标题和页面头部 ",-1))])]),e("tr",Mt,[t[56]||(t[56]=e("td",{class:"w-48 whitespace-nowrap px-6 py-4"},[e("div",{class:"flex items-center"},[e("div",{class:"mr-3 flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-purple-500 to-purple-600"},[e("i",{class:"fas fa-image text-xs text-white"})]),e("div",null,[e("div",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"}," 网站图标 "),e("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"Favicon")])])],-1)),e("td",Wt,[e("div",qt,[A(S).siteIconData||A(S).siteIcon?(n(),o("div",Bt,[e("img",{alt:"图标预览",class:"h-8 w-8",src:A(S).siteIconData||A(S).siteIcon,onError:Ze},null,40,$t),t[53]||(t[53]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"当前图标",-1)),e("button",{class:"rounded-lg px-3 py-1 font-medium text-red-600 transition-colors hover:bg-red-50 hover:text-red-900",onClick:Je},t[52]||(t[52]=[e("i",{class:"fas fa-trash mr-1"},null,-1),c("删除 ",-1)]))])):p("",!0),e("div",null,[e("input",{ref_key:"iconFileInput",ref:fe,accept:".ico,.png,.jpg,.jpeg,.svg",class:"hidden",type:"file",onChange:Qe},null,544),e("button",{class:"btn btn-success px-4 py-2",onClick:t[6]||(t[6]=a=>r.$refs.iconFileInput.click())},t[54]||(t[54]=[e("i",{class:"fas fa-upload mr-2"},null,-1),c(" 上传图标 ",-1)])),t[55]||(t[55]=e("span",{class:"ml-3 text-xs text-gray-500 dark:text-gray-400"},"支持 .ico, .png, .jpg, .svg 格式，最大 350KB",-1))])])])]),e("tr",null,[e("td",zt,[e("div",Nt,[e("div",Pt,[e("button",{class:O(["btn btn-primary px-6 py-3",{"cursor-not-allowed opacity-50":A(q)}]),disabled:A(q),onClick:He},[A(q)?(n(),o("div",Ht)):(n(),o("i",Kt)),c(" "+g(A(q)?"保存中...":"保存设置"),1)],10,Gt),e("button",{class:"btn bg-gray-100 px-6 py-3 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",disabled:A(q),onClick:Ke},t[57]||(t[57]=[e("i",{class:"fas fa-undo mr-2"},null,-1),c(" 重置为默认 ",-1)]),8,Qt)]),A(S).updatedAt?(n(),o("div",Jt,[t[58]||(t[58]=e("i",{class:"fas fa-clock mr-1"},null,-1)),c(" 最后更新："+g(A(he)(A(S).updatedAt)),1)])):p("",!0)])])])])])]),t[59]||(t[59]=e("div",{class:"space-y-4 sm:hidden"},null,-1))],512),[[ee,x.value==="branding"]]),u(e("div",null,[e("div",Zt,[e("div",Xt,[t[60]||(t[60]=e("div",null,[e("h2",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},[e("i",{class:"fas fa-route mr-2 text-blue-500"}),c(" 全局默认调度策略 ")]),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," 设置系统的默认调度策略，影响所有未单独配置的账户和分组 ")],-1)),e("div",Yt," 当前生效："+g(Ye()),1)]),e("div",er,[e("div",null,[t[62]||(t[62]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 默认策略 ",-1)),u(e("select",{"onUpdate:modelValue":t[7]||(t[7]=a=>m.value.globalDefaultStrategy=a),class:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",onChange:z},t[61]||(t[61]=[H('<option value="round_robin" data-v-0bedd3d7>轮询调度 (Round Robin)</option><option value="least_used" data-v-0bedd3d7>最少使用 (Least Used)</option><option value="least_recent" data-v-0bedd3d7>最近最少使用 (Least Recent)</option><option value="random" data-v-0bedd3d7>随机调度 (Random)</option><option value="weighted_random" data-v-0bedd3d7>加权随机 (Weighted Random)</option><option value="sequential" data-v-0bedd3d7>顺序调度 (Sequential)</option>',6)]),544),[[ce,m.value.globalDefaultStrategy]])]),e("div",tr,[e("div",rr,[e("i",{class:O(et(m.value.globalDefaultStrategy))},null,2),e("div",ar,[e("p",sr,g(Fe(m.value.globalDefaultStrategy))+"策略说明： ",1),e("p",null,g(tt(m.value.globalDefaultStrategy)),1)])])]),m.value.globalDefaultStrategy==="weighted_random"?(n(),o("div",lr,[t[63]||(t[63]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-weight-hanging mr-2 text-amber-500"}),c(" 全局默认权重 (1-10) ")],-1)),u(e("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>m.value.globalDefaultWeight=a),class:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",max:"10",min:"1",type:"number",onChange:z},null,544),[[D,m.value.globalDefaultWeight,void 0,{number:!0}]]),t[64]||(t[64]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," 权重越高的账户被选中的概率越大 ",-1))])):m.value.globalDefaultStrategy==="sequential"?(n(),o("div",or,[t[65]||(t[65]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-sort-numeric-down mr-2 text-indigo-500"}),c(" 全局默认起始位置 ")],-1)),u(e("input",{"onUpdate:modelValue":t[9]||(t[9]=a=>m.value.globalDefaultOrder=a),class:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",min:"1",type:"number",onChange:z},null,544),[[D,m.value.globalDefaultOrder,void 0,{number:!0}]]),t[66]||(t[66]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"数字越小的账户优先被选择",-1))])):p("",!0)])]),e("div",nr,[t[71]||(t[71]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},[e("i",{class:"fas fa-cogs mr-2 text-green-500"}),c(" 策略覆盖设置 ")],-1)),e("div",dr,[e("div",ir,[t[68]||(t[68]=e("div",null,[e("h3",{class:"font-medium text-gray-700 dark:text-gray-300"},"账户级别覆盖"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 允许单个账户覆盖全局调度策略 ")],-1)),e("label",ur,[u(e("input",{"onUpdate:modelValue":t[10]||(t[10]=a=>m.value.enableAccountOverride=a),class:"peer sr-only",type:"checkbox",onChange:z},null,544),[[E,m.value.enableAccountOverride]]),t[67]||(t[67]=e("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-blue-800"},null,-1))])]),e("div",gr,[t[70]||(t[70]=e("div",null,[e("h3",{class:"font-medium text-gray-700 dark:text-gray-300"},"分组级别覆盖"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"允许分组覆盖全局调度策略")],-1)),e("label",cr,[u(e("input",{"onUpdate:modelValue":t[11]||(t[11]=a=>m.value.enableGroupOverride=a),class:"peer sr-only",type:"checkbox",onChange:z},null,544),[[E,m.value.enableGroupOverride]]),t[69]||(t[69]=e("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-blue-800"},null,-1))])])])]),e("div",br,[t[81]||(t[81]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},[e("i",{class:"fas fa-chart-pie mr-2 text-purple-500"}),c(" 当前使用统计 ")],-1)),e("div",fr,[e("div",yr,[e("div",vr,[e("div",null,[t[72]||(t[72]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"使用全局策略",-1)),e("p",xr,g(te.value.globalStrategyCount||0),1)]),t[73]||(t[73]=e("i",{class:"fas fa-globe text-xl text-blue-500"},null,-1))]),t[74]||(t[74]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"账户数量",-1))]),e("div",pr,[e("div",mr,[e("div",null,[t[75]||(t[75]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"自定义策略",-1)),e("p",kr,g(te.value.customStrategyCount||0),1)]),t[76]||(t[76]=e("i",{class:"fas fa-cog text-xl text-green-500"},null,-1))]),t[77]||(t[77]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"账户数量",-1))]),e("div",wr,[e("div",hr,[e("div",null,[t[78]||(t[78]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"分组策略",-1)),e("p",_r,g(te.value.groupStrategyCount||0),1)]),t[79]||(t[79]=e("i",{class:"fas fa-layer-group text-xl text-purple-500"},null,-1))]),t[80]||(t[80]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"分组数量",-1))])])]),e("div",Cr,[e("div",Sr,[e("button",{class:O(["btn btn-primary px-6 py-3",{"cursor-not-allowed opacity-50":L.value}]),disabled:L.value,onClick:z},[L.value?(n(),o("div",Dr)):(n(),o("i",Fr)),c(" "+g(L.value?"保存中...":"保存配置"),1)],10,Ar),e("button",{class:"btn bg-gray-100 px-6 py-3 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",disabled:L.value,onClick:Xe},t[82]||(t[82]=[e("i",{class:"fas fa-undo mr-2"},null,-1),c(" 重置为默认 ",-1)]),8,Or)]),m.value.updatedAt?(n(),o("div",jr,[t[83]||(t[83]=e("i",{class:"fas fa-clock mr-1"},null,-1)),c(" 最后更新："+g(A(he)(m.value.updatedAt)),1)])):p("",!0)])],512),[[ee,x.value==="scheduling"]]),u(e("div",null,[e("div",Er,[e("div",Ir,[t[85]||(t[85]=e("div",null,[e("h2",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"}," 启用 Webhook 通知 "),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," 开启后，系统将按配置发送通知到指定平台 ")],-1)),e("label",Ur,[u(e("input",{"onUpdate:modelValue":t[12]||(t[12]=a=>_.value.enabled=a),class:"peer sr-only",type:"checkbox",onChange:J},null,544),[[E,_.value.enabled]]),t[84]||(t[84]=e("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-blue-800"},null,-1))])])]),e("div",Vr,[t[87]||(t[87]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},"通知类型",-1)),e("div",Tr,[(n(!0),o(be,null,_e(_.value.notificationTypes,(a,w)=>(n(),o("div",{key:w,class:"flex items-center justify-between"},[e("div",null,[e("span",Rr,g(Pe(w)),1),e("span",Lr,g(Ge(w)),1)]),e("label",Mr,[u(e("input",{"onUpdate:modelValue":$=>_.value.notificationTypes[w]=$,class:"peer sr-only",type:"checkbox",onChange:J},null,40,Wr),[[E,_.value.notificationTypes[w]]]),t[86]||(t[86]=e("div",{class:"peer h-5 w-9 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-4 after:w-4 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white dark:border-gray-600 dark:bg-gray-700"},null,-1))])]))),128))])]),e("div",qr,[e("div",Br,[t[89]||(t[89]=e("h2",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"通知平台",-1)),e("button",{class:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",onClick:t[13]||(t[13]=a=>M.value=!0)},t[88]||(t[88]=[e("i",{class:"fas fa-plus mr-2"},null,-1),c(" 添加平台 ",-1)]))]),_.value.platforms&&_.value.platforms.length>0?(n(),o("div",$r,[(n(!0),o(be,null,_e(_.value.platforms,a=>(n(),o("div",{key:a.id,class:"rounded-lg border border-gray-200 p-4 dark:border-gray-700"},[e("div",zr,[e("div",Nr,[e("div",Pr,[e("i",{class:O(["mr-3 text-xl",Ne(a.type)])},null,2),e("div",null,[e("h3",Gr,g(a.name||Se(a.type)),1),e("p",Hr,g(Se(a.type)),1)])]),e("div",Kr,[e("div",Qr,[t[90]||(t[90]=e("i",{class:"fas fa-link mr-2"},null,-1)),e("span",Jr,g(a.url),1)]),a.enableSign?(n(),o("div",Zr,t[91]||(t[91]=[e("i",{class:"fas fa-shield-alt mr-2"},null,-1),e("span",null,"已启用签名验证",-1)]))):p("",!0)])]),e("div",Xr,[e("label",Yr,[e("input",{checked:a.enabled,class:"peer sr-only",type:"checkbox",onChange:w=>qe(a.id)},null,40,ea),t[92]||(t[92]=e("div",{class:"peer h-5 w-9 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-4 after:w-4 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white dark:border-gray-600 dark:bg-gray-700"},null,-1))]),e("button",{class:"rounded-lg bg-blue-100 p-2 text-blue-600 transition-colors hover:bg-blue-200 dark:bg-blue-900 dark:text-blue-400 dark:hover:bg-blue-800",title:"测试连接",onClick:w=>Be(a)},t[93]||(t[93]=[e("i",{class:"fas fa-vial"},null,-1)]),8,ta),e("button",{class:"rounded-lg bg-gray-100 p-2 text-gray-600 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600",title:"编辑",onClick:w=>Me(a)},t[94]||(t[94]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ra),e("button",{class:"rounded-lg bg-red-100 p-2 text-red-600 transition-colors hover:bg-red-200 dark:bg-red-900 dark:text-red-400 dark:hover:bg-red-800",title:"删除",onClick:w=>We(a.id)},t[95]||(t[95]=[e("i",{class:"fas fa-trash"},null,-1)]),8,aa)])])]))),128))])):(n(),o("div",sa,' 暂无配置的通知平台，请点击"添加平台"按钮添加 '))]),e("div",la,[t[99]||(t[99]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},"高级设置",-1)),e("div",oa,[e("div",null,[t[96]||(t[96]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," 最大重试次数 ",-1)),u(e("input",{"onUpdate:modelValue":t[14]||(t[14]=a=>_.value.retrySettings.maxRetries=a),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",max:"10",min:"0",type:"number",onChange:J},null,544),[[D,_.value.retrySettings.maxRetries,void 0,{number:!0}]])]),e("div",null,[t[97]||(t[97]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," 重试延迟 (毫秒) ",-1)),u(e("input",{"onUpdate:modelValue":t[15]||(t[15]=a=>_.value.retrySettings.retryDelay=a),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",max:"10000",min:"100",step:"100",type:"number",onChange:J},null,544),[[D,_.value.retrySettings.retryDelay,void 0,{number:!0}]])]),e("div",null,[t[98]||(t[98]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," 超时时间 (毫秒) ",-1)),u(e("input",{"onUpdate:modelValue":t[16]||(t[16]=a=>_.value.retrySettings.timeout=a),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",max:"30000",min:"1000",step:"1000",type:"number",onChange:J},null,544),[[D,_.value.retrySettings.timeout,void 0,{number:!0}]])])])]),e("div",{class:"mt-6 text-center"},[e("button",{class:"rounded-lg bg-green-600 px-6 py-3 text-white shadow-lg transition-all hover:bg-green-700 hover:shadow-xl",onClick:ze},t[100]||(t[100]=[e("i",{class:"fas fa-paper-plane mr-2"},null,-1),c(" 发送测试通知 ",-1)]))])],512),[[ee,x.value==="webhook"]]),u(e("div",null,[e("div",na,[t[105]||(t[105]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},"数据概览",-1)),e("div",da,[e("div",ia,[e("div",ua,g(F.value.apiKeys),1),t[101]||(t[101]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"API Keys",-1))]),e("div",ga,[e("div",ca,g(F.value.claudeAccounts),1),t[102]||(t[102]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"Claude账户",-1))]),e("div",ba,[e("div",fa,g(F.value.openaiAccounts),1),t[103]||(t[103]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"OpenAI账户",-1))]),e("div",ya,[e("div",va,g(F.value.systemConfig),1),t[104]||(t[104]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"系统配置",-1))])]),e("div",xa,[e("div",pa,[e("div",ma,[e("div",ka,[e("div",{class:O(["mr-2 h-3 w-3 rounded-full",F.value.is2FAEnabled?"bg-green-500":"bg-red-500"])},null,2),e("span",wa," 2FA状态: "+g(F.value.is2FAEnabled?"已启用":"未启用"),1)])]),F.value.lastExport?(n(),o("div",ha," 最后导出: "+g(bt(F.value.lastExport)),1)):p("",!0)])])]),F.value.is2FAEnabled?p("",!0):(n(),o("div",_a,[e("div",{class:"rounded-lg border border-yellow-200 bg-yellow-50 p-4 dark:border-yellow-800 dark:bg-yellow-900/20"},[t[106]||(t[106]=H('<div class="flex items-center" data-v-0bedd3d7><svg class="mr-3 h-5 w-5 text-yellow-600" fill="currentColor" viewBox="0 0 20 20" data-v-0bedd3d7><path clip-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" fill-rule="evenodd" data-v-0bedd3d7></path></svg><div data-v-0bedd3d7><h3 class="font-medium text-yellow-800 dark:text-yellow-200" data-v-0bedd3d7>需要启用2FA</h3><p class="mt-1 text-sm text-yellow-700 dark:text-yellow-300" data-v-0bedd3d7> 数据导出等敏感操作需要双因素认证保护，请先设置2FA。 </p></div></div>',1)),e("div",{class:"mt-3"},[e("button",{class:"rounded-md bg-yellow-600 px-4 py-2 text-sm font-medium text-white hover:bg-yellow-700",onClick:st}," 设置2FA ")])])])),e("div",Ca,[e("div",Sa,[t[108]||(t[108]=H('<div class="mb-4 flex items-center" data-v-0bedd3d7><svg class="mr-3 h-8 w-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-0bedd3d7><path d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" data-v-0bedd3d7></path></svg><h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200" data-v-0bedd3d7>数据导出</h3></div><p class="mb-4 text-sm text-gray-600 dark:text-gray-400" data-v-0bedd3d7> 将当前数据库中的所有数据导出为加密的ZIP文件 </p>',2)),e("div",Aa,[e("label",Da,[u(e("input",{"onUpdate:modelValue":t[17]||(t[17]=a=>me.value.includeStats=a),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",type:"checkbox"},null,512),[[E,me.value.includeStats]]),t[107]||(t[107]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"包含使用统计",-1))])]),e("button",{class:"w-full rounded-md bg-blue-600 px-4 py-2 font-medium text-white transition-colors hover:bg-blue-700 disabled:bg-gray-400",disabled:!F.value.is2FAEnabled||le.value,onClick:dt},[le.value?(n(),o("span",Oa,"导出中...")):(n(),o("span",ja,"开始导出"))],8,Fa)]),e("div",Ea,[t[112]||(t[112]=H('<div class="mb-4 flex items-center" data-v-0bedd3d7><svg class="mr-3 h-8 w-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-0bedd3d7><path d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" data-v-0bedd3d7></path></svg><h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200" data-v-0bedd3d7>数据导入</h3></div><p class="mb-4 text-sm text-gray-600 dark:text-gray-400" data-v-0bedd3d7> 从导出的ZIP文件恢复数据到当前数据库 </p>',2)),e("div",Ia,[e("div",null,[t[110]||(t[110]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 冲突处理策略 ",-1)),u(e("select",{"onUpdate:modelValue":t[18]||(t[18]=a=>ke.value.conflictStrategy=a),class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100"},t[109]||(t[109]=[e("option",{value:"skip"},"跳过已存在的记录",-1),e("option",{value:"overwrite"},"覆盖已存在的记录",-1),e("option",{value:"merge"},"智能合并记录",-1)]),512),[[ce,ke.value.conflictStrategy]])]),e("div",null,[t[111]||(t[111]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 选择文件 ",-1)),e("input",{ref_key:"importFileInput",ref:rt,accept:".zip,.json",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",type:"file",onChange:it},null,544)])]),e("button",{class:"w-full rounded-md bg-green-600 px-4 py-2 font-medium text-white transition-colors hover:bg-green-700 disabled:bg-gray-400",disabled:!F.value.is2FAEnabled||!ne.value||oe.value,onClick:ut},[oe.value?(n(),o("span",Va,"导入中...")):(n(),o("span",Ta,"开始导入"))],8,Ua)]),e("div",Ra,[t[115]||(t[115]=H('<div class="mb-4 flex items-center" data-v-0bedd3d7><svg class="mr-3 h-8 w-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-0bedd3d7><path d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" data-v-0bedd3d7></path></svg><h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200" data-v-0bedd3d7>数据库迁移</h3></div><p class="mb-4 text-sm text-gray-600 dark:text-gray-400" data-v-0bedd3d7> 将数据迁移到其他数据库系统（MongoDB、MySQL、PostgreSQL） </p>',2)),e("div",La,[e("label",Ma,[u(e("input",{"onUpdate:modelValue":t[19]||(t[19]=a=>de.value.validateOnly=a),class:"rounded border-gray-300 text-purple-600 focus:ring-purple-500",type:"checkbox"},null,512),[[E,de.value.validateOnly]]),t[113]||(t[113]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"仅验证（不执行迁移）",-1))]),e("div",null,[t[114]||(t[114]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 目标数据库配置文件 ",-1)),e("input",{ref_key:"migrationConfigInput",ref:at,accept:".json",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",type:"file",onChange:gt},null,544)])]),e("button",{class:"w-full rounded-md bg-purple-600 px-4 py-2 font-medium text-white transition-colors hover:bg-purple-700 disabled:bg-gray-400",disabled:!F.value.is2FAEnabled||!ue.value||ie.value,onClick:ct},[ie.value?(n(),o("span",qa,"迁移中...")):(n(),o("span",Ba,"开始迁移"))],8,Wa)])])],512),[[ee,x.value==="data-management"]]),u(e("div",null,[e("div",$a,[e("div",za,[t[117]||(t[117]=e("div",null,[e("h2",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"}," 启用请求日志记录 "),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," 记录所有API请求的详细信息，便于监控和调试 ")],-1)),e("label",Na,[u(e("input",{"onUpdate:modelValue":t[20]||(t[20]=a=>v.value.enabled=a),class:"peer sr-only",type:"checkbox",onChange:V},null,544),[[E,v.value.enabled]]),t[116]||(t[116]=e("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-blue-800"},null,-1))])])]),e("div",Pa,[t[124]||(t[124]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},"日志配置",-1)),e("div",Ga,[e("div",null,[t[119]||(t[119]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 日志级别 ",-1)),u(e("select",{"onUpdate:modelValue":t[21]||(t[21]=a=>v.value.level=a),class:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",onChange:V},t[118]||(t[118]=[e("option",{value:"error"},"错误 (Error)",-1),e("option",{value:"warn"},"警告 (Warning)",-1),e("option",{value:"info"},"信息 (Info)",-1),e("option",{value:"debug"},"调试 (Debug)",-1)]),544),[[ce,v.value.level]])]),e("div",null,[t[120]||(t[120]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 日志保留天数 ",-1)),u(e("input",{"onUpdate:modelValue":t[22]||(t[22]=a=>v.value.retentionDays=a),class:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",max:"365",min:"1",type:"number",onChange:V},null,544),[[D,v.value.retentionDays,void 0,{number:!0}]]),t[121]||(t[121]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 超过指定天数的日志将被自动清理 ",-1))]),e("div",null,[t[122]||(t[122]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 单个日志文件最大大小 (MB) ",-1)),u(e("input",{"onUpdate:modelValue":t[23]||(t[23]=a=>v.value.maxFileSize=a),class:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",max:"1000",min:"1",type:"number",onChange:V},null,544),[[D,v.value.maxFileSize,void 0,{number:!0}]])]),e("div",null,[t[123]||(t[123]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 最大日志文件数 ",-1)),u(e("input",{"onUpdate:modelValue":t[24]||(t[24]=a=>v.value.maxFiles=a),class:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",max:"100",min:"1",type:"number",onChange:V},null,544),[[D,v.value.maxFiles,void 0,{number:!0}]])])])]),e("div",Ha,[t[136]||(t[136]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"}," 记录内容配置 ",-1)),e("div",Ka,[e("div",Qa,[e("div",Ja,[t[126]||(t[126]=e("div",null,[e("h3",{class:"font-medium text-gray-700 dark:text-gray-300"},"请求头"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"记录HTTP请求头信息")],-1)),e("label",Za,[u(e("input",{"onUpdate:modelValue":t[25]||(t[25]=a=>v.value.includeHeaders=a),class:"peer sr-only",type:"checkbox",onChange:V},null,544),[[E,v.value.includeHeaders]]),t[125]||(t[125]=e("div",{class:"peer h-5 w-9 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-4 after:w-4 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white dark:border-gray-600 dark:bg-gray-700"},null,-1))])]),e("div",Xa,[t[128]||(t[128]=e("div",null,[e("h3",{class:"font-medium text-gray-700 dark:text-gray-300"},"请求体"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"记录请求体内容")],-1)),e("label",Ya,[u(e("input",{"onUpdate:modelValue":t[26]||(t[26]=a=>v.value.includeBody=a),class:"peer sr-only",type:"checkbox",onChange:V},null,544),[[E,v.value.includeBody]]),t[127]||(t[127]=e("div",{class:"peer h-5 w-9 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-4 after:w-4 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white dark:border-gray-600 dark:bg-gray-700"},null,-1))])]),e("div",es,[t[130]||(t[130]=e("div",null,[e("h3",{class:"font-medium text-gray-700 dark:text-gray-300"},"响应数据"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"记录API响应内容")],-1)),e("label",ts,[u(e("input",{"onUpdate:modelValue":t[27]||(t[27]=a=>v.value.includeResponse=a),class:"peer sr-only",type:"checkbox",onChange:V},null,544),[[E,v.value.includeResponse]]),t[129]||(t[129]=e("div",{class:"peer h-5 w-9 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-4 after:w-4 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white dark:border-gray-600 dark:bg-gray-700"},null,-1))])]),e("div",rs,[t[132]||(t[132]=e("div",null,[e("h3",{class:"font-medium text-gray-700 dark:text-gray-300"},"错误详情"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"记录错误堆栈信息")],-1)),e("label",as,[u(e("input",{"onUpdate:modelValue":t[28]||(t[28]=a=>v.value.includeErrors=a),class:"peer sr-only",type:"checkbox",onChange:V},null,544),[[E,v.value.includeErrors]]),t[131]||(t[131]=e("div",{class:"peer h-5 w-9 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-4 after:w-4 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white dark:border-gray-600 dark:bg-gray-700"},null,-1))])])]),e("div",ss,[t[135]||(t[135]=e("h3",{class:"font-medium text-gray-700 dark:text-gray-300"},"敏感数据过滤",-1)),e("div",ls,[e("div",os,[e("label",ns,[u(e("input",{"onUpdate:modelValue":t[29]||(t[29]=a=>v.value.filterSensitiveData=a),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-0",type:"checkbox",onChange:V},null,544),[[E,v.value.filterSensitiveData]]),t[133]||(t[133]=e("span",{class:"ml-3 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-shield-alt mr-2 text-gray-400"}),c(" 启用敏感数据过滤 ")],-1))])]),t[134]||(t[134]=e("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"}," 自动过滤或脱敏API密钥、令牌、密码等敏感信息 ",-1))])])])]),e("div",ds,[t[149]||(t[149]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"}," 日志统计信息 ",-1)),e("div",is,[e("div",us,[e("div",gs,[e("div",null,[t[137]||(t[137]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"今日日志",-1)),e("p",cs,g(Z.value.todayLogs||0),1)]),t[138]||(t[138]=e("i",{class:"fas fa-calendar-day text-xl text-blue-500"},null,-1))]),t[139]||(t[139]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"条记录",-1))]),e("div",bs,[e("div",fs,[e("div",null,[t[140]||(t[140]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"总日志数",-1)),e("p",ys,g(Z.value.totalLogs||0),1)]),t[141]||(t[141]=e("i",{class:"fas fa-file-alt text-xl text-green-500"},null,-1))]),t[142]||(t[142]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"条记录",-1))]),e("div",vs,[e("div",xs,[e("div",null,[t[143]||(t[143]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"存储占用",-1)),e("p",ps,g(yt(Z.value.storageUsed||0)),1)]),t[144]||(t[144]=e("i",{class:"fas fa-hdd text-xl text-orange-500"},null,-1))]),t[145]||(t[145]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"磁盘使用",-1))]),e("div",ms,[e("div",ks,[e("div",null,[t[146]||(t[146]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"错误日志",-1)),e("p",ws,g(Z.value.errorLogs||0),1)]),t[147]||(t[147]=e("i",{class:"fas fa-exclamation-triangle text-xl text-red-500"},null,-1))]),t[148]||(t[148]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"条错误",-1))])])]),e("div",hs,[e("div",_s,[e("button",{class:O(["btn btn-primary px-6 py-3",{"cursor-not-allowed opacity-50":G.value}]),disabled:G.value,onClick:V},[G.value?(n(),o("div",Ss)):(n(),o("i",As)),c(" "+g(G.value?"保存中...":"保存配置"),1)],10,Cs),Ve(l,{class:"btn bg-green-600 px-6 py-3 text-white hover:bg-green-700 focus:ring-green-500",to:"/request-logs"},{default:Te(()=>t[150]||(t[150]=[e("i",{class:"fas fa-eye mr-2"},null,-1),c(" 查看日志 ",-1)])),_:1,__:[150]}),e("button",{class:"btn bg-yellow-600 px-6 py-3 text-white hover:bg-yellow-700 focus:ring-yellow-500",disabled:X.value,onClick:ft},[X.value?(n(),o("div",Fs)):(n(),o("i",Os)),c(" "+g(X.value?"清理中...":"清理旧日志"),1)],8,Ds)]),v.value.updatedAt?(n(),o("div",js,[t[151]||(t[151]=e("i",{class:"fas fa-clock mr-1"},null,-1)),c(" 最后更新："+g(A(he)(v.value.updatedAt)),1)])):p("",!0)])],512),[[ee,x.value==="request-logging"]])]))])]),M.value?(n(),o("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm transition-all duration-300 ease-out",onClick:re},[e("div",{class:"relative mx-4 w-full max-w-2xl overflow-hidden rounded-2xl bg-white shadow-2xl transition-all duration-300 ease-out dark:bg-gray-800",onClick:t[35]||(t[35]=Ct(()=>{},["stop"]))},[e("div",Es,[e("div",Is,[e("div",Us,[t[153]||(t[153]=e("div",{class:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white shadow-lg"},[e("i",{class:"fas fa-bell"})],-1)),e("div",null,[e("h3",Vs,g(U.value?"编辑":"添加")+"通知平台 ",1),e("p",Ts," 配置"+g(U.value?"并更新":"新的")+"Webhook通知渠道 ",1)])]),e("button",{class:"rounded-lg p-2 text-gray-400 transition-colors hover:bg-gray-100 hover:text-gray-600 dark:hover:bg-gray-700 dark:hover:text-gray-300",onClick:re},t[154]||(t[154]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])]),e("div",Rs,[e("div",Ls,[e("div",null,[t[158]||(t[158]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-layer-group mr-2 text-gray-400"}),c(" 平台类型 ")],-1)),e("div",Ms,[u(e("select",{"onUpdate:modelValue":t[30]||(t[30]=a=>y.value.type=a),class:"w-full appearance-none rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white",disabled:U.value},t[155]||(t[155]=[H('<option value="wechat_work" data-v-0bedd3d7>🟢 企业微信</option><option value="dingtalk" data-v-0bedd3d7>🔵 钉钉</option><option value="feishu" data-v-0bedd3d7>🟦 飞书</option><option value="slack" data-v-0bedd3d7>🟣 Slack</option><option value="discord" data-v-0bedd3d7>🟪 Discord</option><option value="custom" data-v-0bedd3d7>⚙️ 自定义</option>',6)]),8,Ws),[[ce,y.value.type]]),t[156]||(t[156]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},[e("i",{class:"fas fa-chevron-down text-gray-400"})],-1))]),U.value?(n(),o("p",qs,t[157]||(t[157]=[e("i",{class:"fas fa-info-circle mr-1"},null,-1),c(" 编辑模式下不能更改平台类型 ",-1)]))):p("",!0)]),e("div",null,[t[159]||(t[159]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-tag mr-2 text-gray-400"}),c(" 名称 "),e("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),u(e("input",{"onUpdate:modelValue":t[31]||(t[31]=a=>y.value.name=a),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如：运维群通知、开发测试群",type:"text"},null,512),[[D,y.value.name]])]),e("div",null,[t[163]||(t[163]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-link mr-2 text-gray-400"}),c(" Webhook URL "),e("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),e("div",Bs,[u(e("input",{"onUpdate:modelValue":t[32]||(t[32]=a=>y.value.url=a),class:O(["w-full rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",{"border-red-500 focus:border-red-500 focus:ring-red-500/20":T.value,"border-green-500 focus:border-green-500 focus:ring-green-500/20":b.value}]),placeholder:"https://...",required:"",type:"url",onInput:Re},null,34),[[D,y.value.url]]),b.value?(n(),o("div",$s,t[160]||(t[160]=[e("i",{class:"fas fa-check-circle text-green-500"},null,-1)]))):p("",!0),T.value?(n(),o("div",zs,t[161]||(t[161]=[e("i",{class:"fas fa-exclamation-circle text-red-500"},null,-1)]))):p("",!0)]),Ae(y.value.type)?(n(),o("div",Ns,[t[162]||(t[162]=e("i",{class:"fas fa-info-circle mr-2 mt-0.5 text-blue-600 dark:text-blue-400"},null,-1)),e("p",Ps,g(Ae(y.value.type)),1)])):p("",!0)]),y.value.type==="dingtalk"||y.value.type==="feishu"?(n(),o("div",Gs,[e("div",Hs,[e("div",Ks,[e("label",Qs,[u(e("input",{id:"enableSign","onUpdate:modelValue":t[33]||(t[33]=a=>y.value.enableSign=a),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-0",type:"checkbox"},null,512),[[E,y.value.enableSign]]),t[164]||(t[164]=e("span",{class:"ml-3 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-shield-alt mr-2 text-gray-400"}),c(" 启用签名验证 ")],-1))]),y.value.enableSign?(n(),o("span",Js," 已启用 ")):p("",!0)]),Ve(_t,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-2"},{default:Te(()=>[y.value.enableSign?(n(),o("div",Zs,[t[165]||(t[165]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 签名密钥 ",-1)),u(e("input",{"onUpdate:modelValue":t[34]||(t[34]=a=>y.value.secret=a),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-800 dark:text-white dark:placeholder:text-gray-500",placeholder:"SEC...",type:"text"},null,512),[[D,y.value.secret]])])):p("",!0)]),_:1})])])):p("",!0)])]),e("div",Xs,[e("div",Ys,[t[167]||(t[167]=e("div",{class:"text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-asterisk mr-1 text-red-500"}),c(" 必填项 ")],-1)),e("div",el,[e("button",{class:"group flex items-center rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 shadow-sm transition-all hover:bg-gray-50 hover:shadow-md dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",onClick:re},t[166]||(t[166]=[e("i",{class:"fas fa-times mr-2 transition-transform group-hover:scale-110"},null,-1),c(" 取消 ",-1)])),e("button",{class:"group flex items-center rounded-xl border border-blue-200 bg-blue-50 px-4 py-2.5 text-sm font-medium text-blue-700 shadow-sm transition-all hover:bg-blue-100 hover:shadow-md dark:border-blue-800 dark:bg-blue-900/50 dark:text-blue-300 dark:hover:bg-blue-900/70",disabled:k.value,onClick:$e},[e("i",{class:O(["mr-2 transition-transform",k.value?"fas fa-spinner fa-spin":"fas fa-vial group-hover:scale-110"])},null,2),c(" "+g(k.value?"测试中...":"测试连接"),1)],8,tl),e("button",{class:"group flex items-center rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-5 py-2.5 text-sm font-medium text-white shadow-md transition-all hover:from-blue-700 hover:to-indigo-700 hover:shadow-lg disabled:cursor-not-allowed disabled:from-gray-400 disabled:to-gray-500",disabled:!y.value.url||R.value,onClick:Le},[e("i",{class:O(["mr-2 transition-transform",R.value?"fas fa-spinner fa-spin":"fas fa-save group-hover:scale-110"])},null,2),c(" "+g(R.value?"保存中...":U.value?"保存修改":"添加平台"),1)],8,rl)])])])])])):p("",!0),ae.value?(n(),o("div",al,[e("div",sl,[e("div",ll,[t[169]||(t[169]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"设置双因素认证",-1)),e("button",{class:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",onClick:t[36]||(t[36]=a=>ae.value=!1)},t[168]||(t[168]=[e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M6 18L18 6M6 6l12 12","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1)]))]),W.value===1?(n(),o("div",ol,[t[171]||(t[171]=e("p",{class:"mb-4 text-gray-600 dark:text-gray-400"}," 使用Google Authenticator或Authy扫描二维码： ",-1)),ve.value?(n(),o("div",nl,[e("img",{alt:"2FA QR Code",class:"mx-auto rounded border",src:ve.value},null,8,dl)])):p("",!0),xe.value?(n(),o("div",il,[t[170]||(t[170]=e("p",{class:"mb-2 text-sm text-gray-600 dark:text-gray-400"},"手动输入密钥：",-1)),e("code",ul,g(xe.value),1)])):p("",!0),e("button",{class:"w-full rounded-md bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",onClick:t[37]||(t[37]=a=>W.value=2)}," 下一步 ")])):p("",!0),W.value===2?(n(),o("div",gl,[t[172]||(t[172]=e("p",{class:"mb-4 text-gray-600 dark:text-gray-400"},"输入应用显示的6位验证码：",-1)),u(e("input",{"onUpdate:modelValue":t[38]||(t[38]=a=>N.value=a),class:"mb-4 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-center font-mono text-2xl text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",maxlength:"6",placeholder:"000000",type:"text"},null,512),[[D,N.value]]),e("div",cl,[e("button",{class:"flex-1 rounded-md bg-gray-500 px-4 py-2 text-white hover:bg-gray-600",onClick:t[39]||(t[39]=a=>W.value=1)}," 上一步 "),e("button",{class:"flex-1 rounded-md bg-green-600 px-4 py-2 text-white hover:bg-green-700 disabled:bg-gray-400",disabled:!N.value||N.value.length!==6,onClick:lt}," 启用2FA ",8,bl)])])):p("",!0),W.value===3&&pe.value?(n(),o("div",fl,[t[173]||(t[173]=e("p",{class:"mb-4 text-gray-600 dark:text-gray-400"},"2FA设置成功！请保存以下备份码：",-1)),e("div",yl,[e("div",vl,[(n(!0),o(be,null,_e(pe.value,a=>(n(),o("div",{key:a,class:"text-center"},g(a),1))),128))])]),e("button",{class:"w-full rounded-md bg-green-600 px-4 py-2 text-white hover:bg-green-700",onClick:ot}," 完成设置 ")])):p("",!0)])])):p("",!0),B.value?(n(),o("div",xl,[e("div",pl,[e("div",ml,[t[175]||(t[175]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"敏感操作验证",-1)),e("button",{class:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",onClick:t[40]||(t[40]=a=>B.value=!1)},t[174]||(t[174]=[e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M6 18L18 6M6 6l12 12","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1)]))]),e("div",kl,[e("div",null,[t[176]||(t[176]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 管理员密码 ",-1)),u(e("input",{"onUpdate:modelValue":t[41]||(t[41]=a=>C.value.password=a),class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",type:"password"},null,512),[[D,C.value.password]])]),e("div",null,[t[177]||(t[177]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 2FA验证码 ",-1)),u(e("input",{"onUpdate:modelValue":t[42]||(t[42]=a=>C.value.token=a),class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-center font-mono text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",maxlength:"8",placeholder:"6位验证码或8位备份码",type:"text"},null,512),[[D,C.value.token]])]),e("div",wl,[e("button",{class:"flex-1 rounded-md bg-gray-500 px-4 py-2 text-white hover:bg-gray-600",onClick:t[43]||(t[43]=a=>B.value=!1)}," 取消 "),e("button",{class:"flex-1 rounded-md bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 disabled:bg-gray-400",disabled:!C.value.password||!C.value.token||se.value,onClick:nt},[se.value?(n(),o("span",_l,"验证中...")):(n(),o("span",Cl,"验证"))],8,hl)])])])])):p("",!0)],64)}}}),El=St(Sl,[["__scopeId","data-v-0bedd3d7"]]);export{El as default};
