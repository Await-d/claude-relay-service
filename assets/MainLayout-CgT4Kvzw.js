import{c as x,r as P,_ as de,q as ce,V as ge,o as O,x as n,y as o,z as e,L as S,R as _,J as Y,P as v,C as I,Y as Q,O as C,T as me,K as R,aq as L,Q as z,aX as Z,ac as X,u as D,ax as pe,aY as fe,D as xe}from"./vue-vendor-CcFZMz-v.js";import{_ as B,u as F,b as W}from"./index-DCzasIW1.js";import{s as M}from"./toast-BvwA7Mwb.js";import{L as ve}from"./LogoTitle-C8dX0Z7j.js";import{T as ye}from"./ThemeToggle-DM1-KGIK.js";import{S as be}from"./SessionManager-lTc519vh.js";import"./element-plus-C-1FTG0y.js";import"./vendor-B90ziCBp.js";const he={class:"glass-strong mb-4 rounded-xl p-3 shadow-xl sm:mb-6 sm:rounded-2xl sm:p-4 md:mb-8 md:rounded-3xl md:p-6",style:{"z-index":"10",position:"relative"}},ke={class:"flex flex-col items-center justify-between gap-3 sm:flex-row sm:gap-4"},we={class:"flex w-full items-center justify-center gap-2 sm:w-auto sm:justify-start sm:gap-3 md:gap-4"},_e={class:"flex items-center gap-1 sm:gap-2"},Te={class:"font-mono text-xs text-gray-400 dark:text-gray-500 sm:text-sm"},Ue=["href"],Se={class:"flex items-center gap-2 sm:gap-4"},Ce={class:"flex items-center"},Me=["title"],Pe={class:"hidden text-xs font-medium md:inline"},Ie={class:"user-menu-container relative"},Ae={class:"hidden sm:inline"},$e={key:0,class:"hidden text-xs opacity-75 lg:inline"},qe={class:"border-b border-gray-100 px-4 py-3 dark:border-gray-700"},Ne={class:"mb-3 flex items-center gap-3"},Re={class:"font-semibold text-gray-900 dark:text-gray-100"},Le={class:"text-xs text-gray-500 dark:text-gray-400"},De={class:"border-b border-gray-100 px-4 py-3 dark:border-gray-700"},je={class:"flex items-center justify-between text-sm"},Ve={class:"font-mono text-gray-700 dark:text-gray-300"},Ee={key:0,class:"mt-2"},Ke={class:"mb-2 flex items-center justify-between text-sm"},Oe={class:"font-mono text-green-600 dark:text-green-400"},ze=["href"],Be={key:1,class:"mt-2 text-center text-xs text-gray-500 dark:text-gray-400"},Fe={key:2,class:"mt-2 text-center"},Ge={key:"message",class:"inline-block rounded-lg border border-green-200 bg-green-100 px-3 py-1.5 dark:border-green-800 dark:bg-green-900/30"},Je={key:0,class:"border-b border-gray-200 dark:border-gray-700"},He={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},Ye={class:"modal-content mx-auto flex max-h-[90vh] w-full max-w-md flex-col p-4 sm:p-6 md:p-8"},Qe=["value"],Xe={class:"flex gap-3 pt-4"},We=["disabled"],Ze={key:0,class:"loading-spinner mr-2"},et={key:1,class:"fas fa-save mr-2"},tt=5*60*1e3,st={__name:"AppHeader",props:{sessionToken:{type:String,default:""},expiresAt:{type:[String,Number],default:null}},emits:["logout"],setup(T,{emit:h}){const m=T,p=h,r=Z(),i=F(),s=x(()=>i.user||{username:"Admin"}),U=x(()=>i.oemSettings||{}),j=x(()=>i.oemLoading),A=P(Date.now()),N=x(()=>m.expiresAt?typeof m.expiresAt=="string"?new Date(m.expiresAt).getTime():m.expiresAt:null),k=x(()=>N.value?Math.max(0,N.value-A.value):0),d=x(()=>k.value<=0),y=x(()=>k.value>0&&k.value<=tt),u=x(()=>m.sessionToken?d.value?"expired":y.value?"expiring":"active":"none"),w=x(()=>{switch(u.value){case"active":return"bg-green-50 text-green-600 dark:bg-green-900/20 dark:text-green-400";case"expiring":return"bg-yellow-50 text-yellow-600 dark:bg-yellow-900/20 dark:text-yellow-400";case"expired":return"bg-red-50 text-red-600 dark:bg-red-900/20 dark:text-red-400";default:return"bg-gray-50 text-gray-500 dark:bg-gray-800 dark:text-gray-400"}}),ee=x(()=>{switch(u.value){case"active":return"fas fa-check-circle";case"expiring":return"fas fa-clock";case"expired":return"fas fa-times-circle";default:return"fas fa-question-circle"}}),te=x(()=>{switch(u.value){case"active":return"会话正常";case"expiring":return`会话即将过期 (${ae(k.value)})`;case"expired":return"会话已过期";default:return"未登录"}}),se=x(()=>{switch(u.value){case"active":return"已连接";case"expiring":return"即将过期";case"expired":return"已过期";default:return"离线"}}),ae=c=>{const t=Math.floor(c/1e3),f=Math.floor(t/60),g=Math.floor(f/60);return g>0?`${g}小时${f%60}分钟`:f>0?`${f}分钟`:`${t}秒`},a=P({current:"...",latest:"",hasUpdate:!1,checkingUpdate:!1,lastChecked:null,releaseInfo:null,noUpdateMessage:!1}),b=P(!1),V=P(!1),$=P(!1),l=de({currentPassword:"",newPassword:"",confirmPassword:"",newUsername:""}),E=async()=>{if(!a.value.checkingUpdate){a.value.checkingUpdate=!0;try{const c=await W.get("/admin/check-updates");if(c.success){const t=c.data;a.value.current=t.current,a.value.latest=t.latest,a.value.hasUpdate=t.hasUpdate,a.value.releaseInfo=t.releaseInfo,a.value.lastChecked=new Date,localStorage.setItem("versionInfo",JSON.stringify({current:t.current,latest:t.latest,lastChecked:a.value.lastChecked,hasUpdate:t.hasUpdate,releaseInfo:t.releaseInfo})),t.hasUpdate||(a.value.noUpdateMessage=!0,setTimeout(()=>{a.value.noUpdateMessage=!1},3e3))}}catch(c){console.error("Error checking for updates:",c);const t=localStorage.getItem("versionInfo");if(t){const f=JSON.parse(t);a.value.current=f.current||a.value.current,a.value.latest=f.latest,a.value.hasUpdate=f.hasUpdate,a.value.releaseInfo=f.releaseInfo,a.value.lastChecked=new Date(f.lastChecked)}}finally{a.value.checkingUpdate=!1}}},re=()=>{l.currentPassword="",l.newPassword="",l.confirmPassword="",l.newUsername="",V.value=!0,b.value=!1},K=()=>{V.value=!1},ne=async()=>{if(l.newPassword!==l.confirmPassword){M("两次输入的密码不一致","error");return}if(l.newPassword.length<8){M("新密码长度至少8位","error");return}$.value=!0;try{const c=await W.post("/web/auth/change-password",{currentPassword:l.currentPassword,newPassword:l.newPassword,newUsername:l.newUsername||void 0});if(c.success){const t=l.newUsername?"账户信息修改成功，请重新登录":"密码修改成功，请重新登录";M(t,"success"),K(),setTimeout(()=>{i.logout(),r.push("/login")},1500)}else M(c.message||"修改失败","error")}catch{M("修改密码失败","error")}finally{$.value=!1}},oe=()=>{confirm("确定要退出登录吗？")&&(i.logout(),r.push("/login"),M("已安全退出","success"),p("logout")),b.value=!1},le=()=>{r.push("/users"),b.value=!1},ie=()=>{r.push("/user-groups"),b.value=!1},ue=()=>{r.push("/settings"),b.value=!1},G=c=>{!c.target.closest(".user-menu-container")&&b.value&&(b.value=!1)};let q=null;const J=()=>{q||(q=setInterval(()=>{A.value=Date.now()},1e3))},H=()=>{q&&(clearInterval(q),q=null)};return ce(()=>{E(),setInterval(()=>{E()},36e5),m.sessionToken&&J(),document.addEventListener("click",G)}),ge(()=>{H(),document.removeEventListener("click",G)}),O(()=>m.sessionToken,c=>{c?J():H()}),O(()=>m.expiresAt,()=>{m.sessionToken&&(A.value=Date.now())}),(c,t)=>{var f;return o(),n(z,null,[e("div",he,[e("div",ke,[e("div",we,[_(ve,{loading:j.value,"logo-src":U.value.siteIconData||U.value.siteIcon,subtitle:"管理后台",title:U.value.siteName,"title-class":"text-white dark:text-gray-100"},{"after-title":Y(()=>{var g;return[e("div",_e,[e("span",Te,"v"+v(a.value.current||"..."),1),a.value.hasUpdate?(o(),n("a",{key:0,class:"inline-flex animate-pulse items-center gap-1 rounded-full border border-green-600 bg-green-500 px-2 py-0.5 text-xs text-white transition-colors hover:bg-green-600",href:((g=a.value.releaseInfo)==null?void 0:g.htmlUrl)||"#",target:"_blank",title:"有新版本可用"},[...t[7]||(t[7]=[e("i",{class:"fas fa-arrow-up text-[10px]"},null,-1),e("span",null,"新版本",-1)])],8,Ue)):S("",!0)])]}),_:1},8,["loading","logo-src","title"])]),e("div",Se,[e("div",Ce,[_(ye,{mode:"dropdown"})]),T.sessionToken?(o(),n("div",{key:0,class:I(["hidden items-center gap-1.5 rounded-lg px-2 py-1 sm:flex",w.value]),title:te.value},[e("i",{class:I(["text-xs",ee.value])},null,2),e("span",Pe,v(se.value),1)],10,Me)):S("",!0),t[23]||(t[23]=e("div",{class:"h-8 w-px bg-gradient-to-b from-transparent via-gray-300 to-transparent opacity-50 dark:via-gray-600"},null,-1)),e("div",Ie,[e("button",{class:"user-menu-button flex items-center gap-2 rounded-2xl bg-gradient-to-r from-blue-500 to-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-lg transition-all duration-200 hover:scale-105 hover:shadow-xl active:scale-95 sm:px-4 sm:py-2.5",onClick:t[0]||(t[0]=g=>b.value=!b.value)},[t[8]||(t[8]=e("i",{class:"fas fa-user-circle text-sm sm:text-base"},null,-1)),e("span",Ae,v(s.value.username||"Admin"),1),s.value.role?(o(),n("span",$e," ("+v(s.value.role==="admin"?"管理员":"用户")+") ",1)):S("",!0),e("i",{class:I(["fas fa-chevron-down ml-1 text-xs transition-transform duration-200",{"rotate-180":b.value}])},null,2)]),b.value?(o(),n("div",{key:0,class:"user-menu-dropdown absolute right-0 top-full mt-2 w-48 rounded-xl border border-gray-200 bg-white py-2 shadow-xl dark:border-gray-700 dark:bg-gray-800 sm:w-56",style:{"z-index":"999999"},onClick:t[2]||(t[2]=Q(()=>{},["stop"]))},[e("div",qe,[e("div",Ne,[e("div",{class:I(["flex h-10 w-10 items-center justify-center rounded-full",s.value.role==="admin"?"bg-gradient-to-br from-purple-500 to-pink-500":"bg-gradient-to-br from-blue-500 to-indigo-500"])},[...t[9]||(t[9]=[e("i",{class:"fas fa-user text-sm text-white"},null,-1)])],2),e("div",null,[e("div",Re,v(s.value.username||"Admin"),1),e("div",Le,v(s.value.role==="admin"?"系统管理员":"普通用户"),1)])])]),e("div",De,[e("div",je,[t[10]||(t[10]=e("span",{class:"text-gray-500 dark:text-gray-400"},"当前版本",-1)),e("span",Ve,"v"+v(a.value.current||"..."),1)]),a.value.hasUpdate?(o(),n("div",Ee,[e("div",Ke,[t[11]||(t[11]=e("span",{class:"font-medium text-green-600 dark:text-green-400"},[e("i",{class:"fas fa-arrow-up mr-1"}),C("有新版本 ")],-1)),e("span",Oe,"v"+v(a.value.latest),1)]),e("a",{class:"block w-full rounded-lg bg-green-500 px-3 py-1.5 text-center text-sm text-white transition-colors hover:bg-green-600",href:((f=a.value.releaseInfo)==null?void 0:f.htmlUrl)||"#",target:"_blank"},[...t[12]||(t[12]=[e("i",{class:"fas fa-external-link-alt mr-1"},null,-1),C("查看更新 ",-1)])],8,ze)])):a.value.checkingUpdate?(o(),n("div",Be,[...t[13]||(t[13]=[e("i",{class:"fas fa-spinner fa-spin mr-1"},null,-1),C("检查更新中... ",-1)])])):(o(),n("div",Fe,[_(me,{mode:"out-in",name:"fade"},{default:Y(()=>[a.value.noUpdateMessage?(o(),n("div",Ge,[...t[14]||(t[14]=[e("p",{class:"text-xs font-medium text-green-700 dark:text-green-400"},[e("i",{class:"fas fa-check-circle mr-1"}),C("当前已是最新版本 ")],-1)])])):(o(),n("button",{key:"button",class:"text-xs text-blue-500 transition-colors hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",onClick:t[1]||(t[1]=g=>E())},[...t[15]||(t[15]=[e("i",{class:"fas fa-sync-alt mr-1"},null,-1),C("检查更新 ",-1)])]))]),_:1})]))]),s.value.role==="admin"?(o(),n("div",Je,[e("div",{class:"px-4 py-2"},[t[19]||(t[19]=e("p",{class:"mb-2 text-xs font-medium text-gray-500 dark:text-gray-400"},"管理功能",-1)),e("div",{class:"space-y-1"},[e("button",{class:"flex w-full items-center gap-3 rounded-lg px-2 py-2 text-left text-sm text-gray-700 transition-colors hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700",onClick:le},[...t[16]||(t[16]=[e("i",{class:"fas fa-user-friends w-4 text-xs text-blue-500"},null,-1),e("span",null,"用户管理",-1)])]),e("button",{class:"flex w-full items-center gap-3 rounded-lg px-2 py-2 text-left text-sm text-gray-700 transition-colors hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700",onClick:ie},[...t[17]||(t[17]=[e("i",{class:"fas fa-users-cog w-4 text-xs text-purple-500"},null,-1),e("span",null,"用户组管理",-1)])]),e("button",{class:"flex w-full items-center gap-3 rounded-lg px-2 py-2 text-left text-sm text-gray-700 transition-colors hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700",onClick:ue},[...t[18]||(t[18]=[e("i",{class:"fas fa-cogs w-4 text-xs text-gray-500"},null,-1),e("span",null,"系统设置",-1)])])])])])):S("",!0),e("button",{class:"flex w-full items-center gap-3 px-4 py-3 text-left text-gray-700 transition-colors hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700",onClick:re},[...t[20]||(t[20]=[e("i",{class:"fas fa-key text-blue-500"},null,-1),e("span",null,"修改账户信息",-1)])]),t[22]||(t[22]=e("hr",{class:"my-2 border-gray-200 dark:border-gray-700"},null,-1)),e("button",{class:"flex w-full items-center gap-3 px-4 py-3 text-left text-gray-700 transition-colors hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700",onClick:oe},[...t[21]||(t[21]=[e("i",{class:"fas fa-sign-out-alt text-red-500"},null,-1),e("span",null,"退出登录",-1)])])])):S("",!0)])])])]),V.value?(o(),n("div",He,[e("div",Ye,[e("div",{class:"mb-6 flex items-center justify-between"},[t[25]||(t[25]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600"},[e("i",{class:"fas fa-key text-white"})]),e("h3",{class:"text-xl font-bold text-gray-900 dark:text-gray-100"},"修改账户信息")],-1)),e("button",{class:"text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",onClick:K},[...t[24]||(t[24]=[e("i",{class:"fas fa-times text-xl"},null,-1)])])]),e("form",{class:"modal-scroll-content custom-scrollbar flex-1 space-y-6",onSubmit:Q(ne,["prevent"])},[e("div",null,[t[26]||(t[26]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"当前用户名",-1)),e("input",{class:"form-input w-full cursor-not-allowed bg-gray-100 dark:bg-gray-700 dark:text-gray-300",disabled:"",type:"text",value:s.value.username||"Admin"},null,8,Qe),t[27]||(t[27]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 当前用户名，输入新用户名以修改 ",-1))]),e("div",null,[t[28]||(t[28]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"新用户名",-1)),R(e("input",{"onUpdate:modelValue":t[3]||(t[3]=g=>l.newUsername=g),class:"form-input w-full",placeholder:"输入新用户名（留空保持不变）",type:"text"},null,512),[[L,l.newUsername]]),t[29]||(t[29]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},"留空表示不修改用户名",-1))]),e("div",null,[t[30]||(t[30]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"当前密码",-1)),R(e("input",{"onUpdate:modelValue":t[4]||(t[4]=g=>l.currentPassword=g),class:"form-input w-full",placeholder:"请输入当前密码",required:"",type:"password"},null,512),[[L,l.currentPassword]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"新密码",-1)),R(e("input",{"onUpdate:modelValue":t[5]||(t[5]=g=>l.newPassword=g),class:"form-input w-full",placeholder:"请输入新密码",required:"",type:"password"},null,512),[[L,l.newPassword]]),t[32]||(t[32]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},"密码长度至少8位",-1))]),e("div",null,[t[33]||(t[33]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"确认新密码",-1)),R(e("input",{"onUpdate:modelValue":t[6]||(t[6]=g=>l.confirmPassword=g),class:"form-input w-full",placeholder:"请再次输入新密码",required:"",type:"password"},null,512),[[L,l.confirmPassword]])]),e("div",Xe,[e("button",{class:"flex-1 rounded-xl bg-gray-100 px-6 py-3 font-semibold text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",type:"button",onClick:K}," 取消 "),e("button",{class:"btn btn-primary flex-1 px-6 py-3 font-semibold",disabled:$.value,type:"submit"},[$.value?(o(),n("div",Ze)):(o(),n("i",et)),C(" "+v($.value?"保存中...":"保存修改"),1)],8,We)])],32)])])):S("",!0)],64)}}},at=B(st,[["__scopeId","data-v-9e1dfb1a"]]),rt={class:"mb-4 sm:mb-6"},nt={class:"block rounded-xl bg-white/10 p-2 backdrop-blur-sm dark:bg-gray-800/20 sm:hidden"},ot=["value"],lt=["value"],it={class:"hidden flex-wrap gap-2 rounded-2xl bg-white/10 p-2 backdrop-blur-sm dark:bg-gray-800/20 sm:flex"},ut=["onClick"],dt={class:"hidden md:inline"},ct={class:"md:hidden"},gt={__name:"TabBar",props:{activeTab:{type:String,required:!0}},emits:["tab-change"],setup(T){const h=F(),m=[{key:"dashboard",name:"仪表板",shortName:"仪表板",icon:"fas fa-tachometer-alt",requiredRole:null},{key:"apiKeys",name:"API Keys",shortName:"API",icon:"fas fa-key",requiredRole:null},{key:"accounts",name:"账户管理",shortName:"账户",icon:"fas fa-user-circle",requiredRole:null},{key:"users",name:"用户管理",shortName:"用户",icon:"fas fa-user-friends",requiredRole:"admin"},{key:"groups",name:"用户组",shortName:"组",icon:"fas fa-users",requiredRole:"admin"},{key:"user-groups",name:"用户组管理",shortName:"组管理",icon:"fas fa-users-cog",requiredRole:"admin"},{key:"requestLogs",name:"请求日志",shortName:"日志",icon:"fas fa-file-alt",requiredRole:null},{key:"tutorial",name:"使用教程",shortName:"教程",icon:"fas fa-graduation-cap",requiredRole:null},{key:"settings",name:"系统设置",shortName:"设置",icon:"fas fa-cogs",requiredRole:"admin"}],p=x(()=>{const r=h.user,i=(r==null?void 0:r.role)||"user";return m.filter(s=>!s.requiredRole||i==="admin"?!0:i===s.requiredRole)});return(r,i)=>(o(),n("div",rt,[e("div",nt,[e("select",{class:"focus:ring-primary-color w-full rounded-lg bg-white/90 px-4 py-3 font-semibold text-gray-700 focus:outline-none focus:ring-2 dark:bg-gray-800/90 dark:text-gray-200 dark:focus:ring-indigo-400",value:T.activeTab,onChange:i[0]||(i[0]=s=>r.$emit("tab-change",s.target.value))},[(o(!0),n(z,null,X(p.value,s=>(o(),n("option",{key:s.key,value:s.key},v(s.name),9,lt))),128))],40,ot)]),e("div",it,[(o(!0),n(z,null,X(p.value,s=>(o(),n("button",{key:s.key,class:I(["tab-btn flex-1 px-3 py-2 text-xs font-semibold transition-all duration-300 sm:px-4 sm:py-3 sm:text-sm md:px-6",T.activeTab===s.key?"active":"text-gray-700 hover:bg-white/10 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-gray-700/30 dark:hover:text-gray-100"]),onClick:U=>r.$emit("tab-change",s.key)},[e("i",{class:I(s.icon+" mr-1 sm:mr-2")},null,2),e("span",dt,v(s.name),1),e("span",ct,v(s.shortName||s.name),1)],10,ut))),128))])]))}},mt=B(gt,[["__scopeId","data-v-67758799"]]),pt={class:"min-h-screen p-3 sm:p-4 md:p-6"},ft={class:"glass-strong rounded-xl p-3 shadow-xl sm:rounded-2xl sm:p-4 md:rounded-3xl md:p-6",style:{"z-index":"1","min-height":"calc(100vh - 120px)"}},xt={class:"tab-content"},vt={__name:"MainLayout",setup(T){const h=fe(),m=Z(),p=F(),r=P("dashboard"),i={dashboard:"/dashboard",apiKeys:"/api-keys",accounts:"/accounts",users:"/users",groups:"/groups","user-groups":"/user-groups",requestLogs:"/request-logs",tutorial:"/tutorial",settings:"/settings"},s=()=>{const d=h.path,y=Object.keys(i).find(u=>i[u]===d);if(y)r.value=y;else{const u=h.name,w={Dashboard:"dashboard",ApiKeys:"apiKeys",Accounts:"accounts",Users:"users",Groups:"groups",UserGroups:"user-groups",DataManagement:"data-management",Tutorial:"tutorial",Settings:"settings"};u&&w[u]?r.value=w[u]:r.value="dashboard"}};s(),O(()=>h.path,d=>{const y=Object.keys(i).find(u=>i[u]===d);if(y)r.value=y;else{const u=h.name,w={Dashboard:"dashboard",ApiKeys:"apiKeys",Accounts:"accounts",Users:"users",Groups:"groups",UserGroups:"user-groups",DataManagement:"data-management",Tutorial:"tutorial",Settings:"settings"};u&&w[u]&&(r.value=w[u])}});const U=async d=>{if(i[d]!==h.path){r.value=d;try{await m.push(i[d]),await xe()}catch(y){y.name!=="NavigationDuplicated"&&(console.error("路由切换失败:",y),s())}}},j=async()=>{try{await p.refreshSession()||console.warn("Session refresh failed in MainLayout")}catch(d){console.error("Session refresh error in MainLayout:",d)}},A=()=>{console.warn("Session expired in MainLayout"),p.clearAuthState()},N=d=>{console.error("Session refresh failed in MainLayout:",d),p.clearAuthState()},k=()=>{p.logout()};return(d,y)=>{const u=pe("router-view");return o(),n("div",pt,[_(be,{"auto-refresh":!0,"expires-at":D(p).expiresAt,"session-token":D(p).sessionToken,"show-indicator":!1,"show-status-text":!1,onLogout:k,onRefreshFailed:N,onSessionExpired:A,onSessionRefreshed:j},null,8,["expires-at","session-token"]),_(at,{"session-token":D(p).sessionToken,"expires-at":D(p).expiresAt,onLogout:k},null,8,["session-token","expires-at"]),e("div",ft,[_(mt,{"active-tab":r.value,onTabChange:U},null,8,["active-tab"]),e("div",xt,[_(u)])])])}}},St=B(vt,[["__scopeId","data-v-ec0816d5"]]);export{St as default};
