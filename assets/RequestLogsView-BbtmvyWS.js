import{x as i,y as d,z as t,O as b,P as a,L as $,C as _,B as ut,r as O,c as tt,q as wt,D as xe,o as ge,Q as ot,K as Z,aq as xt,ac as lt,aW as ct,aZ as Ce,V as De,I as Te,u as p,a_ as _t,R as vt,a5 as Se,Y as je}from"./vue-vendor-CcFZMz-v.js";import{u as Be}from"./requestLogs-YugafwDP.js";import{s as nt}from"./toast-BvwA7Mwb.js";import{_ as gt}from"./index-BRegghkI.js";import{C as qe}from"./chart-DOIXA9jv.js";import"./element-plus-C-1FTG0y.js";import"./vendor-B90ziCBp.js";const Le={class:"request-overview"},Ne={class:"mb-8 grid grid-cols-1 gap-6 lg:grid-cols-2"},Oe={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},Ae={class:"space-y-4"},Ie={class:"grid grid-cols-2 gap-4"},Re={class:"text-sm text-gray-900 dark:text-gray-100"},He={class:"text-xs text-gray-500 dark:text-gray-400"},Ke={class:"break-all font-mono text-sm text-gray-900 dark:text-gray-100"},Pe={class:"grid grid-cols-2 gap-4"},Me={class:"flex items-center gap-2"},Ee={class:"text-sm text-gray-900 dark:text-gray-100"},Fe={class:"text-sm text-gray-900 dark:text-gray-100"},Ue={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},Ve={class:"space-y-4"},ze={class:"grid grid-cols-2 gap-4"},Je={class:"flex items-center gap-2"},We={class:"text-xs text-gray-500 dark:text-gray-400"},Ge={class:"break-all rounded border bg-gray-50 p-2 font-mono text-sm text-gray-900 dark:bg-gray-700/50 dark:text-gray-100"},Qe={class:"grid grid-cols-2 gap-4"},Ye={class:"flex items-center gap-2"},Ze={class:"font-mono text-sm text-gray-900 dark:text-gray-100"},Xe={class:"mb-8 grid grid-cols-1 gap-6 lg:grid-cols-2"},ts={class:"rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white"},es={class:"grid grid-cols-2 gap-4"},ss={class:"text-2xl font-bold"},as={class:"text-2xl font-bold"},rs={class:"mt-4 grid grid-cols-4 gap-2 text-xs"},os={class:"text-center"},ns={class:"font-semibold"},ls={class:"text-center"},ds={class:"font-semibold"},is={class:"text-center"},us={class:"font-semibold"},cs={class:"text-center"},xs={class:"font-semibold"},gs={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},ys={class:"space-y-4"},ms={class:"text-center"},fs={class:"text-3xl font-bold text-green-600 dark:text-green-400"},bs={class:"grid grid-cols-2 gap-4 border-t border-gray-200 pt-4 dark:border-gray-700"},ps={class:"text-center"},ks={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},vs={class:"text-center"},hs={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},$s={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},_s={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},ws={class:"space-y-3"},Cs={class:"flex items-center justify-between"},Ds={class:"flex items-center gap-2"},Ts={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},Ss={class:"text-xs font-medium"},js={class:"flex items-center justify-between"},Bs={class:"flex items-center gap-2"},qs={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},Ls={class:"text-xs font-medium"},Ns={class:"flex items-center justify-between"},Os={class:"flex items-center gap-2"},As={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},Is={class:"text-xs font-medium"},Rs={class:"flex items-center justify-between"},Hs={class:"flex items-center gap-2"},Ks={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},Ps={class:"text-xs font-medium"},Ms={class:"space-y-2 text-sm"},Es={class:"flex justify-between"},Fs={class:"text-gray-900 dark:text-gray-100"},Us={class:"flex justify-between"},Vs={class:"flex justify-between"},zs={class:"text-gray-900 dark:text-gray-100"},Js={class:"mt-6 border-t border-gray-200 pt-4 dark:border-gray-700"},Ws={class:"flex items-center justify-between"},Gs={class:"flex items-center gap-3"},Qs={class:"h-3 w-32 rounded-full bg-gray-200 dark:bg-gray-700"},Ys={__name:"RequestOverview",props:{log:{type:Object,required:!0}},setup(x){const w=x,S=u=>u?new Date(u).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"N/A",B=u=>{if(!u)return"";const c=Date.now(),P=new Date(u).getTime(),L=c-P;return L<6e4?"刚刚":L<36e5?`${Math.floor(L/6e4)} 分钟前`:L<864e5?`${Math.floor(L/36e5)} 小时前`:`${Math.floor(L/864e5)} 天前`},j=u=>u.id||u.logId||"N/A",q=u=>{var c;return u.formattedKeyName||((c=u.apiKey)==null?void 0:c.name)||(u.keyId?`Key-${u.keyId.slice(-8)}`:"N/A")},C=u=>q(u).includes("(已删除)")?"已删除":"正常",g=u=>C(u)==="已删除"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",D=u=>({GET:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",POST:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",PUT:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300",DELETE:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300",PATCH:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300"})[u]||"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300",W=u=>u>=200&&u<300?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":u>=300&&u<400?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":u>=400&&u<500?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":u>=500?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300":"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300",K=u=>u>=200&&u<300?"成功":u>=300&&u<400?"重定向":u>=400&&u<500?"客户端错误":u>=500?"服务器错误":"",I=u=>u?u<1e3?`${u}ms`:`${(u/1e3).toFixed(2)}s`:"N/A",G=u=>u?u<1e3?"text-green-600 dark:text-green-400":u<3e3?"text-yellow-600 dark:text-yellow-400":u<5e3?"text-orange-600 dark:text-orange-400":"text-red-600 dark:text-red-400":"text-gray-500",F=u=>u?u<1e3?"快速":u<3e3?"正常":u<5e3?"较慢":"很慢":"N/A",v=u=>u?u<1e3?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":u<3e3?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":u<5e3?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300",n=()=>{const u=w.log.tokenDetails||{},c=u.input_tokens||0,P=u.output_tokens||0,L=u.cache_creation_input_tokens||0,k=u.cache_read_input_tokens||0,R=c+P+L+k,H=c>0?(P/c).toFixed(2):"0.00";return{total:R.toLocaleString(),input:c.toLocaleString(),output:P.toLocaleString(),cacheCreate:L.toLocaleString(),cacheRead:k.toLocaleString(),efficiency:H}},l=()=>{const u=w.log.costDetails||{},c=(u.totalCost||0).toFixed(6),P=n(),L=parseInt(P.total.replace(/,/g,""))||0,k=L>0?(u.totalCost/L).toFixed(8):"0.00000000";return{total:c,perToken:k,currency:u.currency||"USD"}},f=()=>{const u=w.log,P=["timestamp","keyId","method","path","status"].reduce((z,X)=>z+(u[X]?20:0),0),k=!!(u.tokenDetails&&Object.keys(u.tokenDetails).length>0)?100:0,H=!!(u.costDetails&&u.costDetails.totalCost)?100:0,M=!!(u.requestHeaders||u.responseHeaders)?100:0;return{basic:Math.min(P,100),tokens:k,costs:H,headers:M}},y=()=>{const u=f();return Math.round((u.basic+u.tokens+u.costs+u.headers)/4)},o=()=>{const u=y();return u>=80?"bg-green-500":u>=60?"bg-yellow-500":u>=40?"bg-orange-500":"bg-red-500"},T=()=>{const u=y();return u>=80?"text-green-600 dark:text-green-400":u>=60?"text-yellow-600 dark:text-yellow-400":u>=40?"text-orange-600 dark:text-orange-400":"text-red-600 dark:text-red-400"},V=()=>new Date().toLocaleTimeString("zh-CN");return(u,c)=>{var P;return d(),i("div",Le,[t("div",Ne,[t("div",Oe,[c[4]||(c[4]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-info-circle mr-2 text-blue-500"}),b(" 基本信息 ")],-1)),t("div",Ae,[t("div",Ie,[t("div",null,[c[0]||(c[0]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求时间 ",-1)),t("div",Re,a(S(x.log.timestamp)),1),t("div",He,a(B(x.log.timestamp)),1)]),t("div",null,[c[1]||(c[1]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求ID ",-1)),t("div",Ke,a(j(x.log)),1)])]),t("div",Pe,[t("div",null,[c[2]||(c[2]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," API Key ",-1)),t("div",Me,[t("span",Ee,a(q(x.log)),1),C(x.log)?(d(),i("span",{key:0,class:_(["rounded-full px-2 py-1 text-xs",g(x.log)])},a(C(x.log)),3)):$("",!0)])]),t("div",null,[c[3]||(c[3]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 使用模型 ",-1)),t("div",Fe,a(x.log.model||"N/A"),1)])])])]),t("div",Ue,[c[10]||(c[10]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-network-wired mr-2 text-green-500"}),b(" 请求详情 ")],-1)),t("div",Ve,[t("div",ze,[t("div",null,[c[5]||(c[5]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求方法 ",-1)),t("span",{class:_(["inline-block rounded px-2 py-1 text-xs font-medium",D(x.log.method)])},a(x.log.method||"N/A"),3)]),t("div",null,[c[6]||(c[6]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 状态码 ",-1)),t("div",Je,[t("span",{class:_(["inline-block rounded px-2 py-1 text-xs font-medium",W(x.log.status)])},a(x.log.status||"N/A"),3),t("span",We,a(K(x.log.status)),1)])])]),t("div",null,[c[7]||(c[7]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求路径 ",-1)),t("div",Ge,a(x.log.path||"/"),1)]),t("div",Qe,[t("div",null,[c[8]||(c[8]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 响应时间 ",-1)),t("div",Ye,[t("span",{class:_(["text-lg font-semibold",G(x.log.responseTime)])},a(I(x.log.responseTime)),3),t("span",{class:_(["rounded-full px-2 py-1 text-xs",v(x.log.responseTime)])},a(F(x.log.responseTime)),3)])]),t("div",null,[c[9]||(c[9]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 客户端IP ",-1)),t("div",Ze,a(((P=x.log.request)==null?void 0:P.ip)||x.log.clientIP||"N/A"),1)])])])])]),t("div",Xe,[t("div",ts,[c[17]||(c[17]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold"},[t("i",{class:"fas fa-coins mr-2"}),b(" Token使用概览 ")],-1)),t("div",es,[t("div",null,[t("div",ss,a(n().total),1),c[11]||(c[11]=t("div",{class:"text-sm opacity-90"},"总Token数",-1))]),t("div",null,[t("div",as,a(n().efficiency),1),c[12]||(c[12]=t("div",{class:"text-sm opacity-90"},"使用效率",-1))])]),t("div",rs,[t("div",os,[t("div",ns,a(n().input),1),c[13]||(c[13]=t("div",{class:"opacity-75"},"输入",-1))]),t("div",ls,[t("div",ds,a(n().output),1),c[14]||(c[14]=t("div",{class:"opacity-75"},"输出",-1))]),t("div",is,[t("div",us,a(n().cacheCreate),1),c[15]||(c[15]=t("div",{class:"opacity-75"},"缓存创建",-1))]),t("div",cs,[t("div",xs,a(n().cacheRead),1),c[16]||(c[16]=t("div",{class:"opacity-75"},"缓存读取",-1))])])]),t("div",gs,[c[21]||(c[21]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-dollar-sign mr-2 text-green-500"}),b(" 费用信息 ")],-1)),t("div",ys,[t("div",ms,[t("div",fs," $"+a(l().total),1),c[18]||(c[18]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"总费用",-1))]),t("div",bs,[t("div",ps,[t("div",ks," $"+a(l().perToken),1),c[19]||(c[19]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"每Token费用",-1))]),t("div",vs,[t("div",hs,a(l().currency),1),c[20]||(c[20]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"货币单位",-1))])])])])]),t("div",$s,[c[33]||(c[33]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-pie mr-2 text-purple-500"}),b(" 数据完整性分析 ")],-1)),t("div",_s,[t("div",null,[c[26]||(c[26]=t("h5",{class:"mb-3 font-medium text-gray-900 dark:text-gray-100"},"数据可用性",-1)),t("div",ws,[t("div",Cs,[c[22]||(c[22]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"基本信息",-1)),t("div",Ds,[t("div",Ts,[t("div",{class:"h-2 rounded-full bg-green-500",style:ut(`width: ${f().basic}%`)},null,4)]),t("span",Ss,a(f().basic)+"%",1)])]),t("div",js,[c[23]||(c[23]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Token详情",-1)),t("div",Bs,[t("div",qs,[t("div",{class:"h-2 rounded-full bg-blue-500",style:ut(`width: ${f().tokens}%`)},null,4)]),t("span",Ls,a(f().tokens)+"%",1)])]),t("div",Ns,[c[24]||(c[24]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"费用信息",-1)),t("div",Os,[t("div",As,[t("div",{class:"h-2 rounded-full bg-purple-500",style:ut(`width: ${f().costs}%`)},null,4)]),t("span",Is,a(f().costs)+"%",1)])]),t("div",Rs,[c[25]||(c[25]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Headers信息",-1)),t("div",Hs,[t("div",Ks,[t("div",{class:"h-2 rounded-full bg-orange-500",style:ut(`width: ${f().headers}%`)},null,4)]),t("span",Ps,a(f().headers)+"%",1)])])])]),t("div",null,[c[31]||(c[31]=t("h5",{class:"mb-3 font-medium text-gray-900 dark:text-gray-100"},"日志元信息",-1)),t("div",Ms,[t("div",Es,[c[27]||(c[27]=t("span",{class:"text-gray-600 dark:text-gray-400"},"日志版本",-1)),t("span",Fs,a(x.log.logVersion||"1.0"),1)]),t("div",Us,[c[28]||(c[28]=t("span",{class:"text-gray-600 dark:text-gray-400"},"数据优化",-1)),t("span",{class:_(x.log.dataOptimized?"text-green-600 dark:text-green-400":"text-gray-500")},a(x.log.dataOptimized?"已优化":"未优化"),3)]),c[30]||(c[30]=t("div",{class:"flex justify-between"},[t("span",{class:"text-gray-600 dark:text-gray-400"},"存储TTL"),t("span",{class:"text-gray-900 dark:text-gray-100"},"7 天")],-1)),t("div",Vs,[c[29]||(c[29]=t("span",{class:"text-gray-600 dark:text-gray-400"},"检索时间",-1)),t("span",zs,a(V()),1)])])])]),t("div",Js,[t("div",Ws,[c[32]||(c[32]=t("span",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"整体完整性评分",-1)),t("div",Gs,[t("div",Qs,[t("div",{class:_(["h-3 rounded-full transition-all duration-500",o()]),style:ut(`width: ${y()}%`)},null,6)]),t("span",{class:_(["text-xl font-bold",T()])},a(y())+"% ",3)])])])])])}}},Zs=gt(Ys,[["__scopeId","data-v-ea7782be"]]),Xs={class:"token-breakdown"},ta={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},ea={class:"stat-card bg-blue-50 dark:bg-blue-900/20"},sa={class:"flex items-center justify-between"},aa={class:"text-2xl font-bold text-blue-900 dark:text-blue-100"},ra={class:"mt-2 text-xs text-blue-600 dark:text-blue-400"},oa={class:"stat-card bg-green-50 dark:bg-green-900/20"},na={class:"flex items-center justify-between"},la={class:"text-2xl font-bold text-green-900 dark:text-green-100"},da={class:"mt-2 text-xs text-green-600 dark:text-green-400"},ia={class:"stat-card bg-purple-50 dark:bg-purple-900/20"},ua={class:"flex items-center justify-between"},ca={class:"text-2xl font-bold text-purple-900 dark:text-purple-100"},xa={class:"mt-2 text-xs text-purple-600 dark:text-purple-400"},ga={class:"stat-card bg-orange-50 dark:bg-orange-900/20"},ya={class:"flex items-center justify-between"},ma={class:"text-2xl font-bold text-orange-900 dark:text-orange-100"},fa={class:"mt-2 text-xs text-orange-600 dark:text-orange-400"},ba={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},pa={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},ka={class:"relative flex h-64 items-center justify-center"},va={key:0,class:"absolute inset-0 flex items-center justify-center"},ha={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},$a={class:"overflow-x-auto"},_a={class:"min-w-full"},wa={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ca={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Da={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Ta={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Sa={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},ja={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Ba={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},qa={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},La={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Na={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Oa={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Aa={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Ia={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Ra={class:"bg-gray-50 dark:bg-gray-700/50"},Ha={class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},Ka={class:"bg-gray-50 dark:bg-gray-700/50"},Pa={class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},Ma={class:"mt-6 grid grid-cols-1 gap-6 lg:grid-cols-2"},Ea={class:"rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white"},Fa={class:"mb-2 text-3xl font-bold"},Ua={class:"text-sm opacity-90"},Va={class:"text-sm opacity-90"},za={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},Ja={class:"space-y-3"},Wa={class:"flex items-center justify-between"},Ga={class:"font-semibold text-gray-900 dark:text-gray-100"},Qa={class:"flex items-center justify-between"},Ya={class:"font-semibold text-gray-900 dark:text-gray-100"},Za={class:"flex items-center justify-between"},Xa={__name:"TokenBreakdown",props:{tokenDetails:{type:Object,default:()=>({})},costDetails:{type:Object,default:()=>({})}},setup(x){const w=x,S=O(null);let B=null;const j=tt(()=>{const v=w.tokenDetails||{};return(v.input_tokens||0)+(v.output_tokens||0)+(v.cache_creation_input_tokens||0)+(v.cache_read_input_tokens||0)>0}),q=()=>{const v=w.tokenDetails||{};return(v.input_tokens||0)+(v.output_tokens||0)+(v.cache_creation_input_tokens||0)+(v.cache_read_input_tokens||0)},C=v=>v>=1e6?(v/1e6).toFixed(1)+"M":v>=1e3?(v/1e3).toFixed(1)+"K":v.toLocaleString(),g=v=>typeof v!="number"||isNaN(v)?"0.000000":v.toFixed(6),D=v=>{const n=q();if(n===0)return"0.0";const l=w.tokenDetails||{};let f=0;switch(v){case"input":f=l.input_tokens||0;break;case"output":f=l.output_tokens||0;break;case"cache_create":f=l.cache_creation_input_tokens||0;break;case"cache_read":f=l.cache_read_input_tokens||0;break}return(f/n*100).toFixed(1)},W=()=>{var l;const v=q(),n=((l=w.costDetails)==null?void 0:l.totalCost)||0;return v===0?0:n/v},K=()=>{const v=w.tokenDetails||{},n=v.cache_read_input_tokens||0,l=(v.input_tokens||0)+(v.cache_creation_input_tokens||0)+n;return l===0?"0.0":(n/l*100).toFixed(1)},I=()=>{const v=w.tokenDetails||{},n=v.input_tokens||0,l=v.output_tokens||0;return n===0?"N/A":(l/n).toFixed(2)},G=()=>{const v=parseFloat(I());return isNaN(v)?"text-gray-500":v>.5?"text-green-600 dark:text-green-400":v>.2?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"},F=()=>{if(!S.value||!j.value)return;const v=w.tokenDetails||{},n={labels:["输入Token","输出Token","缓存创建","缓存读取"],datasets:[{data:[v.input_tokens||0,v.output_tokens||0,v.cache_creation_input_tokens||0,v.cache_read_input_tokens||0],backgroundColor:["#3B82F6","#10B981","#8B5CF6","#F59E0B"],borderWidth:0}]},l={labels:[],datasets:[{data:[],backgroundColor:[],borderWidth:0}]};n.labels.forEach((f,y)=>{n.datasets[0].data[y]>0&&(l.labels.push(f),l.datasets[0].data.push(n.datasets[0].data[y]),l.datasets[0].backgroundColor.push(n.datasets[0].backgroundColor[y]))}),B&&B.destroy(),B=new qe(S.value,{type:"doughnut",data:l,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0}}}}})};return wt(()=>{xe(()=>{j.value&&F()})}),ge(()=>w.tokenDetails,()=>{xe(()=>{j.value&&F()})},{deep:!0}),(v,n)=>{var l,f,y,o,T,V,u,c,P,L,k,R,H,A,M,z,X,et,st;return d(),i("div",Xs,[t("div",ta,[t("div",ea,[t("div",sa,[t("div",null,[n[0]||(n[0]=t("p",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"输入Token",-1)),t("p",aa,a(C(((l=x.tokenDetails)==null?void 0:l.input_tokens)||0)),1)]),n[1]||(n[1]=t("i",{class:"fas fa-sign-in-alt text-2xl text-blue-500"},null,-1))]),t("div",ra," 费用: $"+a(g(((f=x.costDetails)==null?void 0:f.inputCost)||0)),1)]),t("div",oa,[t("div",na,[t("div",null,[n[2]||(n[2]=t("p",{class:"text-sm font-medium text-green-700 dark:text-green-300"},"输出Token",-1)),t("p",la,a(C(((y=x.tokenDetails)==null?void 0:y.output_tokens)||0)),1)]),n[3]||(n[3]=t("i",{class:"fas fa-sign-out-alt text-2xl text-green-500"},null,-1))]),t("div",da," 费用: $"+a(g(((o=x.costDetails)==null?void 0:o.outputCost)||0)),1)]),t("div",ia,[t("div",ua,[t("div",null,[n[4]||(n[4]=t("p",{class:"text-sm font-medium text-purple-700 dark:text-purple-300"},"缓存创建",-1)),t("p",ca,a(C(((T=x.tokenDetails)==null?void 0:T.cache_creation_input_tokens)||0)),1)]),n[5]||(n[5]=t("i",{class:"fas fa-save text-2xl text-purple-500"},null,-1))]),t("div",xa," 费用: $"+a(g(((V=x.costDetails)==null?void 0:V.cacheCreateCost)||0)),1)]),t("div",ga,[t("div",ya,[t("div",null,[n[6]||(n[6]=t("p",{class:"text-sm font-medium text-orange-700 dark:text-orange-300"},"缓存读取",-1)),t("p",ma,a(C(((u=x.tokenDetails)==null?void 0:u.cache_read_input_tokens)||0)),1)]),n[7]||(n[7]=t("i",{class:"fas fa-download text-2xl text-orange-500"},null,-1))]),t("div",fa," 费用: $"+a(g(((c=x.costDetails)==null?void 0:c.cacheReadCost)||0)),1)])]),t("div",ba,[t("div",pa,[n[9]||(n[9]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-pie mr-2"}),b(" Token分布 ")],-1)),t("div",ka,[t("canvas",{ref_key:"tokenChart",ref:S,class:"max-h-full max-w-full"},null,512),j.value?$("",!0):(d(),i("div",va,[...n[8]||(n[8]=[t("div",{class:"text-center text-gray-400 dark:text-gray-600"},[t("i",{class:"fas fa-chart-pie mb-2 text-4xl"}),t("p",null,"暂无Token使用数据")],-1)])]))])]),t("div",ha,[n[21]||(n[21]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-table mr-2"}),b(" 详细统计 ")],-1)),t("div",$a,[t("table",_a,[n[20]||(n[20]=t("thead",null,[t("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[t("th",{class:"py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-300"}," 类型 "),t("th",{class:"py-2 text-right text-sm font-medium text-gray-700 dark:text-gray-300"}," Token数 "),t("th",{class:"py-2 text-right text-sm font-medium text-gray-700 dark:text-gray-300"}," 费用 "),t("th",{class:"py-2 text-right text-sm font-medium text-gray-700 dark:text-gray-300"}," 占比 ")])],-1)),t("tbody",wa,[t("tr",null,[n[10]||(n[10]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"输入Token",-1)),t("td",Ca,a(C(((P=x.tokenDetails)==null?void 0:P.input_tokens)||0)),1),t("td",Da," $"+a(g(((L=x.costDetails)==null?void 0:L.inputCost)||0)),1),t("td",Ta,a(D("input"))+"% ",1)]),t("tr",null,[n[11]||(n[11]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"输出Token",-1)),t("td",Sa,a(C(((k=x.tokenDetails)==null?void 0:k.output_tokens)||0)),1),t("td",ja," $"+a(g(((R=x.costDetails)==null?void 0:R.outputCost)||0)),1),t("td",Ba,a(D("output"))+"% ",1)]),t("tr",null,[n[12]||(n[12]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"缓存创建",-1)),t("td",qa,a(C(((H=x.tokenDetails)==null?void 0:H.cache_creation_input_tokens)||0)),1),t("td",La," $"+a(g(((A=x.costDetails)==null?void 0:A.cacheCreateCost)||0)),1),t("td",Na,a(D("cache_create"))+"% ",1)]),t("tr",null,[n[13]||(n[13]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"缓存读取",-1)),t("td",Oa,a(C(((M=x.tokenDetails)==null?void 0:M.cache_read_input_tokens)||0)),1),t("td",Aa," $"+a(g(((z=x.costDetails)==null?void 0:z.cacheReadCost)||0)),1),t("td",Ia,a(D("cache_read"))+"% ",1)]),(X=x.tokenDetails)!=null&&X.cache_breakdown?(d(),i(ot,{key:0},[t("tr",Ra,[n[14]||(n[14]=t("td",{class:"py-2 pl-4 text-sm text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-clock mr-1"}),b(" 5分钟缓存 ")],-1)),t("td",Ha,a(C(x.tokenDetails.cache_breakdown.ephemeral_5m_input_tokens||0)),1),n[15]||(n[15]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1)),n[16]||(n[16]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1))]),t("tr",Ka,[n[17]||(n[17]=t("td",{class:"py-2 pl-4 text-sm text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-hourglass-half mr-1"}),b(" 1小时缓存 ")],-1)),t("td",Pa,a(C(x.tokenDetails.cache_breakdown.ephemeral_1h_input_tokens||0)),1),n[18]||(n[18]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1)),n[19]||(n[19]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1))])],64)):$("",!0)])])])])]),t("div",Ma,[t("div",Ea,[n[22]||(n[22]=t("h4",{class:"mb-4 text-lg font-semibold"},[t("i",{class:"fas fa-dollar-sign mr-2"}),b(" 费用总计 ")],-1)),t("div",Fa,"$"+a(g(((et=x.costDetails)==null?void 0:et.totalCost)||0)),1),t("div",Ua," 平均每Token: $"+a(g(W())),1),t("div",Va,"货币: "+a(((st=x.costDetails)==null?void 0:st.currency)||"USD"),1)]),t("div",za,[n[26]||(n[26]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-line mr-2"}),b(" 效率分析 ")],-1)),t("div",Ja,[t("div",Wa,[n[23]||(n[23]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"总Token数",-1)),t("span",Ga,a(C(q())),1)]),t("div",Qa,[n[24]||(n[24]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"缓存命中率",-1)),t("span",Ya,a(K())+"% ",1)]),t("div",Za,[n[25]||(n[25]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"Token效率",-1)),t("span",{class:_(["font-semibold",G()])},a(I()),3)])])])])])}}},tr=gt(Xa,[["__scopeId","data-v-8814da88"]]),er={class:"headers-viewer"},sr={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-3"},ar={class:"stat-card bg-blue-50 dark:bg-blue-900/20"},rr={class:"flex items-center justify-between"},or={class:"text-2xl font-bold text-blue-900 dark:text-blue-100"},nr={class:"stat-card bg-green-50 dark:bg-green-900/20"},lr={class:"flex items-center justify-between"},dr={class:"text-2xl font-bold text-green-900 dark:text-green-100"},ir={class:"stat-card bg-purple-50 dark:bg-purple-900/20"},ur={class:"flex items-center justify-between"},cr={class:"text-2xl font-bold text-purple-900 dark:text-purple-100"},xr={class:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},gr={class:"max-w-md flex-1"},yr={class:"relative"},mr={class:"flex items-center gap-2"},fr={class:"space-y-6"},br={key:0,class:"rounded-lg bg-white shadow dark:bg-gray-800"},pr={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},kr={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},vr={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},hr={class:"p-6"},$r={key:0,class:"py-8 text-center"},_r={class:"text-gray-500 dark:text-gray-400"},wr={key:1,class:"space-y-3"},Cr={class:"flex items-start justify-between rounded-lg bg-gray-50 px-4 py-3 transition-colors duration-200 hover:bg-gray-100 dark:bg-gray-700/50 dark:hover:bg-gray-700"},Dr={class:"min-w-0 flex-1"},Tr={class:"mb-1 flex items-center gap-2"},Sr={class:"font-medium text-gray-900 dark:text-gray-100"},jr={class:"break-all text-sm text-gray-600 dark:text-gray-400"},Br=["title","onClick"],qr={key:1,class:"rounded-lg bg-white shadow dark:bg-gray-800"},Lr={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},Nr={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},Or={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},Ar={class:"p-6"},Ir={key:0,class:"py-8 text-center"},Rr={class:"text-gray-500 dark:text-gray-400"},Hr={key:1,class:"space-y-3"},Kr={class:"flex items-start justify-between rounded-lg bg-gray-50 px-4 py-3 transition-colors duration-200 hover:bg-gray-100 dark:bg-gray-700/50 dark:hover:bg-gray-700"},Pr={class:"min-w-0 flex-1"},Mr={class:"mb-1 flex items-center gap-2"},Er={class:"font-medium text-gray-900 dark:text-gray-100"},Fr={class:"break-all text-sm text-gray-600 dark:text-gray-400"},Ur=["title","onClick"],Vr={key:0,class:"mt-6"},zr={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},Jr={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Wr={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},Gr={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},Qr={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},Yr={class:"text-2xl font-bold text-green-600 dark:text-green-400"},Zr={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},Xr={class:"text-2xl font-bold text-purple-600 dark:text-purple-400"},to={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},eo={class:"text-2xl font-bold text-orange-600 dark:text-orange-400"},so={__name:"HeadersViewer",props:{requestHeaders:{type:Object,default:()=>({})},responseHeaders:{type:Object,default:()=>({})}},setup(x){const w=x,S=O(""),B=O(!0),j=O(!0),q=tt(()=>Object.keys(w.requestHeaders||{}).length>0||Object.keys(w.responseHeaders||{}).length>0),C=tt(()=>{let n=0;return Object.entries(w.requestHeaders||{}).forEach(([l,f])=>{n+=l.length+String(f).length}),Object.entries(w.responseHeaders||{}).forEach(([l,f])=>{n+=l.length+String(f).length}),n}),g=tt(()=>{const n=w.requestHeaders||{},l=Object.entries(n);if(!S.value)return l;const f=S.value.toLowerCase();return l.filter(([y,o])=>y.toLowerCase().includes(f)||String(o).toLowerCase().includes(f))}),D=tt(()=>{const n=w.responseHeaders||{},l=Object.entries(n);if(!S.value)return l;const f=S.value.toLowerCase();return l.filter(([y,o])=>y.toLowerCase().includes(f)||String(o).toLowerCase().includes(f))}),W=n=>{if(n===0)return"0 B";const l=1024,f=["B","KB","MB","GB"],y=Math.floor(Math.log(n)/Math.log(l));return parseFloat((n/Math.pow(l,y)).toFixed(2))+" "+f[y]},K=n=>typeof n!="string"?String(n):n.length>100?n.substring(0,97)+"...":n,I=n=>{const l=n.toLowerCase();return["authorization","cookie","set-cookie","x-csrf-token","x-frame-options","x-content-type-options"].includes(l)?"安全":["cache-control","expires","etag","if-none-match","if-modified-since","last-modified"].includes(l)?"缓存":["content-type","content-length","content-encoding","accept","accept-encoding","accept-language"].includes(l)?"内容":l.startsWith("x-")||l.startsWith("anthropic-")?"自定义":"标准"},G=n=>{const l=I(n),f={安全:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300",缓存:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",内容:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",自定义:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",标准:"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300"};return f[l]||f.标准},F=n=>{const l={...w.requestHeaders,...w.responseHeaders};let f=0;return Object.keys(l).forEach(y=>{const o=I(y);(n==="security"&&o==="安全"||n==="cache"&&o==="缓存"||n==="content"&&o==="内容"||n==="custom"&&o==="自定义")&&f++}),f},v=async n=>{try{await navigator.clipboard.writeText(n),console.log("已复制到剪贴板")}catch(l){console.error("复制失败:",l)}};return(n,l)=>(d(),i("div",er,[t("div",sr,[t("div",ar,[t("div",rr,[t("div",null,[l[3]||(l[3]=t("p",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"请求头数量",-1)),t("p",or,a(Object.keys(x.requestHeaders||{}).length),1)]),l[4]||(l[4]=t("i",{class:"fas fa-arrow-up text-2xl text-blue-500"},null,-1))])]),t("div",nr,[t("div",lr,[t("div",null,[l[5]||(l[5]=t("p",{class:"text-sm font-medium text-green-700 dark:text-green-300"},"响应头数量",-1)),t("p",dr,a(Object.keys(x.responseHeaders||{}).length),1)]),l[6]||(l[6]=t("i",{class:"fas fa-arrow-down text-2xl text-green-500"},null,-1))])]),t("div",ir,[t("div",ur,[t("div",null,[l[7]||(l[7]=t("p",{class:"text-sm font-medium text-purple-700 dark:text-purple-300"},"总大小",-1)),t("p",cr,a(W(C.value)),1)]),l[8]||(l[8]=t("i",{class:"fas fa-weight-hanging text-2xl text-purple-500"},null,-1))])])]),t("div",xr,[t("div",gr,[t("div",yr,[Z(t("input",{"onUpdate:modelValue":l[0]||(l[0]=f=>S.value=f),class:"w-full rounded-lg border border-gray-300 bg-white py-2 pl-10 pr-4 text-gray-900 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",placeholder:"搜索请求头或响应头...",type:"text"},null,512),[[xt,S.value]]),l[9]||(l[9]=t("i",{class:"fas fa-search absolute left-3 top-3 text-gray-400"},null,-1))])]),t("div",mr,[t("button",{class:_(["rounded-lg px-3 py-2 text-sm font-medium transition-colors",B.value?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:l[1]||(l[1]=f=>B.value=!B.value)},[...l[10]||(l[10]=[t("i",{class:"fas fa-arrow-up mr-1"},null,-1),b(" 请求头 ",-1)])],2),t("button",{class:_(["rounded-lg px-3 py-2 text-sm font-medium transition-colors",j.value?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:l[2]||(l[2]=f=>j.value=!j.value)},[...l[11]||(l[11]=[t("i",{class:"fas fa-arrow-down mr-1"},null,-1),b(" 响应头 ",-1)])],2)])]),t("div",fr,[B.value?(d(),i("div",br,[t("div",pr,[t("h4",kr,[l[12]||(l[12]=t("i",{class:"fas fa-arrow-up mr-2 text-blue-500"},null,-1)),l[13]||(l[13]=b(" 请求头 ",-1)),t("span",vr," ("+a(g.value.length)+" 个) ",1)])]),t("div",hr,[g.value.length===0?(d(),i("div",$r,[l[14]||(l[14]=t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1)),t("p",_r,a(S.value?"没有找到匹配的请求头":"暂无请求头信息"),1)])):(d(),i("div",wr,[(d(!0),i(ot,null,lt(g.value,([f,y])=>(d(),i("div",{key:`req-${f}`,class:"header-item group"},[t("div",Cr,[t("div",Dr,[t("div",Tr,[t("span",Sr,a(f),1),t("span",{class:_(["rounded-full px-2 py-1 text-xs",G(f)])},a(I(f)),3)]),t("div",jr,a(K(y)),1)]),t("button",{class:"ml-3 p-2 text-gray-400 opacity-0 transition-all duration-200 hover:text-gray-600 group-hover:opacity-100 dark:hover:text-gray-300",title:`复制 ${f}`,onClick:o=>v(`${f}: ${y}`)},[...l[15]||(l[15]=[t("i",{class:"fas fa-copy text-sm"},null,-1)])],8,Br)])]))),128))]))])])):$("",!0),j.value?(d(),i("div",qr,[t("div",Lr,[t("h4",Nr,[l[16]||(l[16]=t("i",{class:"fas fa-arrow-down mr-2 text-green-500"},null,-1)),l[17]||(l[17]=b(" 响应头 ",-1)),t("span",Or," ("+a(D.value.length)+" 个) ",1)])]),t("div",Ar,[D.value.length===0?(d(),i("div",Ir,[l[18]||(l[18]=t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1)),t("p",Rr,a(S.value?"没有找到匹配的响应头":"暂无响应头信息"),1)])):(d(),i("div",Hr,[(d(!0),i(ot,null,lt(D.value,([f,y])=>(d(),i("div",{key:`res-${f}`,class:"header-item group"},[t("div",Kr,[t("div",Pr,[t("div",Mr,[t("span",Er,a(f),1),t("span",{class:_(["rounded-full px-2 py-1 text-xs",G(f)])},a(I(f)),3)]),t("div",Fr,a(K(y)),1)]),t("button",{class:"ml-3 p-2 text-gray-400 opacity-0 transition-all duration-200 hover:text-gray-600 group-hover:opacity-100 dark:hover:text-gray-300",title:`复制 ${f}`,onClick:o=>v(`${f}: ${y}`)},[...l[19]||(l[19]=[t("i",{class:"fas fa-copy text-sm"},null,-1)])],8,Ur)])]))),128))]))])])):$("",!0)]),q.value?(d(),i("div",Vr,[t("div",zr,[l[24]||(l[24]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-bar mr-2"}),b(" Header分析 ")],-1)),t("div",Jr,[t("div",Wr,[t("div",Gr,a(F("security")),1),l[20]||(l[20]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"安全相关",-1))]),t("div",Qr,[t("div",Yr,a(F("cache")),1),l[21]||(l[21]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"缓存控制",-1))]),t("div",Zr,[t("div",Xr,a(F("content")),1),l[22]||(l[22]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"内容类型",-1))]),t("div",to,[t("div",eo,a(F("custom")),1),l[23]||(l[23]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"自定义头",-1))])])])])):$("",!0)]))}},ao=gt(so,[["__scopeId","data-v-8e3597c3"]]),ro={class:"message-content"},oo={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},no={class:"stat-card bg-blue-50 dark:bg-blue-900/20"},lo={class:"flex items-center justify-between"},io={class:"text-2xl font-bold text-blue-900 dark:text-blue-100"},uo={class:"stat-card bg-green-50 dark:bg-green-900/20"},co={class:"flex items-center justify-between"},xo={class:"text-2xl font-bold text-green-900 dark:text-green-100"},go={class:"stat-card bg-purple-50 dark:bg-purple-900/20"},yo={class:"flex items-center justify-between"},mo={class:"text-2xl font-bold text-purple-900 dark:text-purple-100"},fo={class:"stat-card bg-orange-50 dark:bg-orange-900/20"},bo={class:"flex items-center justify-between"},po={class:"text-lg font-bold text-orange-900 dark:text-orange-100"},ko={class:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},vo={class:"flex items-center gap-2"},ho={class:"flex items-center gap-2"},$o={class:"relative"},_o={class:"space-y-6"},wo={key:0,class:"rounded-lg bg-white shadow dark:bg-gray-800"},Co={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},Do={class:"flex items-center justify-between"},To={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},So={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},jo={class:"flex items-center gap-2"},Bo={class:"p-6"},qo={key:0,class:"py-12 text-center"},Lo={key:1,class:"relative"},No={class:"content-container"},Oo={key:0,class:"content-block raw-content"},Ao=["innerHTML"],Io={key:2,class:"content-block pretty-content"},Ro={class:"mt-4 flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400"},Ho={key:0},Ko={key:1,class:"rounded-lg bg-white shadow dark:bg-gray-800"},Po={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},Mo={class:"flex items-center justify-between"},Eo={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},Fo={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},Uo={class:"flex items-center gap-2"},Vo={class:"p-6"},zo={key:0,class:"py-12 text-center"},Jo={key:1,class:"relative"},Wo={class:"content-container"},Go={key:0,class:"content-block raw-content"},Qo=["innerHTML"],Yo={key:2,class:"content-block pretty-content"},Zo={class:"mt-4 flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400"},Xo={key:0},tn={key:0,class:"mt-6"},en={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},sn={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},an={class:"rounded-lg bg-blue-50 p-4 dark:bg-blue-900/20"},rn={class:"space-y-1 text-sm text-blue-800 dark:text-blue-200"},on={class:"rounded-lg bg-green-50 p-4 dark:bg-green-900/20"},nn={class:"space-y-1 text-sm text-green-800 dark:text-green-200"},ln={__name:"MessageContent",props:{requestBody:{type:[String,Object],default:null},responseBody:{type:[String,Object],default:null}},setup(x){const w=x,S=O("request"),B=O("formatted"),j=O(""),q=y=>{if(y===0)return"0 B";const o=1024,T=["B","KB","MB","GB"],V=Math.floor(Math.log(y)/Math.log(o));return parseFloat((y/Math.pow(o,V)).toFixed(2))+" "+T[V]},C=y=>y?typeof y=="string"?y.length:JSON.stringify(y).length:0,g=y=>y?typeof y=="string"?y:JSON.stringify(y,null,2):"",D=y=>{if(!y)return"";try{if(typeof y=="string"){const o=JSON.parse(y);return JSON.stringify(o,null,2)}return JSON.stringify(y,null,2)}catch{return g(y)}},W=(y,o=!1)=>{if(!y)return"";let T=g(y);return o&&K(y)&&(T=T.replace(/(".*?")/g,'<span class="json-string">$1</span>').replace(/(\b\d+\b)/g,'<span class="json-number">$1</span>').replace(/(\btrue\b|\bfalse\b|\bnull\b)/g,'<span class="json-boolean">$1</span>').replace(/([{}[\],])/g,'<span class="json-key">$1</span>')),`<pre class="whitespace-pre-wrap"><code>${T}</code></pre>`},K=y=>{if(typeof y=="object")return!0;if(typeof y=="string")try{return JSON.parse(y),!0}catch{return!1}return!1},I=y=>g(y).split(`
`).length,G=y=>g(y).length,F=()=>{let y=0;if(w.requestBody)try{const o=typeof w.requestBody=="string"?JSON.parse(w.requestBody):w.requestBody;o.messages&&Array.isArray(o.messages)&&(y+=o.messages.length)}catch{}return y||"—"},v=()=>{const y=K(w.requestBody),o=K(w.responseBody);return y&&o?"JSON":y||o?"Mixed":w.requestBody||w.responseBody?"Text":"—"},n=y=>{if(!j.value||!y)return y;const o=j.value,T=new RegExp(`(${o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return y.replace(T,'<mark class="bg-yellow-200 dark:bg-yellow-800">$1</mark>')},l=async y=>{try{await navigator.clipboard.writeText(y),console.log("已复制到剪贴板")}catch(o){console.error("复制失败:",o)}},f=(y,o)=>{const T=new Blob([y],{type:"application/json"}),V=URL.createObjectURL(T),u=document.createElement("a");u.href=V,u.download=o,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(V)};return(y,o)=>(d(),i("div",ro,[t("div",oo,[t("div",no,[t("div",lo,[t("div",null,[o[8]||(o[8]=t("p",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"请求体大小",-1)),t("p",io,a(q(C(x.requestBody))),1)]),o[9]||(o[9]=t("i",{class:"fas fa-upload text-2xl text-blue-500"},null,-1))])]),t("div",uo,[t("div",co,[t("div",null,[o[10]||(o[10]=t("p",{class:"text-sm font-medium text-green-700 dark:text-green-300"},"响应体大小",-1)),t("p",xo,a(q(C(x.responseBody))),1)]),o[11]||(o[11]=t("i",{class:"fas fa-download text-2xl text-green-500"},null,-1))])]),t("div",go,[t("div",yo,[t("div",null,[o[12]||(o[12]=t("p",{class:"text-sm font-medium text-purple-700 dark:text-purple-300"},"消息数量",-1)),t("p",mo,a(F()),1)]),o[13]||(o[13]=t("i",{class:"fas fa-comments text-2xl text-purple-500"},null,-1))])]),t("div",fo,[t("div",bo,[t("div",null,[o[14]||(o[14]=t("p",{class:"text-sm font-medium text-orange-700 dark:text-orange-300"},"数据格式",-1)),t("p",po,a(v()),1)]),o[15]||(o[15]=t("i",{class:"fas fa-file-code text-2xl text-orange-500"},null,-1))])])]),t("div",ko,[t("div",vo,[t("button",{class:_(["rounded-lg px-4 py-2 text-sm font-medium transition-colors",S.value==="request"?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:o[0]||(o[0]=T=>S.value="request")},[...o[16]||(o[16]=[t("i",{class:"fas fa-upload mr-1"},null,-1),b(" 请求内容 ",-1)])],2),t("button",{class:_(["rounded-lg px-4 py-2 text-sm font-medium transition-colors",S.value==="response"?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:o[1]||(o[1]=T=>S.value="response")},[...o[17]||(o[17]=[t("i",{class:"fas fa-download mr-1"},null,-1),b(" 响应内容 ",-1)])],2)]),t("div",ho,[t("div",$o,[Z(t("input",{"onUpdate:modelValue":o[2]||(o[2]=T=>j.value=T),class:"rounded-lg border border-gray-300 bg-white py-2 pl-8 pr-4 text-sm text-gray-900 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",placeholder:"搜索内容...",type:"text"},null,512),[[xt,j.value]]),o[18]||(o[18]=t("i",{class:"fas fa-search absolute left-2.5 top-2.5 text-sm text-gray-400"},null,-1))]),Z(t("select",{"onUpdate:modelValue":o[3]||(o[3]=T=>B.value=T),class:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100"},[...o[19]||(o[19]=[t("option",{value:"formatted"},"格式化",-1),t("option",{value:"raw"},"原始",-1),t("option",{value:"pretty"},"美化",-1)])],512),[[ct,B.value]])])]),t("div",_o,[S.value==="request"?(d(),i("div",wo,[t("div",Co,[t("div",Do,[t("h4",To,[o[20]||(o[20]=t("i",{class:"fas fa-upload mr-2 text-blue-500"},null,-1)),o[21]||(o[21]=b(" 请求内容 ",-1)),t("span",So,a(C(x.requestBody)>0?q(C(x.requestBody)):"无内容"),1)]),t("div",jo,[x.requestBody?(d(),i("button",{key:0,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"复制内容",onClick:o[4]||(o[4]=T=>l(g(x.requestBody)))},[...o[22]||(o[22]=[t("i",{class:"fas fa-copy"},null,-1)])])):$("",!0),x.requestBody?(d(),i("button",{key:1,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"下载内容",onClick:o[5]||(o[5]=T=>f(g(x.requestBody),"request.json"))},[...o[23]||(o[23]=[t("i",{class:"fas fa-download"},null,-1)])])):$("",!0)])])]),t("div",Bo,[x.requestBody?(d(),i("div",Lo,[t("div",No,[B.value==="raw"?(d(),i("pre",Oo,[t("code",null,a(n(g(x.requestBody))),1)])):B.value==="formatted"?(d(),i("div",{key:1,class:"content-block formatted-content",innerHTML:W(x.requestBody,!0)},null,8,Ao)):(d(),i("pre",Io,[t("code",null,a(n(D(x.requestBody))),1)]))]),t("div",Ro,[t("span",null,[o[25]||(o[25]=t("i",{class:"fas fa-align-left mr-1"},null,-1)),b(a(I(x.requestBody))+" 行",1)]),t("span",null,[o[26]||(o[26]=t("i",{class:"fas fa-font mr-1"},null,-1)),b(a(G(x.requestBody))+" 字符",1)]),K(x.requestBody)?(d(),i("span",Ho,[...o[27]||(o[27]=[t("i",{class:"fas fa-code mr-1"},null,-1),b("JSON 格式 ",-1)])])):$("",!0)])])):(d(),i("div",qo,[...o[24]||(o[24]=[t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1),t("p",{class:"text-gray-500 dark:text-gray-400"},"暂无请求内容",-1)])]))])])):$("",!0),S.value==="response"?(d(),i("div",Ko,[t("div",Po,[t("div",Mo,[t("h4",Eo,[o[28]||(o[28]=t("i",{class:"fas fa-download mr-2 text-green-500"},null,-1)),o[29]||(o[29]=b(" 响应内容 ",-1)),t("span",Fo,a(C(x.responseBody)>0?q(C(x.responseBody)):"无内容"),1)]),t("div",Uo,[x.responseBody?(d(),i("button",{key:0,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"复制内容",onClick:o[6]||(o[6]=T=>l(g(x.responseBody)))},[...o[30]||(o[30]=[t("i",{class:"fas fa-copy"},null,-1)])])):$("",!0),x.responseBody?(d(),i("button",{key:1,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"下载内容",onClick:o[7]||(o[7]=T=>f(g(x.responseBody),"response.json"))},[...o[31]||(o[31]=[t("i",{class:"fas fa-download"},null,-1)])])):$("",!0)])])]),t("div",Vo,[x.responseBody?(d(),i("div",Jo,[t("div",Wo,[B.value==="raw"?(d(),i("pre",Go,[t("code",null,a(n(g(x.responseBody))),1)])):B.value==="formatted"?(d(),i("div",{key:1,class:"content-block formatted-content",innerHTML:W(x.responseBody,!0)},null,8,Qo)):(d(),i("pre",Yo,[t("code",null,a(n(D(x.responseBody))),1)]))]),t("div",Zo,[t("span",null,[o[33]||(o[33]=t("i",{class:"fas fa-align-left mr-1"},null,-1)),b(a(I(x.responseBody))+" 行",1)]),t("span",null,[o[34]||(o[34]=t("i",{class:"fas fa-font mr-1"},null,-1)),b(a(G(x.responseBody))+" 字符",1)]),K(x.responseBody)?(d(),i("span",Xo,[...o[35]||(o[35]=[t("i",{class:"fas fa-code mr-1"},null,-1),b("JSON 格式 ",-1)])])):$("",!0)])])):(d(),i("div",zo,[...o[32]||(o[32]=[t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1),t("p",{class:"text-gray-500 dark:text-gray-400"},"暂无响应内容",-1)])]))])])):$("",!0)]),x.requestBody&&x.responseBody?(d(),i("div",tn,[t("div",en,[o[38]||(o[38]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-balance-scale mr-2"}),b(" 内容对比 ")],-1)),t("div",sn,[t("div",an,[o[36]||(o[36]=t("h5",{class:"mb-2 font-medium text-blue-900 dark:text-blue-100"},"请求摘要",-1)),t("div",rn,[t("div",null,"大小: "+a(q(C(x.requestBody))),1),t("div",null,"行数: "+a(I(x.requestBody)),1),t("div",null,"格式: "+a(K(x.requestBody)?"JSON":"文本"),1)])]),t("div",on,[o[37]||(o[37]=t("h5",{class:"mb-2 font-medium text-green-900 dark:text-green-100"},"响应摘要",-1)),t("div",nn,[t("div",null,"大小: "+a(q(C(x.responseBody))),1),t("div",null,"行数: "+a(I(x.responseBody)),1),t("div",null,"格式: "+a(K(x.responseBody)?"JSON":"文本"),1)])])])])])):$("",!0)]))}},dn=gt(ln,[["__scopeId","data-v-847c2f90"]]),un={class:"request-logs-container"},cn={class:"mb-6 flex items-center justify-between"},xn={key:0,class:"mt-2 flex items-center text-sm text-red-600 dark:text-red-400"},gn={class:"flex items-center space-x-3"},yn=["aria-label","disabled"],mn={class:"relative"},fn=["aria-label","disabled"],bn={key:0,"aria-label":"导出格式选择",class:"absolute right-0 top-full z-50 mt-2 w-48 rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5 dark:bg-gray-800",role:"menu"},pn={class:"py-1"},kn={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},vn={class:"stat-card"},hn={class:"flex items-center justify-between"},$n={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},_n={class:"stat-card"},wn={class:"flex items-center justify-between"},Cn={class:"text-2xl font-bold text-red-600 dark:text-red-400"},Dn={class:"stat-card"},Tn={class:"flex items-center justify-between"},Sn={class:"text-2xl font-bold text-green-600 dark:text-green-400"},jn={class:"stat-card"},Bn={class:"flex items-center justify-between"},qn={class:"text-2xl font-bold text-purple-600 dark:text-purple-400"},Ln={class:"card mb-6 p-4"},Nn={class:"mb-4 flex items-center justify-between"},On={class:"flex items-center space-x-2"},An=["aria-label"],In={class:"relative"},Rn={class:"relative"},Hn=["aria-describedby"],Kn={class:"absolute right-2 top-1/2 -translate-y-1/2"},Pn={key:0,class:"loading-spinner h-4 w-4"},Mn={key:2,class:"fas fa-search text-sm text-gray-400"},En={key:0,id:"search-results-info",class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Fn={key:0},Un={key:1},Vn={class:"relative"},zn=["disabled"],Jn=["value"],Wn={key:0,class:"absolute right-3 top-1/2 -translate-y-1/2"},Gn={key:0,class:"mt-1 text-xs text-red-600 dark:text-red-400"},Qn={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Yn={key:0,class:"mt-4"},Zn={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Xn={key:0,class:"mt-2 text-sm text-red-600 dark:text-red-400"},tl={key:1,class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},el={key:0,class:"card mb-6 p-6"},sl={class:"text-center"},al={class:"mb-4 text-sm text-gray-600 dark:text-gray-400"},rl={class:"flex flex-col items-center space-y-2 sm:flex-row sm:justify-center sm:space-x-4 sm:space-y-0"},ol={key:1,class:"card"},nl={class:"flex flex-col space-y-3 border-b border-gray-200 p-4 dark:border-gray-700 sm:flex-row sm:items-center sm:justify-between sm:space-y-0"},ll={class:"flex items-center space-x-4"},dl={class:"text-sm text-gray-600 dark:text-gray-400"},il={key:0,class:"flex items-center text-xs text-green-600 dark:text-green-400"},ul={class:"flex items-center space-x-2"},cl={class:"flex items-center space-x-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-800"},xl={key:0,class:"p-8"},gl={class:"space-y-3"},yl={key:1,class:"py-12 text-center"},ml={class:"mb-2 text-lg font-semibold text-gray-900 dark:text-gray-100"},fl={class:"space-y-2 text-sm text-gray-600 dark:text-gray-400"},bl={key:0},pl={key:1},kl={class:"mt-4 flex flex-col items-center space-y-2 sm:flex-row sm:justify-center sm:space-x-4 sm:space-y-0"},vl={key:2,class:"overflow-x-auto"},hl={"aria-label":"请求日志列表",class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",role:"table"},$l={class:"bg-gray-50 dark:bg-gray-800"},_l={class:"flex items-center space-x-1"},wl={class:"flex items-center space-x-1"},Cl={class:"flex items-center space-x-1"},Dl={class:"flex items-center space-x-1"},Tl={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},Sl={class:"table-cell"},jl={class:"text-sm text-gray-900 dark:text-gray-100"},Bl={class:"table-cell"},ql={class:"flex items-center space-x-2"},Ll=["title"],Nl={class:"table-cell"},Ol={class:"table-cell"},Al=["title"],Il={class:"table-cell"},Rl={class:"flex items-center gap-2"},Hl=["title"],Kl={class:"table-cell"},Pl={class:"flex items-center space-x-1"},Ml={class:"text-sm text-gray-900 dark:text-gray-100"},El=["title"],Fl={key:1,class:"fas fa-rocket text-xs text-green-500",title:"高性能请求"},Ul={class:"table-cell"},Vl={class:"text-sm space-y-1"},zl={class:"flex items-center space-x-1 text-blue-600 dark:text-blue-400"},Jl=["title"],Wl={key:0,class:"flex items-center space-x-1 text-green-600 dark:text-green-400"},Gl={class:"text-xs"},Ql=["title"],Yl={key:1,class:"flex items-center space-x-1"},Zl=["title"],Xl={class:"text-xs text-gray-500"},t0={class:"table-cell"},e0={class:"text-sm space-y-1"},s0={class:"font-medium"},a0={key:0,class:"text-green-600 dark:text-green-400"},r0={key:1,class:"text-gray-400"},o0=["title"],n0={key:0},l0=["title"],d0={class:"table-cell"},i0={class:"text-sm text-gray-600 dark:text-gray-400"},u0={class:"table-cell"},c0=["aria-label","onClick"],x0={key:3,class:"divide-y divide-gray-200 dark:divide-gray-700"},g0={class:"flex items-start justify-between"},y0={class:"flex-1 space-y-2"},m0={class:"flex items-center justify-between"},f0={class:"flex items-center space-x-3"},b0={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},p0={class:"flex items-center space-x-1"},k0=["title"],v0=["onClick"],h0={class:"flex items-center space-x-2"},$0={class:"truncate text-sm text-gray-900 dark:text-gray-100"},_0={class:"flex items-center justify-between text-sm"},w0={class:"flex items-center space-x-2"},C0={class:"text-gray-600 dark:text-gray-400"},D0={class:"flex flex-col items-end text-xs"},T0={class:"flex items-center space-x-1 text-blue-600 dark:text-blue-400"},S0={key:0,class:"text-green-600 dark:text-green-400"},j0={class:"mt-2 text-xs text-gray-500 dark:text-gray-500"},B0={key:4,class:"flex items-center justify-between border-t border-gray-200 px-4 py-3 dark:border-gray-700"},q0={class:"flex items-center space-x-2"},L0=["disabled"],N0={class:"text-sm text-gray-600 dark:text-gray-400"},O0=["disabled"],A0={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},I0={class:"modal-content relative mx-auto flex max-h-[95vh] w-[95%] max-w-6xl flex-col p-4 sm:w-full sm:p-6"},R0={class:"mb-4 flex items-center justify-between sm:mb-6"},H0={class:"flex items-center gap-3"},K0={class:"text-sm text-gray-600 dark:text-gray-400"},P0={class:"mb-6 border-b border-gray-200 dark:border-gray-700"},M0={"aria-label":"Tabs",class:"-mb-px flex space-x-8"},E0=["onClick"],F0={key:0,class:"ml-2 inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"},U0={class:"modal-scroll-content custom-scrollbar flex-1 overflow-y-auto"},V0={key:0,class:"tab-content"},z0={key:1,class:"tab-content"},J0={key:2,class:"tab-content"},W0={key:3,class:"tab-content"},G0={class:"mt-6 flex justify-between border-t border-gray-200 pt-6 dark:border-gray-700"},Q0={class:"flex items-center space-x-4"},Y0={class:"text-sm text-gray-500 dark:text-gray-400"},Z0={class:"text-sm text-gray-500 dark:text-gray-400"},X0={class:"flex gap-3"},td=["disabled"],ed={class:"max-h-[90vh] w-full max-w-2xl overflow-hidden rounded-lg bg-white shadow-xl dark:bg-gray-800"},sd={class:"flex items-center justify-between border-b border-gray-200 px-6 py-4 dark:border-gray-700"},ad={class:"max-h-[calc(90vh-120px)] overflow-y-auto p-6"},rd={class:"space-y-4"},od={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},nd={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},ld={key:0},dd={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},id={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},ud={class:"mt-1 space-y-2 text-sm text-gray-600 dark:text-gray-400"},cd={key:0},xd={key:1},gd={key:2},yd={key:3},md={__name:"RequestLogsView",setup(x){const w=(r,e)=>{let m;return(...h)=>{clearTimeout(m),m=setTimeout(()=>r.apply(this,h),e)}},S=Be(),{logs:B,loading:j,exporting:q,stats:C,filters:g,pagination:D,filteredLogs:W,hasFilters:K,apiKeyLoading:I,apiKeyMap:G}=Ce(S),{fetchLogs:F,fetchStats:v,exportLogs:n,updateFilters:l,clearFilters:f,refreshLogs:y,formatLogEntry:o,getStatusClass:T,getMethodClass:V,formatDuration:u,fetchApiKeys:c,fetchLogDetails:P}=S,L=O(!1),k=O(null),R=O("24h"),H=O(""),A=O(null),M=O(!1),z=O(null),X=O(!1),et=O(!1),st=O("table"),Ct=O(!1),yt=O(!1),Dt=O(0),at=O("overview"),ye=O([{id:"overview",name:"概览",icon:"fas fa-info-circle"},{id:"tokens",name:"Token详情",icon:"fas fa-coins",badge:!0},{id:"headers",name:"请求头",icon:"fas fa-list-ul",badge:!0},{id:"content",name:"消息内容",icon:"fas fa-file-text",badge:!0}]),dt=r=>{var m;if(!r||r===null||r===void 0)return"Unknown";if(z.value)return`${r} (无法验证)`;if(I.value)return`${r} (加载中...)`;const e=(m=G.value)==null?void 0:m.get(r);return e!=null&&e.name?e.name:`${r} (已删除)`},me=tt(()=>{var e;return(((e=C.value)==null?void 0:e.topApiKeys)||[]).map(m=>({id:m.keyId,name:dt(m.keyId),count:m.count,displayText:`${dt(m.keyId)} (${m.count}次使用)`}))}),it=tt(()=>{const r=Array.isArray(B.value)?B.value:[];if(!g.search)return r;const e=String(g.search||"").toLowerCase();return e?r.filter(m=>{var h,N,E,U;return((h=m==null?void 0:m.keyName)==null?void 0:h.toLowerCase().includes(e))||((N=m==null?void 0:m.userAgent)==null?void 0:N.toLowerCase().includes(e))||((E=m==null?void 0:m.ipAddress)==null?void 0:E.includes(e))||((U=m==null?void 0:m.path)==null?void 0:U.toLowerCase().includes(e))}):r}),mt=tt(()=>{let r=[];return r=Array.isArray(W.value)?W.value:[],r.map(e=>({...e,formattedKeyName:e.keyName||dt(e.keyId),mergeInfo:e._mergedCount>1?{count:e._mergedCount,tooltip:`此记录合并了 ${e._mergedCount} 条相关日志`}:null}))}),Tt=w(async()=>{X.value=!0;try{await rt()}finally{X.value=!1}},500),fe=tt(()=>R.value!=="custom"?{"1h":"最近 1 小时","24h":"最近 24 小时","7d":"最近 7 天","30d":"最近 30 天"}[R.value]||"":g.startDate&&g.endDate?`${g.startDate} 至 ${g.endDate}`:"请设置时间范围");ge(()=>[g.startDate,g.endDate],([r,e])=>{R.value==="custom"&&r&&e&&(H.value="",be())});const be=w(async()=>{R.value==="custom"&&await Nt()},1e3),pe=()=>{var m;const r=(D==null?void 0:D.total)||0,e=((m=mt.value)==null?void 0:m.length)||0;return g!=null&&g.search?`找到 ${it.value?it.value.length:0} 条匹配结果，共 ${r} 条记录`:`显示 ${e} 条记录，共 ${r} 条`},ke=r=>r?r.code==="NETWORK_ERROR"?"网络连接失败，请检查网络连接后重试":r.code==="TIMEOUT"?"请求超时，服务器响应缓慢":r.status===401?"认证失败，请重新登录":r.status===403?"没有权限访问此资源":r.status>=500?"服务器内部错误，请稍后重试或联系技术支持":r.message||"请求失败，请重试":"未知错误",ve=()=>{l({search:""}),rt()},St=()=>{f(),rt()},jt=async()=>{A.value=null,M.value=!1,Dt.value++;try{await $t(),nt("数据加载成功","success")}catch(r){A.value=r,nt("重试失败，请检查网络连接","error")}},he=r=>`${(r*100).toFixed(1)}%`,Bt=r=>{if(r.tokenDetails){const E=r.tokenDetails.inputTokens||0,U=r.tokenDetails.outputTokens||0,J=r.tokenDetails.totalTokens||E+U;if(J>0){if(E>0&&U>0){const kt=r._mergedCount>1?` (×${r._mergedCount})`:"";return`${E}→${U}${kt}`}return J.toString()}}const e=r.usage||{},m=e.input_tokens||r.inputTokens||0,h=e.output_tokens||r.outputTokens||0,N=r.tokens||m+h;if(N>0){if(m>0&&h>0){const E=r._mergedCount>1?` (×${r._mergedCount})`:"";return`${m}→${h}${E}`}return N.toString()}return"-"},qt=r=>{var e;if(typeof r=="object"&&r!==null){const m=r;r=((e=m.costDetails)==null?void 0:e.totalCost)||m.cost||0}return!r||r===0?"0.00":r<.01?"< 0.01":r.toFixed(4)},Q=r=>{var e;return((e=r.costDetails)==null?void 0:e.totalCost)||r.cost||0},Lt=r=>{var h,N;if(r.tokenDetails)return(r.tokenDetails.cacheReadTokens||0)+(r.tokenDetails.cacheCreateTokens||0);const e=((h=r.usage)==null?void 0:h.cache_read_input_tokens)||0,m=((N=r.usage)==null?void 0:N.cache_creation_input_tokens)||0;return e+m},rt=async()=>{try{A.value=null,M.value=!1,R.value==="custom"?await Nt():await F()}catch(r){console.error("Apply filters failed:",r),A.value=r,M.value=!0}},Nt=async()=>{const r=g.startDate,e=g.endDate;if(!r||!e){H.value="请设置完整的时间范围";return}const m=new Date(r),h=new Date(e);if(m>=h){H.value="结束时间必须大于开始时间";return}if((h-m)/(1e3*60*60*24)>90){H.value="时间范围不能超过90天";return}H.value="",await Ot(m.toISOString(),h.toISOString())},Ot=async(r,e)=>{console.log("📅 applyFiltersWithTimeRange被调用:",{startDateISO:r,endDateISO:e});const m=g.startDate,h=g.endDate;l({startDate:r,endDate:e}),console.log("📊 调用fetchLogs前，filters状态:",g.value),await F(),console.log("✅ fetchLogs调用完成"),R.value!=="custom"&&l({startDate:m,endDate:h})},$e=(r,e)=>{const m=new Date(e);switch(r){case"1h":return new Date(m.getTime()-60*60*1e3);case"24h":return new Date(m.getTime()-24*60*60*1e3);case"7d":return new Date(m.getTime()-7*24*60*60*1e3);case"30d":return new Date(m.getTime()-30*24*60*60*1e3);default:return new Date(m.getTime()-24*60*60*1e3)}},At=r=>{const e=new Date(r);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e.toISOString().slice(0,16)},It=()=>{if(console.log("🕐 applyTimeRange被调用, timeRange.value:",R.value),H.value="",R.value==="custom"){console.log("⚠️ timeRange是custom，跳过自动更新");return}try{const r=new Date,e=$e(R.value,r),m=r,h=e.toISOString(),N=m.toISOString(),E=At(e),U=At(m);l({startDate:E,endDate:U}),Ot(h,N)}catch(r){console.error("时间范围设置错误:",r),H.value=r.message}},ft=r=>{const e=g==null?void 0:g.sortBy,m=g==null?void 0:g.sortOrder;l(e===r?{sortOrder:m==="asc"?"desc":"asc"}:{sortBy:r,sortOrder:"desc"}),rt()},bt=r=>(g==null?void 0:g.sortBy)!==r?"fa-sort":(g==null?void 0:g.sortOrder)==="asc"?"fa-sort-up":"fa-sort-down",Rt=r=>{const e=(D==null?void 0:D.totalPages)||1;r>=1&&r<=e&&(l({page:r}),rt())},Ht=async r=>{var e,m;if(k.value=r,at.value="overview",!r.tokenDetails&&!r.costDetails&&!r.requestHeaders&&!r.responseHeaders)try{console.log("获取日志详情:",r.id||r.logId);const h=await P(r.id||r.logId);h&&(console.log("获取到的详细日志:",h),k.value={...r,...h,tokenDetails:h.tokenDetails||h.usage||{},costDetails:h.costDetails||{totalCost:h.cost||0,currency:"USD"},requestHeaders:h.requestHeaders||{},responseHeaders:h.responseHeaders||{},request:h.request||r.request||{},response:h.response||r.response||{},requestBody:h.requestBody||((e=h.request)==null?void 0:e.body),responseBody:h.responseBody||((m=h.response)==null?void 0:m.body)},console.log("合并后的日志对象:",k.value))}catch(h){console.error("获取日志详情失败:",h),nt("获取日志详情失败","error")}},ht=()=>{k.value=null,at.value="overview"},Kt=r=>{var e,m;if(!k.value)return 0;switch(r){case"tokens":{const h=k.value.tokenDetails&&Object.keys(k.value.tokenDetails).length>0,N=k.value.costDetails&&Object.keys(k.value.costDetails).length>0;return(h?1:0)+(N?1:0)}case"headers":{const h=k.value.requestHeaders?Object.keys(k.value.requestHeaders).length:0,N=k.value.responseHeaders?Object.keys(k.value.responseHeaders).length:0;return h+N}case"content":{let h=0;return((e=k.value.request)!=null&&e.body||k.value.requestBody)&&h++,((m=k.value.response)!=null&&m.body||k.value.responseBody)&&h++,h}default:return 0}},_e=async()=>{var r,e,m,h;if(k.value)try{const N={metadata:{timestamp:k.value.timestamp,apiKey:k.value.formattedKeyName||dt(k.value.keyId)||"Unknown",method:((r=k.value.request)==null?void 0:r.method)||"N/A",path:((e=k.value.request)==null?void 0:e.path)||"/",statusCode:((m=k.value.response)==null?void 0:m.statusCode)||"N/A",responseTime:k.value.responseTime||"N/A",ipAddress:((h=k.value.request)==null?void 0:h.ip)||"N/A"},request:k.value.request||{},response:k.value.response||{},usage:k.value.usage||{}},E=new Blob([JSON.stringify(N,null,2)],{type:"application/json"}),U=URL.createObjectURL(E),J=document.createElement("a");J.href=U,J.download=`log-detail-${new Date(k.value.timestamp).getTime()}.json`,J.style.display="none",document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(U),nt("日志详情已导出","success")}catch(N){console.error("导出日志详情失败:",N),nt("导出失败","error")}},Pt=async r=>{L.value=!1,await n(r)},we=async()=>{try{z.value=null,await c(!0),nt("API Key数据重新加载成功","success")}catch(r){console.error("API Key重试失败:",r),z.value="重试失败，请稍后再试",nt("API Key重新加载失败","error")}},$t=async()=>{try{A.value=null,M.value=!1,z.value=null;try{await c(!0)}catch(r){console.warn("API Key加载失败，使用现有数据:",r),z.value="API Key数据加载失败"}await y()}catch(r){throw console.error("Refresh failed:",r),A.value=r,M.value=!0,r}};let pt=null;wt(async()=>{try{try{await c()}catch(r){console.warn("API Key初始加载失败:",r),z.value="API Key数据加载失败，可能影响显示效果"}It(),await v(),Ct.value&&(pt=setInterval(async()=>{try{await v()}catch(r){console.warn("Auto refresh failed:",r),M.value=!0}},3e4))}catch(r){console.error("Initial load failed:",r),A.value=r}});const Mt=r=>{r.target.closest(".relative")||(L.value=!1)},Et=()=>{M.value=!1,A.value&&jt()},Ft=()=>{M.value=!0};return wt(()=>{document.addEventListener("click",Mt),window.addEventListener("online",Et),window.addEventListener("offline",Ft),navigator.onLine||(M.value=!0)}),De(()=>{pt&&(clearInterval(pt),pt=null),document.removeEventListener("click",Mt),window.removeEventListener("online",Et),window.removeEventListener("offline",Ft)}),(r,e)=>{var m,h,N,E,U,J,kt,Ut,Vt,zt,Jt,Wt,Gt,Qt,Yt,Zt,Xt,te,ee,se,ae,re;return d(),i("div",un,[t("div",cn,[t("div",null,[e[24]||(e[24]=t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},"请求日志",-1)),e[25]||(e[25]=t("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},"查看和管理 API 请求日志记录",-1)),M.value?(d(),i("div",xn,[...e[23]||(e[23]=[t("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1),b(" 连接异常，数据可能不是最新的 ",-1)])])):$("",!0)]),t("div",gn,[t("button",{"aria-label":p(j)?"正在刷新数据":"刷新日志数据",class:"btn btn-secondary",disabled:p(j),onClick:$t},[t("i",{class:_(["fas fa-sync-alt mr-2",{"animate-spin":p(j)}])},null,2),b(" "+a(p(j)?"刷新中...":"刷新"),1)],8,yn),t("div",mn,[t("button",{"aria-label":p(q)?"正在导出数据":"导出日志数据",class:"btn btn-primary",disabled:p(q)||(Array.isArray(p(B))?p(B).length:0)===0,onClick:e[0]||(e[0]=s=>L.value=!L.value)},[t("i",{class:_(["fas fa-download mr-2",{"animate-spin":p(q)}])},null,2),b(" "+a(p(q)?"导出中...":"导出"),1)],8,fn),L.value?(d(),i("div",bn,[t("div",pn,[t("button",{class:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",role:"menuitem",onClick:e[1]||(e[1]=s=>Pt("json"))},[...e[26]||(e[26]=[t("i",{class:"fas fa-file-code mr-2"},null,-1),b(" 导出为 JSON ",-1)])]),t("button",{class:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",role:"menuitem",onClick:e[2]||(e[2]=s=>Pt("csv"))},[...e[27]||(e[27]=[t("i",{class:"fas fa-file-csv mr-2"},null,-1),b(" 导出为 CSV ",-1)])])])])):$("",!0)])])]),t("div",kn,[t("div",vn,[t("div",hn,[t("div",null,[e[28]||(e[28]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"总请求数",-1)),t("p",$n,a(((m=p(C))==null?void 0:m.totalRequests)||((h=p(D))==null?void 0:h.total)||0),1)]),e[29]||(e[29]=t("i",{class:"fas fa-chart-line text-2xl text-blue-500"},null,-1))])]),t("div",_n,[t("div",wn,[t("div",null,[e[30]||(e[30]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"错误率",-1)),t("p",Cn,a(he(((N=p(C))==null?void 0:N.errorRate)||0)),1)]),e[31]||(e[31]=t("i",{class:"fas fa-exclamation-triangle text-2xl text-red-500"},null,-1))])]),t("div",Dn,[t("div",Tn,[t("div",null,[e[32]||(e[32]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"平均响应时间",-1)),t("p",Sn,a(p(u)(((E=p(C))==null?void 0:E.averageResponseTime)||0)),1)]),e[33]||(e[33]=t("i",{class:"fas fa-clock text-2xl text-green-500"},null,-1))])]),t("div",jn,[t("div",Bn,[t("div",null,[e[34]||(e[34]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"活跃 API Keys",-1)),t("p",qn,a(((J=(U=p(C))==null?void 0:U.topApiKeys)==null?void 0:J.length)||0),1)]),e[35]||(e[35]=t("i",{class:"fas fa-key text-2xl text-purple-500"},null,-1))])])]),t("div",Ln,[t("div",Nn,[t("div",On,[e[36]||(e[36]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"筛选条件",-1)),t("button",{"aria-label":et.value?"收起筛选面板":"展开筛选面板",class:"rounded-md bg-gray-100 px-2 py-1 text-xs text-gray-600 dark:bg-gray-700 dark:text-gray-300 md:hidden",onClick:e[3]||(e[3]=s=>et.value=!et.value)},[t("i",{class:_(["fas",et.value?"fa-chevron-up":"fa-chevron-down"])},null,2)],8,An)]),p(K)?(d(),i("button",{key:0,class:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",onClick:St},[...e[37]||(e[37]=[t("i",{class:"fas fa-times mr-1"},null,-1),b(" 清除筛选 ",-1)])])):$("",!0)]),t("div",{class:_(["grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",{"hidden md:grid":!et.value}])},[t("div",In,[e[40]||(e[40]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 搜索 ",-1)),t("div",Rn,[Z(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>p(g).search=s),"aria-describedby":p(g).search&&(it.value||[]).length>0?"search-results-info":void 0,"aria-label":"搜索日志记录",class:"form-input w-full pr-8",placeholder:"API Key、IP、路径...",onInput:e[5]||(e[5]=(...s)=>p(Tt)&&p(Tt)(...s))},null,40,Hn),[[xt,p(g).search]]),t("div",Kn,[X.value?(d(),i("div",Pn)):p(g).search?(d(),i("button",{key:1,"aria-label":"清除搜索",class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:ve},[...e[38]||(e[38]=[t("i",{class:"fas fa-times text-sm"},null,-1)])])):(d(),i("i",Mn))])]),p(g).search&&!X.value?(d(),i("div",En,[p(g).search&&((kt=it.value)==null?void 0:kt.length)>0?(d(),i("span",Fn,"找到 "+a(((Ut=it.value)==null?void 0:Ut.length)||0)+" 条结果",1)):(d(),i("span",Un,"未找到匹配结果")),e[39]||(e[39]=t("span",{class:"ml-2"},"💡 试试搜索IP地址或完整路径",-1))])):$("",!0)]),t("div",null,[e[44]||(e[44]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," API Key ",-1)),t("div",Vn,[Z(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>p(g).apiKeyId=s),class:"form-select w-full",disabled:p(I),onChange:rt},[e[41]||(e[41]=t("option",{value:""},"全部",-1)),(d(!0),i(ot,null,lt(me.value,s=>(d(),i("option",{key:s.id,value:s.id},a(s.displayText),9,Jn))),128))],40,zn),[[ct,p(g).apiKeyId]]),p(I)?(d(),i("div",Wn,[...e[42]||(e[42]=[t("div",{class:"loading-spinner h-4 w-4"},null,-1)])])):$("",!0)]),z.value?(d(),i("div",Gn,[e[43]||(e[43]=t("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1)),b(" "+a(z.value)+" ",1),t("button",{class:"ml-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",onClick:we}," 重试 ")])):$("",!0)]),t("div",null,[e[46]||(e[46]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 状态码 ",-1)),Z(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>p(g).statusCode=s),class:"form-select w-full",onChange:rt},[...e[45]||(e[45]=[_t('<option value="" data-v-7fc8d4e0>全部</option><option value="200" data-v-7fc8d4e0>200 (成功)</option><option value="400" data-v-7fc8d4e0>400 (请求错误)</option><option value="401" data-v-7fc8d4e0>401 (未授权)</option><option value="403" data-v-7fc8d4e0>403 (禁止访问)</option><option value="429" data-v-7fc8d4e0>429 (限流)</option><option value="500" data-v-7fc8d4e0>500 (服务器错误)</option>',7)])],544),[[ct,p(g).statusCode]])]),t("div",null,[e[48]||(e[48]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 时间范围 ",-1)),Z(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>R.value=s),class:"form-select w-full",onChange:It},[...e[47]||(e[47]=[_t('<option value="1h" data-v-7fc8d4e0>最近 1 小时</option><option value="24h" data-v-7fc8d4e0>最近 24 小时</option><option value="7d" data-v-7fc8d4e0>最近 7 天</option><option value="30d" data-v-7fc8d4e0>最近 30 天</option><option value="custom" data-v-7fc8d4e0>自定义</option>',5)])],544),[[ct,R.value]]),t("p",Qn,a(fe.value),1)])],2),R.value==="custom"?(d(),i("div",Yn,[t("div",Zn,[t("div",null,[e[49]||(e[49]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 开始时间 ",-1)),Z(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>p(g).startDate=s),class:_(["form-input w-full",{"border-red-300 focus:border-red-500 focus:ring-red-500":H.value}]),placeholder:"选择开始时间",type:"datetime-local"},null,2),[[xt,p(g).startDate]])]),t("div",null,[e[50]||(e[50]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 结束时间 ",-1)),Z(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>p(g).endDate=s),class:_(["form-input w-full",{"border-red-300 focus:border-red-500 focus:ring-red-500":H.value}]),placeholder:"选择结束时间",type:"datetime-local"},null,2),[[xt,p(g).endDate]])])]),H.value?(d(),i("div",Xn,[e[51]||(e[51]=t("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),b(" "+a(H.value),1)])):(d(),i("div",tl,[...e[52]||(e[52]=[t("i",{class:"fas fa-info-circle mr-1"},null,-1),b(" 支持最长90天的时间范围查询。修改时间后将自动查询。 ",-1)])]))])):$("",!0)]),A.value&&!p(j)?(d(),i("div",el,[t("div",sl,[e[55]||(e[55]=t("div",{class:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900"},[t("i",{class:"fas fa-exclamation-triangle text-2xl text-red-600 dark:text-red-400"})],-1)),e[56]||(e[56]=t("h3",{class:"mb-2 text-lg font-semibold text-gray-900 dark:text-gray-100"},"加载失败",-1)),t("p",al,a(ke(A.value)),1),t("div",rl,[t("button",{class:"btn btn-primary",onClick:jt},[...e[53]||(e[53]=[t("i",{class:"fas fa-redo mr-2"},null,-1),b(" 重试 ",-1)])]),t("button",{class:"btn btn-secondary",onClick:e[11]||(e[11]=s=>yt.value=!0)},[...e[54]||(e[54]=[t("i",{class:"fas fa-info-circle mr-2"},null,-1),b(" 查看详情 ",-1)])])])])])):(d(),i("div",ol,[t("div",nl,[t("div",ll,[t("span",dl,a(pe()),1),Ct.value?(d(),i("div",il,[...e[57]||(e[57]=[t("div",{class:"mr-1 h-2 w-2 animate-pulse rounded-full bg-green-500"},null,-1),b(" 实时更新 ",-1)])])):$("",!0)]),t("div",ul,[t("div",cl,[t("button",{class:_(["rounded px-2 py-1 text-xs font-medium transition-colors",st.value==="table"?"bg-white text-blue-600 shadow-sm dark:bg-gray-700 dark:text-blue-400":"text-gray-600 dark:text-gray-400"]),onClick:e[12]||(e[12]=s=>st.value="table")},[...e[58]||(e[58]=[t("i",{class:"fas fa-table mr-1"},null,-1),b(" 表格 ",-1)])],2),t("button",{class:_(["rounded px-2 py-1 text-xs font-medium transition-colors",st.value==="cards"?"bg-white text-blue-600 shadow-sm dark:bg-gray-700 dark:text-blue-400":"text-gray-600 dark:text-gray-400"]),onClick:e[13]||(e[13]=s=>st.value="cards")},[...e[59]||(e[59]=[t("i",{class:"fas fa-th-large mr-1"},null,-1),b(" 卡片 ",-1)])],2)]),Z(t("select",{"onUpdate:modelValue":e[14]||(e[14]=s=>p(g).limit=s),"aria-label":"每页显示条数",class:"form-select text-sm",onChange:rt},[...e[60]||(e[60]=[t("option",{value:"25"},"25 条/页",-1),t("option",{value:"50"},"50 条/页",-1),t("option",{value:"100"},"100 条/页",-1)])],544),[[ct,p(g).limit]])])]),p(j)?(d(),i("div",xl,[t("div",gl,[(d(),i(ot,null,lt(5,s=>t("div",{key:s,class:"animate-pulse"},[...e[61]||(e[61]=[_t('<div class="flex items-center space-x-4" data-v-7fc8d4e0><div class="h-4 w-20 rounded bg-gray-200 dark:bg-gray-700" data-v-7fc8d4e0></div><div class="h-4 w-16 rounded bg-gray-200 dark:bg-gray-700" data-v-7fc8d4e0></div><div class="h-4 w-12 rounded bg-gray-200 dark:bg-gray-700" data-v-7fc8d4e0></div><div class="h-4 flex-1 rounded bg-gray-200 dark:bg-gray-700" data-v-7fc8d4e0></div><div class="h-4 w-16 rounded bg-gray-200 dark:bg-gray-700" data-v-7fc8d4e0></div><div class="h-4 w-12 rounded bg-gray-200 dark:bg-gray-700" data-v-7fc8d4e0></div></div>',1)])])),64)),e[62]||(e[62]=t("div",{class:"mt-4 text-center"},[t("div",{class:"inline-flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400"},[t("div",{class:"loading-spinner"}),t("span",null,"正在加载日志数据...")])],-1))])])):mt.value.length===0?(d(),i("div",yl,[e[65]||(e[65]=t("div",{class:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800"},[t("i",{class:"fas fa-inbox text-2xl text-gray-400"})],-1)),t("h3",ml,a(p(g).search?"未找到匹配的日志":"暂无日志记录"),1),t("div",fl,[p(g).search?(d(),i("p",bl,'未找到包含 "'+a(p(g).search)+'" 的日志记录',1)):(d(),i("p",pl,"当前时间范围内没有日志记录")),t("div",kl,[p(K)?(d(),i("button",{key:0,class:"btn btn-primary",onClick:St},[...e[63]||(e[63]=[t("i",{class:"fas fa-filter mr-2"},null,-1),b(" 清除所有筛选 ",-1)])])):$("",!0),t("button",{class:"btn btn-secondary",onClick:$t},[...e[64]||(e[64]=[t("i",{class:"fas fa-sync-alt mr-2"},null,-1),b(" 刷新数据 ",-1)])])])])])):st.value==="table"?(d(),i("div",vl,[t("table",hl,[t("thead",$l,[t("tr",null,[t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[15]||(e[15]=s=>ft("timestamp"))},[t("div",_l,[e[66]||(e[66]=t("span",null,"时间",-1)),t("i",{class:_(["fas fa-sort text-gray-400",bt("timestamp")])},null,2)])]),e[70]||(e[70]=t("th",{class:"table-header",role:"columnheader"},"API Key",-1)),t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[16]||(e[16]=s=>ft("request.method"))},[t("div",wl,[e[67]||(e[67]=t("span",null,"方法",-1)),t("i",{class:_(["fas fa-sort text-gray-400",bt("request.method")])},null,2)])]),e[71]||(e[71]=t("th",{class:"table-header",role:"columnheader"},"路径",-1)),t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[17]||(e[17]=s=>ft("response.statusCode"))},[t("div",Cl,[e[68]||(e[68]=t("span",null,"状态码",-1)),t("i",{class:_(["fas fa-sort text-gray-400",bt("response.statusCode")])},null,2)])]),t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[18]||(e[18]=s=>ft("response.duration"))},[t("div",Dl,[e[69]||(e[69]=t("span",null,"响应时间",-1)),t("i",{class:_(["fas fa-sort text-gray-400",bt("response.duration")])},null,2)])]),e[72]||(e[72]=t("th",{class:"table-header",role:"columnheader"},"Tokens",-1)),e[73]||(e[73]=t("th",{class:"table-header",role:"columnheader"},"成本",-1)),e[74]||(e[74]=t("th",{class:"table-header",role:"columnheader"},"IP 地址",-1)),e[75]||(e[75]=t("th",{class:"table-header",role:"columnheader"},"操作",-1))])]),t("tbody",Tl,[(d(!0),i(ot,null,lt(mt.value,s=>{var Y,oe,ne,le,de,ie,ue,ce;return d(),i("tr",{key:s.logId||s.timestamp,class:_(["transition-colors hover:bg-gray-50 dark:hover:bg-gray-800",{"animate-pulse bg-green-50 dark:bg-green-900/20":s._isNew}])},[t("td",Sl,[t("div",jl,a(new Date(s.timestamp).toLocaleString("zh-CN")),1)]),t("td",Bl,[t("div",ql,[e[77]||(e[77]=t("div",{"aria-label":"API Key 活跃",class:"h-2 w-2 rounded-full bg-green-500"},null,-1)),t("span",{class:_(["text-sm font-medium",s.formattedKeyName&&s.formattedKeyName.includes("(已删除)")?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-gray-100"])},a(s.formattedKeyName),3),s.mergeInfo?(d(),i("div",{key:0,class:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",title:s.mergeInfo.tooltip},[e[76]||(e[76]=t("i",{class:"fas fa-layer-group mr-1 text-xs"},null,-1)),b(" "+a(s.mergeInfo.count),1)],8,Ll)):$("",!0)])]),t("td",Nl,[t("span",{class:_(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",p(V)(s.method)])},a(s.method||"N/A"),3)]),t("td",Ol,[t("span",{class:"max-w-32 truncate text-sm text-gray-900 dark:text-gray-100",title:s.path},a(s.path||"/"),9,Al)]),t("td",Il,[t("div",Rl,[t("span",{class:_(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",p(T)(s.status||s.statusCode)])},a(s.status||s.statusCode||"N/A"),3),s.statusCategory?(d(),i("span",{key:0,class:_(["inline-flex items-center gap-1 text-xs",{"text-green-600":s.statusCategory==="success","text-yellow-600":s.statusCategory==="redirect","text-red-600":s.statusCategory==="client_error"||s.statusCategory==="server_error","text-gray-600":s.statusCategory==="unknown"}]),title:`状态分类: ${s.statusCategory}`},[...e[78]||(e[78]=[t("i",{class:"fas fa-tag"},null,-1)])],10,Hl)):$("",!0)])]),t("td",Kl,[t("div",Pl,[t("span",Ml,a(s.duration||s.responseTime?`${s.duration||s.responseTime}ms`:"N/A"),1),s.performanceLevel==="slow"||s.performanceLevel==="very_slow"?(d(),i("i",{key:0,class:_(["fas fa-exclamation-triangle text-xs",{"text-yellow-500":s.performanceLevel==="slow","text-red-500":s.performanceLevel==="very_slow"}]),title:`性能等级: ${s.performanceLevel}`},null,10,El)):s.performanceLevel==="fast"?(d(),i("i",Fl)):$("",!0)])]),t("td",Ul,[t("div",Vl,[t("div",zl,[e[79]||(e[79]=t("i",{class:"fas fa-coins text-xs"},null,-1)),t("span",null,a(Bt(s)),1),(Y=s.tokenSummary)!=null&&Y.efficiency&&s.tokenSummary.efficiency>0?(d(),i("span",{key:0,class:"text-xs text-gray-500",title:`Token使用效率: ${s.tokenSummary.efficiency}%`}," ("+a(s.tokenSummary.efficiency)+"%) ",9,Jl)):$("",!0)]),Lt(s)>0?(d(),i("div",Wl,[e[80]||(e[80]=t("i",{class:"fas fa-memory text-xs"},null,-1)),t("span",Gl,"缓存: "+a(Lt(s)),1),((oe=s.tokenSummary)==null?void 0:oe.cacheCreateTokens)>0||((ne=s.tokenSummary)==null?void 0:ne.cacheReadTokens)>0?(d(),i("span",{key:0,class:"text-xs text-gray-500",title:`缓存创建: ${((le=s.tokenSummary)==null?void 0:le.cacheCreateTokens)||0}, 缓存读取: ${((de=s.tokenSummary)==null?void 0:de.cacheReadTokens)||0}`}," (C:"+a(((ie=s.tokenSummary)==null?void 0:ie.cacheCreateTokens)||0)+" R:"+a(((ue=s.tokenSummary)==null?void 0:ue.cacheReadTokens)||0)+") ",9,Ql)):$("",!0)])):$("",!0),s.dataCompleteness&&s.dataCompleteness.completenessScore?(d(),i("div",Yl,[t("i",{class:_(["fas text-xs",{"fa-check-circle text-green-500":parseInt(s.dataCompleteness.completenessScore)>=80,"fa-exclamation-triangle text-yellow-500":parseInt(s.dataCompleteness.completenessScore)>=50,"fa-times-circle text-red-500":parseInt(s.dataCompleteness.completenessScore)<50}]),title:`数据完整性: ${s.dataCompleteness.completenessScore}%`},null,10,Zl),t("span",Xl,a(s.dataCompleteness.completenessScore)+"%",1)])):$("",!0)])]),t("td",t0,[t("div",e0,[t("div",s0,[Q(s)>0?(d(),i("span",a0," $"+a(qt(Q(s))),1)):(d(),i("span",r0,"-"))]),s.costDetails&&(s.costDetails.costPerToken||s.costDetails.currency)?(d(),i("div",{key:0,class:"text-xs text-gray-500",title:`单价: $${s.costDetails.costPerToken||"N/A"}/token, 货币: ${s.costDetails.currency||"USD"}`},[e[81]||(e[81]=t("i",{class:"fas fa-info-circle"},null,-1)),b(" "+a(s.costDetails.currency||"USD")+" ",1),s.costDetails.costPerToken?(d(),i("span",n0," @$"+a((s.costDetails.costPerToken*1e3).toFixed(6))+"/1k ",1)):$("",!0)],8,o0)):$("",!0),Q(s)>0&&((ce=s.tokenSummary)!=null&&ce.totalTokens)?(d(),i("div",{key:1,class:_(["text-xs",{"text-green-600":Q(s)/s.tokenSummary.totalTokens*1e3<.01,"text-yellow-600":Q(s)/s.tokenSummary.totalTokens*1e3>=.01&&Q(s)/s.tokenSummary.totalTokens*1e3<.05,"text-red-600":Q(s)/s.tokenSummary.totalTokens*1e3>=.05}]),title:`成本效率: $${(Q(s)/s.tokenSummary.totalTokens*1e3).toFixed(4)}/1k tokens`},[e[82]||(e[82]=t("i",{class:"fas fa-chart-line"},null,-1)),b(" $"+a((Q(s)/s.tokenSummary.totalTokens*1e3).toFixed(4))+"/1k ",1)],10,l0)):$("",!0)])]),t("td",d0,[t("span",i0,a(s.ipAddress||"N/A"),1)]),t("td",u0,[t("button",{"aria-label":`查看日志详情: ${s.formattedKeyName||"Unknown"} ${s.method} ${s.path}`,class:"rounded p-1 text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-800 dark:text-blue-400 dark:hover:bg-blue-900/20 dark:hover:text-blue-300",onClick:fd=>Ht(s)},[...e[83]||(e[83]=[t("i",{class:"fas fa-eye"},null,-1)])],8,c0)])],2)}),128))])])])):(d(),i("div",x0,[(d(!0),i(ot,null,lt(mt.value,s=>(d(),i("div",{key:s.logId||s.timestamp,class:_(["p-4 transition-colors hover:bg-gray-50 dark:hover:bg-gray-800",{"animate-pulse bg-green-50 dark:bg-green-900/20":s._isNew}])},[t("div",g0,[t("div",y0,[t("div",m0,[t("div",f0,[t("span",b0,a(new Date(s.timestamp).toLocaleString("zh-CN").split(" ")[1]),1),t("div",p0,[e[85]||(e[85]=t("div",{class:"h-2 w-2 rounded-full bg-green-500"},null,-1)),t("span",{class:_(["text-sm",s.formattedKeyName&&s.formattedKeyName.includes("(已删除)")?"text-gray-500 dark:text-gray-400":"text-gray-600 dark:text-gray-400"])},a(s.formattedKeyName),3),s.mergeInfo?(d(),i("div",{key:0,class:"inline-flex items-center rounded-full bg-blue-100 px-1.5 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",title:s.mergeInfo.tooltip},[e[84]||(e[84]=t("i",{class:"fas fa-layer-group mr-0.5 text-xs"},null,-1)),b(" "+a(s.mergeInfo.count),1)],8,k0)):$("",!0)])]),t("button",{"aria-label":"查看详情",class:"rounded p-2 text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-800 dark:text-blue-400 dark:hover:bg-blue-900/20 dark:hover:text-blue-300",onClick:Y=>Ht(s)},[...e[86]||(e[86]=[t("i",{class:"fas fa-eye"},null,-1)])],8,v0)]),t("div",h0,[t("span",{class:_(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",p(V)(s.method)])},a(s.method||"N/A"),3),t("span",$0,a(s.path||"/"),1)]),t("div",_0,[t("div",w0,[t("span",{class:_(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",p(T)(s.statusCode)])},a(s.statusCode||"N/A"),3),t("span",C0," ⏱️ "+a(s.responseTime?`${s.responseTime}ms`:"N/A"),1)]),t("div",D0,[t("div",T0,[e[87]||(e[87]=t("i",{class:"fas fa-coins"},null,-1)),t("span",null,a(Bt(s)),1)]),Q(s)>0?(d(),i("div",S0," $"+a(qt(Q(s))),1)):$("",!0)])]),t("div",j0," 🌐 "+a(s.ipAddress||"N/A"),1)])])],2))),128))])),(((Vt=p(D))==null?void 0:Vt.totalPages)||0)>1?(d(),i("div",B0,[t("div",q0,[t("button",{class:"btn btn-secondary btn-sm",disabled:(((zt=p(D))==null?void 0:zt.page)||1)<=1,onClick:e[19]||(e[19]=s=>{var Y;return Rt((((Y=p(D))==null?void 0:Y.page)||1)-1)})},[...e[88]||(e[88]=[t("i",{class:"fas fa-chevron-left"},null,-1)])],8,L0),t("span",N0," 第 "+a(((Jt=p(D))==null?void 0:Jt.page)||1)+" 页，共 "+a(((Wt=p(D))==null?void 0:Wt.totalPages)||1)+" 页 ",1),t("button",{class:"btn btn-secondary btn-sm",disabled:(((Gt=p(D))==null?void 0:Gt.page)||1)>=(((Qt=p(D))==null?void 0:Qt.totalPages)||1),onClick:e[20]||(e[20]=s=>{var Y;return Rt((((Y=p(D))==null?void 0:Y.page)||1)+1)})},[...e[89]||(e[89]=[t("i",{class:"fas fa-chevron-right"},null,-1)])],8,O0)])])):$("",!0)])),(d(),Te(Se,{to:"body"},[k.value?(d(),i("div",A0,[t("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm",onClick:ht}),t("div",I0,[t("div",R0,[t("div",H0,[e[91]||(e[91]=t("div",{class:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600"},[t("i",{class:"fas fa-file-alt text-white"})],-1)),t("div",null,[e[90]||(e[90]=t("h3",{class:"text-xl font-bold text-gray-900 dark:text-gray-100"},"日志详情",-1)),t("p",K0,a(k.value.formattedKeyName||dt(k.value.keyId)||"Unknown"),1)])]),t("button",{class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",onClick:ht},[...e[92]||(e[92]=[t("i",{class:"fas fa-times text-xl"},null,-1)])])]),t("div",P0,[t("nav",M0,[(d(!0),i(ot,null,lt(ye.value,s=>(d(),i("button",{key:s.id,class:_([at.value===s.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300","flex items-center gap-2 whitespace-nowrap border-b-2 px-1 py-2 text-sm font-medium"]),onClick:Y=>at.value=s.id},[t("i",{class:_(s.icon)},null,2),b(" "+a(s.name)+" ",1),s.badge&&Kt(s.id)?(d(),i("span",F0,a(Kt(s.id)),1)):$("",!0)],10,E0))),128))])]),t("div",U0,[at.value==="overview"?(d(),i("div",V0,[vt(Zs,{log:k.value},null,8,["log"])])):$("",!0),at.value==="tokens"?(d(),i("div",z0,[vt(tr,{"cost-details":k.value.costDetails||{},"token-details":k.value.tokenDetails||{}},null,8,["cost-details","token-details"])])):$("",!0),at.value==="headers"?(d(),i("div",J0,[vt(ao,{"request-headers":k.value.requestHeaders||{},"response-headers":k.value.responseHeaders||{}},null,8,["request-headers","response-headers"])])):$("",!0),at.value==="content"?(d(),i("div",W0,[vt(dn,{"request-body":((Yt=k.value.request)==null?void 0:Yt.body)||k.value.requestBody,"response-body":((Zt=k.value.response)==null?void 0:Zt.body)||k.value.responseBody},null,8,["request-body","response-body"])])):$("",!0)]),t("div",G0,[t("div",Q0,[t("div",Y0,[e[93]||(e[93]=t("i",{class:"fas fa-clock mr-1"},null,-1)),b(" "+a(p(o)(k.value).timestamp),1)]),t("div",Z0,[e[94]||(e[94]=t("i",{class:"fas fa-tachometer-alt mr-1"},null,-1)),b(" "+a(p(o)(k.value).duration),1)])]),t("div",X0,[t("button",{class:"btn btn-secondary px-4 py-2 text-sm",disabled:p(q),type:"button",onClick:_e},[t("i",{class:_(["fas fa-download mr-2",{"animate-spin":p(q)}])},null,2),e[95]||(e[95]=b(" 导出 ",-1))],8,td),t("button",{class:"btn btn-primary px-4 py-2 text-sm",type:"button",onClick:ht}," 关闭 ")])])])])):$("",!0)])),yt.value?(d(),i("div",{key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e[22]||(e[22]=je(s=>yt.value=!1,["self"]))},[t("div",ed,[t("div",sd,[e[97]||(e[97]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"错误详情",-1)),t("button",{class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:e[21]||(e[21]=s=>yt.value=!1)},[...e[96]||(e[96]=[t("i",{class:"fas fa-times text-xl"},null,-1)])])]),t("div",ad,[t("div",rd,[t("div",null,[e[98]||(e[98]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"错误类型",-1)),t("p",od,a(((Xt=A.value)==null?void 0:Xt.code)||"未知错误"),1)]),t("div",null,[e[99]||(e[99]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"错误信息",-1)),t("p",nd,a(((te=A.value)==null?void 0:te.message)||"无详细信息"),1)]),(ee=A.value)!=null&&ee.status?(d(),i("div",ld,[e[100]||(e[100]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"状态码",-1)),t("p",dd,a(A.value.status),1)])):$("",!0),t("div",null,[e[101]||(e[101]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"重试次数",-1)),t("p",id,a(Dt.value),1)]),t("div",null,[e[106]||(e[106]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"建议操作",-1)),t("div",ud,[((se=A.value)==null?void 0:se.code)==="NETWORK_ERROR"?(d(),i("p",cd,[...e[102]||(e[102]=[b(" • 检查网络连接是否正常",-1),t("br",null,null,-1),b(" • 检查VPN或代理设置",-1),t("br",null,null,-1),b(" • 尝试刷新页面 ",-1)])])):((ae=A.value)==null?void 0:ae.status)===401?(d(),i("p",xd,[...e[103]||(e[103]=[b(" • 重新登录系统",-1),t("br",null,null,-1),b(" • 检查登录凭据是否过期 ",-1)])])):((re=A.value)==null?void 0:re.status)>=500?(d(),i("p",gd,[...e[104]||(e[104]=[b(" • 稍后再试",-1),t("br",null,null,-1),b(" • 如问题持续，请联系技术支持 ",-1)])])):(d(),i("p",yd,[...e[105]||(e[105]=[b(" • 检查网络连接",-1),t("br",null,null,-1),b(" • 刷新页面后重试 ",-1)])]))])])])])])])):$("",!0)])}}},wd=gt(md,[["__scopeId","data-v-7fc8d4e0"]]);export{wd as default};
