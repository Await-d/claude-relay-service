import{x as c,y as u,z as t,O as v,P as s,L as $,C as w,B as it,r as O,c as X,q as _t,D as oe,o as ne,Q as rt,K as Y,aq as ct,ac as nt,aY as ut,aX as ve,V as pe,I as ke,u as b,aZ as wt,R as kt,a5 as he,Y as $e}from"./vue-vendor-C9wZz30M.js";import{u as we}from"./requestLogs-BHLFFc27.js";import{s as ot}from"./toast-BvwA7Mwb.js";import{_ as gt}from"./index-DzfMknhi.js";import{C as _e}from"./chart-D2XTohFh.js";import"./element-plus-5SvmA99H.js";import"./vendor-DeB155zE.js";const Ce={class:"request-overview"},De={class:"mb-8 grid grid-cols-1 gap-6 lg:grid-cols-2"},Te={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},je={class:"space-y-4"},Be={class:"grid grid-cols-2 gap-4"},qe={class:"text-sm text-gray-900 dark:text-gray-100"},Se={class:"text-xs text-gray-500 dark:text-gray-400"},Le={class:"break-all font-mono text-sm text-gray-900 dark:text-gray-100"},Ne={class:"grid grid-cols-2 gap-4"},Oe={class:"flex items-center gap-2"},Ae={class:"text-sm text-gray-900 dark:text-gray-100"},Ie={class:"text-sm text-gray-900 dark:text-gray-100"},Re={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},He={class:"space-y-4"},Ke={class:"grid grid-cols-2 gap-4"},Me={class:"flex items-center gap-2"},Pe={class:"text-xs text-gray-500 dark:text-gray-400"},Ee={class:"break-all rounded border bg-gray-50 p-2 font-mono text-sm text-gray-900 dark:bg-gray-700/50 dark:text-gray-100"},Fe={class:"grid grid-cols-2 gap-4"},Ue={class:"flex items-center gap-2"},Ve={class:"font-mono text-sm text-gray-900 dark:text-gray-100"},ze={class:"mb-8 grid grid-cols-1 gap-6 lg:grid-cols-2"},Je={class:"rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white"},We={class:"grid grid-cols-2 gap-4"},Ge={class:"text-2xl font-bold"},Ye={class:"text-2xl font-bold"},Qe={class:"mt-4 grid grid-cols-4 gap-2 text-xs"},Xe={class:"text-center"},Ze={class:"font-semibold"},ts={class:"text-center"},es={class:"font-semibold"},ss={class:"text-center"},as={class:"font-semibold"},rs={class:"text-center"},os={class:"font-semibold"},ns={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},ls={class:"space-y-4"},ds={class:"text-center"},is={class:"text-3xl font-bold text-green-600 dark:text-green-400"},us={class:"grid grid-cols-2 gap-4 border-t border-gray-200 pt-4 dark:border-gray-700"},cs={class:"text-center"},gs={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},xs={class:"text-center"},ys={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},ms={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},fs={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},bs={class:"space-y-3"},vs={class:"flex items-center justify-between"},ps={class:"flex items-center gap-2"},ks={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},hs={class:"text-xs font-medium"},$s={class:"flex items-center justify-between"},ws={class:"flex items-center gap-2"},_s={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},Cs={class:"text-xs font-medium"},Ds={class:"flex items-center justify-between"},Ts={class:"flex items-center gap-2"},js={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},Bs={class:"text-xs font-medium"},qs={class:"flex items-center justify-between"},Ss={class:"flex items-center gap-2"},Ls={class:"h-2 w-16 rounded-full bg-gray-200 dark:bg-gray-700"},Ns={class:"text-xs font-medium"},Os={class:"space-y-2 text-sm"},As={class:"flex justify-between"},Is={class:"text-gray-900 dark:text-gray-100"},Rs={class:"flex justify-between"},Hs={class:"flex justify-between"},Ks={class:"text-gray-900 dark:text-gray-100"},Ms={class:"mt-6 border-t border-gray-200 pt-4 dark:border-gray-700"},Ps={class:"flex items-center justify-between"},Es={class:"flex items-center gap-3"},Fs={class:"h-3 w-32 rounded-full bg-gray-200 dark:bg-gray-700"},Us={__name:"RequestOverview",props:{log:{type:Object,required:!0}},setup(g){const _=g,j=d=>d?new Date(d).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"N/A",q=d=>{if(!d)return"";const i=Date.now(),M=new Date(d).getTime(),L=i-M;return L<6e4?"刚刚":L<36e5?`${Math.floor(L/6e4)} 分钟前`:L<864e5?`${Math.floor(L/36e5)} 小时前`:`${Math.floor(L/864e5)} 天前`},B=d=>d.id||d.logId||"N/A",S=d=>{var i;return d.formattedKeyName||((i=d.apiKey)==null?void 0:i.name)||(d.keyId?`Key-${d.keyId.slice(-8)}`:"N/A")},C=d=>S(d).includes("(已删除)")?"已删除":"正常",x=d=>C(d)==="已删除"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",D=d=>({GET:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",POST:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",PUT:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300",DELETE:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300",PATCH:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300"})[d]||"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300",W=d=>d>=200&&d<300?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":d>=300&&d<400?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":d>=400&&d<500?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":d>=500?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300":"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300",K=d=>d>=200&&d<300?"成功":d>=300&&d<400?"重定向":d>=400&&d<500?"客户端错误":d>=500?"服务器错误":"",I=d=>d?d<1e3?`${d}ms`:`${(d/1e3).toFixed(2)}s`:"N/A",G=d=>d?d<1e3?"text-green-600 dark:text-green-400":d<3e3?"text-yellow-600 dark:text-yellow-400":d<5e3?"text-orange-600 dark:text-orange-400":"text-red-600 dark:text-red-400":"text-gray-500",F=d=>d?d<1e3?"快速":d<3e3?"正常":d<5e3?"较慢":"很慢":"N/A",k=d=>d?d<1e3?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":d<3e3?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":d<5e3?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300",o=()=>{const d=_.log.tokenDetails||{},i=d.input_tokens||0,M=d.output_tokens||0,L=d.cache_creation_input_tokens||0,p=d.cache_read_input_tokens||0,R=i+M+L+p,H=i>0?(M/i).toFixed(2):"0.00";return{total:R.toLocaleString(),input:i.toLocaleString(),output:M.toLocaleString(),cacheCreate:L.toLocaleString(),cacheRead:p.toLocaleString(),efficiency:H}},n=()=>{const d=_.log.costDetails||{},i=(d.totalCost||0).toFixed(6),M=o(),L=parseInt(M.total.replace(/,/g,""))||0,p=L>0?(d.totalCost/L).toFixed(8):"0.00000000";return{total:i,perToken:p,currency:d.currency||"USD"}},f=()=>{const d=_.log,M=["timestamp","keyId","method","path","status"].reduce((z,Q)=>z+(d[Q]?20:0),0),p=!!(d.tokenDetails&&Object.keys(d.tokenDetails).length>0)?100:0,H=!!(d.costDetails&&d.costDetails.totalCost)?100:0,P=!!(d.requestHeaders||d.responseHeaders)?100:0;return{basic:Math.min(M,100),tokens:p,costs:H,headers:P}},y=()=>{const d=f();return Math.round((d.basic+d.tokens+d.costs+d.headers)/4)},r=()=>{const d=y();return d>=80?"bg-green-500":d>=60?"bg-yellow-500":d>=40?"bg-orange-500":"bg-red-500"},T=()=>{const d=y();return d>=80?"text-green-600 dark:text-green-400":d>=60?"text-yellow-600 dark:text-yellow-400":d>=40?"text-orange-600 dark:text-orange-400":"text-red-600 dark:text-red-400"},V=()=>new Date().toLocaleTimeString("zh-CN");return(d,i)=>{var M;return u(),c("div",Ce,[t("div",De,[t("div",Te,[i[4]||(i[4]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-info-circle mr-2 text-blue-500"}),v(" 基本信息 ")],-1)),t("div",je,[t("div",Be,[t("div",null,[i[0]||(i[0]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求时间 ",-1)),t("div",qe,s(j(g.log.timestamp)),1),t("div",Se,s(q(g.log.timestamp)),1)]),t("div",null,[i[1]||(i[1]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求ID ",-1)),t("div",Le,s(B(g.log)),1)])]),t("div",Ne,[t("div",null,[i[2]||(i[2]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," API Key ",-1)),t("div",Oe,[t("span",Ae,s(S(g.log)),1),C(g.log)?(u(),c("span",{key:0,class:w(["rounded-full px-2 py-1 text-xs",x(g.log)])},s(C(g.log)),3)):$("",!0)])]),t("div",null,[i[3]||(i[3]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 使用模型 ",-1)),t("div",Ie,s(g.log.model||"N/A"),1)])])])]),t("div",Re,[i[10]||(i[10]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-network-wired mr-2 text-green-500"}),v(" 请求详情 ")],-1)),t("div",He,[t("div",Ke,[t("div",null,[i[5]||(i[5]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求方法 ",-1)),t("span",{class:w(["inline-block rounded px-2 py-1 text-xs font-medium",D(g.log.method)])},s(g.log.method||"N/A"),3)]),t("div",null,[i[6]||(i[6]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 状态码 ",-1)),t("div",Me,[t("span",{class:w(["inline-block rounded px-2 py-1 text-xs font-medium",W(g.log.status)])},s(g.log.status||"N/A"),3),t("span",Pe,s(K(g.log.status)),1)])])]),t("div",null,[i[7]||(i[7]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 请求路径 ",-1)),t("div",Ee,s(g.log.path||"/"),1)]),t("div",Fe,[t("div",null,[i[8]||(i[8]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 响应时间 ",-1)),t("div",Ue,[t("span",{class:w(["text-lg font-semibold",G(g.log.responseTime)])},s(I(g.log.responseTime)),3),t("span",{class:w(["rounded-full px-2 py-1 text-xs",k(g.log.responseTime)])},s(F(g.log.responseTime)),3)])]),t("div",null,[i[9]||(i[9]=t("label",{class:"mb-1 block text-sm font-medium text-gray-600 dark:text-gray-400"}," 客户端IP ",-1)),t("div",Ve,s(((M=g.log.request)==null?void 0:M.ip)||g.log.clientIP||"N/A"),1)])])])])]),t("div",ze,[t("div",Je,[i[17]||(i[17]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold"},[t("i",{class:"fas fa-coins mr-2"}),v(" Token使用概览 ")],-1)),t("div",We,[t("div",null,[t("div",Ge,s(o().total),1),i[11]||(i[11]=t("div",{class:"text-sm opacity-90"},"总Token数",-1))]),t("div",null,[t("div",Ye,s(o().efficiency),1),i[12]||(i[12]=t("div",{class:"text-sm opacity-90"},"使用效率",-1))])]),t("div",Qe,[t("div",Xe,[t("div",Ze,s(o().input),1),i[13]||(i[13]=t("div",{class:"opacity-75"},"输入",-1))]),t("div",ts,[t("div",es,s(o().output),1),i[14]||(i[14]=t("div",{class:"opacity-75"},"输出",-1))]),t("div",ss,[t("div",as,s(o().cacheCreate),1),i[15]||(i[15]=t("div",{class:"opacity-75"},"缓存创建",-1))]),t("div",rs,[t("div",os,s(o().cacheRead),1),i[16]||(i[16]=t("div",{class:"opacity-75"},"缓存读取",-1))])])]),t("div",ns,[i[21]||(i[21]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-dollar-sign mr-2 text-green-500"}),v(" 费用信息 ")],-1)),t("div",ls,[t("div",ds,[t("div",is," $"+s(n().total),1),i[18]||(i[18]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"总费用",-1))]),t("div",us,[t("div",cs,[t("div",gs," $"+s(n().perToken),1),i[19]||(i[19]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"每Token费用",-1))]),t("div",xs,[t("div",ys,s(n().currency),1),i[20]||(i[20]=t("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"货币单位",-1))])])])])]),t("div",ms,[i[33]||(i[33]=t("h4",{class:"mb-4 flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-pie mr-2 text-purple-500"}),v(" 数据完整性分析 ")],-1)),t("div",fs,[t("div",null,[i[26]||(i[26]=t("h5",{class:"mb-3 font-medium text-gray-900 dark:text-gray-100"},"数据可用性",-1)),t("div",bs,[t("div",vs,[i[22]||(i[22]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"基本信息",-1)),t("div",ps,[t("div",ks,[t("div",{class:"h-2 rounded-full bg-green-500",style:it(`width: ${f().basic}%`)},null,4)]),t("span",hs,s(f().basic)+"%",1)])]),t("div",$s,[i[23]||(i[23]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Token详情",-1)),t("div",ws,[t("div",_s,[t("div",{class:"h-2 rounded-full bg-blue-500",style:it(`width: ${f().tokens}%`)},null,4)]),t("span",Cs,s(f().tokens)+"%",1)])]),t("div",Ds,[i[24]||(i[24]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"费用信息",-1)),t("div",Ts,[t("div",js,[t("div",{class:"h-2 rounded-full bg-purple-500",style:it(`width: ${f().costs}%`)},null,4)]),t("span",Bs,s(f().costs)+"%",1)])]),t("div",qs,[i[25]||(i[25]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Headers信息",-1)),t("div",Ss,[t("div",Ls,[t("div",{class:"h-2 rounded-full bg-orange-500",style:it(`width: ${f().headers}%`)},null,4)]),t("span",Ns,s(f().headers)+"%",1)])])])]),t("div",null,[i[31]||(i[31]=t("h5",{class:"mb-3 font-medium text-gray-900 dark:text-gray-100"},"日志元信息",-1)),t("div",Os,[t("div",As,[i[27]||(i[27]=t("span",{class:"text-gray-600 dark:text-gray-400"},"日志版本",-1)),t("span",Is,s(g.log.logVersion||"1.0"),1)]),t("div",Rs,[i[28]||(i[28]=t("span",{class:"text-gray-600 dark:text-gray-400"},"数据优化",-1)),t("span",{class:w(g.log.dataOptimized?"text-green-600 dark:text-green-400":"text-gray-500")},s(g.log.dataOptimized?"已优化":"未优化"),3)]),i[30]||(i[30]=t("div",{class:"flex justify-between"},[t("span",{class:"text-gray-600 dark:text-gray-400"},"存储TTL"),t("span",{class:"text-gray-900 dark:text-gray-100"},"7 天")],-1)),t("div",Hs,[i[29]||(i[29]=t("span",{class:"text-gray-600 dark:text-gray-400"},"检索时间",-1)),t("span",Ks,s(V()),1)])])])]),t("div",Ms,[t("div",Ps,[i[32]||(i[32]=t("span",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"整体完整性评分",-1)),t("div",Es,[t("div",Fs,[t("div",{class:w(["h-3 rounded-full transition-all duration-500",r()]),style:it(`width: ${y()}%`)},null,6)]),t("span",{class:w(["text-xl font-bold",T()])},s(y())+"% ",3)])])])])])}}},Vs=gt(Us,[["__scopeId","data-v-ea7782be"]]),zs={class:"token-breakdown"},Js={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Ws={class:"stat-card bg-blue-50 dark:bg-blue-900/20"},Gs={class:"flex items-center justify-between"},Ys={class:"text-2xl font-bold text-blue-900 dark:text-blue-100"},Qs={class:"mt-2 text-xs text-blue-600 dark:text-blue-400"},Xs={class:"stat-card bg-green-50 dark:bg-green-900/20"},Zs={class:"flex items-center justify-between"},ta={class:"text-2xl font-bold text-green-900 dark:text-green-100"},ea={class:"mt-2 text-xs text-green-600 dark:text-green-400"},sa={class:"stat-card bg-purple-50 dark:bg-purple-900/20"},aa={class:"flex items-center justify-between"},ra={class:"text-2xl font-bold text-purple-900 dark:text-purple-100"},oa={class:"mt-2 text-xs text-purple-600 dark:text-purple-400"},na={class:"stat-card bg-orange-50 dark:bg-orange-900/20"},la={class:"flex items-center justify-between"},da={class:"text-2xl font-bold text-orange-900 dark:text-orange-100"},ia={class:"mt-2 text-xs text-orange-600 dark:text-orange-400"},ua={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},ca={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},ga={class:"relative flex h-64 items-center justify-center"},xa={key:0,class:"absolute inset-0 flex items-center justify-center"},ya={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},ma={class:"overflow-x-auto"},fa={class:"min-w-full"},ba={class:"divide-y divide-gray-200 dark:divide-gray-700"},va={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},pa={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},ka={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},ha={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},$a={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},wa={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},_a={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Ca={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Da={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Ta={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},ja={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},Ba={class:"py-2 text-right text-sm text-gray-900 dark:text-gray-100"},qa={class:"bg-gray-50 dark:bg-gray-700/50"},Sa={class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},La={class:"bg-gray-50 dark:bg-gray-700/50"},Na={class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},Oa={class:"mt-6 grid grid-cols-1 gap-6 lg:grid-cols-2"},Aa={class:"rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white"},Ia={class:"mb-2 text-3xl font-bold"},Ra={class:"text-sm opacity-90"},Ha={class:"text-sm opacity-90"},Ka={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},Ma={class:"space-y-3"},Pa={class:"flex items-center justify-between"},Ea={class:"font-semibold text-gray-900 dark:text-gray-100"},Fa={class:"flex items-center justify-between"},Ua={class:"font-semibold text-gray-900 dark:text-gray-100"},Va={class:"flex items-center justify-between"},za={__name:"TokenBreakdown",props:{tokenDetails:{type:Object,default:()=>({})},costDetails:{type:Object,default:()=>({})}},setup(g){const _=g,j=O(null);let q=null;const B=X(()=>{const k=_.tokenDetails||{};return(k.input_tokens||0)+(k.output_tokens||0)+(k.cache_creation_input_tokens||0)+(k.cache_read_input_tokens||0)>0}),S=()=>{const k=_.tokenDetails||{};return(k.input_tokens||0)+(k.output_tokens||0)+(k.cache_creation_input_tokens||0)+(k.cache_read_input_tokens||0)},C=k=>k>=1e6?(k/1e6).toFixed(1)+"M":k>=1e3?(k/1e3).toFixed(1)+"K":k.toLocaleString(),x=k=>typeof k!="number"||isNaN(k)?"0.000000":k.toFixed(6),D=k=>{const o=S();if(o===0)return"0.0";const n=_.tokenDetails||{};let f=0;switch(k){case"input":f=n.input_tokens||0;break;case"output":f=n.output_tokens||0;break;case"cache_create":f=n.cache_creation_input_tokens||0;break;case"cache_read":f=n.cache_read_input_tokens||0;break}return(f/o*100).toFixed(1)},W=()=>{var n;const k=S(),o=((n=_.costDetails)==null?void 0:n.totalCost)||0;return k===0?0:o/k},K=()=>{const k=_.tokenDetails||{},o=k.cache_read_input_tokens||0,n=(k.input_tokens||0)+(k.cache_creation_input_tokens||0)+o;return n===0?"0.0":(o/n*100).toFixed(1)},I=()=>{const k=_.tokenDetails||{},o=k.input_tokens||0,n=k.output_tokens||0;return o===0?"N/A":(n/o).toFixed(2)},G=()=>{const k=parseFloat(I());return isNaN(k)?"text-gray-500":k>.5?"text-green-600 dark:text-green-400":k>.2?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"},F=()=>{if(!j.value||!B.value)return;const k=_.tokenDetails||{},o={labels:["输入Token","输出Token","缓存创建","缓存读取"],datasets:[{data:[k.input_tokens||0,k.output_tokens||0,k.cache_creation_input_tokens||0,k.cache_read_input_tokens||0],backgroundColor:["#3B82F6","#10B981","#8B5CF6","#F59E0B"],borderWidth:0}]},n={labels:[],datasets:[{data:[],backgroundColor:[],borderWidth:0}]};o.labels.forEach((f,y)=>{o.datasets[0].data[y]>0&&(n.labels.push(f),n.datasets[0].data.push(o.datasets[0].data[y]),n.datasets[0].backgroundColor.push(o.datasets[0].backgroundColor[y]))}),q&&q.destroy(),q=new _e(j.value,{type:"doughnut",data:n,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0}}}}})};return _t(()=>{oe(()=>{B.value&&F()})}),ne(()=>_.tokenDetails,()=>{oe(()=>{B.value&&F()})},{deep:!0}),(k,o)=>{var n,f,y,r,T,V,d,i,M,L,p,R,H,A,P,z,Q,Z,tt;return u(),c("div",zs,[t("div",Js,[t("div",Ws,[t("div",Gs,[t("div",null,[o[0]||(o[0]=t("p",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"输入Token",-1)),t("p",Ys,s(C(((n=g.tokenDetails)==null?void 0:n.input_tokens)||0)),1)]),o[1]||(o[1]=t("i",{class:"fas fa-sign-in-alt text-2xl text-blue-500"},null,-1))]),t("div",Qs," 费用: $"+s(x(((f=g.costDetails)==null?void 0:f.inputCost)||0)),1)]),t("div",Xs,[t("div",Zs,[t("div",null,[o[2]||(o[2]=t("p",{class:"text-sm font-medium text-green-700 dark:text-green-300"},"输出Token",-1)),t("p",ta,s(C(((y=g.tokenDetails)==null?void 0:y.output_tokens)||0)),1)]),o[3]||(o[3]=t("i",{class:"fas fa-sign-out-alt text-2xl text-green-500"},null,-1))]),t("div",ea," 费用: $"+s(x(((r=g.costDetails)==null?void 0:r.outputCost)||0)),1)]),t("div",sa,[t("div",aa,[t("div",null,[o[4]||(o[4]=t("p",{class:"text-sm font-medium text-purple-700 dark:text-purple-300"},"缓存创建",-1)),t("p",ra,s(C(((T=g.tokenDetails)==null?void 0:T.cache_creation_input_tokens)||0)),1)]),o[5]||(o[5]=t("i",{class:"fas fa-save text-2xl text-purple-500"},null,-1))]),t("div",oa," 费用: $"+s(x(((V=g.costDetails)==null?void 0:V.cacheCreateCost)||0)),1)]),t("div",na,[t("div",la,[t("div",null,[o[6]||(o[6]=t("p",{class:"text-sm font-medium text-orange-700 dark:text-orange-300"},"缓存读取",-1)),t("p",da,s(C(((d=g.tokenDetails)==null?void 0:d.cache_read_input_tokens)||0)),1)]),o[7]||(o[7]=t("i",{class:"fas fa-download text-2xl text-orange-500"},null,-1))]),t("div",ia," 费用: $"+s(x(((i=g.costDetails)==null?void 0:i.cacheReadCost)||0)),1)])]),t("div",ua,[t("div",ca,[o[9]||(o[9]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-pie mr-2"}),v(" Token分布 ")],-1)),t("div",ga,[t("canvas",{ref_key:"tokenChart",ref:j,class:"max-h-full max-w-full"},null,512),B.value?$("",!0):(u(),c("div",xa,[...o[8]||(o[8]=[t("div",{class:"text-center text-gray-400 dark:text-gray-600"},[t("i",{class:"fas fa-chart-pie mb-2 text-4xl"}),t("p",null,"暂无Token使用数据")],-1)])]))])]),t("div",ya,[o[21]||(o[21]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-table mr-2"}),v(" 详细统计 ")],-1)),t("div",ma,[t("table",fa,[o[20]||(o[20]=t("thead",null,[t("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[t("th",{class:"py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-300"}," 类型 "),t("th",{class:"py-2 text-right text-sm font-medium text-gray-700 dark:text-gray-300"}," Token数 "),t("th",{class:"py-2 text-right text-sm font-medium text-gray-700 dark:text-gray-300"}," 费用 "),t("th",{class:"py-2 text-right text-sm font-medium text-gray-700 dark:text-gray-300"}," 占比 ")])],-1)),t("tbody",ba,[t("tr",null,[o[10]||(o[10]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"输入Token",-1)),t("td",va,s(C(((M=g.tokenDetails)==null?void 0:M.input_tokens)||0)),1),t("td",pa," $"+s(x(((L=g.costDetails)==null?void 0:L.inputCost)||0)),1),t("td",ka,s(D("input"))+"% ",1)]),t("tr",null,[o[11]||(o[11]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"输出Token",-1)),t("td",ha,s(C(((p=g.tokenDetails)==null?void 0:p.output_tokens)||0)),1),t("td",$a," $"+s(x(((R=g.costDetails)==null?void 0:R.outputCost)||0)),1),t("td",wa,s(D("output"))+"% ",1)]),t("tr",null,[o[12]||(o[12]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"缓存创建",-1)),t("td",_a,s(C(((H=g.tokenDetails)==null?void 0:H.cache_creation_input_tokens)||0)),1),t("td",Ca," $"+s(x(((A=g.costDetails)==null?void 0:A.cacheCreateCost)||0)),1),t("td",Da,s(D("cache_create"))+"% ",1)]),t("tr",null,[o[13]||(o[13]=t("td",{class:"py-2 text-sm text-gray-900 dark:text-gray-100"},"缓存读取",-1)),t("td",Ta,s(C(((P=g.tokenDetails)==null?void 0:P.cache_read_input_tokens)||0)),1),t("td",ja," $"+s(x(((z=g.costDetails)==null?void 0:z.cacheReadCost)||0)),1),t("td",Ba,s(D("cache_read"))+"% ",1)]),(Q=g.tokenDetails)!=null&&Q.cache_breakdown?(u(),c(rt,{key:0},[t("tr",qa,[o[14]||(o[14]=t("td",{class:"py-2 pl-4 text-sm text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-clock mr-1"}),v(" 5分钟缓存 ")],-1)),t("td",Sa,s(C(g.tokenDetails.cache_breakdown.ephemeral_5m_input_tokens||0)),1),o[15]||(o[15]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1)),o[16]||(o[16]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1))]),t("tr",La,[o[17]||(o[17]=t("td",{class:"py-2 pl-4 text-sm text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-hourglass-half mr-1"}),v(" 1小时缓存 ")],-1)),t("td",Na,s(C(g.tokenDetails.cache_breakdown.ephemeral_1h_input_tokens||0)),1),o[18]||(o[18]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1)),o[19]||(o[19]=t("td",{class:"py-2 text-right text-sm text-gray-700 dark:text-gray-300"},"-",-1))])],64)):$("",!0)])])])])]),t("div",Oa,[t("div",Aa,[o[22]||(o[22]=t("h4",{class:"mb-4 text-lg font-semibold"},[t("i",{class:"fas fa-dollar-sign mr-2"}),v(" 费用总计 ")],-1)),t("div",Ia,"$"+s(x(((Z=g.costDetails)==null?void 0:Z.totalCost)||0)),1),t("div",Ra," 平均每Token: $"+s(x(W())),1),t("div",Ha,"货币: "+s(((tt=g.costDetails)==null?void 0:tt.currency)||"USD"),1)]),t("div",Ka,[o[26]||(o[26]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-line mr-2"}),v(" 效率分析 ")],-1)),t("div",Ma,[t("div",Pa,[o[23]||(o[23]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"总Token数",-1)),t("span",Ea,s(C(S())),1)]),t("div",Fa,[o[24]||(o[24]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"缓存命中率",-1)),t("span",Ua,s(K())+"% ",1)]),t("div",Va,[o[25]||(o[25]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"Token效率",-1)),t("span",{class:w(["font-semibold",G()])},s(I()),3)])])])])])}}},Ja=gt(za,[["__scopeId","data-v-8814da88"]]),Wa={class:"headers-viewer"},Ga={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-3"},Ya={class:"stat-card bg-blue-50 dark:bg-blue-900/20"},Qa={class:"flex items-center justify-between"},Xa={class:"text-2xl font-bold text-blue-900 dark:text-blue-100"},Za={class:"stat-card bg-green-50 dark:bg-green-900/20"},tr={class:"flex items-center justify-between"},er={class:"text-2xl font-bold text-green-900 dark:text-green-100"},sr={class:"stat-card bg-purple-50 dark:bg-purple-900/20"},ar={class:"flex items-center justify-between"},rr={class:"text-2xl font-bold text-purple-900 dark:text-purple-100"},or={class:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},nr={class:"max-w-md flex-1"},lr={class:"relative"},dr={class:"flex items-center gap-2"},ir={class:"space-y-6"},ur={key:0,class:"rounded-lg bg-white shadow dark:bg-gray-800"},cr={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},gr={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},xr={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},yr={class:"p-6"},mr={key:0,class:"py-8 text-center"},fr={class:"text-gray-500 dark:text-gray-400"},br={key:1,class:"space-y-3"},vr={class:"flex items-start justify-between rounded-lg bg-gray-50 px-4 py-3 transition-colors duration-200 hover:bg-gray-100 dark:bg-gray-700/50 dark:hover:bg-gray-700"},pr={class:"min-w-0 flex-1"},kr={class:"mb-1 flex items-center gap-2"},hr={class:"font-medium text-gray-900 dark:text-gray-100"},$r={class:"break-all text-sm text-gray-600 dark:text-gray-400"},wr=["title","onClick"],_r={key:1,class:"rounded-lg bg-white shadow dark:bg-gray-800"},Cr={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},Dr={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},Tr={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},jr={class:"p-6"},Br={key:0,class:"py-8 text-center"},qr={class:"text-gray-500 dark:text-gray-400"},Sr={key:1,class:"space-y-3"},Lr={class:"flex items-start justify-between rounded-lg bg-gray-50 px-4 py-3 transition-colors duration-200 hover:bg-gray-100 dark:bg-gray-700/50 dark:hover:bg-gray-700"},Nr={class:"min-w-0 flex-1"},Or={class:"mb-1 flex items-center gap-2"},Ar={class:"font-medium text-gray-900 dark:text-gray-100"},Ir={class:"break-all text-sm text-gray-600 dark:text-gray-400"},Rr=["title","onClick"],Hr={key:0,class:"mt-6"},Kr={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},Mr={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Pr={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},Er={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},Fr={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},Ur={class:"text-2xl font-bold text-green-600 dark:text-green-400"},Vr={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},zr={class:"text-2xl font-bold text-purple-600 dark:text-purple-400"},Jr={class:"rounded-lg bg-gray-50 p-3 text-center dark:bg-gray-700/50"},Wr={class:"text-2xl font-bold text-orange-600 dark:text-orange-400"},Gr={__name:"HeadersViewer",props:{requestHeaders:{type:Object,default:()=>({})},responseHeaders:{type:Object,default:()=>({})}},setup(g){const _=g,j=O(""),q=O(!0),B=O(!0),S=X(()=>Object.keys(_.requestHeaders||{}).length>0||Object.keys(_.responseHeaders||{}).length>0),C=X(()=>{let o=0;return Object.entries(_.requestHeaders||{}).forEach(([n,f])=>{o+=n.length+String(f).length}),Object.entries(_.responseHeaders||{}).forEach(([n,f])=>{o+=n.length+String(f).length}),o}),x=X(()=>{const o=_.requestHeaders||{},n=Object.entries(o);if(!j.value)return n;const f=j.value.toLowerCase();return n.filter(([y,r])=>y.toLowerCase().includes(f)||String(r).toLowerCase().includes(f))}),D=X(()=>{const o=_.responseHeaders||{},n=Object.entries(o);if(!j.value)return n;const f=j.value.toLowerCase();return n.filter(([y,r])=>y.toLowerCase().includes(f)||String(r).toLowerCase().includes(f))}),W=o=>{if(o===0)return"0 B";const n=1024,f=["B","KB","MB","GB"],y=Math.floor(Math.log(o)/Math.log(n));return parseFloat((o/Math.pow(n,y)).toFixed(2))+" "+f[y]},K=o=>typeof o!="string"?String(o):o.length>100?o.substring(0,97)+"...":o,I=o=>{const n=o.toLowerCase();return["authorization","cookie","set-cookie","x-csrf-token","x-frame-options","x-content-type-options"].includes(n)?"安全":["cache-control","expires","etag","if-none-match","if-modified-since","last-modified"].includes(n)?"缓存":["content-type","content-length","content-encoding","accept","accept-encoding","accept-language"].includes(n)?"内容":n.startsWith("x-")||n.startsWith("anthropic-")?"自定义":"标准"},G=o=>{const n=I(o),f={安全:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300",缓存:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",内容:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",自定义:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",标准:"bg-gray-100 text-gray-700 dark:bg-gray-700/50 dark:text-gray-300"};return f[n]||f.标准},F=o=>{const n={..._.requestHeaders,..._.responseHeaders};let f=0;return Object.keys(n).forEach(y=>{const r=I(y);(o==="security"&&r==="安全"||o==="cache"&&r==="缓存"||o==="content"&&r==="内容"||o==="custom"&&r==="自定义")&&f++}),f},k=async o=>{try{await navigator.clipboard.writeText(o),console.log("已复制到剪贴板")}catch(n){console.error("复制失败:",n)}};return(o,n)=>(u(),c("div",Wa,[t("div",Ga,[t("div",Ya,[t("div",Qa,[t("div",null,[n[3]||(n[3]=t("p",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"请求头数量",-1)),t("p",Xa,s(Object.keys(g.requestHeaders||{}).length),1)]),n[4]||(n[4]=t("i",{class:"fas fa-arrow-up text-2xl text-blue-500"},null,-1))])]),t("div",Za,[t("div",tr,[t("div",null,[n[5]||(n[5]=t("p",{class:"text-sm font-medium text-green-700 dark:text-green-300"},"响应头数量",-1)),t("p",er,s(Object.keys(g.responseHeaders||{}).length),1)]),n[6]||(n[6]=t("i",{class:"fas fa-arrow-down text-2xl text-green-500"},null,-1))])]),t("div",sr,[t("div",ar,[t("div",null,[n[7]||(n[7]=t("p",{class:"text-sm font-medium text-purple-700 dark:text-purple-300"},"总大小",-1)),t("p",rr,s(W(C.value)),1)]),n[8]||(n[8]=t("i",{class:"fas fa-weight-hanging text-2xl text-purple-500"},null,-1))])])]),t("div",or,[t("div",nr,[t("div",lr,[Y(t("input",{"onUpdate:modelValue":n[0]||(n[0]=f=>j.value=f),class:"w-full rounded-lg border border-gray-300 bg-white py-2 pl-10 pr-4 text-gray-900 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",placeholder:"搜索请求头或响应头...",type:"text"},null,512),[[ct,j.value]]),n[9]||(n[9]=t("i",{class:"fas fa-search absolute left-3 top-3 text-gray-400"},null,-1))])]),t("div",dr,[t("button",{class:w(["rounded-lg px-3 py-2 text-sm font-medium transition-colors",q.value?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:n[1]||(n[1]=f=>q.value=!q.value)},[...n[10]||(n[10]=[t("i",{class:"fas fa-arrow-up mr-1"},null,-1),v(" 请求头 ",-1)])],2),t("button",{class:w(["rounded-lg px-3 py-2 text-sm font-medium transition-colors",B.value?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:n[2]||(n[2]=f=>B.value=!B.value)},[...n[11]||(n[11]=[t("i",{class:"fas fa-arrow-down mr-1"},null,-1),v(" 响应头 ",-1)])],2)])]),t("div",ir,[q.value?(u(),c("div",ur,[t("div",cr,[t("h4",gr,[n[12]||(n[12]=t("i",{class:"fas fa-arrow-up mr-2 text-blue-500"},null,-1)),n[13]||(n[13]=v(" 请求头 ",-1)),t("span",xr," ("+s(x.value.length)+" 个) ",1)])]),t("div",yr,[x.value.length===0?(u(),c("div",mr,[n[14]||(n[14]=t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1)),t("p",fr,s(j.value?"没有找到匹配的请求头":"暂无请求头信息"),1)])):(u(),c("div",br,[(u(!0),c(rt,null,nt(x.value,([f,y])=>(u(),c("div",{key:`req-${f}`,class:"header-item group"},[t("div",vr,[t("div",pr,[t("div",kr,[t("span",hr,s(f),1),t("span",{class:w(["rounded-full px-2 py-1 text-xs",G(f)])},s(I(f)),3)]),t("div",$r,s(K(y)),1)]),t("button",{class:"ml-3 p-2 text-gray-400 opacity-0 transition-all duration-200 hover:text-gray-600 group-hover:opacity-100 dark:hover:text-gray-300",title:`复制 ${f}`,onClick:r=>k(`${f}: ${y}`)},[...n[15]||(n[15]=[t("i",{class:"fas fa-copy text-sm"},null,-1)])],8,wr)])]))),128))]))])])):$("",!0),B.value?(u(),c("div",_r,[t("div",Cr,[t("h4",Dr,[n[16]||(n[16]=t("i",{class:"fas fa-arrow-down mr-2 text-green-500"},null,-1)),n[17]||(n[17]=v(" 响应头 ",-1)),t("span",Tr," ("+s(D.value.length)+" 个) ",1)])]),t("div",jr,[D.value.length===0?(u(),c("div",Br,[n[18]||(n[18]=t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1)),t("p",qr,s(j.value?"没有找到匹配的响应头":"暂无响应头信息"),1)])):(u(),c("div",Sr,[(u(!0),c(rt,null,nt(D.value,([f,y])=>(u(),c("div",{key:`res-${f}`,class:"header-item group"},[t("div",Lr,[t("div",Nr,[t("div",Or,[t("span",Ar,s(f),1),t("span",{class:w(["rounded-full px-2 py-1 text-xs",G(f)])},s(I(f)),3)]),t("div",Ir,s(K(y)),1)]),t("button",{class:"ml-3 p-2 text-gray-400 opacity-0 transition-all duration-200 hover:text-gray-600 group-hover:opacity-100 dark:hover:text-gray-300",title:`复制 ${f}`,onClick:r=>k(`${f}: ${y}`)},[...n[19]||(n[19]=[t("i",{class:"fas fa-copy text-sm"},null,-1)])],8,Rr)])]))),128))]))])])):$("",!0)]),S.value?(u(),c("div",Hr,[t("div",Kr,[n[24]||(n[24]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-chart-bar mr-2"}),v(" Header分析 ")],-1)),t("div",Mr,[t("div",Pr,[t("div",Er,s(F("security")),1),n[20]||(n[20]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"安全相关",-1))]),t("div",Fr,[t("div",Ur,s(F("cache")),1),n[21]||(n[21]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"缓存控制",-1))]),t("div",Vr,[t("div",zr,s(F("content")),1),n[22]||(n[22]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"内容类型",-1))]),t("div",Jr,[t("div",Wr,s(F("custom")),1),n[23]||(n[23]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"自定义头",-1))])])])])):$("",!0)]))}},Yr=gt(Gr,[["__scopeId","data-v-8e3597c3"]]),Qr={class:"message-content"},Xr={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Zr={class:"stat-card bg-blue-50 dark:bg-blue-900/20"},to={class:"flex items-center justify-between"},eo={class:"text-2xl font-bold text-blue-900 dark:text-blue-100"},so={class:"stat-card bg-green-50 dark:bg-green-900/20"},ao={class:"flex items-center justify-between"},ro={class:"text-2xl font-bold text-green-900 dark:text-green-100"},oo={class:"stat-card bg-purple-50 dark:bg-purple-900/20"},no={class:"flex items-center justify-between"},lo={class:"text-2xl font-bold text-purple-900 dark:text-purple-100"},io={class:"stat-card bg-orange-50 dark:bg-orange-900/20"},uo={class:"flex items-center justify-between"},co={class:"text-lg font-bold text-orange-900 dark:text-orange-100"},go={class:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},xo={class:"flex items-center gap-2"},yo={class:"flex items-center gap-2"},mo={class:"relative"},fo={class:"space-y-6"},bo={key:0,class:"rounded-lg bg-white shadow dark:bg-gray-800"},vo={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},po={class:"flex items-center justify-between"},ko={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},ho={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},$o={class:"flex items-center gap-2"},wo={class:"p-6"},_o={key:0,class:"py-12 text-center"},Co={key:1,class:"relative"},Do={class:"content-container"},To={key:0,class:"content-block raw-content"},jo=["innerHTML"],Bo={key:2,class:"content-block pretty-content"},qo={class:"mt-4 flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400"},So={key:0},Lo={key:1,class:"rounded-lg bg-white shadow dark:bg-gray-800"},No={class:"border-b border-gray-200 px-6 py-4 dark:border-gray-700"},Oo={class:"flex items-center justify-between"},Ao={class:"flex items-center text-lg font-semibold text-gray-900 dark:text-gray-100"},Io={class:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"},Ro={class:"flex items-center gap-2"},Ho={class:"p-6"},Ko={key:0,class:"py-12 text-center"},Mo={key:1,class:"relative"},Po={class:"content-container"},Eo={key:0,class:"content-block raw-content"},Fo=["innerHTML"],Uo={key:2,class:"content-block pretty-content"},Vo={class:"mt-4 flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400"},zo={key:0},Jo={key:0,class:"mt-6"},Wo={class:"rounded-lg bg-white p-6 shadow dark:bg-gray-800"},Go={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Yo={class:"rounded-lg bg-blue-50 p-4 dark:bg-blue-900/20"},Qo={class:"space-y-1 text-sm text-blue-800 dark:text-blue-200"},Xo={class:"rounded-lg bg-green-50 p-4 dark:bg-green-900/20"},Zo={class:"space-y-1 text-sm text-green-800 dark:text-green-200"},tn={__name:"MessageContent",props:{requestBody:{type:[String,Object],default:null},responseBody:{type:[String,Object],default:null}},setup(g){const _=g,j=O("request"),q=O("formatted"),B=O(""),S=y=>{if(y===0)return"0 B";const r=1024,T=["B","KB","MB","GB"],V=Math.floor(Math.log(y)/Math.log(r));return parseFloat((y/Math.pow(r,V)).toFixed(2))+" "+T[V]},C=y=>y?typeof y=="string"?y.length:JSON.stringify(y).length:0,x=y=>y?typeof y=="string"?y:JSON.stringify(y,null,2):"",D=y=>{if(!y)return"";try{if(typeof y=="string"){const r=JSON.parse(y);return JSON.stringify(r,null,2)}return JSON.stringify(y,null,2)}catch{return x(y)}},W=(y,r=!1)=>{if(!y)return"";let T=x(y);return r&&K(y)&&(T=T.replace(/(".*?")/g,'<span class="json-string">$1</span>').replace(/(\b\d+\b)/g,'<span class="json-number">$1</span>').replace(/(\btrue\b|\bfalse\b|\bnull\b)/g,'<span class="json-boolean">$1</span>').replace(/([{}[\],])/g,'<span class="json-key">$1</span>')),`<pre class="whitespace-pre-wrap"><code>${T}</code></pre>`},K=y=>{if(typeof y=="object")return!0;if(typeof y=="string")try{return JSON.parse(y),!0}catch{return!1}return!1},I=y=>x(y).split(`
`).length,G=y=>x(y).length,F=()=>{let y=0;if(_.requestBody)try{const r=typeof _.requestBody=="string"?JSON.parse(_.requestBody):_.requestBody;r.messages&&Array.isArray(r.messages)&&(y+=r.messages.length)}catch{}return y||"—"},k=()=>{const y=K(_.requestBody),r=K(_.responseBody);return y&&r?"JSON":y||r?"Mixed":_.requestBody||_.responseBody?"Text":"—"},o=y=>{if(!B.value||!y)return y;const r=B.value,T=new RegExp(`(${r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return y.replace(T,'<mark class="bg-yellow-200 dark:bg-yellow-800">$1</mark>')},n=async y=>{try{await navigator.clipboard.writeText(y),console.log("已复制到剪贴板")}catch(r){console.error("复制失败:",r)}},f=(y,r)=>{const T=new Blob([y],{type:"application/json"}),V=URL.createObjectURL(T),d=document.createElement("a");d.href=V,d.download=r,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(V)};return(y,r)=>(u(),c("div",Qr,[t("div",Xr,[t("div",Zr,[t("div",to,[t("div",null,[r[8]||(r[8]=t("p",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"请求体大小",-1)),t("p",eo,s(S(C(g.requestBody))),1)]),r[9]||(r[9]=t("i",{class:"fas fa-upload text-2xl text-blue-500"},null,-1))])]),t("div",so,[t("div",ao,[t("div",null,[r[10]||(r[10]=t("p",{class:"text-sm font-medium text-green-700 dark:text-green-300"},"响应体大小",-1)),t("p",ro,s(S(C(g.responseBody))),1)]),r[11]||(r[11]=t("i",{class:"fas fa-download text-2xl text-green-500"},null,-1))])]),t("div",oo,[t("div",no,[t("div",null,[r[12]||(r[12]=t("p",{class:"text-sm font-medium text-purple-700 dark:text-purple-300"},"消息数量",-1)),t("p",lo,s(F()),1)]),r[13]||(r[13]=t("i",{class:"fas fa-comments text-2xl text-purple-500"},null,-1))])]),t("div",io,[t("div",uo,[t("div",null,[r[14]||(r[14]=t("p",{class:"text-sm font-medium text-orange-700 dark:text-orange-300"},"数据格式",-1)),t("p",co,s(k()),1)]),r[15]||(r[15]=t("i",{class:"fas fa-file-code text-2xl text-orange-500"},null,-1))])])]),t("div",go,[t("div",xo,[t("button",{class:w(["rounded-lg px-4 py-2 text-sm font-medium transition-colors",j.value==="request"?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:r[0]||(r[0]=T=>j.value="request")},[...r[16]||(r[16]=[t("i",{class:"fas fa-upload mr-1"},null,-1),v(" 请求内容 ",-1)])],2),t("button",{class:w(["rounded-lg px-4 py-2 text-sm font-medium transition-colors",j.value==="response"?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:r[1]||(r[1]=T=>j.value="response")},[...r[17]||(r[17]=[t("i",{class:"fas fa-download mr-1"},null,-1),v(" 响应内容 ",-1)])],2)]),t("div",yo,[t("div",mo,[Y(t("input",{"onUpdate:modelValue":r[2]||(r[2]=T=>B.value=T),class:"rounded-lg border border-gray-300 bg-white py-2 pl-8 pr-4 text-sm text-gray-900 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",placeholder:"搜索内容...",type:"text"},null,512),[[ct,B.value]]),r[18]||(r[18]=t("i",{class:"fas fa-search absolute left-2.5 top-2.5 text-sm text-gray-400"},null,-1))]),Y(t("select",{"onUpdate:modelValue":r[3]||(r[3]=T=>q.value=T),class:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100"},[...r[19]||(r[19]=[t("option",{value:"formatted"},"格式化",-1),t("option",{value:"raw"},"原始",-1),t("option",{value:"pretty"},"美化",-1)])],512),[[ut,q.value]])])]),t("div",fo,[j.value==="request"?(u(),c("div",bo,[t("div",vo,[t("div",po,[t("h4",ko,[r[20]||(r[20]=t("i",{class:"fas fa-upload mr-2 text-blue-500"},null,-1)),r[21]||(r[21]=v(" 请求内容 ",-1)),t("span",ho,s(C(g.requestBody)>0?S(C(g.requestBody)):"无内容"),1)]),t("div",$o,[g.requestBody?(u(),c("button",{key:0,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"复制内容",onClick:r[4]||(r[4]=T=>n(x(g.requestBody)))},[...r[22]||(r[22]=[t("i",{class:"fas fa-copy"},null,-1)])])):$("",!0),g.requestBody?(u(),c("button",{key:1,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"下载内容",onClick:r[5]||(r[5]=T=>f(x(g.requestBody),"request.json"))},[...r[23]||(r[23]=[t("i",{class:"fas fa-download"},null,-1)])])):$("",!0)])])]),t("div",wo,[g.requestBody?(u(),c("div",Co,[t("div",Do,[q.value==="raw"?(u(),c("pre",To,[t("code",null,s(o(x(g.requestBody))),1)])):q.value==="formatted"?(u(),c("div",{key:1,class:"content-block formatted-content",innerHTML:W(g.requestBody,!0)},null,8,jo)):(u(),c("pre",Bo,[t("code",null,s(o(D(g.requestBody))),1)]))]),t("div",qo,[t("span",null,[r[25]||(r[25]=t("i",{class:"fas fa-align-left mr-1"},null,-1)),v(s(I(g.requestBody))+" 行",1)]),t("span",null,[r[26]||(r[26]=t("i",{class:"fas fa-font mr-1"},null,-1)),v(s(G(g.requestBody))+" 字符",1)]),K(g.requestBody)?(u(),c("span",So,[...r[27]||(r[27]=[t("i",{class:"fas fa-code mr-1"},null,-1),v("JSON 格式 ",-1)])])):$("",!0)])])):(u(),c("div",_o,[...r[24]||(r[24]=[t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1),t("p",{class:"text-gray-500 dark:text-gray-400"},"暂无请求内容",-1)])]))])])):$("",!0),j.value==="response"?(u(),c("div",Lo,[t("div",No,[t("div",Oo,[t("h4",Ao,[r[28]||(r[28]=t("i",{class:"fas fa-download mr-2 text-green-500"},null,-1)),r[29]||(r[29]=v(" 响应内容 ",-1)),t("span",Io,s(C(g.responseBody)>0?S(C(g.responseBody)):"无内容"),1)]),t("div",Ro,[g.responseBody?(u(),c("button",{key:0,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"复制内容",onClick:r[6]||(r[6]=T=>n(x(g.responseBody)))},[...r[30]||(r[30]=[t("i",{class:"fas fa-copy"},null,-1)])])):$("",!0),g.responseBody?(u(),c("button",{key:1,class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",title:"下载内容",onClick:r[7]||(r[7]=T=>f(x(g.responseBody),"response.json"))},[...r[31]||(r[31]=[t("i",{class:"fas fa-download"},null,-1)])])):$("",!0)])])]),t("div",Ho,[g.responseBody?(u(),c("div",Mo,[t("div",Po,[q.value==="raw"?(u(),c("pre",Eo,[t("code",null,s(o(x(g.responseBody))),1)])):q.value==="formatted"?(u(),c("div",{key:1,class:"content-block formatted-content",innerHTML:W(g.responseBody,!0)},null,8,Fo)):(u(),c("pre",Uo,[t("code",null,s(o(D(g.responseBody))),1)]))]),t("div",Vo,[t("span",null,[r[33]||(r[33]=t("i",{class:"fas fa-align-left mr-1"},null,-1)),v(s(I(g.responseBody))+" 行",1)]),t("span",null,[r[34]||(r[34]=t("i",{class:"fas fa-font mr-1"},null,-1)),v(s(G(g.responseBody))+" 字符",1)]),K(g.responseBody)?(u(),c("span",zo,[...r[35]||(r[35]=[t("i",{class:"fas fa-code mr-1"},null,-1),v("JSON 格式 ",-1)])])):$("",!0)])])):(u(),c("div",Ko,[...r[32]||(r[32]=[t("i",{class:"fas fa-inbox mb-3 text-4xl text-gray-300 dark:text-gray-600"},null,-1),t("p",{class:"text-gray-500 dark:text-gray-400"},"暂无响应内容",-1)])]))])])):$("",!0)]),g.requestBody&&g.responseBody?(u(),c("div",Jo,[t("div",Wo,[r[38]||(r[38]=t("h4",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100"},[t("i",{class:"fas fa-balance-scale mr-2"}),v(" 内容对比 ")],-1)),t("div",Go,[t("div",Yo,[r[36]||(r[36]=t("h5",{class:"mb-2 font-medium text-blue-900 dark:text-blue-100"},"请求摘要",-1)),t("div",Qo,[t("div",null,"大小: "+s(S(C(g.requestBody))),1),t("div",null,"行数: "+s(I(g.requestBody)),1),t("div",null,"格式: "+s(K(g.requestBody)?"JSON":"文本"),1)])]),t("div",Xo,[r[37]||(r[37]=t("h5",{class:"mb-2 font-medium text-green-900 dark:text-green-100"},"响应摘要",-1)),t("div",Zo,[t("div",null,"大小: "+s(S(C(g.responseBody))),1),t("div",null,"行数: "+s(I(g.responseBody)),1),t("div",null,"格式: "+s(K(g.responseBody)?"JSON":"文本"),1)])])])])])):$("",!0)]))}},en=gt(tn,[["__scopeId","data-v-847c2f90"]]),sn={class:"request-logs-container"},an={class:"mb-6 flex items-center justify-between"},rn={key:0,class:"mt-2 flex items-center text-sm text-red-600 dark:text-red-400"},on={class:"flex items-center space-x-3"},nn=["aria-label","disabled"],ln={class:"relative"},dn=["aria-label","disabled"],un={key:0,"aria-label":"导出格式选择",class:"absolute right-0 top-full z-50 mt-2 w-48 rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5 dark:bg-gray-800",role:"menu"},cn={class:"py-1"},gn={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},xn={class:"stat-card"},yn={class:"flex items-center justify-between"},mn={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},fn={class:"stat-card"},bn={class:"flex items-center justify-between"},vn={class:"text-2xl font-bold text-red-600 dark:text-red-400"},pn={class:"stat-card"},kn={class:"flex items-center justify-between"},hn={class:"text-2xl font-bold text-green-600 dark:text-green-400"},$n={class:"stat-card"},wn={class:"flex items-center justify-between"},_n={class:"text-2xl font-bold text-purple-600 dark:text-purple-400"},Cn={class:"card mb-6 p-4"},Dn={class:"mb-4 flex items-center justify-between"},Tn={class:"flex items-center space-x-2"},jn=["aria-label"],Bn={class:"relative"},qn={class:"relative"},Sn=["aria-describedby"],Ln={class:"absolute right-2 top-1/2 -translate-y-1/2"},Nn={key:0,class:"loading-spinner h-4 w-4"},On={key:2,class:"fas fa-search text-sm text-gray-400"},An={key:0,id:"search-results-info",class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},In={key:0},Rn={key:1},Hn={class:"relative"},Kn=["disabled"],Mn=["value"],Pn={key:0,class:"absolute right-3 top-1/2 -translate-y-1/2"},En={key:0,class:"mt-1 text-xs text-red-600 dark:text-red-400"},Fn={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Un={key:0,class:"mt-4"},Vn={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},zn={key:0,class:"mt-2 text-sm text-red-600 dark:text-red-400"},Jn={key:1,class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},Wn={key:0,class:"card mb-6 p-6"},Gn={class:"text-center"},Yn={class:"mb-4 text-sm text-gray-600 dark:text-gray-400"},Qn={class:"flex flex-col items-center space-y-2 sm:flex-row sm:justify-center sm:space-x-4 sm:space-y-0"},Xn={key:1,class:"card"},Zn={class:"flex flex-col space-y-3 border-b border-gray-200 p-4 dark:border-gray-700 sm:flex-row sm:items-center sm:justify-between sm:space-y-0"},tl={class:"flex items-center space-x-4"},el={class:"text-sm text-gray-600 dark:text-gray-400"},sl={key:0,class:"flex items-center text-xs text-green-600 dark:text-green-400"},al={class:"flex items-center space-x-2"},rl={class:"flex items-center space-x-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-800"},ol={key:0,class:"p-8"},nl={class:"space-y-3"},ll={key:1,class:"py-12 text-center"},dl={class:"mb-2 text-lg font-semibold text-gray-900 dark:text-gray-100"},il={class:"space-y-2 text-sm text-gray-600 dark:text-gray-400"},ul={key:0},cl={key:1},gl={class:"mt-4 flex flex-col items-center space-y-2 sm:flex-row sm:justify-center sm:space-x-4 sm:space-y-0"},xl={key:2,class:"overflow-x-auto"},yl={"aria-label":"请求日志列表",class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",role:"table"},ml={class:"bg-gray-50 dark:bg-gray-800"},fl={class:"flex items-center space-x-1"},bl={class:"flex items-center space-x-1"},vl={class:"flex items-center space-x-1"},pl={class:"flex items-center space-x-1"},kl={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},hl={class:"table-cell"},$l={class:"text-sm text-gray-900 dark:text-gray-100"},wl={class:"table-cell"},_l={class:"flex items-center space-x-2"},Cl=["title"],Dl={class:"table-cell"},Tl={class:"table-cell"},jl=["title"],Bl={class:"table-cell"},ql={class:"table-cell"},Sl={class:"flex items-center space-x-1"},Ll={class:"text-sm text-gray-900 dark:text-gray-100"},Nl={key:0,class:"fas fa-exclamation-triangle text-xs text-yellow-500",title:"响应时间较慢"},Ol={class:"table-cell"},Al={class:"text-sm"},Il={class:"flex items-center space-x-1 text-blue-600 dark:text-blue-400"},Rl={key:0,class:"mt-1 text-xs text-green-600 dark:text-green-400"},Hl={class:"table-cell"},Kl={class:"text-sm font-medium"},Ml={key:0,class:"text-green-600 dark:text-green-400"},Pl={key:1,class:"text-gray-400"},El={class:"table-cell"},Fl={class:"text-sm text-gray-600 dark:text-gray-400"},Ul={class:"table-cell"},Vl=["aria-label","onClick"],zl={key:3,class:"divide-y divide-gray-200 dark:divide-gray-700"},Jl={class:"flex items-start justify-between"},Wl={class:"flex-1 space-y-2"},Gl={class:"flex items-center justify-between"},Yl={class:"flex items-center space-x-3"},Ql={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Xl={class:"flex items-center space-x-1"},Zl=["title"],td=["onClick"],ed={class:"flex items-center space-x-2"},sd={class:"truncate text-sm text-gray-900 dark:text-gray-100"},ad={class:"flex items-center justify-between text-sm"},rd={class:"flex items-center space-x-2"},od={class:"text-gray-600 dark:text-gray-400"},nd={class:"flex flex-col items-end text-xs"},ld={class:"flex items-center space-x-1 text-blue-600 dark:text-blue-400"},dd={key:0,class:"text-green-600 dark:text-green-400"},id={class:"mt-2 text-xs text-gray-500 dark:text-gray-500"},ud={key:4,class:"flex items-center justify-between border-t border-gray-200 px-4 py-3 dark:border-gray-700"},cd={class:"flex items-center space-x-2"},gd=["disabled"],xd={class:"text-sm text-gray-600 dark:text-gray-400"},yd=["disabled"],md={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},fd={class:"modal-content relative mx-auto flex max-h-[95vh] w-[95%] max-w-6xl flex-col p-4 sm:w-full sm:p-6"},bd={class:"mb-4 flex items-center justify-between sm:mb-6"},vd={class:"flex items-center gap-3"},pd={class:"text-sm text-gray-600 dark:text-gray-400"},kd={class:"mb-6 border-b border-gray-200 dark:border-gray-700"},hd={"aria-label":"Tabs",class:"-mb-px flex space-x-8"},$d=["onClick"],wd={key:0,class:"ml-2 inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"},_d={class:"modal-scroll-content custom-scrollbar flex-1 overflow-y-auto"},Cd={key:0,class:"tab-content"},Dd={key:1,class:"tab-content"},Td={key:2,class:"tab-content"},jd={key:3,class:"tab-content"},Bd={class:"mt-6 flex justify-between border-t border-gray-200 pt-6 dark:border-gray-700"},qd={class:"flex items-center space-x-4"},Sd={class:"text-sm text-gray-500 dark:text-gray-400"},Ld={class:"text-sm text-gray-500 dark:text-gray-400"},Nd={class:"flex gap-3"},Od=["disabled"],Ad={class:"max-h-[90vh] w-full max-w-2xl overflow-hidden rounded-lg bg-white shadow-xl dark:bg-gray-800"},Id={class:"flex items-center justify-between border-b border-gray-200 px-6 py-4 dark:border-gray-700"},Rd={class:"max-h-[calc(90vh-120px)] overflow-y-auto p-6"},Hd={class:"space-y-4"},Kd={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Md={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Pd={key:0},Ed={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Fd={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Ud={class:"mt-1 space-y-2 text-sm text-gray-600 dark:text-gray-400"},Vd={key:0},zd={key:1},Jd={key:2},Wd={key:3},Gd={__name:"RequestLogsView",setup(g){const _=(a,e)=>{let m;return(...h)=>{clearTimeout(m),m=setTimeout(()=>a.apply(this,h),e)}},j=we(),{logs:q,loading:B,exporting:S,stats:C,filters:x,pagination:D,filteredLogs:W,hasFilters:K,apiKeyLoading:I,apiKeyMap:G}=ve(j),{fetchLogs:F,fetchStats:k,exportLogs:o,updateFilters:n,clearFilters:f,refreshLogs:y,formatLogEntry:r,getStatusClass:T,getMethodClass:V,formatDuration:d,fetchApiKeys:i,fetchLogDetails:M}=j,L=O(!1),p=O(null),R=O("24h"),H=O(""),A=O(null),P=O(!1),z=O(null),Q=O(!1),Z=O(!1),tt=O("table"),Ct=O(!1),xt=O(!1),Dt=O(0),et=O("overview"),le=O([{id:"overview",name:"概览",icon:"fas fa-info-circle"},{id:"tokens",name:"Token详情",icon:"fas fa-coins",badge:!0},{id:"headers",name:"请求头",icon:"fas fa-list-ul",badge:!0},{id:"content",name:"消息内容",icon:"fas fa-file-text",badge:!0}]),lt=a=>{var m;if(!a||a===null||a===void 0)return"Unknown";if(z.value)return`${a} (无法验证)`;if(I.value)return`${a} (加载中...)`;const e=(m=G.value)==null?void 0:m.get(a);return e!=null&&e.name?e.name:`${a} (已删除)`},de=X(()=>{var e;return(((e=C.value)==null?void 0:e.topApiKeys)||[]).map(m=>({id:m.keyId,name:lt(m.keyId),count:m.count,displayText:`${lt(m.keyId)} (${m.count}次使用)`}))}),dt=X(()=>{const a=Array.isArray(q.value)?q.value:[];if(!x.search)return a;const e=String(x.search||"").toLowerCase();return e?a.filter(m=>{var h,N,E,U;return((h=m==null?void 0:m.keyName)==null?void 0:h.toLowerCase().includes(e))||((N=m==null?void 0:m.userAgent)==null?void 0:N.toLowerCase().includes(e))||((E=m==null?void 0:m.ipAddress)==null?void 0:E.includes(e))||((U=m==null?void 0:m.path)==null?void 0:U.toLowerCase().includes(e))}):a}),yt=X(()=>{let a=[];return a=Array.isArray(W.value)?W.value:[],a.map(e=>({...e,formattedKeyName:e.keyName||lt(e.keyId),mergeInfo:e._mergedCount>1?{count:e._mergedCount,tooltip:`此记录合并了 ${e._mergedCount} 条相关日志`}:null}))}),Tt=_(async()=>{Q.value=!0;try{await st()}finally{Q.value=!1}},500),ie=X(()=>R.value!=="custom"?{"1h":"最近 1 小时","24h":"最近 24 小时","7d":"最近 7 天","30d":"最近 30 天"}[R.value]||"":x.startDate&&x.endDate?`${x.startDate} 至 ${x.endDate}`:"请设置时间范围");ne(()=>[x.startDate,x.endDate],([a,e])=>{R.value==="custom"&&a&&e&&(H.value="",ue())});const ue=_(async()=>{R.value==="custom"&&await Nt()},1e3),ce=()=>{var m;const a=(D==null?void 0:D.total)||0,e=((m=yt.value)==null?void 0:m.length)||0;return x!=null&&x.search?`找到 ${dt.value?dt.value.length:0} 条匹配结果，共 ${a} 条记录`:`显示 ${e} 条记录，共 ${a} 条`},ge=a=>a?a.code==="NETWORK_ERROR"?"网络连接失败，请检查网络连接后重试":a.code==="TIMEOUT"?"请求超时，服务器响应缓慢":a.status===401?"认证失败，请重新登录":a.status===403?"没有权限访问此资源":a.status>=500?"服务器内部错误，请稍后重试或联系技术支持":a.message||"请求失败，请重试":"未知错误",xe=()=>{n({search:""}),st()},jt=()=>{f(),st()},Bt=async()=>{A.value=null,P.value=!1,Dt.value++;try{await $t(),ot("数据加载成功","success")}catch(a){A.value=a,ot("重试失败，请检查网络连接","error")}},ye=a=>`${(a*100).toFixed(1)}%`,qt=a=>{if(a.tokenDetails){const E=a.tokenDetails.inputTokens||0,U=a.tokenDetails.outputTokens||0,J=a.tokenDetails.totalTokens||E+U;if(J>0){if(E>0&&U>0){const pt=a._mergedCount>1?` (×${a._mergedCount})`:"";return`${E}→${U}${pt}`}return J.toString()}}const e=a.usage||{},m=e.input_tokens||a.inputTokens||0,h=e.output_tokens||a.outputTokens||0,N=a.tokens||m+h;if(N>0){if(m>0&&h>0){const E=a._mergedCount>1?` (×${a._mergedCount})`:"";return`${m}→${h}${E}`}return N.toString()}return"-"},St=a=>{var e;if(typeof a=="object"&&a!==null){const m=a;a=((e=m.costDetails)==null?void 0:e.totalCost)||m.cost||0}return!a||a===0?"0.00":a<.01?"< 0.01":a.toFixed(4)},mt=a=>{var e;return((e=a.costDetails)==null?void 0:e.totalCost)||a.cost||0},Lt=a=>{var h,N;if(a.tokenDetails)return(a.tokenDetails.cacheReadTokens||0)+(a.tokenDetails.cacheCreateTokens||0);const e=((h=a.usage)==null?void 0:h.cache_read_input_tokens)||0,m=((N=a.usage)==null?void 0:N.cache_creation_input_tokens)||0;return e+m},st=async()=>{try{A.value=null,P.value=!1,R.value==="custom"?await Nt():await F()}catch(a){console.error("Apply filters failed:",a),A.value=a,P.value=!0}},Nt=async()=>{const a=x.startDate,e=x.endDate;if(!a||!e){H.value="请设置完整的时间范围";return}const m=new Date(a),h=new Date(e);if(m>=h){H.value="结束时间必须大于开始时间";return}if((h-m)/(1e3*60*60*24)>90){H.value="时间范围不能超过90天";return}H.value="",await Ot(m.toISOString(),h.toISOString())},Ot=async(a,e)=>{console.log("📅 applyFiltersWithTimeRange被调用:",{startDateISO:a,endDateISO:e});const m=x.startDate,h=x.endDate;n({startDate:a,endDate:e}),console.log("📊 调用fetchLogs前，filters状态:",x.value),await F(),console.log("✅ fetchLogs调用完成"),R.value!=="custom"&&n({startDate:m,endDate:h})},me=(a,e)=>{const m=new Date(e);switch(a){case"1h":return new Date(m.getTime()-60*60*1e3);case"24h":return new Date(m.getTime()-24*60*60*1e3);case"7d":return new Date(m.getTime()-7*24*60*60*1e3);case"30d":return new Date(m.getTime()-30*24*60*60*1e3);default:return new Date(m.getTime()-24*60*60*1e3)}},At=a=>{const e=new Date(a);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e.toISOString().slice(0,16)},It=()=>{if(console.log("🕐 applyTimeRange被调用, timeRange.value:",R.value),H.value="",R.value==="custom"){console.log("⚠️ timeRange是custom，跳过自动更新");return}try{const a=new Date,e=me(R.value,a),m=a,h=e.toISOString(),N=m.toISOString(),E=At(e),U=At(m);n({startDate:E,endDate:U}),Ot(h,N)}catch(a){console.error("时间范围设置错误:",a),H.value=a.message}},ft=a=>{const e=x==null?void 0:x.sortBy,m=x==null?void 0:x.sortOrder;n(e===a?{sortOrder:m==="asc"?"desc":"asc"}:{sortBy:a,sortOrder:"desc"}),st()},bt=a=>(x==null?void 0:x.sortBy)!==a?"fa-sort":(x==null?void 0:x.sortOrder)==="asc"?"fa-sort-up":"fa-sort-down",Rt=a=>{const e=(D==null?void 0:D.totalPages)||1;a>=1&&a<=e&&(n({page:a}),st())},Ht=async a=>{var e,m;if(p.value=a,et.value="overview",!a.tokenDetails&&!a.costDetails&&!a.requestHeaders&&!a.responseHeaders)try{console.log("获取日志详情:",a.id||a.logId);const h=await M(a.id||a.logId);h&&(console.log("获取到的详细日志:",h),p.value={...a,...h,tokenDetails:h.tokenDetails||h.usage||{},costDetails:h.costDetails||{totalCost:h.cost||0,currency:"USD"},requestHeaders:h.requestHeaders||{},responseHeaders:h.responseHeaders||{},request:h.request||a.request||{},response:h.response||a.response||{},requestBody:h.requestBody||((e=h.request)==null?void 0:e.body),responseBody:h.responseBody||((m=h.response)==null?void 0:m.body)},console.log("合并后的日志对象:",p.value))}catch(h){console.error("获取日志详情失败:",h),ot("获取日志详情失败","error")}},ht=()=>{p.value=null,et.value="overview"},Kt=a=>{var e,m;if(!p.value)return 0;switch(a){case"tokens":{const h=p.value.tokenDetails&&Object.keys(p.value.tokenDetails).length>0,N=p.value.costDetails&&Object.keys(p.value.costDetails).length>0;return(h?1:0)+(N?1:0)}case"headers":{const h=p.value.requestHeaders?Object.keys(p.value.requestHeaders).length:0,N=p.value.responseHeaders?Object.keys(p.value.responseHeaders).length:0;return h+N}case"content":{let h=0;return((e=p.value.request)!=null&&e.body||p.value.requestBody)&&h++,((m=p.value.response)!=null&&m.body||p.value.responseBody)&&h++,h}default:return 0}},fe=async()=>{var a,e,m,h;if(p.value)try{const N={metadata:{timestamp:p.value.timestamp,apiKey:p.value.formattedKeyName||lt(p.value.keyId)||"Unknown",method:((a=p.value.request)==null?void 0:a.method)||"N/A",path:((e=p.value.request)==null?void 0:e.path)||"/",statusCode:((m=p.value.response)==null?void 0:m.statusCode)||"N/A",responseTime:p.value.responseTime||"N/A",ipAddress:((h=p.value.request)==null?void 0:h.ip)||"N/A"},request:p.value.request||{},response:p.value.response||{},usage:p.value.usage||{}},E=new Blob([JSON.stringify(N,null,2)],{type:"application/json"}),U=URL.createObjectURL(E),J=document.createElement("a");J.href=U,J.download=`log-detail-${new Date(p.value.timestamp).getTime()}.json`,J.style.display="none",document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(U),ot("日志详情已导出","success")}catch(N){console.error("导出日志详情失败:",N),ot("导出失败","error")}},Mt=async a=>{L.value=!1,await o(a)},be=async()=>{try{z.value=null,await i(!0),ot("API Key数据重新加载成功","success")}catch(a){console.error("API Key重试失败:",a),z.value="重试失败，请稍后再试",ot("API Key重新加载失败","error")}},$t=async()=>{try{A.value=null,P.value=!1,z.value=null;try{await i(!0)}catch(a){console.warn("API Key加载失败，使用现有数据:",a),z.value="API Key数据加载失败"}await y()}catch(a){throw console.error("Refresh failed:",a),A.value=a,P.value=!0,a}};let vt=null;_t(async()=>{try{try{await i()}catch(a){console.warn("API Key初始加载失败:",a),z.value="API Key数据加载失败，可能影响显示效果"}It(),await k(),Ct.value&&(vt=setInterval(async()=>{try{await k()}catch(a){console.warn("Auto refresh failed:",a),P.value=!0}},3e4))}catch(a){console.error("Initial load failed:",a),A.value=a}});const Pt=a=>{a.target.closest(".relative")||(L.value=!1)},Et=()=>{P.value=!1,A.value&&Bt()},Ft=()=>{P.value=!0};return _t(()=>{document.addEventListener("click",Pt),window.addEventListener("online",Et),window.addEventListener("offline",Ft),navigator.onLine||(P.value=!0)}),pe(()=>{vt&&(clearInterval(vt),vt=null),document.removeEventListener("click",Pt),window.removeEventListener("online",Et),window.removeEventListener("offline",Ft)}),(a,e)=>{var m,h,N,E,U,J,pt,Ut,Vt,zt,Jt,Wt,Gt,Yt,Qt,Xt,Zt,te,ee,se,ae,re;return u(),c("div",sn,[t("div",an,[t("div",null,[e[24]||(e[24]=t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},"请求日志",-1)),e[25]||(e[25]=t("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},"查看和管理 API 请求日志记录",-1)),P.value?(u(),c("div",rn,[...e[23]||(e[23]=[t("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1),v(" 连接异常，数据可能不是最新的 ",-1)])])):$("",!0)]),t("div",on,[t("button",{"aria-label":b(B)?"正在刷新数据":"刷新日志数据",class:"btn btn-secondary",disabled:b(B),onClick:$t},[t("i",{class:w(["fas fa-sync-alt mr-2",{"animate-spin":b(B)}])},null,2),v(" "+s(b(B)?"刷新中...":"刷新"),1)],8,nn),t("div",ln,[t("button",{"aria-label":b(S)?"正在导出数据":"导出日志数据",class:"btn btn-primary",disabled:b(S)||(Array.isArray(b(q))?b(q).length:0)===0,onClick:e[0]||(e[0]=l=>L.value=!L.value)},[t("i",{class:w(["fas fa-download mr-2",{"animate-spin":b(S)}])},null,2),v(" "+s(b(S)?"导出中...":"导出"),1)],8,dn),L.value?(u(),c("div",un,[t("div",cn,[t("button",{class:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",role:"menuitem",onClick:e[1]||(e[1]=l=>Mt("json"))},[...e[26]||(e[26]=[t("i",{class:"fas fa-file-code mr-2"},null,-1),v(" 导出为 JSON ",-1)])]),t("button",{class:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",role:"menuitem",onClick:e[2]||(e[2]=l=>Mt("csv"))},[...e[27]||(e[27]=[t("i",{class:"fas fa-file-csv mr-2"},null,-1),v(" 导出为 CSV ",-1)])])])])):$("",!0)])])]),t("div",gn,[t("div",xn,[t("div",yn,[t("div",null,[e[28]||(e[28]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"总请求数",-1)),t("p",mn,s(((m=b(C))==null?void 0:m.totalRequests)||((h=b(D))==null?void 0:h.total)||0),1)]),e[29]||(e[29]=t("i",{class:"fas fa-chart-line text-2xl text-blue-500"},null,-1))])]),t("div",fn,[t("div",bn,[t("div",null,[e[30]||(e[30]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"错误率",-1)),t("p",vn,s(ye(((N=b(C))==null?void 0:N.errorRate)||0)),1)]),e[31]||(e[31]=t("i",{class:"fas fa-exclamation-triangle text-2xl text-red-500"},null,-1))])]),t("div",pn,[t("div",kn,[t("div",null,[e[32]||(e[32]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"平均响应时间",-1)),t("p",hn,s(b(d)(((E=b(C))==null?void 0:E.averageResponseTime)||0)),1)]),e[33]||(e[33]=t("i",{class:"fas fa-clock text-2xl text-green-500"},null,-1))])]),t("div",$n,[t("div",wn,[t("div",null,[e[34]||(e[34]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"活跃 API Keys",-1)),t("p",_n,s(((J=(U=b(C))==null?void 0:U.topApiKeys)==null?void 0:J.length)||0),1)]),e[35]||(e[35]=t("i",{class:"fas fa-key text-2xl text-purple-500"},null,-1))])])]),t("div",Cn,[t("div",Dn,[t("div",Tn,[e[36]||(e[36]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"筛选条件",-1)),t("button",{"aria-label":Z.value?"收起筛选面板":"展开筛选面板",class:"rounded-md bg-gray-100 px-2 py-1 text-xs text-gray-600 dark:bg-gray-700 dark:text-gray-300 md:hidden",onClick:e[3]||(e[3]=l=>Z.value=!Z.value)},[t("i",{class:w(["fas",Z.value?"fa-chevron-up":"fa-chevron-down"])},null,2)],8,jn)]),b(K)?(u(),c("button",{key:0,class:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",onClick:jt},[...e[37]||(e[37]=[t("i",{class:"fas fa-times mr-1"},null,-1),v(" 清除筛选 ",-1)])])):$("",!0)]),t("div",{class:w(["grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",{"hidden md:grid":!Z.value}])},[t("div",Bn,[e[40]||(e[40]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 搜索 ",-1)),t("div",qn,[Y(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>b(x).search=l),"aria-describedby":b(x).search&&(dt.value||[]).length>0?"search-results-info":void 0,"aria-label":"搜索日志记录",class:"form-input w-full pr-8",placeholder:"API Key、IP、路径...",onInput:e[5]||(e[5]=(...l)=>b(Tt)&&b(Tt)(...l))},null,40,Sn),[[ct,b(x).search]]),t("div",Ln,[Q.value?(u(),c("div",Nn)):b(x).search?(u(),c("button",{key:1,"aria-label":"清除搜索",class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:xe},[...e[38]||(e[38]=[t("i",{class:"fas fa-times text-sm"},null,-1)])])):(u(),c("i",On))])]),b(x).search&&!Q.value?(u(),c("div",An,[b(x).search&&((pt=dt.value)==null?void 0:pt.length)>0?(u(),c("span",In,"找到 "+s(((Ut=dt.value)==null?void 0:Ut.length)||0)+" 条结果",1)):(u(),c("span",Rn,"未找到匹配结果")),e[39]||(e[39]=t("span",{class:"ml-2"},"💡 试试搜索IP地址或完整路径",-1))])):$("",!0)]),t("div",null,[e[44]||(e[44]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," API Key ",-1)),t("div",Hn,[Y(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>b(x).apiKeyId=l),class:"form-select w-full",disabled:b(I),onChange:st},[e[41]||(e[41]=t("option",{value:""},"全部",-1)),(u(!0),c(rt,null,nt(de.value,l=>(u(),c("option",{key:l.id,value:l.id},s(l.displayText),9,Mn))),128))],40,Kn),[[ut,b(x).apiKeyId]]),b(I)?(u(),c("div",Pn,[...e[42]||(e[42]=[t("div",{class:"loading-spinner h-4 w-4"},null,-1)])])):$("",!0)]),z.value?(u(),c("div",En,[e[43]||(e[43]=t("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1)),v(" "+s(z.value)+" ",1),t("button",{class:"ml-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",onClick:be}," 重试 ")])):$("",!0)]),t("div",null,[e[46]||(e[46]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 状态码 ",-1)),Y(t("select",{"onUpdate:modelValue":e[7]||(e[7]=l=>b(x).statusCode=l),class:"form-select w-full",onChange:st},[...e[45]||(e[45]=[wt('<option value="" data-v-afa33e91>全部</option><option value="200" data-v-afa33e91>200 (成功)</option><option value="400" data-v-afa33e91>400 (请求错误)</option><option value="401" data-v-afa33e91>401 (未授权)</option><option value="403" data-v-afa33e91>403 (禁止访问)</option><option value="429" data-v-afa33e91>429 (限流)</option><option value="500" data-v-afa33e91>500 (服务器错误)</option>',7)])],544),[[ut,b(x).statusCode]])]),t("div",null,[e[48]||(e[48]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 时间范围 ",-1)),Y(t("select",{"onUpdate:modelValue":e[8]||(e[8]=l=>R.value=l),class:"form-select w-full",onChange:It},[...e[47]||(e[47]=[wt('<option value="1h" data-v-afa33e91>最近 1 小时</option><option value="24h" data-v-afa33e91>最近 24 小时</option><option value="7d" data-v-afa33e91>最近 7 天</option><option value="30d" data-v-afa33e91>最近 30 天</option><option value="custom" data-v-afa33e91>自定义</option>',5)])],544),[[ut,R.value]]),t("p",Fn,s(ie.value),1)])],2),R.value==="custom"?(u(),c("div",Un,[t("div",Vn,[t("div",null,[e[49]||(e[49]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 开始时间 ",-1)),Y(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>b(x).startDate=l),class:w(["form-input w-full",{"border-red-300 focus:border-red-500 focus:ring-red-500":H.value}]),placeholder:"选择开始时间",type:"datetime-local"},null,2),[[ct,b(x).startDate]])]),t("div",null,[e[50]||(e[50]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 结束时间 ",-1)),Y(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>b(x).endDate=l),class:w(["form-input w-full",{"border-red-300 focus:border-red-500 focus:ring-red-500":H.value}]),placeholder:"选择结束时间",type:"datetime-local"},null,2),[[ct,b(x).endDate]])])]),H.value?(u(),c("div",zn,[e[51]||(e[51]=t("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),v(" "+s(H.value),1)])):(u(),c("div",Jn,[...e[52]||(e[52]=[t("i",{class:"fas fa-info-circle mr-1"},null,-1),v(" 支持最长90天的时间范围查询。修改时间后将自动查询。 ",-1)])]))])):$("",!0)]),A.value&&!b(B)?(u(),c("div",Wn,[t("div",Gn,[e[55]||(e[55]=t("div",{class:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900"},[t("i",{class:"fas fa-exclamation-triangle text-2xl text-red-600 dark:text-red-400"})],-1)),e[56]||(e[56]=t("h3",{class:"mb-2 text-lg font-semibold text-gray-900 dark:text-gray-100"},"加载失败",-1)),t("p",Yn,s(ge(A.value)),1),t("div",Qn,[t("button",{class:"btn btn-primary",onClick:Bt},[...e[53]||(e[53]=[t("i",{class:"fas fa-redo mr-2"},null,-1),v(" 重试 ",-1)])]),t("button",{class:"btn btn-secondary",onClick:e[11]||(e[11]=l=>xt.value=!0)},[...e[54]||(e[54]=[t("i",{class:"fas fa-info-circle mr-2"},null,-1),v(" 查看详情 ",-1)])])])])])):(u(),c("div",Xn,[t("div",Zn,[t("div",tl,[t("span",el,s(ce()),1),Ct.value?(u(),c("div",sl,[...e[57]||(e[57]=[t("div",{class:"mr-1 h-2 w-2 animate-pulse rounded-full bg-green-500"},null,-1),v(" 实时更新 ",-1)])])):$("",!0)]),t("div",al,[t("div",rl,[t("button",{class:w(["rounded px-2 py-1 text-xs font-medium transition-colors",tt.value==="table"?"bg-white text-blue-600 shadow-sm dark:bg-gray-700 dark:text-blue-400":"text-gray-600 dark:text-gray-400"]),onClick:e[12]||(e[12]=l=>tt.value="table")},[...e[58]||(e[58]=[t("i",{class:"fas fa-table mr-1"},null,-1),v(" 表格 ",-1)])],2),t("button",{class:w(["rounded px-2 py-1 text-xs font-medium transition-colors",tt.value==="cards"?"bg-white text-blue-600 shadow-sm dark:bg-gray-700 dark:text-blue-400":"text-gray-600 dark:text-gray-400"]),onClick:e[13]||(e[13]=l=>tt.value="cards")},[...e[59]||(e[59]=[t("i",{class:"fas fa-th-large mr-1"},null,-1),v(" 卡片 ",-1)])],2)]),Y(t("select",{"onUpdate:modelValue":e[14]||(e[14]=l=>b(x).limit=l),"aria-label":"每页显示条数",class:"form-select text-sm",onChange:st},[...e[60]||(e[60]=[t("option",{value:"25"},"25 条/页",-1),t("option",{value:"50"},"50 条/页",-1),t("option",{value:"100"},"100 条/页",-1)])],544),[[ut,b(x).limit]])])]),b(B)?(u(),c("div",ol,[t("div",nl,[(u(),c(rt,null,nt(5,l=>t("div",{key:l,class:"animate-pulse"},[...e[61]||(e[61]=[wt('<div class="flex items-center space-x-4" data-v-afa33e91><div class="h-4 w-20 rounded bg-gray-200 dark:bg-gray-700" data-v-afa33e91></div><div class="h-4 w-16 rounded bg-gray-200 dark:bg-gray-700" data-v-afa33e91></div><div class="h-4 w-12 rounded bg-gray-200 dark:bg-gray-700" data-v-afa33e91></div><div class="h-4 flex-1 rounded bg-gray-200 dark:bg-gray-700" data-v-afa33e91></div><div class="h-4 w-16 rounded bg-gray-200 dark:bg-gray-700" data-v-afa33e91></div><div class="h-4 w-12 rounded bg-gray-200 dark:bg-gray-700" data-v-afa33e91></div></div>',1)])])),64)),e[62]||(e[62]=t("div",{class:"mt-4 text-center"},[t("div",{class:"inline-flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400"},[t("div",{class:"loading-spinner"}),t("span",null,"正在加载日志数据...")])],-1))])])):yt.value.length===0?(u(),c("div",ll,[e[65]||(e[65]=t("div",{class:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800"},[t("i",{class:"fas fa-inbox text-2xl text-gray-400"})],-1)),t("h3",dl,s(b(x).search?"未找到匹配的日志":"暂无日志记录"),1),t("div",il,[b(x).search?(u(),c("p",ul,'未找到包含 "'+s(b(x).search)+'" 的日志记录',1)):(u(),c("p",cl,"当前时间范围内没有日志记录")),t("div",gl,[b(K)?(u(),c("button",{key:0,class:"btn btn-primary",onClick:jt},[...e[63]||(e[63]=[t("i",{class:"fas fa-filter mr-2"},null,-1),v(" 清除所有筛选 ",-1)])])):$("",!0),t("button",{class:"btn btn-secondary",onClick:$t},[...e[64]||(e[64]=[t("i",{class:"fas fa-sync-alt mr-2"},null,-1),v(" 刷新数据 ",-1)])])])])])):tt.value==="table"?(u(),c("div",xl,[t("table",yl,[t("thead",ml,[t("tr",null,[t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[15]||(e[15]=l=>ft("timestamp"))},[t("div",fl,[e[66]||(e[66]=t("span",null,"时间",-1)),t("i",{class:w(["fas fa-sort text-gray-400",bt("timestamp")])},null,2)])]),e[70]||(e[70]=t("th",{class:"table-header",role:"columnheader"},"API Key",-1)),t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[16]||(e[16]=l=>ft("request.method"))},[t("div",bl,[e[67]||(e[67]=t("span",null,"方法",-1)),t("i",{class:w(["fas fa-sort text-gray-400",bt("request.method")])},null,2)])]),e[71]||(e[71]=t("th",{class:"table-header",role:"columnheader"},"路径",-1)),t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[17]||(e[17]=l=>ft("response.statusCode"))},[t("div",vl,[e[68]||(e[68]=t("span",null,"状态码",-1)),t("i",{class:w(["fas fa-sort text-gray-400",bt("response.statusCode")])},null,2)])]),t("th",{class:"table-header cursor-pointer",role:"columnheader",onClick:e[18]||(e[18]=l=>ft("response.duration"))},[t("div",pl,[e[69]||(e[69]=t("span",null,"响应时间",-1)),t("i",{class:w(["fas fa-sort text-gray-400",bt("response.duration")])},null,2)])]),e[72]||(e[72]=t("th",{class:"table-header",role:"columnheader"},"Tokens",-1)),e[73]||(e[73]=t("th",{class:"table-header",role:"columnheader"},"成本",-1)),e[74]||(e[74]=t("th",{class:"table-header",role:"columnheader"},"IP 地址",-1)),e[75]||(e[75]=t("th",{class:"table-header",role:"columnheader"},"操作",-1))])]),t("tbody",kl,[(u(!0),c(rt,null,nt(yt.value,l=>(u(),c("tr",{key:l.logId||l.timestamp,class:w(["transition-colors hover:bg-gray-50 dark:hover:bg-gray-800",{"animate-pulse bg-green-50 dark:bg-green-900/20":l._isNew}])},[t("td",hl,[t("div",$l,s(new Date(l.timestamp).toLocaleString("zh-CN")),1)]),t("td",wl,[t("div",_l,[e[77]||(e[77]=t("div",{"aria-label":"API Key 活跃",class:"h-2 w-2 rounded-full bg-green-500"},null,-1)),t("span",{class:w(["text-sm font-medium",l.formattedKeyName&&l.formattedKeyName.includes("(已删除)")?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-gray-100"])},s(l.formattedKeyName),3),l.mergeInfo?(u(),c("div",{key:0,class:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",title:l.mergeInfo.tooltip},[e[76]||(e[76]=t("i",{class:"fas fa-layer-group mr-1 text-xs"},null,-1)),v(" "+s(l.mergeInfo.count),1)],8,Cl)):$("",!0)])]),t("td",Dl,[t("span",{class:w(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",b(V)(l.method)])},s(l.method||"N/A"),3)]),t("td",Tl,[t("span",{class:"max-w-32 truncate text-sm text-gray-900 dark:text-gray-100",title:l.path},s(l.path||"/"),9,jl)]),t("td",Bl,[t("span",{class:w(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",b(T)(l.statusCode)])},s(l.statusCode||"N/A"),3)]),t("td",ql,[t("div",Sl,[t("span",Ll,s(l.responseTime?`${l.responseTime}ms`:"N/A"),1),parseInt(l.responseTime)>5e3?(u(),c("i",Nl)):$("",!0)])]),t("td",Ol,[t("div",Al,[t("div",Il,[e[78]||(e[78]=t("i",{class:"fas fa-coins text-xs"},null,-1)),t("span",null,s(qt(l)),1)]),Lt(l)>0?(u(),c("div",Rl,[e[79]||(e[79]=t("i",{class:"fas fa-memory text-xs"},null,-1)),v(" "+s(Lt(l))+" 缓存 ",1)])):$("",!0)])]),t("td",Hl,[t("div",Kl,[mt(l)>0?(u(),c("span",Ml," $"+s(St(mt(l))),1)):(u(),c("span",Pl,"-"))])]),t("td",El,[t("span",Fl,s(l.ipAddress||"N/A"),1)]),t("td",Ul,[t("button",{"aria-label":`查看日志详情: ${l.formattedKeyName||"Unknown"} ${l.method} ${l.path}`,class:"rounded p-1 text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-800 dark:text-blue-400 dark:hover:bg-blue-900/20 dark:hover:text-blue-300",onClick:at=>Ht(l)},[...e[80]||(e[80]=[t("i",{class:"fas fa-eye"},null,-1)])],8,Vl)])],2))),128))])])])):(u(),c("div",zl,[(u(!0),c(rt,null,nt(yt.value,l=>(u(),c("div",{key:l.logId||l.timestamp,class:w(["p-4 transition-colors hover:bg-gray-50 dark:hover:bg-gray-800",{"animate-pulse bg-green-50 dark:bg-green-900/20":l._isNew}])},[t("div",Jl,[t("div",Wl,[t("div",Gl,[t("div",Yl,[t("span",Ql,s(new Date(l.timestamp).toLocaleString("zh-CN").split(" ")[1]),1),t("div",Xl,[e[82]||(e[82]=t("div",{class:"h-2 w-2 rounded-full bg-green-500"},null,-1)),t("span",{class:w(["text-sm",l.formattedKeyName&&l.formattedKeyName.includes("(已删除)")?"text-gray-500 dark:text-gray-400":"text-gray-600 dark:text-gray-400"])},s(l.formattedKeyName),3),l.mergeInfo?(u(),c("div",{key:0,class:"inline-flex items-center rounded-full bg-blue-100 px-1.5 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",title:l.mergeInfo.tooltip},[e[81]||(e[81]=t("i",{class:"fas fa-layer-group mr-0.5 text-xs"},null,-1)),v(" "+s(l.mergeInfo.count),1)],8,Zl)):$("",!0)])]),t("button",{"aria-label":"查看详情",class:"rounded p-2 text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-800 dark:text-blue-400 dark:hover:bg-blue-900/20 dark:hover:text-blue-300",onClick:at=>Ht(l)},[...e[83]||(e[83]=[t("i",{class:"fas fa-eye"},null,-1)])],8,td)]),t("div",ed,[t("span",{class:w(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",b(V)(l.method)])},s(l.method||"N/A"),3),t("span",sd,s(l.path||"/"),1)]),t("div",ad,[t("div",rd,[t("span",{class:w(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",b(T)(l.statusCode)])},s(l.statusCode||"N/A"),3),t("span",od," ⏱️ "+s(l.responseTime?`${l.responseTime}ms`:"N/A"),1)]),t("div",nd,[t("div",ld,[e[84]||(e[84]=t("i",{class:"fas fa-coins"},null,-1)),t("span",null,s(qt(l)),1)]),mt(l)>0?(u(),c("div",dd," $"+s(St(mt(l))),1)):$("",!0)])]),t("div",id," 🌐 "+s(l.ipAddress||"N/A"),1)])])],2))),128))])),(((Vt=b(D))==null?void 0:Vt.totalPages)||0)>1?(u(),c("div",ud,[t("div",cd,[t("button",{class:"btn btn-secondary btn-sm",disabled:(((zt=b(D))==null?void 0:zt.page)||1)<=1,onClick:e[19]||(e[19]=l=>{var at;return Rt((((at=b(D))==null?void 0:at.page)||1)-1)})},[...e[85]||(e[85]=[t("i",{class:"fas fa-chevron-left"},null,-1)])],8,gd),t("span",xd," 第 "+s(((Jt=b(D))==null?void 0:Jt.page)||1)+" 页，共 "+s(((Wt=b(D))==null?void 0:Wt.totalPages)||1)+" 页 ",1),t("button",{class:"btn btn-secondary btn-sm",disabled:(((Gt=b(D))==null?void 0:Gt.page)||1)>=(((Yt=b(D))==null?void 0:Yt.totalPages)||1),onClick:e[20]||(e[20]=l=>{var at;return Rt((((at=b(D))==null?void 0:at.page)||1)+1)})},[...e[86]||(e[86]=[t("i",{class:"fas fa-chevron-right"},null,-1)])],8,yd)])])):$("",!0)])),(u(),ke(he,{to:"body"},[p.value?(u(),c("div",md,[t("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm",onClick:ht}),t("div",fd,[t("div",bd,[t("div",vd,[e[88]||(e[88]=t("div",{class:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600"},[t("i",{class:"fas fa-file-alt text-white"})],-1)),t("div",null,[e[87]||(e[87]=t("h3",{class:"text-xl font-bold text-gray-900 dark:text-gray-100"},"日志详情",-1)),t("p",pd,s(p.value.formattedKeyName||lt(p.value.keyId)||"Unknown"),1)])]),t("button",{class:"p-2 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300",onClick:ht},[...e[89]||(e[89]=[t("i",{class:"fas fa-times text-xl"},null,-1)])])]),t("div",kd,[t("nav",hd,[(u(!0),c(rt,null,nt(le.value,l=>(u(),c("button",{key:l.id,class:w([et.value===l.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300","flex items-center gap-2 whitespace-nowrap border-b-2 px-1 py-2 text-sm font-medium"]),onClick:at=>et.value=l.id},[t("i",{class:w(l.icon)},null,2),v(" "+s(l.name)+" ",1),l.badge&&Kt(l.id)?(u(),c("span",wd,s(Kt(l.id)),1)):$("",!0)],10,$d))),128))])]),t("div",_d,[et.value==="overview"?(u(),c("div",Cd,[kt(Vs,{log:p.value},null,8,["log"])])):$("",!0),et.value==="tokens"?(u(),c("div",Dd,[kt(Ja,{"cost-details":p.value.costDetails||{},"token-details":p.value.tokenDetails||{}},null,8,["cost-details","token-details"])])):$("",!0),et.value==="headers"?(u(),c("div",Td,[kt(Yr,{"request-headers":p.value.requestHeaders||{},"response-headers":p.value.responseHeaders||{}},null,8,["request-headers","response-headers"])])):$("",!0),et.value==="content"?(u(),c("div",jd,[kt(en,{"request-body":((Qt=p.value.request)==null?void 0:Qt.body)||p.value.requestBody,"response-body":((Xt=p.value.response)==null?void 0:Xt.body)||p.value.responseBody},null,8,["request-body","response-body"])])):$("",!0)]),t("div",Bd,[t("div",qd,[t("div",Sd,[e[90]||(e[90]=t("i",{class:"fas fa-clock mr-1"},null,-1)),v(" "+s(b(r)(p.value).timestamp),1)]),t("div",Ld,[e[91]||(e[91]=t("i",{class:"fas fa-tachometer-alt mr-1"},null,-1)),v(" "+s(b(r)(p.value).duration),1)])]),t("div",Nd,[t("button",{class:"btn btn-secondary px-4 py-2 text-sm",disabled:b(S),type:"button",onClick:fe},[t("i",{class:w(["fas fa-download mr-2",{"animate-spin":b(S)}])},null,2),e[92]||(e[92]=v(" 导出 ",-1))],8,Od),t("button",{class:"btn btn-primary px-4 py-2 text-sm",type:"button",onClick:ht}," 关闭 ")])])])])):$("",!0)])),xt.value?(u(),c("div",{key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e[22]||(e[22]=$e(l=>xt.value=!1,["self"]))},[t("div",Ad,[t("div",Id,[e[94]||(e[94]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"错误详情",-1)),t("button",{class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:e[21]||(e[21]=l=>xt.value=!1)},[...e[93]||(e[93]=[t("i",{class:"fas fa-times text-xl"},null,-1)])])]),t("div",Rd,[t("div",Hd,[t("div",null,[e[95]||(e[95]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"错误类型",-1)),t("p",Kd,s(((Zt=A.value)==null?void 0:Zt.code)||"未知错误"),1)]),t("div",null,[e[96]||(e[96]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"错误信息",-1)),t("p",Md,s(((te=A.value)==null?void 0:te.message)||"无详细信息"),1)]),(ee=A.value)!=null&&ee.status?(u(),c("div",Pd,[e[97]||(e[97]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"状态码",-1)),t("p",Ed,s(A.value.status),1)])):$("",!0),t("div",null,[e[98]||(e[98]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"重试次数",-1)),t("p",Fd,s(Dt.value),1)]),t("div",null,[e[103]||(e[103]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"建议操作",-1)),t("div",Ud,[((se=A.value)==null?void 0:se.code)==="NETWORK_ERROR"?(u(),c("p",Vd,[...e[99]||(e[99]=[v(" • 检查网络连接是否正常",-1),t("br",null,null,-1),v(" • 检查VPN或代理设置",-1),t("br",null,null,-1),v(" • 尝试刷新页面 ",-1)])])):((ae=A.value)==null?void 0:ae.status)===401?(u(),c("p",zd,[...e[100]||(e[100]=[v(" • 重新登录系统",-1),t("br",null,null,-1),v(" • 检查登录凭据是否过期 ",-1)])])):((re=A.value)==null?void 0:re.status)>=500?(u(),c("p",Jd,[...e[101]||(e[101]=[v(" • 稍后再试",-1),t("br",null,null,-1),v(" • 如问题持续，请联系技术支持 ",-1)])])):(u(),c("p",Wd,[...e[102]||(e[102]=[v(" • 检查网络连接",-1),t("br",null,null,-1),v(" • 刷新页面后重试 ",-1)])]))])])])])])])):$("",!0)])}}},a0=gt(Gd,[["__scopeId","data-v-afa33e91"]]);export{a0 as default};
