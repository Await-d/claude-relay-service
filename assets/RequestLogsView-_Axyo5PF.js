import{aR as wt,r as v,c as ft,q as pt,V as ht,x,z as t,L as p,u as r,O as U,C as _,P as l,K as I,aq as Y,aW as M,Q as vt,ac as bt,aX as kt,Y as Ct,y as c}from"./vue-vendor-Ig-GgGwA.js";import{b as P,_ as qt}from"./index-BLZi1Gsb.js";import{s as k}from"./toast-BvwA7Mwb.js";import{P as _t}from"./vendor-DuCvjFhD.js";import"./element-plus-lTawJ3jz.js";const Lt=wt("requestLogs",()=>{const A=v([]),q=v(!1),w=v(!1),n=v({totalRequests:0,errorRate:0,averageResponseTime:0,topApiKeys:[]}),m=v({apiKeyId:"",startDate:"",endDate:"",statusCode:"",method:"",search:"",page:1,limit:50,sortBy:"timestamp",sortOrder:"desc"}),L=v({page:1,limit:50,total:0,totalPages:0}),h=v({enabled:!1,mode:"performance",sampling:{successRate:.1,errorRate:1,slowRequestThreshold:5e3},retention:{days:30,maxEntries:1e5},async:{batchSize:50,flushInterval:2e3}}),T=v(!1),C=v(!1),g=ft(()=>{if(!m.value.search)return A.value;const s=m.value.search.toLowerCase();return A.value.filter(a=>{var d,u,S,D,y,B,i,e;return((u=(d=a.apiKey)==null?void 0:d.name)==null?void 0:u.toLowerCase().includes(s))||((D=(S=a.request)==null?void 0:S.userAgent)==null?void 0:D.toLowerCase().includes(s))||((B=(y=a.request)==null?void 0:y.ip)==null?void 0:B.includes(s))||((e=(i=a.request)==null?void 0:i.path)==null?void 0:e.toLowerCase().includes(s))})}),f=ft(()=>{const s=m.value;return s.apiKeyId||s.startDate||s.endDate||s.statusCode||s.method||s.search}),F=async(s={})=>{q.value=!0;try{const a={...m.value,...s},d=await P.get("/admin/request-logs",{params:a});return d&&d.success&&(A.value=d.data.logs||[],L.value={page:d.data.page||1,limit:d.data.limit||50,total:d.data.total||0,totalPages:d.data.totalPages||0}),d}catch(a){throw console.error("Failed to fetch request logs:",a),k("获取请求日志失败","error"),a}finally{q.value=!1}},z=async(s,a={})=>{q.value=!0;try{const d={...a},u=await P.get(`/admin/request-logs/${s}`,{params:d});return u&&u.success&&(A.value=u.data.logs||[],L.value=u.data.pagination||{}),u}catch(d){throw console.error("Failed to fetch API key logs:",d),k("获取API Key日志失败","error"),d}finally{q.value=!1}},j=async(s="24h")=>{try{const a=await P.get("/admin/request-logs/stats",{params:{timeRange:s}});return a&&a.success&&(n.value=a.data||{}),a}catch(a){throw console.error("Failed to fetch log stats:",a),k("获取统计信息失败","error"),a}},V=async s=>{try{const a=await P.delete(`/admin/request-logs/${s}`);return a&&a.success&&(k("日志删除成功","success"),await F()),a}catch(a){throw console.error("Failed to delete logs:",a),k("删除日志失败","error"),a}},J=async(s="json",a={})=>{w.value=!0;try{const d={format:s,...m.value,...a},u=await P.post("/admin/request-logs/export",d);if(u&&u.success){const S=new Blob([u.data.content],{type:s==="csv"?"text/csv":"application/json"}),D=window.URL.createObjectURL(S),y=document.createElement("a");y.href=D,y.download=u.data.filename||`request-logs-${new Date().getTime()}.${s}`,document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL(D),k(`日志已导出为 ${s.toUpperCase()} 格式`,"success")}return u}catch(d){throw console.error("Failed to export logs:",d),k("导出日志失败","error"),d}finally{w.value=!1}},O=async()=>{T.value=!0;try{const s=await P.get("/admin/request-logs/config");return s&&s.success&&(h.value={...h.value,...s.data}),s}catch(s){throw console.error("Failed to load request logging config:",s),k("加载配置失败","error"),s}finally{T.value=!1}},K=async s=>{C.value=!0;try{const a=await P.put("/admin/request-logs/config",s);return a&&a.success&&(h.value={...h.value,...a.data},k("配置保存成功","success")),a}catch(a){throw console.error("Failed to save request logging config:",a),k("保存配置失败","error"),a}finally{C.value=!1}},G=async()=>await K({enabled:!1,mode:"performance",sampling:{successRate:.1,errorRate:1,slowRequestThreshold:5e3},retention:{days:30,maxEntries:1e5},async:{batchSize:50,flushInterval:2e3}}),R=s=>{m.value={...m.value,...s}},H=()=>{m.value={apiKeyId:"",startDate:"",endDate:"",statusCode:"",method:"",search:"",page:1,limit:50,sortBy:"timestamp",sortOrder:"desc"}},Q=async()=>{await F(),await j()},W=s=>{var a,d,u;return{...s,timestamp:new Date(s.timestamp).toLocaleString("zh-CN"),duration:(a=s.response)!=null&&a.duration?`${s.response.duration}ms`:"N/A",statusClass:N((d=s.response)==null?void 0:d.statusCode),methodClass:E((u=s.request)==null?void 0:u.method)}},N=s=>s?s>=200&&s<300?"text-green-600":s>=300&&s<400?"text-yellow-600":s>=400&&s<500?"text-orange-600":s>=500?"text-red-600":"text-gray-500":"text-gray-500",E=s=>({GET:"text-blue-600",POST:"text-green-600",PUT:"text-yellow-600",DELETE:"text-red-600",PATCH:"text-purple-600"})[s]||"text-gray-600";return{logs:A,loading:q,exporting:w,stats:n,filters:m,pagination:L,config:h,configLoading:T,configSaving:C,filteredLogs:g,hasFilters:f,fetchLogs:F,fetchLogsByApiKey:z,fetchStats:j,deleteLogsByApiKey:V,exportLogs:J,refreshLogs:Q,loadConfig:O,saveConfig:K,resetConfig:G,updateFilters:R,clearFilters:H,formatLogEntry:W,getStatusClass:N,getMethodClass:E,formatBytes:s=>{if(s===0)return"0 B";const a=1024,d=["B","KB","MB","GB"],u=Math.floor(Math.log(s)/Math.log(a));return parseFloat((s/Math.pow(a,u)).toFixed(2))+" "+d[u]},formatDuration:s=>s<1e3?`${s}ms`:s<6e4?`${(s/1e3).toFixed(1)}s`:`${(s/6e4).toFixed(1)}m`}}),St={class:"request-logs-container"},Dt={class:"mb-6 flex items-center justify-between"},It={class:"flex items-center space-x-3"},Pt=["disabled"],At={class:"relative"},Tt=["disabled"],Ot={key:0,class:"absolute right-0 top-full z-50 mt-2 w-48 rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5 dark:bg-gray-800"},Rt={class:"py-1"},$t={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Ft={class:"stat-card"},Kt={class:"flex items-center justify-between"},Nt={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},Bt={class:"stat-card"},Ut={class:"flex items-center justify-between"},jt={class:"text-2xl font-bold text-red-600 dark:text-red-400"},Vt={class:"stat-card"},Et={class:"flex items-center justify-between"},Mt={class:"text-2xl font-bold text-green-600 dark:text-green-400"},zt={class:"stat-card"},Jt={class:"flex items-center justify-between"},Gt={class:"text-2xl font-bold text-purple-600 dark:text-purple-400"},Ht={class:"card mb-6 p-4"},Qt={class:"mb-4 flex items-center justify-between"},Wt={class:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4"},Xt=["value"],Yt={key:0,class:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2"},Zt={class:"card"},te={class:"flex items-center justify-between border-b border-gray-200 p-4 dark:border-gray-700"},ee={class:"flex items-center space-x-4"},se={class:"text-sm text-gray-600 dark:text-gray-400"},ae={class:"flex items-center space-x-2"},re={class:"overflow-x-auto"},oe={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},le={class:"bg-gray-50 dark:bg-gray-800"},ne={class:"flex items-center space-x-1"},de={class:"flex items-center space-x-1"},ie={class:"flex items-center space-x-1"},ue={class:"flex items-center space-x-1"},ge={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},xe={key:0},ce={key:1},me={class:"table-cell"},ye={class:"text-sm text-gray-900 dark:text-gray-100"},fe={class:"table-cell"},pe={class:"flex items-center space-x-2"},ve={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},be={class:"table-cell"},ke={class:"table-cell"},we=["title"],he={class:"table-cell"},Ce={class:"table-cell"},qe={class:"text-sm text-gray-900 dark:text-gray-100"},_e={class:"table-cell"},Le={class:"text-sm text-gray-600 dark:text-gray-400"},Se={class:"table-cell"},De=["onClick"],Ie={key:0,class:"flex items-center justify-between border-t border-gray-200 px-4 py-3 dark:border-gray-700"},Pe={class:"flex items-center space-x-2"},Ae=["disabled"],Te={class:"text-sm text-gray-600 dark:text-gray-400"},Oe=["disabled"],Re={class:"max-h-[90vh] w-full max-w-4xl overflow-hidden rounded-lg bg-white shadow-xl dark:bg-gray-800"},$e={class:"flex items-center justify-between border-b border-gray-200 px-6 py-4 dark:border-gray-700"},Fe={class:"max-h-[calc(90vh-120px)] overflow-y-auto p-6"},Ke={class:"space-y-6"},Ne={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Be={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Ue={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},je={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Ve={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Ee={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Me={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},ze={class:"space-y-4"},Je={class:"mt-1 rounded bg-gray-100 p-2 text-sm text-gray-900 dark:bg-gray-700 dark:text-gray-100"},Ge={class:"mt-1 rounded bg-gray-100 p-2 text-sm text-gray-900 dark:bg-gray-700 dark:text-gray-100"},He={key:0},Qe={class:"mt-1 max-h-40 overflow-y-auto rounded bg-gray-100 p-2 text-xs text-gray-900 dark:bg-gray-700 dark:text-gray-100"},We={key:1},Xe={class:"mt-1 max-h-40 overflow-y-auto rounded bg-gray-100 p-2 text-xs text-gray-900 dark:bg-gray-700 dark:text-gray-100"},Ye={key:0},Ze={class:"space-y-4"},ts={key:0},es={class:"mt-1 max-h-40 overflow-y-auto rounded bg-gray-100 p-2 text-xs text-gray-900 dark:bg-gray-700 dark:text-gray-100"},ss={key:1},as={class:"mt-1 max-h-40 overflow-y-auto rounded bg-gray-100 p-2 text-xs text-gray-900 dark:bg-gray-700 dark:text-gray-100"},rs={key:1},os={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},ls={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},ns={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},ds={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},is={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},us={__name:"RequestLogsView",setup(A){const q=Lt(),w=v(!1),n=v(null),m=v("24h"),{logs:L,loading:h,exporting:T,stats:C,filters:g,pagination:f,filteredLogs:F,hasFilters:z}=q,{fetchLogs:j,fetchStats:V,exportLogs:J,updateFilters:O,clearFilters:K,refreshLogs:G,formatLogEntry:R,getStatusClass:H,getMethodClass:Q,formatDuration:W}=q,N=_t.debounce(()=>{b()},500),E=i=>`${(i*100).toFixed(1)}%`,b=async()=>{await j()},X=()=>{const i=new Date;let e=null,$=i.toISOString();switch(m.value){case"1h":e=new Date(i.getTime()-60*60*1e3).toISOString();break;case"24h":e=new Date(i.getTime()-24*60*60*1e3).toISOString();break;case"7d":e=new Date(i.getTime()-7*24*60*60*1e3).toISOString();break;case"30d":e=new Date(i.getTime()-30*24*60*60*1e3).toISOString();break;case"custom":return}e&&(O({startDate:e.slice(0,16),endDate:$.slice(0,16)}),b())},s=i=>{const e=g.sortBy,$=g.sortOrder;O(e===i?{sortOrder:$==="asc"?"desc":"asc"}:{sortBy:i,sortOrder:"desc"}),b()},a=i=>g.sortBy!==i?"fa-sort":g.sortOrder==="asc"?"fa-sort-up":"fa-sort-down",d=i=>{i>=1&&i<=f.totalPages&&(O({page:i}),b())},u=i=>{n.value=i},S=async i=>{w.value=!1,await J(i)},D=async()=>{await G()};let y=null;pt(async()=>{X(),await V(),y=setInterval(async()=>{await V()},3e4)});const B=i=>{i.target.closest(".relative")||(w.value=!1)};return pt(()=>{document.addEventListener("click",B)}),ht(()=>{y&&(clearInterval(y),y=null),document.removeEventListener("click",B)}),(i,e)=>{var $,Z,tt,et,st,at,rt,ot,lt;return c(),x("div",St,[t("div",Dt,[e[24]||(e[24]=t("div",null,[t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},"请求日志"),t("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},"查看和管理 API 请求日志记录")],-1)),t("div",It,[t("button",{class:"btn btn-secondary",disabled:r(h),onClick:D},[t("i",{class:_(["fas fa-sync-alt mr-2",{"animate-spin":r(h)}])},null,2),e[20]||(e[20]=U(" 刷新 ",-1))],8,Pt),t("div",At,[t("button",{class:"btn btn-primary",disabled:r(T)||r(L).length===0,onClick:e[0]||(e[0]=o=>w.value=!w.value)},[e[21]||(e[21]=t("i",{class:"fas fa-download mr-2"},null,-1)),U(" "+l(r(T)?"导出中...":"导出"),1)],8,Tt),w.value?(c(),x("div",Ot,[t("div",Rt,[t("button",{class:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",onClick:e[1]||(e[1]=o=>S("json"))},e[22]||(e[22]=[t("i",{class:"fas fa-file-code mr-2"},null,-1),U(" 导出为 JSON ",-1)])),t("button",{class:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",onClick:e[2]||(e[2]=o=>S("csv"))},e[23]||(e[23]=[t("i",{class:"fas fa-file-csv mr-2"},null,-1),U(" 导出为 CSV ",-1)]))])])):p("",!0)])])]),t("div",$t,[t("div",Ft,[t("div",Kt,[t("div",null,[e[25]||(e[25]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"总请求数",-1)),t("p",Nt,l(r(C).totalRequests||0),1)]),e[26]||(e[26]=t("i",{class:"fas fa-chart-line text-2xl text-blue-500"},null,-1))])]),t("div",Bt,[t("div",Ut,[t("div",null,[e[27]||(e[27]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"错误率",-1)),t("p",jt,l(E(r(C).errorRate||0)),1)]),e[28]||(e[28]=t("i",{class:"fas fa-exclamation-triangle text-2xl text-red-500"},null,-1))])]),t("div",Vt,[t("div",Et,[t("div",null,[e[29]||(e[29]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"平均响应时间",-1)),t("p",Mt,l(r(W)(r(C).averageResponseTime||0)),1)]),e[30]||(e[30]=t("i",{class:"fas fa-clock text-2xl text-green-500"},null,-1))])]),t("div",zt,[t("div",Jt,[t("div",null,[e[31]||(e[31]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"活跃 API Keys",-1)),t("p",Gt,l((($=r(C).topApiKeys)==null?void 0:$.length)||0),1)]),e[32]||(e[32]=t("i",{class:"fas fa-key text-2xl text-purple-500"},null,-1))])])]),t("div",Ht,[t("div",Qt,[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"筛选条件",-1)),r(z)?(c(),x("button",{key:0,class:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",onClick:e[3]||(e[3]=(...o)=>r(K)&&r(K)(...o))},e[33]||(e[33]=[t("i",{class:"fas fa-times mr-1"},null,-1),U(" 清除筛选 ",-1)]))):p("",!0)]),t("div",Wt,[t("div",null,[e[35]||(e[35]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 搜索 ",-1)),I(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>r(g).search=o),class:"form-input w-full",placeholder:"API Key、IP、路径...",onInput:e[5]||(e[5]=(...o)=>r(N)&&r(N)(...o))},null,544),[[Y,r(g).search]])]),t("div",null,[e[37]||(e[37]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," API Key ",-1)),I(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>r(g).apiKeyId=o),class:"form-select w-full",onChange:b},[e[36]||(e[36]=t("option",{value:""},"全部",-1)),(c(!0),x(vt,null,bt(r(C).topApiKeys,o=>(c(),x("option",{key:o.id,value:o.id},l(o.name),9,Xt))),128))],544),[[M,r(g).apiKeyId]])]),t("div",null,[e[39]||(e[39]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 状态码 ",-1)),I(t("select",{"onUpdate:modelValue":e[7]||(e[7]=o=>r(g).statusCode=o),class:"form-select w-full",onChange:b},e[38]||(e[38]=[kt('<option value="" data-v-52932ffa>全部</option><option value="200" data-v-52932ffa>200 (成功)</option><option value="400" data-v-52932ffa>400 (请求错误)</option><option value="401" data-v-52932ffa>401 (未授权)</option><option value="403" data-v-52932ffa>403 (禁止访问)</option><option value="429" data-v-52932ffa>429 (限流)</option><option value="500" data-v-52932ffa>500 (服务器错误)</option>',7)]),544),[[M,r(g).statusCode]])]),t("div",null,[e[41]||(e[41]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 时间范围 ",-1)),I(t("select",{"onUpdate:modelValue":e[8]||(e[8]=o=>m.value=o),class:"form-select w-full",onChange:X},e[40]||(e[40]=[kt('<option value="1h" data-v-52932ffa>最近 1 小时</option><option value="24h" data-v-52932ffa>最近 24 小时</option><option value="7d" data-v-52932ffa>最近 7 天</option><option value="30d" data-v-52932ffa>最近 30 天</option><option value="custom" data-v-52932ffa>自定义</option>',5)]),544),[[M,m.value]])])]),m.value==="custom"?(c(),x("div",Yt,[t("div",null,[e[42]||(e[42]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 开始时间 ",-1)),I(t("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>r(g).startDate=o),class:"form-input w-full",type:"datetime-local",onChange:b},null,544),[[Y,r(g).startDate]])]),t("div",null,[e[43]||(e[43]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 结束时间 ",-1)),I(t("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>r(g).endDate=o),class:"form-input w-full",type:"datetime-local",onChange:b},null,544),[[Y,r(g).endDate]])])])):p("",!0)]),t("div",Zt,[t("div",te,[t("div",ee,[t("span",se," 显示 "+l(r(L).length)+" 条记录，共 "+l(r(f).total)+" 条 ",1)]),t("div",ae,[I(t("select",{"onUpdate:modelValue":e[11]||(e[11]=o=>r(g).limit=o),class:"form-select text-sm",onChange:b},e[44]||(e[44]=[t("option",{value:"25"},"25 条/页",-1),t("option",{value:"50"},"50 条/页",-1),t("option",{value:"100"},"100 条/页",-1)]),544),[[M,r(g).limit]])])]),t("div",re,[t("table",oe,[t("thead",le,[t("tr",null,[t("th",{class:"table-header cursor-pointer",onClick:e[12]||(e[12]=o=>s("timestamp"))},[t("div",ne,[e[45]||(e[45]=t("span",null,"时间",-1)),t("i",{class:_(["fas fa-sort text-gray-400",a("timestamp")])},null,2)])]),e[49]||(e[49]=t("th",{class:"table-header"},"API Key",-1)),t("th",{class:"table-header cursor-pointer",onClick:e[13]||(e[13]=o=>s("request.method"))},[t("div",de,[e[46]||(e[46]=t("span",null,"方法",-1)),t("i",{class:_(["fas fa-sort text-gray-400",a("request.method")])},null,2)])]),e[50]||(e[50]=t("th",{class:"table-header"},"路径",-1)),t("th",{class:"table-header cursor-pointer",onClick:e[14]||(e[14]=o=>s("response.statusCode"))},[t("div",ie,[e[47]||(e[47]=t("span",null,"状态码",-1)),t("i",{class:_(["fas fa-sort text-gray-400",a("response.statusCode")])},null,2)])]),t("th",{class:"table-header cursor-pointer",onClick:e[15]||(e[15]=o=>s("response.duration"))},[t("div",ue,[e[48]||(e[48]=t("span",null,"响应时间",-1)),t("i",{class:_(["fas fa-sort text-gray-400",a("response.duration")])},null,2)])]),e[51]||(e[51]=t("th",{class:"table-header"},"IP 地址",-1)),e[52]||(e[52]=t("th",{class:"table-header"},"操作",-1))])]),t("tbody",ge,[r(h)?(c(),x("tr",xe,e[53]||(e[53]=[t("td",{class:"py-8 text-center",colspan:"8"},[t("div",{class:"flex items-center justify-center space-x-2"},[t("div",{class:"loading-spinner"}),t("span",{class:"text-gray-500 dark:text-gray-400"},"加载中...")])],-1)]))):r(L).length===0?(c(),x("tr",ce,e[54]||(e[54]=[t("td",{class:"py-12 text-center",colspan:"8"},[t("div",{class:"flex flex-col items-center space-y-2"},[t("i",{class:"fas fa-inbox text-4xl text-gray-300 dark:text-gray-600"}),t("p",{class:"text-gray-500 dark:text-gray-400"},"暂无日志记录"),t("p",{class:"text-sm text-gray-400 dark:text-gray-500"}," 请检查筛选条件或确认日志功能已启用 ")])],-1)]))):p("",!0),(c(!0),x(vt,null,bt(r(F),o=>{var nt,dt,it,ut,gt,xt,ct,mt,yt;return c(),x("tr",{key:o.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",me,[t("div",ye,l(r(R)(o).timestamp),1)]),t("td",fe,[t("div",pe,[t("div",{class:_(["h-2 w-2 rounded-full",(nt=o.apiKey)!=null&&nt.active?"bg-green-500":"bg-gray-400"])},null,2),t("span",ve,l(((dt=o.apiKey)==null?void 0:dt.name)||"Unknown"),1)])]),t("td",be,[t("span",{class:_(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",r(Q)((it=o.request)==null?void 0:it.method)])},l(((ut=o.request)==null?void 0:ut.method)||"N/A"),3)]),t("td",ke,[t("span",{class:"max-w-32 truncate text-sm text-gray-900 dark:text-gray-100",title:(gt=o.request)==null?void 0:gt.path},l(((xt=o.request)==null?void 0:xt.path)||"/"),9,we)]),t("td",he,[t("span",{class:_(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",r(H)((ct=o.response)==null?void 0:ct.statusCode)])},l(((mt=o.response)==null?void 0:mt.statusCode)||"N/A"),3)]),t("td",Ce,[t("span",qe,l(r(R)(o).duration),1)]),t("td",_e,[t("span",Le,l(((yt=o.request)==null?void 0:yt.ip)||"N/A"),1)]),t("td",Se,[t("button",{class:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",onClick:gs=>u(o)},e[55]||(e[55]=[t("i",{class:"fas fa-eye"},null,-1)]),8,De)])])}),128))])])]),r(f).totalPages>1?(c(),x("div",Ie,[t("div",Pe,[t("button",{class:"btn btn-secondary btn-sm",disabled:r(f).page<=1,onClick:e[16]||(e[16]=o=>d(r(f).page-1))},e[56]||(e[56]=[t("i",{class:"fas fa-chevron-left"},null,-1)]),8,Ae),t("span",Te," 第 "+l(r(f).page)+" 页，共 "+l(r(f).totalPages)+" 页 ",1),t("button",{class:"btn btn-secondary btn-sm",disabled:r(f).page>=r(f).totalPages,onClick:e[17]||(e[17]=o=>d(r(f).page+1))},e[57]||(e[57]=[t("i",{class:"fas fa-chevron-right"},null,-1)]),8,Oe)])])):p("",!0)]),n.value?(c(),x("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e[19]||(e[19]=Ct(o=>n.value=null,["self"]))},[t("div",Re,[t("div",$e,[e[59]||(e[59]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"日志详情",-1)),t("button",{class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:e[18]||(e[18]=o=>n.value=null)},e[58]||(e[58]=[t("i",{class:"fas fa-times text-xl"},null,-1)]))]),t("div",Fe,[t("div",Ke,[t("div",null,[e[66]||(e[66]=t("h4",{class:"text-md mb-3 font-semibold text-gray-900 dark:text-gray-100"},"基本信息",-1)),t("div",Ne,[t("div",null,[e[60]||(e[60]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"时间",-1)),t("p",Be,l(r(R)(n.value).timestamp),1)]),t("div",null,[e[61]||(e[61]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"API Key",-1)),t("p",Ue,l(((Z=n.value.apiKey)==null?void 0:Z.name)||"Unknown"),1)]),t("div",null,[e[62]||(e[62]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"请求方法",-1)),t("p",je,l(((tt=n.value.request)==null?void 0:tt.method)||"N/A"),1)]),t("div",null,[e[63]||(e[63]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"状态码",-1)),t("p",Ve,l(((et=n.value.response)==null?void 0:et.statusCode)||"N/A"),1)]),t("div",null,[e[64]||(e[64]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"响应时间",-1)),t("p",Ee,l(r(R)(n.value).duration),1)]),t("div",null,[e[65]||(e[65]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"IP 地址",-1)),t("p",Me,l(((st=n.value.request)==null?void 0:st.ip)||"N/A"),1)])])]),t("div",null,[e[71]||(e[71]=t("h4",{class:"text-md mb-3 font-semibold text-gray-900 dark:text-gray-100"},"请求信息",-1)),t("div",ze,[t("div",null,[e[67]||(e[67]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"请求路径",-1)),t("p",Je,l(((at=n.value.request)==null?void 0:at.path)||"/"),1)]),t("div",null,[e[68]||(e[68]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"User Agent",-1)),t("p",Ge,l(((rt=n.value.request)==null?void 0:rt.userAgent)||"N/A"),1)]),(ot=n.value.request)!=null&&ot.headers?(c(),x("div",He,[e[69]||(e[69]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"请求头",-1)),t("pre",Qe,l(JSON.stringify(n.value.request.headers,null,2)),1)])):p("",!0),(lt=n.value.request)!=null&&lt.body?(c(),x("div",We,[e[70]||(e[70]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"请求体",-1)),t("pre",Xe,l(JSON.stringify(n.value.request.body,null,2)),1)])):p("",!0)])]),n.value.response?(c(),x("div",Ye,[e[74]||(e[74]=t("h4",{class:"text-md mb-3 font-semibold text-gray-900 dark:text-gray-100"},"响应信息",-1)),t("div",Ze,[n.value.response.headers?(c(),x("div",ts,[e[72]||(e[72]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"响应头",-1)),t("pre",es,l(JSON.stringify(n.value.response.headers,null,2)),1)])):p("",!0),n.value.response.body?(c(),x("div",ss,[e[73]||(e[73]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"响应体",-1)),t("pre",as,l(JSON.stringify(n.value.response.body,null,2)),1)])):p("",!0)])])):p("",!0),n.value.usage?(c(),x("div",rs,[e[79]||(e[79]=t("h4",{class:"text-md mb-3 font-semibold text-gray-900 dark:text-gray-100"},"使用统计",-1)),t("div",os,[t("div",null,[e[75]||(e[75]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"输入 Tokens",-1)),t("p",ls,l(n.value.usage.inputTokens||0),1)]),t("div",null,[e[76]||(e[76]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"输出 Tokens",-1)),t("p",ns,l(n.value.usage.outputTokens||0),1)]),t("div",null,[e[77]||(e[77]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"总 Tokens",-1)),t("p",ds,l(n.value.usage.totalTokens||0),1)]),t("div",null,[e[78]||(e[78]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"模型",-1)),t("p",is,l(n.value.usage.model||"N/A"),1)])])])):p("",!0)])])])])):p("",!0)])}}},ps=qt(us,[["__scopeId","data-v-52932ffa"]]);export{ps as default};
