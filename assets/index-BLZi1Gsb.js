const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginView-RxYS9q1z.js","assets/vue-vendor-Ig-GgGwA.js","assets/ThemeToggle-CIJMIroR.js","assets/ThemeToggle-CzQ-uydY.css","assets/element-plus-lTawJ3jz.js","assets/vendor-DuCvjFhD.js","assets/element-plus-nq7etrhL.css","assets/LoginView-tn0RQdqM.css","assets/MainLayout-BkPEx1Hh.js","assets/toast-BvwA7Mwb.js","assets/LogoTitle-e4Y26oo4.js","assets/LogoTitle-DXipqypn.css","assets/MainLayout-CCQ2LruH.css","assets/DashboardView-oYuf3Zq7.js","assets/chart-CPgpx6U7.js","assets/DashboardView-CXNlSYti.css","assets/ApiKeysView-q7yMKII6.js","assets/WindowCountdown-DSqUCtdk.js","assets/CustomDropdown-CHeKUqQg.js","assets/CustomDropdown-jjrvIxsf.css","assets/ApiKeysView-BAk5rs4W.css","assets/AccountsView-CO6MPU8i.js","assets/AccountsView-BL1uVz1K.css","assets/TutorialView-C8u_v-Ug.js","assets/TutorialView-BVycHwR_.css","assets/SettingsView-PY1jGoK9.js","assets/SettingsView-CPn5ViiO.css","assets/ApiStatsView-Br6ybPiw.js","assets/ApiStatsView-CM9Kreez.css","assets/RequestLogsView-_Axyo5PF.js","assets/RequestLogsView-BnWmefR5.css"])))=>i.map(i=>d[i]);
import{aP as H,aQ as W,aR as q,r as g,c as k,o as $,q as D,V as N,I as M,z as p,x as b,ac as F,Q as J,a5 as j,y as w,C as R,L,P as E,Y as K,B as Q,R as I,J as X,T as Y,O as Z,av as ee,aM as te,aS as se}from"./vue-vendor-Ig-GgGwA.js";import{i as oe,z as ne}from"./element-plus-lTawJ3jz.js";import"./vendor-DuCvjFhD.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();const ae="modulepreload",re=function(o){return"/admin-next/"+o},U={},T=function(e,t,a){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(t.map(c=>{if(c=re(c),c in U)return;U[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const s=document.createElement("link");if(s.rel=u?"stylesheet":ae,u||(s.as="script"),s.crossOrigin="",s.href=c,l&&s.setAttribute("nonce",l),document.head.appendChild(s),u)return new Promise((h,f)=>{s.addEventListener("load",h),s.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return n.then(i=>{for(const l of i||[])l.status==="rejected"&&r(l.reason);return e().catch(r)})},O={basePath:"/admin-next/",apiPrefix:""};function ie(o=""){return o&&!o.startsWith("/")&&(o="/"+o),O.basePath+(o.startsWith("#")?o:"#"+o)}function ce(){return ie("/login")}const le=()=>T(()=>import("./LoginView-RxYS9q1z.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])),A=()=>T(()=>import("./MainLayout-BkPEx1Hh.js"),__vite__mapDeps([8,1,9,10,11,2,3,4,5,6,12])),ue=()=>T(()=>import("./DashboardView-oYuf3Zq7.js"),__vite__mapDeps([13,4,1,5,6,9,14,15])),de=()=>T(()=>import("./ApiKeysView-q7yMKII6.js"),__vite__mapDeps([16,4,1,5,6,9,17,18,19,20])),he=()=>T(()=>import("./AccountsView-CO6MPU8i.js"),__vite__mapDeps([21,4,1,5,6,9,18,19,22])),fe=()=>T(()=>import("./TutorialView-C8u_v-Ug.js"),__vite__mapDeps([23,1,4,5,6,24])),me=()=>T(()=>import("./SettingsView-PY1jGoK9.js"),__vite__mapDeps([25,1,9,4,5,6,26])),pe=()=>T(()=>import("./ApiStatsView-Br6ybPiw.js"),__vite__mapDeps([27,1,10,11,2,3,5,17,23,4,6,24,28])),ge=()=>T(()=>import("./RequestLogsView-_Axyo5PF.js"),__vite__mapDeps([29,1,9,5,4,6,30])),ve=[{path:"/",redirect:()=>{const o=window.location.pathname,e=O.basePath.replace(/\/$/,"");return o===e||o===e+"/","/api-stats"}},{path:"/login",name:"Login",component:le,meta:{requiresAuth:!1}},{path:"/api-stats",name:"ApiStats",component:pe,meta:{requiresAuth:!1}},{path:"/dashboard",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"Dashboard",component:ue}]},{path:"/api-keys",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"ApiKeys",component:de}]},{path:"/accounts",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"Accounts",component:he}]},{path:"/tutorial",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"Tutorial",component:fe}]},{path:"/settings",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"Settings",component:me}]},{path:"/request-logs",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"RequestLogs",component:ge}]},{path:"/:pathMatch(.*)*",redirect:"/api-stats"}],C=H({history:W(O.basePath),routes:ve});C.beforeEach((o,e,t)=>{const a=B();if(console.log("路由导航:",{to:o.path,from:e.path,fullPath:o.fullPath,requiresAuth:o.meta.requiresAuth,isAuthenticated:a.isAuthenticated}),o.path===e.path&&o.fullPath===e.fullPath)return t();o.path==="/api-stats"||o.path.startsWith("/api-stats")?t():o.meta.requiresAuth&&!a.isAuthenticated?t("/login"):o.path==="/login"&&a.isAuthenticated?t("/dashboard"):t()});const z=O.apiPrefix;function P(o){return o.startsWith("/")||(o="/"+o),z+o}class _e{constructor(){this.baseURL=z}getAuthToken(){return localStorage.getItem("authToken")||null}buildConfig(e={}){const t={headers:{"Content-Type":"application/json",...e.headers},...e},a=this.getAuthToken();return a&&(t.headers.Authorization=`Bearer ${a}`),t}async handleResponse(e,t="json"){if(e.status===401){const n=window.location.pathname+window.location.hash;throw n.includes("/login")||n.endsWith("/")||(localStorage.removeItem("authToken"),window.location.href=ce()),new Error("Unauthorized")}if(!e.ok){const n=e.headers.get("content-type");if(n&&n.includes("application/json"))try{const r=await e.json();throw new Error(r.error||r.message||`HTTP ${e.status}`)}catch{}throw new Error(`HTTP ${e.status}: ${e.statusText}`)}if(t==="blob")return{data:await e.blob(),headers:e.headers,status:e.status,statusText:e.statusText};const a=e.headers.get("content-type");return a&&a.includes("application/json")?await e.json():e}async get(e,t={}){const a=P(e),{responseType:n,...r}=t,i=this.buildConfig({...r,method:"GET"});try{const l=await fetch(a,i);return await this.handleResponse(l,n)}catch(l){throw console.error("API GET Error:",l),l}}async post(e,t=null,a={}){const n=P(e),{responseType:r,...i}=a;let l,c={};t&&(t instanceof FormData?l=t:(l=JSON.stringify(t),c["Content-Type"]="application/json"));const u=this.buildConfig({...i,method:"POST",body:l,headers:{...c,...i.headers}});try{const d=await fetch(n,u);return await this.handleResponse(d,r)}catch(d){throw console.error("API POST Error:",d),d}}async put(e,t=null,a={}){const n=P(e),{responseType:r,...i}=a,l=this.buildConfig({...i,method:"PUT",body:t?JSON.stringify(t):void 0});try{const c=await fetch(n,l);return await this.handleResponse(c,r)}catch(c){throw console.error("API PUT Error:",c),c}}async delete(e,t={}){const a=P(e),{data:n,responseType:r,...i}=t,l=this.buildConfig({...i,method:"DELETE",body:n?JSON.stringify(n):void 0});try{const c=await fetch(a,l);return await this.handleResponse(c,r)}catch(c){throw console.error("API DELETE Error:",c),c}}}const x=new _e,B=q("auth",()=>{const o=g(!1),e=g(localStorage.getItem("authToken")||""),t=g(""),a=g(""),n=g(!1),r=g({siteName:"Claude Relay Service",siteIcon:"",siteIconData:"",faviconData:""}),i=g(!0),l=k(()=>!!e.value&&o.value),c=k(()=>e.value),u=k(()=>({username:t.value}));async function d(m){n.value=!0,a.value="";try{const v=await x.post("/web/auth/login",m);v.success?(e.value=v.token,t.value=v.username||m.username,o.value=!0,localStorage.setItem("authToken",v.token),await C.push("/dashboard")):a.value=v.message||"登录失败"}catch(v){a.value=v.message||"登录失败，请检查用户名和密码"}finally{n.value=!1}}function s(){o.value=!1,e.value="",t.value="",localStorage.removeItem("authToken"),C.push("/login")}function h(){e.value&&(o.value=!0,f())}async function f(){try{const m=await x.get("/web/auth/user");m.success&&m.user&&(t.value=m.user.username),(await x.get("/admin/dashboard")).success||s()}catch{s()}}async function y(){i.value=!0;try{const m=await x.get("/admin/oem-settings");if(m.success&&m.data){if(r.value={...r.value,...m.data},m.data.siteIconData||m.data.siteIcon){const v=document.querySelector("link[rel*='icon']")||document.createElement("link");v.type="image/x-icon",v.rel="shortcut icon",v.href=m.data.siteIconData||m.data.siteIcon,document.getElementsByTagName("head")[0].appendChild(v)}m.data.siteName&&(document.title=`${m.data.siteName} - 管理后台`)}}catch(m){console.error("加载OEM设置失败:",m)}finally{i.value=!1}}return{isLoggedIn:o,authToken:e,username:t,loginError:a,loginLoading:n,oemSettings:r,oemLoading:i,isAuthenticated:l,token:c,user:u,login:d,logout:s,checkAuth:h,loadOemSettings:y}}),_={LIGHT:"light",DARK:"dark",AUTO:"auto"},ye=q("theme",()=>{const o=g(_.AUTO),e=g(!1),t=k(()=>o.value===_.DARK?!0:o.value===_.LIGHT?!1:e.value),a=k(()=>t.value?_.DARK:_.LIGHT),n=()=>{const s=window.matchMedia("(prefers-color-scheme: dark)");e.value=s.matches;const h=localStorage.getItem("themeMode");h&&Object.values(_).includes(h)?o.value=h:o.value=_.AUTO,r(),c()},r=()=>{const s=document.documentElement;t.value?s.classList.add("dark"):s.classList.remove("dark")},i=s=>{Object.values(_).includes(s)&&(o.value=s)},l=()=>{const s=[_.LIGHT,_.DARK,_.AUTO],f=(s.indexOf(o.value)+1)%s.length;o.value=s[f]};$(o,s=>{localStorage.setItem("themeMode",s),r()}),$(e,()=>{o.value===_.AUTO&&r()});const c=()=>{const s=window.matchMedia("(prefers-color-scheme: dark)"),h=f=>{e.value=f.matches};return e.value=s.matches,s.addEventListener("change",h),()=>{s.removeEventListener("change",h)}};return{themeMode:o,isDarkMode:t,currentTheme:a,systemPrefersDark:e,ThemeMode:_,initTheme:n,setThemeMode:i,cycleThemeMode:l,watchSystemTheme:c,toggleTheme:()=>{l()},setTheme:s=>{s==="dark"?i(_.DARK):s==="light"&&i(_.LIGHT)}}}),V=(o,e)=>{const t=o.__vccOpts||o;for(const[a,n]of e)t[a]=n;return t},we={class:"toast-container"},Te=["onClick"],be={class:"toast-content"},Ae={class:"toast-icon"},Ee={class:"toast-body"},ke={key:0,class:"toast-title"},Pe={class:"toast-message"},xe=["onClick"],Ie={__name:"ToastNotification",setup(o,{expose:e}){const t=g([]);let a=0;const n=u=>{const d={success:"fas fa-check-circle",error:"fas fa-exclamation-circle",warning:"fas fa-exclamation-triangle",info:"fas fa-info-circle"};return d[u]||d.info},r=(u,d="info",s=null,h=5e3)=>{const f=++a,y={id:f,message:u,type:d,title:s,duration:h,isVisible:!1};return t.value.push(y),setTimeout(()=>{y.isVisible=!0},10),h>0&&setTimeout(()=>{i(f)},h),f},i=u=>{const d=t.value.findIndex(s=>s.id===u);if(d>-1){const s=t.value[d];s.isVisible=!1,setTimeout(()=>{const h=t.value.findIndex(f=>f.id===u);h>-1&&t.value.splice(h,1)},300)}},l=()=>{t.value.forEach(u=>{u.isVisible=!1}),setTimeout(()=>{t.value.length=0},300)},c=(u,d="info",s=null,h=5e3)=>r(u,d,s,h);return D(()=>{window.showToast=c}),N(()=>{window.showToast===c&&delete window.showToast}),e({showToast:c,removeToast:i,clearAllToasts:l}),(u,d)=>(w(),M(j,{to:"body"},[p("div",we,[(w(!0),b(J,null,F(t.value,s=>(w(),b("div",{key:s.id,class:R(["toast",`toast-${s.type}`,s.isVisible?"toast-show":"toast-hide"]),onClick:h=>i(s.id)},[p("div",be,[p("div",Ae,[p("i",{class:R(n(s.type))},null,2)]),p("div",Ee,[s.title?(w(),b("div",ke,E(s.title),1)):L("",!0),p("div",Pe,E(s.message),1)]),p("button",{class:"toast-close",onClick:K(h=>i(s.id),["stop"])},d[0]||(d[0]=[p("i",{class:"fas fa-times"},null,-1)]),8,xe)]),s.duration>0?(w(),b("div",{key:0,class:"toast-progress",style:Q({animationDuration:`${s.duration}ms`})},null,4)):L("",!0)],10,Te))),128))])]))}},Le=V(Ie,[["__scopeId","data-v-c8b24ff5"]]),Ce={class:"modal-content mx-auto w-full max-w-md p-6"},Oe={class:"mb-6 flex items-start gap-4"},Se={class:"flex-1"},Re={class:"mb-2 text-lg font-semibold text-gray-900 dark:text-white"},De={class:"whitespace-pre-line leading-relaxed text-gray-700 dark:text-gray-400"},Ve={class:"flex items-center justify-end gap-3"},$e=["disabled"],Ue=["disabled"],qe={key:0,class:"loading-spinner mr-2"},Ne={__name:"ConfirmDialog",setup(o,{expose:e}){const t=g(!1),a=g(!1),n=g(""),r=g(""),i=g("确认"),l=g("取消");let c=null;const u=(f,y,m="确认",v="取消")=>new Promise(G=>{n.value=f,r.value=y,i.value=m,l.value=v,t.value=!0,a.value=!1,c=G}),d=()=>{a.value||(a.value=!0,setTimeout(()=>{t.value=!1,a.value=!1,c&&(c(!0),c=null)},200))},s=()=>{a.value||(t.value=!1,c&&(c(!1),c=null))},h=f=>{t.value&&(f.key==="Escape"?s():f.key==="Enter"&&!f.shiftKey&&!f.ctrlKey&&!f.altKey&&d())};return D(()=>{window.showConfirm=u,document.addEventListener("keydown",h)}),N(()=>{window.showConfirm===u&&delete window.showConfirm,document.removeEventListener("keydown",h)}),e({showConfirm:u}),(f,y)=>(w(),M(j,{to:"body"},[I(Y,{appear:"",name:"modal"},{default:X(()=>[t.value?(w(),b("div",{key:0,class:"modal fixed inset-0 z-[100] flex items-center justify-center p-4",onClick:K(s,["self"])},[p("div",Ce,[p("div",Oe,[y[0]||(y[0]=p("div",{class:"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-amber-500 to-amber-600"},[p("i",{class:"fas fa-exclamation-triangle text-lg text-white"})],-1)),p("div",Se,[p("h3",Re,E(n.value),1),p("div",De,E(r.value),1)])]),p("div",Ve,[p("button",{class:"btn bg-gray-100 px-6 py-3 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",disabled:a.value,onClick:s},E(l.value),9,$e),p("button",{class:R(["btn btn-warning px-6 py-3",{"cursor-not-allowed opacity-50":a.value}]),disabled:a.value,onClick:d},[a.value?(w(),b("div",qe)):L("",!0),Z(" "+E(i.value),1)],10,Ue)])])])):L("",!0)]),_:1})]))}},Me=V(Ne,[["__scopeId","data-v-6b3390a6"]]),je={id:"app"},Ke={__name:"App",setup(o){const e=B(),t=ye(),a=g(),n=g();return D(()=>{t.initTheme(),t.watchSystemTheme(),e.checkAuth(),e.loadOemSettings()}),(r,i)=>{const l=ee("router-view");return w(),b("div",je,[I(l),I(Le,{ref_key:"toastRef",ref:a},null,512),I(Me,{ref_key:"confirmRef",ref:n},null,512)])}}},ze=V(Ke,[["__scopeId","data-v-dab04b7e"]]),S=te(ze),Be=se();S.use(Be);S.use(C);S.use(oe,{locale:ne});S.mount("#app");export{V as _,ye as a,x as b,B as u};
