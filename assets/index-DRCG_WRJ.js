const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginView-DtK6NjyT.js","assets/vue-vendor-C9wZz30M.js","assets/ThemeToggle-B1rDsJox.js","assets/ThemeToggle-CzQ-uydY.css","assets/element-plus-5SvmA99H.js","assets/vendor-DeB155zE.js","assets/element-plus-6gb5osKz.css","assets/LoginView-tn0RQdqM.css","assets/MainLayout-CurcX3SZ.js","assets/toast-BvwA7Mwb.js","assets/LogoTitle-CCuIL5IS.js","assets/LogoTitle-DXipqypn.css","assets/MainLayout-CCQ2LruH.css","assets/DashboardView-DWZW6CpC.js","assets/chart-D2XTohFh.js","assets/DashboardView-CXNlSYti.css","assets/ApiKeysView-DsbyygGB.js","assets/WindowCountdown-Dvs-5H5J.js","assets/CustomDropdown-oQzkw8Ea.js","assets/CustomDropdown-jjrvIxsf.css","assets/ApiKeysView-tzwtTcBA.css","assets/AccountsView-CYekUcN7.js","assets/AccountsView-B3Zypun0.css","assets/TutorialView-BntC5SO-.js","assets/TutorialView-Bnd6c_gD.css","assets/SettingsView-NYAhz-vV.js","assets/requestLogs-BLTKo0kz.js","assets/SettingsView-BY7xk7UM.css","assets/ApiStatsView-CHtHjFSf.js","assets/ApiStatsView-CXCjOsh4.css","assets/RequestLogsView-BHuMdpa8.js","assets/RequestLogsView-CmEg5-Gg.css"])))=>i.map(i=>d[i]);
import{aR as H,aS as W,aT as q,r as g,c as k,o as $,q as D,V as j,I as N,z as p,x as b,ac as F,Q as J,a5 as M,y as w,C as R,L,P as E,Y as K,B as Q,R as I,J as X,T as Y,O as Z,ax as ee,aO as te,aU as se}from"./vue-vendor-C9wZz30M.js";import{i as oe,z as ne}from"./element-plus-5SvmA99H.js";import"./vendor-DeB155zE.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();const ae="modulepreload",re=function(o){return"/admin-next/"+o},U={},T=function(e,s,a){let n=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),l=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));n=Promise.allSettled(s.map(r=>{if(r=re(r),r in U)return;U[r]=!0;const u=r.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${d}`))return;const t=document.createElement("link");if(t.rel=u?"stylesheet":ae,u||(t.as="script"),t.crossOrigin="",t.href=r,l&&t.setAttribute("nonce",l),document.head.appendChild(t),u)return new Promise((h,f)=>{t.addEventListener("load",h),t.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${r}`)))})}))}function i(c){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=c,window.dispatchEvent(l),!l.defaultPrevented)throw c}return n.then(c=>{for(const l of c||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},S={basePath:"/admin-next/",apiPrefix:""};function ie(o=""){return o&&!o.startsWith("/")&&(o="/"+o),S.basePath+(o.startsWith("#")?o:"#"+o)}function ce(){return ie("/login")}const le=()=>T(()=>import("./LoginView-DtK6NjyT.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])),A=()=>T(()=>import("./MainLayout-CurcX3SZ.js"),__vite__mapDeps([8,1,9,10,11,2,3,4,5,6,12])),ue=()=>T(()=>import("./DashboardView-DWZW6CpC.js"),__vite__mapDeps([13,4,1,5,6,9,14,15])),de=()=>T(()=>import("./ApiKeysView-DsbyygGB.js"),__vite__mapDeps([16,4,1,5,6,9,17,18,19,20])),he=()=>T(()=>import("./AccountsView-CYekUcN7.js"),__vite__mapDeps([21,4,1,5,6,9,18,19,22])),fe=()=>T(()=>import("./TutorialView-BntC5SO-.js"),__vite__mapDeps([23,1,4,5,6,24])),me=()=>T(()=>import("./SettingsView-NYAhz-vV.js"),__vite__mapDeps([25,1,9,26,4,5,6,27])),pe=()=>T(()=>import("./ApiStatsView-CHtHjFSf.js"),__vite__mapDeps([28,1,10,11,2,3,5,17,23,4,6,24,29])),ge=()=>T(()=>import("./RequestLogsView-BHuMdpa8.js"),__vite__mapDeps([30,1,26,9,14,5,4,6,31])),ve=[{path:"/",redirect:()=>{const o=window.location.pathname,e=S.basePath.replace(/\/$/,"");return o===e||o===e+"/","/api-stats"}},{path:"/login",name:"Login",component:le,meta:{requiresAuth:!1}},{path:"/api-stats",name:"ApiStats",component:pe,meta:{requiresAuth:!1}},{path:"/dashboard",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"Dashboard",component:ue}]},{path:"/api-keys",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"ApiKeys",component:de}]},{path:"/accounts",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"Accounts",component:he}]},{path:"/tutorial",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"Tutorial",component:fe}]},{path:"/settings",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"Settings",component:me}]},{path:"/request-logs",component:A,meta:{requiresAuth:!0},children:[{path:"",name:"RequestLogs",component:ge}]},{path:"/:pathMatch(.*)*",redirect:"/api-stats"}],O=H({history:W(S.basePath),routes:ve});O.beforeEach((o,e,s)=>{const a=z();if(console.log("路由导航:",{to:o.path,from:e.path,fullPath:o.fullPath,requiresAuth:o.meta.requiresAuth,isAuthenticated:a.isAuthenticated}),o.path===e.path&&o.fullPath===e.fullPath)return s();o.path==="/api-stats"||o.path.startsWith("/api-stats")?s():o.meta.requiresAuth&&!a.isAuthenticated?s("/login"):o.path==="/login"&&a.isAuthenticated?s("/dashboard"):s()});const G=S.apiPrefix;function P(o){return o.startsWith("/")||(o="/"+o),G+o}class _e{constructor(){this.baseURL=G}getAuthToken(){return localStorage.getItem("authToken")||null}buildConfig(e={}){const s={headers:{"Content-Type":"application/json",...e.headers},...e},a=this.getAuthToken();return a&&(s.headers.Authorization=`Bearer ${a}`),s}async handleResponse(e,s="json"){if(e.status===401){const n=window.location.pathname+window.location.hash;throw n.includes("/login")||n.endsWith("/")||(localStorage.removeItem("authToken"),window.location.href=ce()),new Error("Unauthorized")}if(!e.ok){const n=e.headers.get("content-type");if(n&&n.includes("application/json"))try{const i=await e.json();throw new Error(i.error||i.message||`HTTP ${e.status}`)}catch{}throw new Error(`HTTP ${e.status}: ${e.statusText}`)}if(s==="blob")return{data:await e.blob(),headers:e.headers,status:e.status,statusText:e.statusText};const a=e.headers.get("content-type");return a&&a.includes("application/json")?await e.json():e}async get(e,s={}){let a=P(e);const{responseType:n,params:i,...c}=s;if(i&&Object.keys(i).length>0){const r=new URLSearchParams;Object.entries(i).forEach(([d,t])=>{t!=null&&t!==""&&r.append(d,t)});const u=r.toString();u&&(a+=(a.includes("?")?"&":"?")+u)}const l=this.buildConfig({...c,method:"GET"});try{console.log("🌐 API GET请求:",{fullUrl:a,params:i,config:l});const r=await fetch(a,l);return await this.handleResponse(r,n)}catch(r){throw console.error("API GET Error:",r),r}}async post(e,s=null,a={}){const n=P(e),{responseType:i,...c}=a;let l,r={};s&&(s instanceof FormData?l=s:(l=JSON.stringify(s),r["Content-Type"]="application/json"));const u=this.buildConfig({...c,method:"POST",body:l,headers:{...r,...c.headers}});try{const d=await fetch(n,u);return await this.handleResponse(d,i)}catch(d){throw console.error("API POST Error:",d),d}}async put(e,s=null,a={}){const n=P(e),{responseType:i,...c}=a,l=this.buildConfig({...c,method:"PUT",body:s?JSON.stringify(s):void 0});try{const r=await fetch(n,l);return await this.handleResponse(r,i)}catch(r){throw console.error("API PUT Error:",r),r}}async delete(e,s={}){const a=P(e),{data:n,responseType:i,...c}=s,l=this.buildConfig({...c,method:"DELETE",body:n?JSON.stringify(n):void 0});try{const r=await fetch(a,l);return await this.handleResponse(r,i)}catch(r){throw console.error("API DELETE Error:",r),r}}}const x=new _e,z=q("auth",()=>{const o=g(!1),e=g(localStorage.getItem("authToken")||""),s=g(""),a=g(""),n=g(!1),i=g({siteName:"Claude Relay Service",siteIcon:"",siteIconData:"",faviconData:""}),c=g(!0),l=k(()=>!!e.value&&o.value),r=k(()=>e.value),u=k(()=>({username:s.value}));async function d(m){n.value=!0,a.value="";try{const v=await x.post("/web/auth/login",m);v.success?(e.value=v.token,s.value=v.username||m.username,o.value=!0,localStorage.setItem("authToken",v.token),await O.push("/dashboard")):a.value=v.message||"登录失败"}catch(v){a.value=v.message||"登录失败，请检查用户名和密码"}finally{n.value=!1}}function t(){o.value=!1,e.value="",s.value="",localStorage.removeItem("authToken"),O.push("/login")}function h(){e.value&&(o.value=!0,f())}async function f(){try{const m=await x.get("/web/auth/user");m.success&&m.user&&(s.value=m.user.username),(await x.get("/admin/dashboard")).success||t()}catch{t()}}async function y(){c.value=!0;try{const m=await x.get("/admin/oem-settings");if(m.success&&m.data){if(i.value={...i.value,...m.data},m.data.siteIconData||m.data.siteIcon){const v=document.querySelector("link[rel*='icon']")||document.createElement("link");v.type="image/x-icon",v.rel="shortcut icon",v.href=m.data.siteIconData||m.data.siteIcon,document.getElementsByTagName("head")[0].appendChild(v)}m.data.siteName&&(document.title=`${m.data.siteName} - 管理后台`)}}catch(m){console.error("加载OEM设置失败:",m)}finally{c.value=!1}}return{isLoggedIn:o,authToken:e,username:s,loginError:a,loginLoading:n,oemSettings:i,oemLoading:c,isAuthenticated:l,token:r,user:u,login:d,logout:t,checkAuth:h,loadOemSettings:y}}),_={LIGHT:"light",DARK:"dark",AUTO:"auto"},ye=q("theme",()=>{const o=g(_.AUTO),e=g(!1),s=k(()=>o.value===_.DARK?!0:o.value===_.LIGHT?!1:e.value),a=k(()=>s.value?_.DARK:_.LIGHT),n=()=>{const t=window.matchMedia("(prefers-color-scheme: dark)");e.value=t.matches;const h=localStorage.getItem("themeMode");h&&Object.values(_).includes(h)?o.value=h:o.value=_.AUTO,i(),r()},i=()=>{const t=document.documentElement;s.value?t.classList.add("dark"):t.classList.remove("dark")},c=t=>{Object.values(_).includes(t)&&(o.value=t)},l=()=>{const t=[_.LIGHT,_.DARK,_.AUTO],f=(t.indexOf(o.value)+1)%t.length;o.value=t[f]};$(o,t=>{localStorage.setItem("themeMode",t),i()}),$(e,()=>{o.value===_.AUTO&&i()});const r=()=>{const t=window.matchMedia("(prefers-color-scheme: dark)"),h=f=>{e.value=f.matches};return e.value=t.matches,t.addEventListener("change",h),()=>{t.removeEventListener("change",h)}};return{themeMode:o,isDarkMode:s,currentTheme:a,systemPrefersDark:e,ThemeMode:_,initTheme:n,setThemeMode:c,cycleThemeMode:l,watchSystemTheme:r,toggleTheme:()=>{l()},setTheme:t=>{t==="dark"?c(_.DARK):t==="light"&&c(_.LIGHT)}}}),V=(o,e)=>{const s=o.__vccOpts||o;for(const[a,n]of e)s[a]=n;return s},we={class:"toast-container"},Te=["onClick"],be={class:"toast-content"},Ae={class:"toast-icon"},Ee={class:"toast-body"},ke={key:0,class:"toast-title"},Pe={class:"toast-message"},xe=["onClick"],Ie={__name:"ToastNotification",setup(o,{expose:e}){const s=g([]);let a=0;const n=u=>{const d={success:"fas fa-check-circle",error:"fas fa-exclamation-circle",warning:"fas fa-exclamation-triangle",info:"fas fa-info-circle"};return d[u]||d.info},i=(u,d="info",t=null,h=5e3)=>{const f=++a,y={id:f,message:u,type:d,title:t,duration:h,isVisible:!1};return s.value.push(y),setTimeout(()=>{y.isVisible=!0},10),h>0&&setTimeout(()=>{c(f)},h),f},c=u=>{const d=s.value.findIndex(t=>t.id===u);if(d>-1){const t=s.value[d];t.isVisible=!1,setTimeout(()=>{const h=s.value.findIndex(f=>f.id===u);h>-1&&s.value.splice(h,1)},300)}},l=()=>{s.value.forEach(u=>{u.isVisible=!1}),setTimeout(()=>{s.value.length=0},300)},r=(u,d="info",t=null,h=5e3)=>i(u,d,t,h);return D(()=>{window.showToast=r}),j(()=>{window.showToast===r&&delete window.showToast}),e({showToast:r,removeToast:c,clearAllToasts:l}),(u,d)=>(w(),N(M,{to:"body"},[p("div",we,[(w(!0),b(J,null,F(s.value,t=>(w(),b("div",{key:t.id,class:R(["toast",`toast-${t.type}`,t.isVisible?"toast-show":"toast-hide"]),onClick:h=>c(t.id)},[p("div",be,[p("div",Ae,[p("i",{class:R(n(t.type))},null,2)]),p("div",Ee,[t.title?(w(),b("div",ke,E(t.title),1)):L("",!0),p("div",Pe,E(t.message),1)]),p("button",{class:"toast-close",onClick:K(h=>c(t.id),["stop"])},[...d[0]||(d[0]=[p("i",{class:"fas fa-times"},null,-1)])],8,xe)]),t.duration>0?(w(),b("div",{key:0,class:"toast-progress",style:Q({animationDuration:`${t.duration}ms`})},null,4)):L("",!0)],10,Te))),128))])]))}},Le=V(Ie,[["__scopeId","data-v-c8b24ff5"]]),Oe={class:"modal-content mx-auto w-full max-w-md p-6"},Se={class:"mb-6 flex items-start gap-4"},Ce={class:"flex-1"},Re={class:"mb-2 text-lg font-semibold text-gray-900 dark:text-white"},De={class:"whitespace-pre-line leading-relaxed text-gray-700 dark:text-gray-400"},Ve={class:"flex items-center justify-end gap-3"},$e=["disabled"],Ue=["disabled"],qe={key:0,class:"loading-spinner mr-2"},je={__name:"ConfirmDialog",setup(o,{expose:e}){const s=g(!1),a=g(!1),n=g(""),i=g(""),c=g("确认"),l=g("取消");let r=null;const u=(f,y,m="确认",v="取消")=>new Promise(B=>{n.value=f,i.value=y,c.value=m,l.value=v,s.value=!0,a.value=!1,r=B}),d=()=>{a.value||(a.value=!0,setTimeout(()=>{s.value=!1,a.value=!1,r&&(r(!0),r=null)},200))},t=()=>{a.value||(s.value=!1,r&&(r(!1),r=null))},h=f=>{s.value&&(f.key==="Escape"?t():f.key==="Enter"&&!f.shiftKey&&!f.ctrlKey&&!f.altKey&&d())};return D(()=>{window.showConfirm=u,document.addEventListener("keydown",h)}),j(()=>{window.showConfirm===u&&delete window.showConfirm,document.removeEventListener("keydown",h)}),e({showConfirm:u}),(f,y)=>(w(),N(M,{to:"body"},[I(Y,{appear:"",name:"modal"},{default:X(()=>[s.value?(w(),b("div",{key:0,class:"modal fixed inset-0 z-[100] flex items-center justify-center p-4",onClick:K(t,["self"])},[p("div",Oe,[p("div",Se,[y[0]||(y[0]=p("div",{class:"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-amber-500 to-amber-600"},[p("i",{class:"fas fa-exclamation-triangle text-lg text-white"})],-1)),p("div",Ce,[p("h3",Re,E(n.value),1),p("div",De,E(i.value),1)])]),p("div",Ve,[p("button",{class:"btn bg-gray-100 px-6 py-3 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",disabled:a.value,onClick:t},E(l.value),9,$e),p("button",{class:R(["btn btn-warning px-6 py-3",{"cursor-not-allowed opacity-50":a.value}]),disabled:a.value,onClick:d},[a.value?(w(),b("div",qe)):L("",!0),Z(" "+E(c.value),1)],10,Ue)])])])):L("",!0)]),_:1})]))}},Ne=V(je,[["__scopeId","data-v-6b3390a6"]]),Me={id:"app"},Ke={__name:"App",setup(o){const e=z(),s=ye(),a=g(),n=g();return D(()=>{s.initTheme(),s.watchSystemTheme(),e.checkAuth(),e.loadOemSettings()}),(i,c)=>{const l=ee("router-view");return w(),b("div",Me,[I(l),I(Le,{ref_key:"toastRef",ref:a},null,512),I(Ne,{ref_key:"confirmRef",ref:n},null,512)])}}},Ge=V(Ke,[["__scopeId","data-v-dab04b7e"]]),C=te(Ge),ze=se();C.use(ze);C.use(O);C.use(oe,{locale:ne});C.mount("#app");export{V as _,ye as a,x as b,z as u};
